<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Copy/Paste Detector Report</title><link href="styles/tailwind.css" rel="stylesheet"><link href="styles/prism.css" rel="stylesheet"></head><body class="bg-gray-100"><header class="bg-white shadow py-4"><div class="container mx-auto px-4"><h1 class="text-3xl font-semibold text-gray-800">jscpd - copy/paste report</h1></div></header><main class="container mx-auto my-8 p-4 bg-white shadow rounded"><section class="mb-8" id="dashboard"><h2 class="text-2xl font-semibold text-gray-700 mb-4">Dashboard</h2><div class="grid grid-cols-4 gap-4"><div class="bg-blue-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-blue-800 mb-2">Total Files</h3><span class="text-4xl font-bold text-blue-800">961</span></div><div class="bg-green-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-green-800 mb-2">Total Lines of Code</h3><span class="text-4xl font-bold text-green-800">132367</span></div><div class="bg-yellow-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-yellow-800 mb-2">Number of Clones</h3><span class="text-4xl font-bold text-yellow-800">975</span></div><div class="bg-red-200 p-4 rounded text-center"><h3 class="text-lg font-semibold text-red-800 mb-2">Duplicated Lines</h3><span class="text-4xl font-bold text-red-800">26417 (19.96%)</span></div></div></section><section class="mb-8" id="formats"><h2 class="text-2xl font-semibold text-gray-700 mb-4">Formats with Duplications</h2><table class="w-full table-auto"><thead><tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal"><th class="py-3 px-6 text-left">Format</th><th class="py-3 px-6 text-left">Files</th><th class="py-3 px-6 text-left">Lines</th><th class="py-3 px-6 text-left">Clones</th><th class="py-3 px-6 text-left">Duplicated Lines</th><th class="py-3 px-6 text-left">Duplicated Tokens</th></tr></thead><tbody><tr class="bg-white border-b border-gray-200 text-gray-800 text-sm"><td class="py-3 px-6"><a class="text-blue-600 hover:underline" href="#javascript-clones">javascript</a></td><td class="py-3 px-6">630</td><td class="py-3 px-6">90076</td><td class="py-3 px-6">621</td><td class="py-3 px-6">20302</td><td class="py-3 px-6">146742</td></tr><tr class="bg-white border-b border-gray-200 text-gray-800 text-sm"><td class="py-3 px-6"><a class="text-blue-600 hover:underline" href="#jsx-clones">jsx</a></td><td class="py-3 px-6">331</td><td class="py-3 px-6">42291</td><td class="py-3 px-6">354</td><td class="py-3 px-6">6115</td><td class="py-3 px-6">43248</td></tr></tbody></table></section><section class="mb-8" id="txt-clones"><a name="javascript-clones"></a><h2 class="text-2xl font-semibold text-gray-700 mb-4">javascript</h2><div class="divide-y divide-gray-200 border-b-2"><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/MySQL.js (Line 24:2 - Line 38:2), server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/Postgresql.js (Line 17:2 - Line 31:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn0" onclick="toggleCodeBlock('cloneGroup0', 'expandBtn0', 'collapseBtn0')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn0" onclick="toggleCodeBlock('cloneGroup0', 'expandBtn0', 'collapseBtn0')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup0"><code class="language-javascript text-sm text-gray-800">);
    this.#connected = true;
    return this._client;
  }

  /**
   *
   * @param {string} queryString the SQL query to be run
   * @returns {import(&quot;.&quot;).QueryResult}
   */
  async runQuery(queryString = &quot;&quot;) {
    const result = { rows: [], count: 0, error: null };
    try {
      if (!this.#connected) await this.connect();
      const [</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/MySQL.js (Line 40:7 - Line 52:73), server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/Postgresql.js (Line 33:9 - Line 45:65)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn1" onclick="toggleCodeBlock('cloneGroup1', 'expandBtn1', 'collapseBtn1')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn1" onclick="toggleCodeBlock('cloneGroup1', 'expandBtn1', 'collapseBtn1')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup1"><code class="language-javascript text-sm text-gray-800">;
    } catch (err) {
      console.log(this.constructor.name, err);
      result.error = err.message;
    } finally {
      await this._client.end();
      this.#connected = false;
    }
    return result;
  }

  getTablesSql() {
    return `SELECT table_name FROM information_schema.tables WHERE table_schema = '</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/MSSQL.js (Line 52:17 - Line 67:1), server/utils/agents/aibitat/plugins/sql-agent/SQLConnectors/Postgresql.js (Line 17:2 - Line 31:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn2" onclick="toggleCodeBlock('cloneGroup2', 'expandBtn2', 'collapseBtn2')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn2" onclick="toggleCodeBlock('cloneGroup2', 'expandBtn2', 'collapseBtn2')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup2"><code class="language-javascript text-sm text-gray-800">);
    this.#connected = true;
    return this._client;
  }

  /**
   *
   * @param {string} queryString the SQL query to be run
   * @returns {import(&quot;.&quot;).QueryResult}
   */
  async runQuery(queryString = &quot;&quot;) {
    const result = { rows: [], count: 0, error: null };
    try {
      if (!this.#connected) await this.connect();

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/list-table.js (Line 29:2 - Line 39:94), server/utils/agents/aibitat/plugins/sql-agent/query.js (Line 40:15 - Line 50:121)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn3" onclick="toggleCodeBlock('cloneGroup3', 'expandBtn3', 'collapseBtn3')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn3" onclick="toggleCodeBlock('cloneGroup3', 'expandBtn3', 'collapseBtn3')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup3"><code class="language-javascript text-sm text-gray-800">}),
            },
          ],
          parameters: {
            $schema: &quot;http://json-schema.org/draft-07/schema#&quot;,
            type: &quot;object&quot;,
            properties: {
              database_id: {
                type: &quot;string&quot;,
                description:
                  &quot;The database identifier for which we will list all tables for. This is a required parameter&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/list-table.js (Line 68:38 - Line 86:1), server/utils/agents/aibitat/plugins/sql-agent/query.js (Line 84:32 - Line 102:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn4" onclick="toggleCodeBlock('cloneGroup4', 'expandBtn4', 'collapseBtn4')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn4" onclick="toggleCodeBlock('cloneGroup4', 'expandBtn4', 'collapseBtn4')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup4"><code class="language-javascript text-sm text-gray-800">,
                  result.error
                );
                this.super.introspect(`Error: ${result.error}`);
                return `There was an error running the query: ${result.error}`;
              }

              return JSON.stringify(result);
            } catch (e) {
              console.error(e);
              return e.message;
            }
          },
        });
      },
    };
  },
};
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/sql-agent/get-table-schema.js (Line 30:8 - Line 41:108), server/utils/agents/aibitat/plugins/sql-agent/query.js (Line 39:66 - Line 50:121)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn5" onclick="toggleCodeBlock('cloneGroup5', 'expandBtn5', 'collapseBtn5')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn5" onclick="toggleCodeBlock('cloneGroup5', 'expandBtn5', 'collapseBtn5')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup5"><code class="language-javascript text-sm text-gray-800">,
              }),
            },
          ],
          parameters: {
            $schema: &quot;http://json-schema.org/draft-07/schema#&quot;,
            type: &quot;object&quot;,
            properties: {
              database_id: {
                type: &quot;string&quot;,
                description:
                  &quot;The database identifier for which we will connect to to query the table schema. This is a required field.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/example/websocket/websock-branding-collab.js (Line 2:56 - Line 42:5), server/utils/agents/aibitat/example/websocket/websock-multi-turn-chat.js (Line 2:56 - Line 42:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn6" onclick="toggleCodeBlock('cloneGroup6', 'expandBtn6', 'collapseBtn6')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn6" onclick="toggleCodeBlock('cloneGroup6', 'expandBtn6', 'collapseBtn6')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup6"><code class="language-javascript text-sm text-gray-800">
// Scraping is enabled, but search requires AGENT_GSE_* keys.

const express = require(&quot;express&quot;);
const chalk = require(&quot;chalk&quot;);
const AIbitat = require(&quot;../../index.js&quot;);
const {
  websocket,
  webBrowsing,
  webScraping,
} = require(&quot;../../plugins/index.js&quot;);
const path = require(&quot;path&quot;);
const port = 3000;
const app = express();
require(&quot;@mintplex-labs/express-ws&quot;).default(app); // load WebSockets in non-SSL mode.
require(&quot;dotenv&quot;).config({ path: `../../../../../.env.development` });

// Debugging echo function if this is working for you.
// app.ws('/echo', function (ws, req) {
//   ws.on('message', function (msg) {
//     ws.send(msg);
//   });
// });

// Set up WSS sockets for listening.
app.ws(&quot;/ws&quot;, function (ws, _response) {
  try {
    ws.on(&quot;message&quot;, function (msg) {
      if (ws?.handleFeedback) ws.handleFeedback(msg);
    });

    ws.on(&quot;close&quot;, function () {
      console.log(&quot;Socket killed&quot;);
      return;
    });

    console.log(&quot;Socket online and waiting...&quot;);
    runAIbitat(ws).catch((error) =&gt; {
      ws.send(
        JSON.stringify({
          from: &quot;AI&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/example/websocket/websock-branding-collab.js (Line 43:8 - Line 59:6), server/utils/agents/aibitat/example/websocket/websock-multi-turn-chat.js (Line 43:6 - Line 59:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn7" onclick="toggleCodeBlock('cloneGroup7', 'expandBtn7', 'collapseBtn7')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn7" onclick="toggleCodeBlock('cloneGroup7', 'expandBtn7', 'collapseBtn7')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup7"><code class="language-javascript text-sm text-gray-800">,
          content: error.message,
        })
      );
    });
  } catch (error) {}
});

app.all(&quot;*&quot;, function (_, response) {
  response.sendFile(path.join(__dirname, &quot;index.html&quot;));
});

app.listen(port, () =&gt; {
  console.log(`Testing HTTP/WSS server listening at http://localhost:${port}`);
});

async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/togetherai.js (Line 17:20 - Line 39:29), server/utils/agents/aibitat/providers/xai.js (Line 17:16 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn8" onclick="toggleCodeBlock('cloneGroup8', 'expandBtn8', 'collapseBtn8')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn8" onclick="toggleCodeBlock('cloneGroup8', 'expandBtn8', 'collapseBtn8')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup8"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;LMStudio chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/togetherai.js (Line 41:36 - Line 111:6), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 110:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn9" onclick="toggleCodeBlock('cloneGroup9', 'expandBtn9', 'collapseBtn9')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn9" onclick="toggleCodeBlock('cloneGroup9', 'expandBtn9', 'collapseBtn9')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup9"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since LMStudio has no cost basis.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/textgenwebui.js (Line 21:47 - Line 38:30), server/utils/agents/aibitat/providers/xai.js (Line 22:2 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn10" onclick="toggleCodeBlock('cloneGroup10', 'expandBtn10', 'collapseBtn10')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn10" onclick="toggleCodeBlock('cloneGroup10', 'expandBtn10', 'collapseBtn10')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup10"><code class="language-javascript text-sm text-gray-800">
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;Oobabooga chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/textgenwebui.js (Line 40:37 - Line 110:6), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 110:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn11" onclick="toggleCodeBlock('cloneGroup11', 'expandBtn11', 'collapseBtn11')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn11" onclick="toggleCodeBlock('cloneGroup11', 'expandBtn11', 'collapseBtn11')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup11"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since KoboldCPP has no cost basis.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/ppio.js (Line 22:2 - Line 42:7), server/utils/agents/aibitat/providers/xai.js (Line 18:2 - Line 38:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn12" onclick="toggleCodeBlock('cloneGroup12', 'expandBtn12', 'collapseBtn12')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn12" onclick="toggleCodeBlock('cloneGroup12', 'expandBtn12', 'collapseBtn12')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup12"><code class="language-javascript text-sm text-gray-800">,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!Object</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/ppio.js (Line 45:32 - Line 60:5), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 56:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn13" onclick="toggleCodeBlock('cloneGroup13', 'expandBtn13', 'collapseBtn13')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn13" onclick="toggleCodeBlock('cloneGroup13', 'expandBtn13', 'collapseBtn13')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup13"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = null</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/perplexity.js (Line 17:5 - Line 39:31), server/utils/agents/aibitat/providers/xai.js (Line 17:16 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn14" onclick="toggleCodeBlock('cloneGroup14', 'expandBtn14', 'collapseBtn14')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn14" onclick="toggleCodeBlock('cloneGroup14', 'expandBtn14', 'collapseBtn14')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup14"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;Perplexity chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/perplexity.js (Line 41:38 - Line 116:19), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn15" onclick="toggleCodeBlock('cloneGroup15', 'expandBtn15', 'collapseBtn15')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn15" onclick="toggleCodeBlock('cloneGroup15', 'expandBtn15', 'collapseBtn15')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup15"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = PerplexityProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/openrouter.js (Line 21:14 - Line 43:31), server/utils/agents/aibitat/providers/ppio.js (Line 21:14 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn16" onclick="toggleCodeBlock('cloneGroup16', 'expandBtn16', 'collapseBtn16')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn16" onclick="toggleCodeBlock('cloneGroup16', 'expandBtn16', 'collapseBtn16')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup16"><code class="language-javascript text-sm text-gray-800">,
      },
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;OpenRouter chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/openrouter.js (Line 45:38 - Line 115:6), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 110:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn17" onclick="toggleCodeBlock('cloneGroup17', 'expandBtn17', 'collapseBtn17')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn17" onclick="toggleCodeBlock('cloneGroup17', 'expandBtn17', 'collapseBtn17')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup17"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since OpenRouter has no cost basis.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/ollama.js (Line 25:2 - Line 35:6), server/utils/agents/aibitat/providers/xai.js (Line 21:7 - Line 31:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn18" onclick="toggleCodeBlock('cloneGroup18', 'expandBtn18', 'collapseBtn18')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn18" onclick="toggleCodeBlock('cloneGroup18', 'expandBtn18', 'collapseBtn18')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup18"><code class="language-javascript text-sm text-gray-800">;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/ollama.js (Line 42:5 - Line 81:5), server/utils/agents/aibitat/providers/xai.js (Line 46:2 - Line 85:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn19" onclick="toggleCodeBlock('cloneGroup19', 'expandBtn19', 'collapseBtn19')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn19" onclick="toggleCodeBlock('cloneGroup19', 'expandBtn19', 'collapseBtn19')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup19"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/ollama.js (Line 89:9 - Line 117:15), server/utils/agents/aibitat/providers/xai.js (Line 89:2 - Line 117:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn20" onclick="toggleCodeBlock('cloneGroup20', 'expandBtn20', 'collapseBtn20')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn20" onclick="toggleCodeBlock('cloneGroup20', 'expandBtn20', 'collapseBtn20')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup20"><code class="language-javascript text-sm text-gray-800">.message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since LMStudio has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = OllamaProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/nvidiaNim.js (Line 19:2 - Line 40:31), server/utils/agents/aibitat/providers/xai.js (Line 18:2 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn21" onclick="toggleCodeBlock('cloneGroup21', 'expandBtn21', 'collapseBtn21')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn21" onclick="toggleCodeBlock('cloneGroup21', 'expandBtn21', 'collapseBtn21')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup21"><code class="language-javascript text-sm text-gray-800">,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;NVIDIA NIM chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/nvidiaNim.js (Line 42:38 - Line 117:18), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn22" onclick="toggleCodeBlock('cloneGroup22', 'expandBtn22', 'collapseBtn22')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn22" onclick="toggleCodeBlock('cloneGroup22', 'expandBtn22', 'collapseBtn22')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup22"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = NvidiaNimProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/novita.js (Line 21:18 - Line 43:27), server/utils/agents/aibitat/providers/ppio.js (Line 21:15 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn23" onclick="toggleCodeBlock('cloneGroup23', 'expandBtn23', 'collapseBtn23')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn23" onclick="toggleCodeBlock('cloneGroup23', 'expandBtn23', 'collapseBtn23')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup23"><code class="language-javascript text-sm text-gray-800">: &quot;anythingllm&quot;,
      },
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;Novita chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/novita.js (Line 45:34 - Line 61:4), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 57:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn24" onclick="toggleCodeBlock('cloneGroup24', 'expandBtn24', 'collapseBtn24')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn24" onclick="toggleCodeBlock('cloneGroup24', 'expandBtn24', 'collapseBtn24')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup24"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    let</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/novita.js (Line 60:2 - Line 109:6), server/utils/agents/aibitat/providers/ppio.js (Line 60:5 - Line 109:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn25" onclick="toggleCodeBlock('cloneGroup25', 'expandBtn25', 'collapseBtn25')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn25" onclick="toggleCodeBlock('cloneGroup25', 'expandBtn25', 'collapseBtn25')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup25"><code class="language-javascript text-sm text-gray-800">) {
    let completion;
    if (functions.length &gt; 0) {
      const { toolCall, text } = await this.functionCall(
        messages,
        functions,
        this.#handleFunctionCallChat.bind(this)
      );

      if (toolCall !== null) {
        this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
        this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
        return {
          result: null,
          functionCall: {
            name: toolCall.name,
            arguments: toolCall.arguments,
          },
          cost: 0,
        };
      }
      completion = { content: text };
    }

    if (!completion?.content) {
      this.providerLog(&quot;Will assume chat completion without tool call inputs.&quot;);
      const response = await this.client.chat.completions.create({
        model: this.model,
        messages: this.cleanMsgs(messages),
      });
      completion = response.choices[0].message;
    }

    // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
    // from calling the exact same function over and over in a loop within a single chat exchange
    // _but_ we should enable it to call previously used tools in a new chat interaction.
    this.deduplicator.reset(&quot;runs&quot;);
    return {
      result: completion.content,
      cost: 0,
    };
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since Novita AI has no cost basis.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/mistral.js (Line 21:16 - Line 120:16), server/utils/agents/aibitat/providers/xai.js (Line 17:16 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn26" onclick="toggleCodeBlock('cloneGroup26', 'expandBtn26', 'collapseBtn26')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn26" onclick="toggleCodeBlock('cloneGroup26', 'expandBtn26', 'collapseBtn26')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup26"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;LMStudio chat: No results!&quot;);
        if (result.choices.length === 0)
          throw new Error(&quot;LMStudio chat: No results length!&quot;);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = MistralProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/localai.js (Line 17:17 - Line 39:28), server/utils/agents/aibitat/providers/perplexity.js (Line 17:19 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn27" onclick="toggleCodeBlock('cloneGroup27', 'expandBtn27', 'collapseBtn27')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn27" onclick="toggleCodeBlock('cloneGroup27', 'expandBtn27', 'collapseBtn27')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup27"><code class="language-javascript text-sm text-gray-800"> ?? null,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;LocalAI chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/localai.js (Line 43:1 - Line 62:1), server/utils/agents/aibitat/providers/xai.js (Line 41:2 - Line 59:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn28" onclick="toggleCodeBlock('cloneGroup28', 'expandBtn28', 'collapseBtn28')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn28" onclick="toggleCodeBlock('cloneGroup28', 'expandBtn28', 'collapseBtn28')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup28"><code class="language-javascript text-sm text-gray-800">
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/localai.js (Line 61:1 - Line 82:1), server/utils/agents/aibitat/providers/xai.js (Line 58:2 - Line 78:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn29" onclick="toggleCodeBlock('cloneGroup29', 'expandBtn29', 'collapseBtn29')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn29" onclick="toggleCodeBlock('cloneGroup29', 'expandBtn29', 'collapseBtn29')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup29"><code class="language-javascript text-sm text-gray-800">
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/localai.js (Line 81:1 - Line 100:2), server/utils/agents/aibitat/providers/xai.js (Line 77:2 - Line 97:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn30" onclick="toggleCodeBlock('cloneGroup30', 'expandBtn30', 'collapseBtn30')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn30" onclick="toggleCodeBlock('cloneGroup30', 'expandBtn30', 'collapseBtn30')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup30"><code class="language-javascript text-sm text-gray-800">
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return { </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/lmstudio.js (Line 25:2 - Line 125:17), server/utils/agents/aibitat/providers/perplexity.js (Line 17:2 - Line 117:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn31" onclick="toggleCodeBlock('cloneGroup31', 'expandBtn31', 'collapseBtn31')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn31" onclick="toggleCodeBlock('cloneGroup31', 'expandBtn31', 'collapseBtn31')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup31"><code class="language-javascript text-sm text-gray-800"> null,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;LMStudio chat: No results!&quot;);
        if (result.choices.length === 0)
          throw new Error(&quot;LMStudio chat: No results length!&quot;);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since LMStudio has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = LMStudioProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/litellm.js (Line 22:20 - Line 39:28), server/utils/agents/aibitat/providers/xai.js (Line 22:6 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn32" onclick="toggleCodeBlock('cloneGroup32', 'expandBtn32', 'collapseBtn32')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn32" onclick="toggleCodeBlock('cloneGroup32', 'expandBtn32', 'collapseBtn32')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup32"><code class="language-javascript text-sm text-gray-800">;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;LiteLLM chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/litellm.js (Line 41:35 - Line 105:8), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 110:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn33" onclick="toggleCodeBlock('cloneGroup33', 'expandBtn33', 'collapseBtn33')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn33" onclick="toggleCodeBlock('cloneGroup33', 'expandBtn33', 'collapseBtn33')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup33"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  getCost</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/koboldcpp.js (Line 16:3 - Line 39:30), server/utils/agents/aibitat/providers/lmstudio.js (Line 24:19 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn34" onclick="toggleCodeBlock('cloneGroup34', 'expandBtn34', 'collapseBtn34')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn34" onclick="toggleCodeBlock('cloneGroup34', 'expandBtn34', 'collapseBtn34')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup34"><code class="language-javascript text-sm text-gray-800">),
      apiKey: null,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;KoboldCPP chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/koboldcpp.js (Line 41:37 - Line 117:18), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn35" onclick="toggleCodeBlock('cloneGroup35', 'expandBtn35', 'collapseBtn35')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn35" onclick="toggleCodeBlock('cloneGroup35', 'expandBtn35', 'collapseBtn35')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup35"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since KoboldCPP has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = KoboldCPPProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/groq.js (Line 18:13 - Line 40:27), server/utils/agents/aibitat/providers/xai.js (Line 17:16 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn36" onclick="toggleCodeBlock('cloneGroup36', 'expandBtn36', 'collapseBtn36')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn36" onclick="toggleCodeBlock('cloneGroup36', 'expandBtn36', 'collapseBtn36')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup36"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;GroqAI chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/groq.js (Line 42:34 - Line 118:13), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 117:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn37" onclick="toggleCodeBlock('cloneGroup37', 'expandBtn37', 'collapseBtn37')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn37" onclick="toggleCodeBlock('cloneGroup37', 'expandBtn37', 'collapseBtn37')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup37"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since LMStudio has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = GroqProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/genericOpenAi.js (Line 30:5 - Line 43:9), server/utils/agents/aibitat/providers/xai.js (Line 23:5 - Line 36:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn38" onclick="toggleCodeBlock('cloneGroup38', 'expandBtn38', 'collapseBtn38')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn38" onclick="toggleCodeBlock('cloneGroup38', 'expandBtn38', 'collapseBtn38')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup38"><code class="language-javascript text-sm text-gray-800">;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
        </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/genericOpenAi.js (Line 49:42 - Line 124:22), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn39" onclick="toggleCodeBlock('cloneGroup39', 'expandBtn39', 'collapseBtn39')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn39" onclick="toggleCodeBlock('cloneGroup39', 'expandBtn39', 'collapseBtn39')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup39"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = GenericOpenAiProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/gemini.js (Line 22:15 - Line 40:6), server/utils/agents/aibitat/providers/nvidiaNim.js (Line 18:5 - Line 30:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn40" onclick="toggleCodeBlock('cloneGroup40', 'expandBtn40', 'collapseBtn40')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn40" onclick="toggleCodeBlock('cloneGroup40', 'expandBtn40', 'collapseBtn40')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup40"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 0,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  /**
   * Format the messages to the format required by the Gemini API since some models do not support system prompts.
   * @see {NO_SYSTEM_PROMPT_MODELS}
   * @param {import(&quot;openai&quot;).OpenAI.ChatCompletionMessage[]} messages
   * @returns {import(&quot;openai&quot;).OpenAI.ChatCompletionMessage[]}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/gemini.js (Line 74:34 - Line 95:5), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 64:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn41" onclick="toggleCodeBlock('cloneGroup41', 'expandBtn41', 'collapseBtn41')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn41" onclick="toggleCodeBlock('cloneGroup41', 'expandBtn41', 'collapseBtn41')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup41"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;

      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/gemini.js (Line 95:2 - Line 121:5), server/utils/agents/aibitat/providers/xai.js (Line 61:9 - Line 87:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn42" onclick="toggleCodeBlock('cloneGroup42', 'expandBtn42', 'collapseBtn42')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn42" onclick="toggleCodeBlock('cloneGroup42', 'expandBtn42', 'collapseBtn42')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup42"><code class="language-javascript text-sm text-gray-800">,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/gemini.js (Line 121:2 - Line 135:4), server/utils/agents/aibitat/providers/xai.js (Line 87:9 - Line 101:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn43" onclick="toggleCodeBlock('cloneGroup43', 'expandBtn43', 'collapseBtn43')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn43" onclick="toggleCodeBlock('cloneGroup43', 'expandBtn43', 'collapseBtn43')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup43"><code class="language-javascript text-sm text-gray-800">),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw new</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/fireworksai.js (Line 19:25 - Line 41:32), server/utils/agents/aibitat/providers/nvidiaNim.js (Line 18:5 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn44" onclick="toggleCodeBlock('cloneGroup44', 'expandBtn44', 'collapseBtn44')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn44" onclick="toggleCodeBlock('cloneGroup44', 'expandBtn44', 'collapseBtn44')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup44"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 0,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;FireworksAI chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/fireworksai.js (Line 43:39 - Line 118:20), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn45" onclick="toggleCodeBlock('cloneGroup45', 'expandBtn45', 'collapseBtn45')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn45" onclick="toggleCodeBlock('cloneGroup45', 'expandBtn45', 'collapseBtn45')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup45"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = FireworksAIProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/dellProAiStudio.js (Line 24:5 - Line 40:9), server/utils/agents/aibitat/providers/xai.js (Line 18:2 - Line 34:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn46" onclick="toggleCodeBlock('cloneGroup46', 'expandBtn46', 'collapseBtn46')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn46" onclick="toggleCodeBlock('cloneGroup46', 'expandBtn46', 'collapseBtn46')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup46"><code class="language-javascript text-sm text-gray-800">,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        messages</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/dellProAiStudio.js (Line 46:43 - Line 122:24), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 117:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn47" onclick="toggleCodeBlock('cloneGroup47', 'expandBtn47', 'collapseBtn47')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn47" onclick="toggleCodeBlock('cloneGroup47', 'expandBtn47', 'collapseBtn47')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup47"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since LMStudio has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = DellProAiStudioProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/deepseek.js (Line 23:20 - Line 41:29), server/utils/agents/aibitat/providers/genericOpenAi.js (Line 29:27 - Line 47:35)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn48" onclick="toggleCodeBlock('cloneGroup48', 'expandBtn48', 'collapseBtn48')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn48" onclick="toggleCodeBlock('cloneGroup48', 'expandBtn48', 'collapseBtn48')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup48"><code class="language-javascript text-sm text-gray-800">, 1024)
      : 1024;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
        max_tokens: this.maxTokens,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;DeepSeek chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/deepseek.js (Line 43:36 - Line 118:17), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn49" onclick="toggleCodeBlock('cloneGroup49', 'expandBtn49', 'collapseBtn49')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn49" onclick="toggleCodeBlock('cloneGroup49', 'expandBtn49', 'collapseBtn49')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup49"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = DeepSeekProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/bedrock.js (Line 102:8 - Line 141:7), server/utils/agents/aibitat/providers/xai.js (Line 46:2 - Line 85:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn50" onclick="toggleCodeBlock('cloneGroup50', 'expandBtn50', 'collapseBtn50')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn50" onclick="toggleCodeBlock('cloneGroup50', 'expandBtn50', 'collapseBtn50')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup50"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.invoke</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/bedrock.js (Line 144:9 - Line 172:19), server/utils/agents/aibitat/providers/xai.js (Line 89:8 - Line 116:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn51" onclick="toggleCodeBlock('cloneGroup51', 'expandBtn51', 'collapseBtn51')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn51" onclick="toggleCodeBlock('cloneGroup51', 'expandBtn51', 'collapseBtn51')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup51"><code class="language-javascript text-sm text-gray-800">;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   * Stubbed since KoboldCPP has no cost basis.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = AWSBedrockProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/azure.js (Line 20:2 - Line 82:12), server/utils/agents/aibitat/providers/openai.js (Line 57:1 - Line 119:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn52" onclick="toggleCodeBlock('cloneGroup52', 'expandBtn52', 'collapseBtn52')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn52" onclick="toggleCodeBlock('cloneGroup52', 'expandBtn52', 'collapseBtn52')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup52"><code class="language-javascript text-sm text-gray-800">
  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the OpenAI API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      const response = await this.client.chat.completions.create({
        model: this.model,
        // stream: true,
        messages,
        ...(Array.isArray(functions) &amp;&amp; functions?.length &gt; 0
          ? { functions }
          : {}),
      });

      // Right now, we only support one completion,
      // so we just take the first one in the list
      const completion = response.choices[0].message;
      const cost = this.getCost(response.usage);
      // treat function calls
      if (completion.function_call) {
        let functionArgs = {};
        try {
          functionArgs = JSON.parse(completion.function_call.arguments);
        } catch (error) {
          // call the complete function again in case it gets a json error
          return this.complete(
            [
              ...messages,
              {
                role: &quot;function&quot;,
                name: completion.function_call.name,
                function_call: completion.function_call,
                content: error?.message,
              },
            ],
            functions
          );
        }

        // console.log(completion, { functionArgs })
        return {
          result: null,
          functionCall: {
            name: completion.function_call.name,
            arguments: functionArgs,
          },
          cost,
        };
      }

      return {
        result: completion.content,
        cost,
      };
    } catch (error) {
      // If invalid Auth error we need to abort because no amount of waiting
      // will make auth better.
      if (error instanceof AzureOpenAI</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/apipie.js (Line 17:19 - Line 39:27), server/utils/agents/aibitat/providers/xai.js (Line 17:16 - Line 39:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn53" onclick="toggleCodeBlock('cloneGroup53', 'expandBtn53', 'collapseBtn53')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn53" onclick="toggleCodeBlock('cloneGroup53', 'expandBtn53', 'collapseBtn53')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup53"><code class="language-javascript text-sm text-gray-800">,
      maxRetries: 3,
    });

    this._client = client;
    this.model = model;
    this.verbose = true;
  }

  get client() {
    return this._client;
  }

  async #handleFunctionCallChat({ messages = [] }) {
    return await this.client.chat.completions
      .create({
        model: this.model,
        temperature: 0,
        messages,
      })
      .then((result) =&gt; {
        if (!result.hasOwnProperty(&quot;choices&quot;))
          throw new Error(&quot;ApiPie chat: No results!&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/providers/apipie.js (Line 41:34 - Line 116:15), server/utils/agents/aibitat/providers/xai.js (Line 41:31 - Line 116:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn54" onclick="toggleCodeBlock('cloneGroup54', 'expandBtn54', 'collapseBtn54')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn54" onclick="toggleCodeBlock('cloneGroup54', 'expandBtn54', 'collapseBtn54')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup54"><code class="language-javascript text-sm text-gray-800">);
        return result.choices[0].message.content;
      })
      .catch((_) =&gt; {
        return null;
      });
  }

  /**
   * Create a completion based on the received messages.
   *
   * @param messages A list of messages to send to the API.
   * @param functions
   * @returns The completion.
   */
  async complete(messages, functions = []) {
    try {
      let completion;
      if (functions.length &gt; 0) {
        const { toolCall, text } = await this.functionCall(
          messages,
          functions,
          this.#handleFunctionCallChat.bind(this)
        );

        if (toolCall !== null) {
          this.providerLog(`Valid tool call found - running ${toolCall.name}.`);
          this.deduplicator.trackRun(toolCall.name, toolCall.arguments);
          return {
            result: null,
            functionCall: {
              name: toolCall.name,
              arguments: toolCall.arguments,
            },
            cost: 0,
          };
        }
        completion = { content: text };
      }

      if (!completion?.content) {
        this.providerLog(
          &quot;Will assume chat completion without tool call inputs.&quot;
        );
        const response = await this.client.chat.completions.create({
          model: this.model,
          messages: this.cleanMsgs(messages),
        });
        completion = response.choices[0].message;
      }

      // The UnTooled class inherited Deduplicator is mostly useful to prevent the agent
      // from calling the exact same function over and over in a loop within a single chat exchange
      // _but_ we should enable it to call previously used tools in a new chat interaction.
      this.deduplicator.reset(&quot;runs&quot;);
      return {
        result: completion.content,
        cost: 0,
      };
    } catch (error) {
      throw error;
    }
  }

  /**
   * Get the cost of the completion.
   *
   * @param _usage The completion to get the cost for.
   * @returns The cost of the completion.
   */
  getCost(_usage) {
    return 0;
  }
}

module.exports = ApiPieProvider</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 6:15 - Line 17:12), server/utils/agents/aibitat/plugins/web-scraping.js (Line 6:15 - Line 17:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn55" onclick="toggleCodeBlock('cloneGroup55', 'expandBtn55', 'collapseBtn55')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn55" onclick="toggleCodeBlock('cloneGroup55', 'expandBtn55', 'collapseBtn55')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup55"><code class="language-javascript text-sm text-gray-800">,
  startupConfig: {
    params: {},
  },
  plugin: function () {
    return {
      name: this.name,
      setup(aibitat) {
        aibitat.function({
          super: aibitat,
          name: this.name,
          countTokens</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 232:13 - Line 248:14), server/utils/agents/aibitat/plugins/web-browsing.js (Line 158:15 - Line 174:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn56" onclick="toggleCodeBlock('cloneGroup56', 'expandBtn56', 'collapseBtn56')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn56" onclick="toggleCodeBlock('cloneGroup56', 'expandBtn56', 'collapseBtn56')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup56"><code class="language-javascript text-sm text-gray-800">});

            if (data.length === 0)
              return `No information was found online for the search query.`;

            const result = JSON.stringify(data);
            this.super.introspect(
              `${this.caller}: I found ${data.length} results - reviewing the results now. (~${this.countTokens(result)} tokens)`
            );
            return result;
          },

          /**
           * Use Serper.dev
           * Free to set up, easy to use, 2,500 calls for free one-time
           * https://serper.dev
           */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 293:8 - Line 311:11), server/utils/agents/aibitat/plugins/web-browsing.js (Line 225:16 - Line 170:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn57" onclick="toggleCodeBlock('cloneGroup57', 'expandBtn57', 'collapseBtn57')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn57" onclick="toggleCodeBlock('cloneGroup57', 'expandBtn57', 'collapseBtn57')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup57"><code class="language-javascript text-sm text-gray-800">?.forEach((searchResult) =&gt; {
              const { title, link, snippet } = searchResult;
              data.push({
                title,
                link,
                snippet,
              });
            });

            if (data.length === 0)
              return `No information was found online for the search query.`;

            const result = JSON.stringify(data);
            this.super.introspect(
              `${this.caller}: I found ${data.length} results - reviewing the results now. (~${this.countTokens(result)} tokens)`
            );
            return result;
          },
          </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 436:12 - Line 449:15), server/utils/agents/aibitat/plugins/web-browsing.js (Line 230:8 - Line 311:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn58" onclick="toggleCodeBlock('cloneGroup58', 'expandBtn58', 'collapseBtn58')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn58" onclick="toggleCodeBlock('cloneGroup58', 'expandBtn58', 'collapseBtn58')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup58"><code class="language-javascript text-sm text-gray-800">,
              });
            });

            if (data.length === 0)
              return `No information was found online for the search query.`;

            const result = JSON.stringify(data);
            this.super.introspect(
              `${this.caller}: I found ${data.length} results - reviewing the results now. (~${this.countTokens(result)} tokens)`
            );
            return result;
          },
          _searXNGEngine</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 508:14 - Line 521:14), server/utils/agents/aibitat/plugins/web-browsing.js (Line 230:8 - Line 311:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn59" onclick="toggleCodeBlock('cloneGroup59', 'expandBtn59', 'collapseBtn59')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn59" onclick="toggleCodeBlock('cloneGroup59', 'expandBtn59', 'collapseBtn59')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup59"><code class="language-javascript text-sm text-gray-800">,
              });
            });

            if (data.length === 0)
              return `No information was found online for the search query.`;

            const result = JSON.stringify(data);
            this.super.introspect(
              `${this.caller}: I found ${data.length} results - reviewing the results now. (~${this.countTokens(result)} tokens)`
            );
            return result;
          },
          _tavilySearch</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/web-browsing.js (Line 571:8 - Line 584:18), server/utils/agents/aibitat/plugins/web-browsing.js (Line 230:8 - Line 311:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn60" onclick="toggleCodeBlock('cloneGroup60', 'expandBtn60', 'collapseBtn60')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn60" onclick="toggleCodeBlock('cloneGroup60', 'expandBtn60', 'collapseBtn60')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup60"><code class="language-javascript text-sm text-gray-800">,
              });
            });

            if (data.length === 0)
              return `No information was found online for the search query.`;

            const result = JSON.stringify(data);
            this.super.introspect(
              `${this.caller}: I found ${data.length} results - reviewing the results now. (~${this.countTokens(result)} tokens)`
            );
            return result;
          },
          _duckDuckGoEngine</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/summarize.js (Line 7:22 - Line 20:118), server/utils/agents/aibitat/plugins/web-scraping.js (Line 6:15 - Line 19:75)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn61" onclick="toggleCodeBlock('cloneGroup61', 'expandBtn61', 'collapseBtn61')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn61" onclick="toggleCodeBlock('cloneGroup61', 'expandBtn61', 'collapseBtn61')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup61"><code class="language-javascript text-sm text-gray-800">,
  startupConfig: {
    params: {},
  },
  plugin: function () {
    return {
      name: this.name,
      setup(aibitat) {
        aibitat.function({
          super: aibitat,
          name: this.name,
          controller: new AbortController(),
          description:
            &quot;Can get the list of files available to search with descriptions and can select a single file to open and summarize.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/memory.js (Line 6:13 - Line 16:8), server/utils/agents/aibitat/plugins/web-scraping.js (Line 6:15 - Line 16:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn62" onclick="toggleCodeBlock('cloneGroup62', 'expandBtn62', 'collapseBtn62')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn62" onclick="toggleCodeBlock('cloneGroup62', 'expandBtn62', 'collapseBtn62')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup62"><code class="language-javascript text-sm text-gray-800">,
  startupConfig: {
    params: {},
  },
  plugin: function () {
    return {
      name: this.name,
      setup(aibitat) {
        aibitat.function({
          super: aibitat,
          tracker</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/memory.js (Line 46:45 - Line 56:9), server/utils/agents/aibitat/plugins/summarize.js (Line 37:12 - Line 47:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn63" onclick="toggleCodeBlock('cloneGroup63', 'expandBtn63', 'collapseBtn63')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn63" onclick="toggleCodeBlock('cloneGroup63', 'expandBtn63', 'collapseBtn63')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup63"><code class="language-javascript text-sm text-gray-800">,
              }),
            },
          ],
          parameters: {
            $schema: &quot;http://json-schema.org/draft-07/schema#&quot;,
            type: &quot;object&quot;,
            properties: {
              action: {
                type: &quot;string&quot;,
                enum: [&quot;search&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/http-socket.js (Line 13:8 - Line 27:8), server/utils/agents/aibitat/plugins/websocket.js (Line 29:7 - Line 43:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn64" onclick="toggleCodeBlock('cloneGroup64', 'expandBtn64', 'collapseBtn64')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn64" onclick="toggleCodeBlock('cloneGroup64', 'expandBtn64', 'collapseBtn64')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup64"><code class="language-javascript text-sm text-gray-800">: {
        required: true,
      },
      muteUserReply: {
        required: false,
        default: true,
      },
      introspection: {
        required: false,
        default: true,
      },
    },
  },
  plugin: function ({
    handler</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/aibitat/plugins/http-socket.js (Line 27:2 - Line 41:8), server/utils/agents/aibitat/plugins/websocket.js (Line 43:26 - Line 57:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn65" onclick="toggleCodeBlock('cloneGroup65', 'expandBtn65', 'collapseBtn65')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn65" onclick="toggleCodeBlock('cloneGroup65', 'expandBtn65', 'collapseBtn65')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup65"><code class="language-javascript text-sm text-gray-800">
    muteUserReply = true, // Do not post messages to &quot;USER&quot; back to frontend.
    introspection = false, // when enabled will attach socket to Aibitat object with .introspect method which reports status updates to frontend.
  }) {
    return {
      name: this.name,
      setup(aibitat) {
        aibitat.onError(async (error) =&gt; {
          let errorMessage =
            error?.message || &quot;An error occurred while running the agent.&quot;;
          console.error(chalk.red(`   error: ${errorMessage}`), error);
          aibitat.introspect(
            `Error encountered while running: ${errorMessage}`
          );
          handler</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 75:2 - Line 91:1), server/utils/vectorDbProviders/zilliz/index.js (Line 324:2 - Line 339:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn66" onclick="toggleCodeBlock('cloneGroup66', 'expandBtn66', 'collapseBtn66')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn66" onclick="toggleCodeBlock('cloneGroup66', 'expandBtn66', 'collapseBtn66')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup66"><code class="language-javascript text-sm text-gray-800">
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 177:2 - Line 187:6), server/utils/vectorDbProviders/zilliz/index.js (Line 136:2 - Line 146:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn67" onclick="toggleCodeBlock('cloneGroup67', 'expandBtn67', 'collapseBtn67')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn67" onclick="toggleCodeBlock('cloneGroup67', 'expandBtn67', 'collapseBtn67')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup67"><code class="language-javascript text-sm text-gray-800">
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 252:18 - Line 273:7), server/utils/vectorDbProviders/zilliz/index.js (Line 186:1 - Line 208:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn68" onclick="toggleCodeBlock('cloneGroup68', 'expandBtn68', 'collapseBtn68')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn68" onclick="toggleCodeBlock('cloneGroup68', 'expandBtn68', 'collapseBtn68')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup68"><code class="language-javascript text-sm text-gray-800">
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);
      </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 294:2 - Line 305:6), server/utils/vectorDbProviders/zilliz/index.js (Line 217:2 - Line 228:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn69" onclick="toggleCodeBlock('cloneGroup69', 'expandBtn69', 'collapseBtn69')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn69" onclick="toggleCodeBlock('cloneGroup69', 'expandBtn69', 'collapseBtn69')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup69"><code class="language-javascript text-sm text-gray-800">;

          vectors.push(vectorRecord);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 333:13 - Line 348:1), server/utils/vectorDbProviders/zilliz/index.js (Line 254:2 - Line 268:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn70" onclick="toggleCodeBlock('cloneGroup70', 'expandBtn70', 'collapseBtn70')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn70" onclick="toggleCodeBlock('cloneGroup70', 'expandBtn70', 'collapseBtn70')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup70"><code class="language-javascript text-sm text-gray-800">);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) return;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/weaviate/index.js (Line 360:8 - Line 402:18), server/utils/vectorDbProviders/zilliz/index.js (Line 284:2 - Line 326:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn71" onclick="toggleCodeBlock('cloneGroup71', 'expandBtn71', 'collapseBtn71')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn71" onclick="toggleCodeBlock('cloneGroup71', 'expandBtn71', 'collapseBtn71')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup71"><code class="language-javascript text-sm text-gray-800">);
    return true;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) {
      return {
        contextTexts: [],
        sources: [],
        message: &quot;Invalid query - no documents found for workspace!&quot;,
      };
    }

    const queryVector = await LLMConnector.embedTextInput(input);
    const { contextTexts, sourceDocuments } = await this.similarityResponse({
      client,
      namespace,
      queryVector,
      similarityThreshold,
      topN,
      filterIdentifiers,
    });

    const sources = sourceDocuments.map((metadata, i) =&gt; {
      return { ...metadata, text: contextTexts[i] };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  &quot;namespace-stats&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 25:63 - Line 36:12), server/utils/vectorDbProviders/zilliz/index.js (Line 40:63 - Line 51:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn72" onclick="toggleCodeBlock('cloneGroup72', 'expandBtn72', 'collapseBtn72')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn72" onclick="toggleCodeBlock('cloneGroup72', 'expandBtn72', 'collapseBtn72')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup72"><code class="language-javascript text-sm text-gray-800">
      );

    return { client };
  },
  heartbeat: async function () {
    await this.connect();
    return { heartbeat: Number(new Date()) };
  },
  totalVectors: async function () {
    const { client } = await this.connect();
    const { collections</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 48:2 - Line 64:10), server/utils/vectorDbProviders/zilliz/index.js (Line 324:2 - Line 91:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn73" onclick="toggleCodeBlock('cloneGroup73', 'expandBtn73', 'collapseBtn73')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn73" onclick="toggleCodeBlock('cloneGroup73', 'expandBtn73', 'collapseBtn73')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup73"><code class="language-javascript text-sm text-gray-800">;
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };

    const responses</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 134:2 - Line 156:1), server/utils/vectorDbProviders/weaviate/index.js (Line 177:5 - Line 157:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn74" onclick="toggleCodeBlock('cloneGroup74', 'expandBtn74', 'collapseBtn74')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn74" onclick="toggleCodeBlock('cloneGroup74', 'expandBtn74', 'collapseBtn74')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup74"><code class="language-javascript text-sm text-gray-800">;
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      let vectorDimension = null;
      const { pageContent, docId, ...metadata } = documentData;
      if (!pageContent || pageContent.length == 0) return false;

      console.log(&quot;Adding new vectorized document into namespace&quot;, namespace);
      if (skipCache) {
        const cacheResult = await cachedVectorInformation(fullFilePath);
        if (cacheResult.exists) {
          const { client } = await this.connect();
          const { chunks } = cacheResult;
          const documentVectors = [];
          vectorDimension =
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 209:85 - Line 235:9), server/utils/vectorDbProviders/weaviate/index.js (Line 250:85 - Line 276:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn75" onclick="toggleCodeBlock('cloneGroup75', 'expandBtn75', 'collapseBtn75')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn75" onclick="toggleCodeBlock('cloneGroup75', 'expandBtn75', 'collapseBtn75')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup75"><code class="language-javascript text-sm text-gray-800">
      // because we then cannot atomically control our namespace to granularly find/remove documents
      // from vectordb.
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);
      const submission = {
        ids: [],
        vectors: [],
        payloads</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 252:8 - Line 264:11), server/utils/vectorDbProviders/weaviate/index.js (Line 294:9 - Line 306:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn76" onclick="toggleCodeBlock('cloneGroup76', 'expandBtn76', 'collapseBtn76')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn76" onclick="toggleCodeBlock('cloneGroup76', 'expandBtn76', 'collapseBtn76')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup76"><code class="language-javascript text-sm text-gray-800">);

          vectors.push(vectorRecord);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      const { client } = await this.connect();
      const collection</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 290:1 - Line 309:6), server/utils/vectorDbProviders/weaviate/index.js (Line 332:2 - Line 351:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn77" onclick="toggleCodeBlock('cloneGroup77', 'expandBtn77', 'collapseBtn77')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn77" onclick="toggleCodeBlock('cloneGroup77', 'expandBtn77', 'collapseBtn77')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup77"><code class="language-javascript text-sm text-gray-800">
        await storeVectorResult(chunks, fullFilePath);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) return;

    const knownDocuments = await DocumentVectors.where({ docId });
    if (knownDocuments.length === 0) return;

    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 313:2 - Line 375:8), server/utils/vectorDbProviders/weaviate/index.js (Line 357:2 - Line 375:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn78" onclick="toggleCodeBlock('cloneGroup78', 'expandBtn78', 'collapseBtn78')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn78" onclick="toggleCodeBlock('cloneGroup78', 'expandBtn78', 'collapseBtn78')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup78"><code class="language-javascript text-sm text-gray-800">

    const indexes = knownDocuments.map((doc) =&gt; doc.id);
    await DocumentVectors.deleteIds(indexes);
    return true;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) {
      return {
        contextTexts: [],
        sources: [],
        message: &quot;Invalid query - no documents found for workspace!&quot;,
      };
    }

    const queryVector = await LLMConnector.embedTextInput(input);
    const { contextTexts, sourceDocuments } = await this.similarityResponse({
      client,
      namespace,
      queryVector,
      similarityThreshold,
      topN,
      filterIdentifiers,
    });

    const sources = sourceDocuments.map((metadata, i) =&gt; {
      return { ...metadata, text: contextTexts[i] };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  &quot;namespace-stats&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    if (!namespace) throw new Error(&quot;namespace required&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);
    const stats = await this.namespace(client, namespace);
    return stats
      ? stats
      : { message: &quot;No stats were able to be fetched from DB for namespace&quot; };
  },
  &quot;delete-namespace&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);

    const details</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/qdrant/index.js (Line 385:5 - Line 397:1), server/utils/vectorDbProviders/weaviate/index.js (Line 426:2 - Line 437:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn79" onclick="toggleCodeBlock('cloneGroup79', 'expandBtn79', 'collapseBtn79')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn79" onclick="toggleCodeBlock('cloneGroup79', 'expandBtn79', 'collapseBtn79')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup79"><code class="language-javascript text-sm text-gray-800">);
    }
    return { reset: true };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      if (Object.keys(source).length &gt; 0) {
        const metadata = source.hasOwnProperty(&quot;metadata&quot;)
          ? source.metadata
          : source;
        documents.push({
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 37:12 - Line 53:18), server/utils/vectorDbProviders/qdrant/index.js (Line 48:12 - Line 91:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn80" onclick="toggleCodeBlock('cloneGroup80', 'expandBtn80', 'collapseBtn80')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn80" onclick="toggleCodeBlock('cloneGroup80', 'expandBtn80', 'collapseBtn80')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup80"><code class="language-javascript text-sm text-gray-800"> || 0;
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };

    const pineconeNamespace</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 93:10 - Line 104:2), server/utils/vectorDbProviders/weaviate/index.js (Line 176:3 - Line 188:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn81" onclick="toggleCodeBlock('cloneGroup81', 'expandBtn81', 'collapseBtn81')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn81" onclick="toggleCodeBlock('cloneGroup81', 'expandBtn81', 'collapseBtn81')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup81"><code class="language-javascript text-sm text-gray-800">();
    return true;
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      const { </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 136:134 - Line 160:13), server/utils/vectorDbProviders/zilliz/index.js (Line 186:1 - Line 281:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn82" onclick="toggleCodeBlock('cloneGroup82', 'expandBtn82', 'collapseBtn82')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn82" onclick="toggleCodeBlock('cloneGroup82', 'expandBtn82', 'collapseBtn82')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup82"><code class="language-javascript text-sm text-gray-800">
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);

      if (!!vectorValues &amp;&amp; vectorValues.length &gt; 0) {
        for (const [i, vector] of vectorValues.entries()) {
          const vectorRecord</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 165:133 - Line 180:14), server/utils/vectorDbProviders/zilliz/index.js (Line 215:101 - Line 230:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn83" onclick="toggleCodeBlock('cloneGroup83', 'expandBtn83', 'collapseBtn83')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn83" onclick="toggleCodeBlock('cloneGroup83', 'expandBtn83', 'collapseBtn83')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup83"><code class="language-javascript text-sm text-gray-800">
            metadata: { ...metadata, text: textChunks[i] },
          };

          vectors.push(vectorRecord);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      if (vectors.length &gt; 0) {
        const chunks = [];
        const { pineconeIndex</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 185:2 - Line 199:14), server/utils/vectorDbProviders/weaviate/index.js (Line 331:32 - Line 266:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn84" onclick="toggleCodeBlock('cloneGroup84', 'expandBtn84', 'collapseBtn84')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn84" onclick="toggleCodeBlock('cloneGroup84', 'expandBtn84', 'collapseBtn84')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup84"><code class="language-javascript text-sm text-gray-800">);
        }
        await storeVectorResult(chunks, fullFilePath);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { pineconeIndex</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 237:2 - Line 250:14), server/utils/vectorDbProviders/zilliz/index.js (Line 285:5 - Line 298:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn85" onclick="toggleCodeBlock('cloneGroup85', 'expandBtn85', 'collapseBtn85')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn85" onclick="toggleCodeBlock('cloneGroup85', 'expandBtn85', 'collapseBtn85')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup85"><code class="language-javascript text-sm text-gray-800">;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { pineconeIndex</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 258:14 - Line 275:14), server/utils/vectorDbProviders/zilliz/index.js (Line 309:7 - Line 326:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn86" onclick="toggleCodeBlock('cloneGroup86', 'expandBtn86', 'collapseBtn86')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn86" onclick="toggleCodeBlock('cloneGroup86', 'expandBtn86', 'collapseBtn86')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup86"><code class="language-javascript text-sm text-gray-800">,
      namespace,
      queryVector,
      similarityThreshold,
      topN,
      filterIdentifiers,
    });

    const sources = sourceDocuments.map((metadata, i) =&gt; {
      return { ...metadata, text: contextTexts[i] };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  curateSources</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pinecone/index.js (Line 272:6 - Line 293:9), server/utils/vectorDbProviders/zilliz/index.js (Line 379:11 - Line 400:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn87" onclick="toggleCodeBlock('cloneGroup87', 'expandBtn87', 'collapseBtn87')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn87" onclick="toggleCodeBlock('cloneGroup87', 'expandBtn87', 'collapseBtn87')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup87"><code class="language-javascript text-sm text-gray-800">,
    };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      const { metadata = {} } = source;
      if (Object.keys(metadata).length &gt; 0) {
        documents.push({
          ...metadata,
          ...(source.hasOwnProperty(&quot;pageContent&quot;)
            ? { text: source.pageContent }
            : {}),
        });
      }
    }

    return documents;
  },
};

module.exports.Pinecone</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pgvector/index.js (Line 293:2 - Line 313:6), server/utils/vectorDbProviders/pgvector/index.js (Line 268:3 - Line 278:58)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn88" onclick="toggleCodeBlock('cloneGroup88', 'expandBtn88', 'collapseBtn88')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn88" onclick="toggleCodeBlock('cloneGroup88', 'expandBtn88', 'collapseBtn88')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup88"><code class="language-javascript text-sm text-gray-800">
      );
      return result.rows[0].count;
    } catch (err) {
      return 0;
    } finally {
      if (connection) await connection.end();
    }
  },

  /**
   * Performs a SimilaritySearch on a given PGVector namespace.
   * @param {Object} params
   * @param {pgsql.Client} params.client
   * @param {string} params.namespace
   * @param {number[]} params.queryVector
   * @param {number} params.similarityThreshold
   * @param {number} params.topN
   * @param {string[]} params.filterIdentifiers
   * @returns
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pgvector/index.js (Line 313:6 - Line 328:10), server/utils/vectorDbProviders/zilliz/index.js (Line 325:2 - Line 91:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn89" onclick="toggleCodeBlock('cloneGroup89', 'expandBtn89', 'collapseBtn89')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn89" onclick="toggleCodeBlock('cloneGroup89', 'expandBtn89', 'collapseBtn89')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup89"><code class="language-javascript text-sm text-gray-800">
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };

    const embedding</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pgvector/index.js (Line 437:2 - Line 450:6), server/utils/vectorDbProviders/pgvector/index.js (Line 254:12 - Line 262:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn90" onclick="toggleCodeBlock('cloneGroup90', 'expandBtn90', 'collapseBtn90')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn90" onclick="toggleCodeBlock('cloneGroup90', 'expandBtn90', 'collapseBtn90')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup90"><code class="language-javascript text-sm text-gray-800">;
    } catch (err) {
      return false;
    } finally {
      if (connection) await connection.end();
    }
  },

  /**
   * Check if the namespace exists in the database
   * @param {pgsql.Client} connection
   * @param {string} namespace
   * @returns {Promise&lt;boolean&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pgvector/index.js (Line 525:2 - Line 542:5), server/utils/vectorDbProviders/zilliz/index.js (Line 186:1 - Line 203:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn91" onclick="toggleCodeBlock('cloneGroup91', 'expandBtn91', 'collapseBtn91')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn91" onclick="toggleCodeBlock('cloneGroup91', 'expandBtn91', 'collapseBtn91')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup91"><code class="language-javascript text-sm text-gray-800">
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/pgvector/index.js (Line 563:2 - Line 574:4), server/utils/vectorDbProviders/zilliz/index.js (Line 219:13 - Line 230:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn92" onclick="toggleCodeBlock('cloneGroup92', 'expandBtn92', 'collapseBtn92')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn92" onclick="toggleCodeBlock('cloneGroup92', 'expandBtn92', 'collapseBtn92')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup92"><code class="language-javascript text-sm text-gray-800">);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      if (vectors.length &gt; 0) {
        const chunks = [];
        for</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 1:1 - Line 14:6), server/utils/vectorDbProviders/zilliz/index.js (Line 1:1 - Line 14:78)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn93" onclick="toggleCodeBlock('cloneGroup93', 'expandBtn93', 'collapseBtn93')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn93" onclick="toggleCodeBlock('cloneGroup93', 'expandBtn93', 'collapseBtn93')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup93"><code class="language-javascript text-sm text-gray-800">const {
  DataType,
  MetricType,
  IndexType,
  MilvusClient,
} = require(&quot;@zilliz/milvus2-sdk-node&quot;);
const { TextSplitter } = require(&quot;../../TextSplitter&quot;);
const { SystemSettings } = require(&quot;../../../models/systemSettings&quot;);
const { v4: uuidv4 } = require(&quot;uuid&quot;);
const { storeVectorResult, cachedVectorInformation } = require(&quot;../../files&quot;);
const { toChunks, getEmbeddingEngineSelection } = require(&quot;../../helpers&quot;);
const { sourceIdentifier } = require(&quot;../../chats&quot;);

const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 15:9 - Line 27:9), server/utils/vectorDbProviders/zilliz/index.js (Line 17:9 - Line 29:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn94" onclick="toggleCodeBlock('cloneGroup94', 'expandBtn94', 'collapseBtn94')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn94" onclick="toggleCodeBlock('cloneGroup94', 'expandBtn94', 'collapseBtn94')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup94"><code class="language-javascript text-sm text-gray-800">,
  // Milvus/Zilliz only allows letters, numbers, and underscores in collection names
  // so we need to enforce that by re-normalizing the names when communicating with
  // the DB.
  // If the first char of the collection is not an underscore or letter the collection name will be invalid.
  normalize: function (inputString) {
    let normalized = inputString.replace(/[^a-zA-Z0-9_]/g, &quot;_&quot;);
    if (new RegExp(/^[a-zA-Z_]/).test(normalized.slice(0, 1)))
      normalized = `anythingllm_${normalized}`;
    return normalized;
  },
  connect: async function () {
    if (process.env.VECTOR_DB !== &quot;milvus&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 39:65 - Line 83:28), server/utils/vectorDbProviders/zilliz/index.js (Line 40:63 - Line 84:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn95" onclick="toggleCodeBlock('cloneGroup95', 'expandBtn95', 'collapseBtn95')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn95" onclick="toggleCodeBlock('cloneGroup95', 'expandBtn95', 'collapseBtn95')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup95"><code class="language-javascript text-sm text-gray-800">
      );

    return { client };
  },
  heartbeat: async function () {
    await this.connect();
    return { heartbeat: Number(new Date()) };
  },
  totalVectors: async function () {
    const { client } = await this.connect();
    const { collection_names } = await client.listCollections();
    const total = collection_names.reduce(async (acc, collection_name) =&gt; {
      const statistics = await client.getCollectionStatistics({
        collection_name: this.normalize(collection_name),
      });
      return Number(acc) + Number(statistics?.data?.row_count ?? 0);
    }, 0);
    return total;
  },
  namespaceCount: async function (_namespace = null) {
    const { client } = await this.connect();
    const statistics = await client.getCollectionStatistics({
      collection_name: this.normalize(_namespace),
    });
    return Number(statistics?.data?.row_count ?? 0);
  },
  namespace: async function (client, namespace = null) {
    if (!namespace) throw new Error(&quot;No namespace value provided.&quot;);
    const collection = await client
      .getCollectionStatistics({ collection_name: this.normalize(namespace) })
      .catch(() =&gt; null);
    return collection;
  },
  hasNamespace: async function (namespace = null) {
    if (!namespace) return false;
    const { client } = await this.connect();
    return await this.namespaceExists(client, namespace);
  },
  namespaceExists: async function (client, namespace = null) {
    if (!namespace) throw new Error(&quot;No namespace value provided.&quot;);
    const { value } = await client
      .hasCollection({ collection_name: this.normalize(namespace) })
      .catch((e) =&gt; {
        console.error(&quot;MilvusDB::namespaceExists&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 100:113 - Line 121:11), server/utils/vectorDbProviders/zilliz/index.js (Line 101:113 - Line 122:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn96" onclick="toggleCodeBlock('cloneGroup96', 'expandBtn96', 'collapseBtn96')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn96" onclick="toggleCodeBlock('cloneGroup96', 'expandBtn96', 'collapseBtn96')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup96"><code class="language-javascript text-sm text-gray-800">
        );

      await client.createCollection({
        collection_name: this.normalize(namespace),
        fields: [
          {
            name: &quot;id&quot;,
            description: &quot;id&quot;,
            data_type: DataType.VarChar,
            max_length: 255,
            is_primary_key: true,
          },
          {
            name: &quot;vector&quot;,
            description: &quot;vector&quot;,
            data_type: DataType.FloatVector,
            dim: dimensions,
          },
          {
            name: &quot;metadata&quot;,
            decription</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 121:11 - Line 159:4), server/utils/vectorDbProviders/zilliz/index.js (Line 122:12 - Line 160:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn97" onclick="toggleCodeBlock('cloneGroup97', 'expandBtn97', 'collapseBtn97')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn97" onclick="toggleCodeBlock('cloneGroup97', 'expandBtn97', 'collapseBtn97')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup97"><code class="language-javascript text-sm text-gray-800">: &quot;metadata&quot;,
            data_type: DataType.JSON,
          },
        ],
      });
      await client.createIndex({
        collection_name: this.normalize(namespace),
        field_name: &quot;vector&quot;,
        index_type: IndexType.AUTOINDEX,
        metric_type: MetricType.COSINE,
      });
      await client.loadCollectionSync({
        collection_name: this.normalize(namespace),
      });
    }
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      let vectorDimension = null;
      const { pageContent, docId, ...metadata } = documentData;
      if (!pageContent || pageContent.length == 0) return false;

      console.log(&quot;Adding new vectorized document into namespace&quot;, namespace);
      if (skipCache) {
        const cacheResult = await cachedVectorInformation(fullFilePath);
        if (cacheResult.exists) {
          const { client } = await this.connect();
          const { chunks } = cacheResult;
          const documentVectors = [];
          vectorDimension = chunks[0][0].values.length || null;

          await this.getOrCreateCollection(client, namespace, vectorDimension);
          try</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 190:2 - Line 240:43), server/utils/vectorDbProviders/zilliz/index.js (Line 183:2 - Line 233:43)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn98" onclick="toggleCodeBlock('cloneGroup98', 'expandBtn98', 'collapseBtn98')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn98" onclick="toggleCodeBlock('cloneGroup98', 'expandBtn98', 'collapseBtn98')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup98"><code class="language-javascript text-sm text-gray-800">
        }
      }

      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);

      if (!!vectorValues &amp;&amp; vectorValues.length &gt; 0) {
        for (const [i, vector] of vectorValues.entries()) {
          if (!vectorDimension) vectorDimension = vector.length;
          const vectorRecord = {
            id: uuidv4(),
            values: vector,
            // [DO NOT REMOVE]
            // LangChain will be unable to find your text if you embed manually and dont include the `text` key.
            metadata: { ...metadata, text: textChunks[i] },
          };

          vectors.push(vectorRecord);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      if (vectors.length &gt; 0) {
        const chunks = [];
        const { client } = await this.connect();
        await this.getOrCreateCollection(client, namespace, vectorDimension);

        console.log(&quot;Inserting vectorized chunks into Milvus.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 254:38 - Line 288:70), server/utils/vectorDbProviders/zilliz/index.js (Line 247:38 - Line 281:70)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn99" onclick="toggleCodeBlock('cloneGroup99', 'expandBtn99', 'collapseBtn99')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn99" onclick="toggleCodeBlock('cloneGroup99', 'expandBtn99', 'collapseBtn99')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup99"><code class="language-javascript text-sm text-gray-800">${insertResult?.status.reason}`
            );
          }
        }
        await storeVectorResult(chunks, fullFilePath);
        await client.flushSync({
          collection_names: [this.normalize(namespace)],
        });
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) return;
    const knownDocuments = await DocumentVectors.where({ docId });
    if (knownDocuments.length === 0) return;

    const vectorIds = knownDocuments.map((doc) =&gt; doc.vectorId);
    const queryIn = vectorIds.map((v) =&gt; `'${v}'`).join(&quot;,&quot;);
    await client.deleteEntities({
      collection_name: this.normalize(namespace),
      expr: `id in [${queryIn}]`,
    });

    const indexes = knownDocuments.map((doc) =&gt; doc.id);
    await DocumentVectors.deleteIds(indexes);

    // Even after flushing Milvus can take some time to re-calc the count</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 288:70 - Line 355:80), server/utils/vectorDbProviders/zilliz/index.js (Line 281:70 - Line 348:80)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn100" onclick="toggleCodeBlock('cloneGroup100', 'expandBtn100', 'collapseBtn100')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn100" onclick="toggleCodeBlock('cloneGroup100', 'expandBtn100', 'collapseBtn100')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup100"><code class="language-javascript text-sm text-gray-800">
    // so all we can hope to do is flushSync so that the count can be correct
    // on a later call.
    await client.flushSync({ collection_names: [this.normalize(namespace)] });
    return true;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) {
      return {
        contextTexts: [],
        sources: [],
        message: &quot;Invalid query - no documents found for workspace!&quot;,
      };
    }

    const queryVector = await LLMConnector.embedTextInput(input);
    const { contextTexts, sourceDocuments } = await this.similarityResponse({
      client,
      namespace,
      queryVector,
      similarityThreshold,
      topN,
      filterIdentifiers,
    });

    const sources = sourceDocuments.map((metadata, i) =&gt; {
      return { ...metadata, text: contextTexts[i] };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };
    const response = await client.search({
      collection_name: this.normalize(namespace),
      vectors: queryVector,
      limit: topN,
    });
    response.results.forEach((match) =&gt; {
      if (match.score &lt; similarityThreshold) return;
      if (filterIdentifiers.includes(sourceIdentifier(match.metadata))) {
        console.log(
          &quot;Milvus: A source was filtered from context as it's parent document is pinned.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/milvus/index.js (Line 359:1 - Line 408:7), server/utils/vectorDbProviders/zilliz/index.js (Line 351:2 - Line 400:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn101" onclick="toggleCodeBlock('cloneGroup101', 'expandBtn101', 'collapseBtn101')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn101" onclick="toggleCodeBlock('cloneGroup101', 'expandBtn101', 'collapseBtn101')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup101"><code class="language-javascript text-sm text-gray-800">
      result.contextTexts.push(match.metadata.text);
      result.sourceDocuments.push(match);
      result.scores.push(match.score);
    });
    return result;
  },
  &quot;namespace-stats&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    if (!namespace) throw new Error(&quot;namespace required&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);
    const stats = await this.namespace(client, namespace);
    return stats
      ? stats
      : { message: &quot;No stats were able to be fetched from DB for namespace&quot; };
  },
  &quot;delete-namespace&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);

    const statistics = await this.namespace(client, namespace);
    await this.deleteVectorsInNamespace(client, namespace);
    const vectorCount = Number(statistics?.data?.row_count ?? 0);
    return {
      message: `Namespace ${namespace} was deleted along with ${vectorCount} vectors.`,
    };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      const { metadata = {} } = source;
      if (Object.keys(metadata).length &gt; 0) {
        documents.push({
          ...metadata,
          ...(source.hasOwnProperty(&quot;pageContent&quot;)
            ? { text: source.pageContent }
            : {}),
        });
      }
    }

    return documents;
  },
};

module.exports.Milvus</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 276:16 - Line 294:7), server/utils/vectorDbProviders/weaviate/index.js (Line 176:2 - Line 111:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn102" onclick="toggleCodeBlock('cloneGroup102', 'expandBtn102', 'collapseBtn102')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn102" onclick="toggleCodeBlock('cloneGroup102', 'expandBtn102', 'collapseBtn102')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup102"><code class="language-javascript text-sm text-gray-800">);
    return true;
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      const { pageContent, docId, ...metadata } = documentData;
      if (!pageContent || pageContent.length == 0) return false;

      console.log(&quot;Adding new vectorized document into namespace&quot;, namespace);
      if (!skipCache) {
        const cacheResult = await cachedVectorInformation(fullFilePath);
        if (cacheResult.exists) {
          const { client</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 308:10 - Line 318:15), server/utils/vectorDbProviders/pgvector/index.js (Line 515:2 - Line 525:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn103" onclick="toggleCodeBlock('cloneGroup103', 'expandBtn103', 'collapseBtn103')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn103" onclick="toggleCodeBlock('cloneGroup103', 'expandBtn103', 'collapseBtn103')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup103"><code class="language-javascript text-sm text-gray-800">);
          await DocumentVectors.bulkInsert(documentVectors);
          return { vectorized: true, error: null };
        }
      }

      // If we are here then we are going to embed and store a novel document.
      // We have to do this manually as opposed to using LangChains `xyz.fromDocuments`
      // because we then cannot atomically control our namespace to granularly find/remove documents
      // from vectordb.
      const EmbedderEngine</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 315:82 - Line 337:12), server/utils/vectorDbProviders/weaviate/index.js (Line 250:85 - Line 206:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn104" onclick="toggleCodeBlock('cloneGroup104', 'expandBtn104', 'collapseBtn104')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn104" onclick="toggleCodeBlock('cloneGroup104', 'expandBtn104', 'collapseBtn104')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup104"><code class="language-javascript text-sm text-gray-800">
      // because we then cannot atomically control our namespace to granularly find/remove documents
      // from vectordb.
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const submissions</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 337:12 - Line 352:12), server/utils/vectorDbProviders/zilliz/index.js (Line 205:8 - Line 170:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn105" onclick="toggleCodeBlock('cloneGroup105', 'expandBtn105', 'collapseBtn105')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn105" onclick="toggleCodeBlock('cloneGroup105', 'expandBtn105', 'collapseBtn105')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup105"><code class="language-javascript text-sm text-gray-800"> = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);

      if (!!vectorValues &amp;&amp; vectorValues.length &gt; 0) {
        for (const [i, vector] of vectorValues.entries()) {
          const vectorRecord = {
            id: uuidv4(),
            values: vector,
            // [DO NOT REMOVE]
            // LangChain will be unable to find your text if you embed manually and dont include the `text` key.
            // https://github.com/hwchase17/langchainjs/blob/2def486af734c0ca87285a48f1a04c057ab74bdf/langchain/src/vectorstores/pinecone.ts#L64
            metadata: { ...metadata, text: textChunks[i] },
          };

          vectors.push(vectorRecord);
          submissions</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 355:7 - Line 369:55), server/utils/vectorDbProviders/pgvector/index.js (Line 562:9 - Line 324:56)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn106" onclick="toggleCodeBlock('cloneGroup106', 'expandBtn106', 'collapseBtn106')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn106" onclick="toggleCodeBlock('cloneGroup106', 'expandBtn106', 'collapseBtn106')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup106"><code class="language-javascript text-sm text-gray-800">,
          });
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      if (vectors.length &gt; 0) {
        const chunks = [];
        for (const chunk of toChunks(vectors, 500)) chunks.push(chunk);

        console.log(&quot;Inserting vectorized chunks into LanceDB collection.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 371:10 - Line 382:24), server/utils/vectorDbProviders/pgvector/index.js (Line 582:2 - Line 264:28)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn107" onclick="toggleCodeBlock('cloneGroup107', 'expandBtn107', 'collapseBtn107')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn107" onclick="toggleCodeBlock('cloneGroup107', 'expandBtn107', 'collapseBtn107')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup107"><code class="language-javascript text-sm text-gray-800">);
        await storeVectorResult(chunks, fullFilePath);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  performSimilaritySearch</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 389:6 - Line 404:7), server/utils/vectorDbProviders/zilliz/index.js (Line 293:2 - Line 308:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn108" onclick="toggleCodeBlock('cloneGroup108', 'expandBtn108', 'collapseBtn108')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn108" onclick="toggleCodeBlock('cloneGroup108', 'expandBtn108', 'collapseBtn108')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup108"><code class="language-javascript text-sm text-gray-800">,
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) {
      return {
        contextTexts: [],
        sources: [],
        message: &quot;Invalid query - no documents found for workspace!&quot;,
      };
    }

    const queryVector = await LLMConnector.embedTextInput(input);
    const result</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 425:2 - Line 450:6), server/utils/vectorDbProviders/weaviate/index.js (Line 394:2 - Line 375:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn109" onclick="toggleCodeBlock('cloneGroup109', 'expandBtn109', 'collapseBtn109')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn109" onclick="toggleCodeBlock('cloneGroup109', 'expandBtn109', 'collapseBtn109')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup109"><code class="language-javascript text-sm text-gray-800"> };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  &quot;namespace-stats&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    if (!namespace) throw new Error(&quot;namespace required&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);
    const stats = await this.namespace(client, namespace);
    return stats
      ? stats
      : { message: &quot;No stats were able to be fetched from DB for namespace&quot; };
  },
  &quot;delete-namespace&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);

    await</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/lance/index.js (Line 458:2 - Line 478:8), server/utils/vectorDbProviders/weaviate/index.js (Line 427:2 - Line 784:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn110" onclick="toggleCodeBlock('cloneGroup110', 'expandBtn110', 'collapseBtn110')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn110" onclick="toggleCodeBlock('cloneGroup110', 'expandBtn110', 'collapseBtn110')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup110"><code class="language-javascript text-sm text-gray-800">
    return { reset: true };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      const { text, vector: _v, _distance: _d, ...rest } = source;
      const metadata = rest.hasOwnProperty(&quot;metadata&quot;) ? rest.metadata : rest;
      if (Object.keys(metadata).length &gt; 0) {
        documents.push({
          ...metadata,
          ...(text ? { text } : {}),
        });
      }
    }

    return documents;
  },
};

module.exports.LanceDb</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 108:2 - Line 119:14), server/utils/vectorDbProviders/qdrant/index.js (Line 47:11 - Line 165:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn111" onclick="toggleCodeBlock('cloneGroup111', 'expandBtn111', 'collapseBtn111')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn111" onclick="toggleCodeBlock('cloneGroup111', 'expandBtn111', 'collapseBtn111')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup111"><code class="language-javascript text-sm text-gray-800">);
    return namespace?.vectorCount || 0;
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const collection = await client.getCollection</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 181:2 - Line 200:11), server/utils/vectorDbProviders/weaviate/index.js (Line 176:2 - Line 155:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn112" onclick="toggleCodeBlock('cloneGroup112', 'expandBtn112', 'collapseBtn112')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn112" onclick="toggleCodeBlock('cloneGroup112', 'expandBtn112', 'collapseBtn112')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup112"><code class="language-javascript text-sm text-gray-800">);
    return true;
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      const { pageContent, docId, ...metadata } = documentData;
      if (!pageContent || pageContent.length == 0) return false;

      console.log(&quot;Adding new vectorized document into namespace&quot;, namespace);
      if (skipCache) {
        const cacheResult = await cachedVectorInformation(fullFilePath);
        if (cacheResult.exists) {
          const { client } = await this.connect();
          const collection</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 230:2 - Line 264:11), server/utils/vectorDbProviders/weaviate/index.js (Line 241:2 - Line 275:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn113" onclick="toggleCodeBlock('cloneGroup113', 'expandBtn113', 'collapseBtn113')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn113" onclick="toggleCodeBlock('cloneGroup113', 'expandBtn113', 'collapseBtn113')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup113"><code class="language-javascript text-sm text-gray-800">
          }

          await DocumentVectors.bulkInsert(documentVectors);
          return { vectorized: true, error: null };
        }
      }

      // If we are here then we are going to embed and store a novel document.
      // We have to do this manually as opposed to using LangChains `Chroma.fromDocuments`
      // because we then cannot atomically control our namespace to granularly find/remove documents
      // from vectordb.
      const EmbedderEngine = getEmbeddingEngineSelection();
      const textSplitter = new TextSplitter({
        chunkSize: TextSplitter.determineMaxChunkSize(
          await SystemSettings.getValueOrFallback({
            label: &quot;text_splitter_chunk_size&quot;,
          }),
          EmbedderEngine?.embeddingMaxChunkLength
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);
      const submission = {
        ids: [],
        embeddings</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 266:10 - Line 280:11), server/utils/vectorDbProviders/weaviate/index.js (Line 276:11 - Line 169:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn114" onclick="toggleCodeBlock('cloneGroup114', 'expandBtn114', 'collapseBtn114')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn114" onclick="toggleCodeBlock('cloneGroup114', 'expandBtn114', 'collapseBtn114')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup114"><code class="language-javascript text-sm text-gray-800">: [],
      };

      if (!!vectorValues &amp;&amp; vectorValues.length &gt; 0) {
        for (const [i, vector] of vectorValues.entries()) {
          const vectorRecord = {
            id: uuidv4(),
            values: vector,
            // [DO NOT REMOVE]
            // LangChain will be unable to find your text if you embed manually and dont include the `text` key.
            // https://github.com/hwchase17/langchainjs/blob/2def486af734c0ca87285a48f1a04c057ab74bdf/langchain/src/vectorstores/pinecone.ts#L64
            metadata: { ...metadata, text: textChunks[i] },
          };

          submission</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 283:2 - Line 295:7), server/utils/vectorDbProviders/weaviate/index.js (Line 294:9 - Line 264:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn115" onclick="toggleCodeBlock('cloneGroup115', 'expandBtn115', 'collapseBtn115')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn115" onclick="toggleCodeBlock('cloneGroup115', 'expandBtn115', 'collapseBtn115')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup115"><code class="language-javascript text-sm text-gray-800">);

          vectors.push(vectorRecord);
          documentVectors.push({ docId, vectorId: vectorRecord.id });
        }
      } else {
        throw new Error(
          &quot;Could not embed document chunks! This document will not be recorded.&quot;
        );
      }

      const { client } = await this.connect();
      const collection = await client</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 313:2 - Line 329:11), server/utils/vectorDbProviders/qdrant/index.js (Line 289:2 - Line 268:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn116" onclick="toggleCodeBlock('cloneGroup116', 'expandBtn116', 'collapseBtn116')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn116" onclick="toggleCodeBlock('cloneGroup116', 'expandBtn116', 'collapseBtn116')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup116"><code class="language-javascript text-sm text-gray-800">

        await storeVectorResult(chunks, fullFilePath);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace))) return;
    const collection</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 337:2 - Line 355:5), server/utils/vectorDbProviders/qdrant/index.js (Line 313:5 - Line 299:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn117" onclick="toggleCodeBlock('cloneGroup117', 'expandBtn117', 'collapseBtn117')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn117" onclick="toggleCodeBlock('cloneGroup117', 'expandBtn117', 'collapseBtn117')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup117"><code class="language-javascript text-sm text-gray-800">});

    const indexes = knownDocuments.map((doc) =&gt; doc.id);
    await DocumentVectors.deleteIds(indexes);
    return true;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 381:1 - Line 392:5), server/utils/vectorDbProviders/weaviate/index.js (Line 395:2 - Line 362:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn118" onclick="toggleCodeBlock('cloneGroup118', 'expandBtn118', 'collapseBtn118')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn118" onclick="toggleCodeBlock('cloneGroup118', 'expandBtn118', 'collapseBtn118')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup118"><code class="language-javascript text-sm text-gray-800">
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  &quot;namespace-stats&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    if (!namespace) throw new Error(&quot;namespace required&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/chroma/index.js (Line 413:2 - Line 434:7), server/utils/vectorDbProviders/lance/index.js (Line 458:5 - Line 400:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn119" onclick="toggleCodeBlock('cloneGroup119', 'expandBtn119', 'collapseBtn119')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn119" onclick="toggleCodeBlock('cloneGroup119', 'expandBtn119', 'collapseBtn119')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup119"><code class="language-javascript text-sm text-gray-800">);
    return { reset: true };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      const { metadata = {} } = source;
      if (Object.keys(metadata).length &gt; 0) {
        documents.push({
          ...metadata,
          ...(source.hasOwnProperty(&quot;pageContent&quot;)
            ? { text: source.pageContent }
            : {}),
        });
      }
    }

    return documents;
  },
};

module.exports.Chroma</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 87:2 - Line 97:19), server/utils/vectorDbProviders/qdrant/index.js (Line 97:6 - Line 81:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn120" onclick="toggleCodeBlock('cloneGroup120', 'expandBtn120', 'collapseBtn120')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn120" onclick="toggleCodeBlock('cloneGroup120', 'expandBtn120', 'collapseBtn120')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup120"><code class="language-javascript text-sm text-gray-800">,
    };
  },
  hasNamespace: async function (namespace = null) {
    if (!namespace) return false;
    const { client } = await this.connect();
    return await this.namespaceExists(client, namespace);
  },
  namespaceExists: async function (client, namespace = null) {
    if (!namespace) throw new Error(&quot;No namespace value provided.&quot;);
    const sanitizedNamespace</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 139:6 - Line 163:6), server/utils/vectorDbProviders/zilliz/index.js (Line 135:2 - Line 159:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn121" onclick="toggleCodeBlock('cloneGroup121', 'expandBtn121', 'collapseBtn121')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn121" onclick="toggleCodeBlock('cloneGroup121', 'expandBtn121', 'collapseBtn121')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup121"><code class="language-javascript text-sm text-gray-800">;
    }
  },
  addDocumentToNamespace: async function (
    namespace,
    documentData = {},
    fullFilePath = null,
    skipCache = false
  ) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    try {
      let vectorDimension = null;
      const { pageContent, docId, ...metadata } = documentData;
      if (!pageContent || pageContent.length == 0) return false;

      console.log(&quot;Adding new vectorized document into namespace&quot;, namespace);
      if (!skipCache) {
        const cacheResult = await cachedVectorInformation(fullFilePath);
        if (cacheResult.exists) {
          const { client } = await this.connect();
          const { chunks } = cacheResult;
          const documentVectors = [];
          vectorDimension = chunks[0][0].values.length || null;

          const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 202:2 - Line 221:4), server/utils/vectorDbProviders/zilliz/index.js (Line 193:24 - Line 212:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn122" onclick="toggleCodeBlock('cloneGroup122', 'expandBtn122', 'collapseBtn122')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn122" onclick="toggleCodeBlock('cloneGroup122', 'expandBtn122', 'collapseBtn122')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup122"><code class="language-javascript text-sm text-gray-800">
        ),
        chunkOverlap: await SystemSettings.getValueOrFallback(
          { label: &quot;text_splitter_chunk_overlap&quot; },
          20
        ),
        chunkHeaderMeta: TextSplitter.buildHeaderMeta(metadata),
      });
      const textChunks = await textSplitter.splitText(pageContent);

      console.log(&quot;Chunks created from document:&quot;, textChunks.length);
      const documentVectors = [];
      const vectors = [];
      const vectorValues = await EmbedderEngine.embedChunks(textChunks);

      if (!!vectorValues &amp;&amp; vectorValues.length &gt; 0) {
        for (const [i, vector] of vectorValues.entries()) {
          if (!vectorDimension) vectorDimension = vector.length;
          const vectorRecord = {
            _id</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 260:6 - Line 275:10), server/utils/vectorDbProviders/weaviate/index.js (Line 331:32 - Line 267:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn123" onclick="toggleCodeBlock('cloneGroup123', 'expandBtn123', 'collapseBtn123')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn123" onclick="toggleCodeBlock('cloneGroup123', 'expandBtn123', 'collapseBtn123')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup123"><code class="language-javascript text-sm text-gray-800">);
        }
        await storeVectorResult(chunks, fullFilePath);
      }

      await DocumentVectors.bulkInsert(documentVectors);
      return { vectorized: true, error: null };
    } catch (e) {
      console.error(&quot;addDocumentToNamespace&quot;, e.message);
      return { vectorized: false, error: e.message };
    }
  },
  deleteDocumentFromNamespace: async function (namespace, docId) {
    const { DocumentVectors } = require(&quot;../../../models/vectors&quot;);
    const { client } = await this.connect();
    namespace</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 289:2 - Line 308:48), server/utils/vectorDbProviders/weaviate/index.js (Line 356:2 - Line 299:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn124" onclick="toggleCodeBlock('cloneGroup124', 'expandBtn124', 'collapseBtn124')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn124" onclick="toggleCodeBlock('cloneGroup124', 'expandBtn124', 'collapseBtn124')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup124"><code class="language-javascript text-sm text-gray-800">);
    }

    const indexes = knownDocuments.map((doc) =&gt; doc.id);
    await DocumentVectors.deleteIds(indexes);
    return true;
  },
  performSimilaritySearch: async function ({
    namespace = null,
    input = &quot;&quot;,
    LLMConnector = null,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    if (!namespace || !input || !LLMConnector)
      throw new Error(&quot;Invalid request to performSimilaritySearch.&quot;);

    const { client } = await this.connect();
    // Sanitize namespace before checking existence</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 323:19 - Line 352:65), server/utils/vectorDbProviders/zilliz/index.js (Line 310:10 - Line 339:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn125" onclick="toggleCodeBlock('cloneGroup125', 'expandBtn125', 'collapseBtn125')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn125" onclick="toggleCodeBlock('cloneGroup125', 'expandBtn125', 'collapseBtn125')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup125"><code class="language-javascript text-sm text-gray-800">,
      queryVector,
      similarityThreshold,
      topN,
      filterIdentifiers,
    });

    const sources = sourceDocuments.map((metadata, i) =&gt; {
      return { ...metadata, text: contextTexts[i] };
    });
    return {
      contextTexts,
      sources: this.curateSources(sources),
      message: false,
    };
  },
  similarityResponse: async function ({
    client,
    namespace,
    queryVector,
    similarityThreshold = 0.25,
    topN = 4,
    filterIdentifiers = [],
  }) {
    const result = {
      contextTexts: [],
      sourceDocuments: [],
      scores: [],
    };
    // Namespace should already be sanitized, but let's be defensive</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 404:2 - Line 427:16), server/utils/vectorDbProviders/zilliz/index.js (Line 356:2 - Line 378:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn126" onclick="toggleCodeBlock('cloneGroup126', 'expandBtn126', 'collapseBtn126')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn126" onclick="toggleCodeBlock('cloneGroup126', 'expandBtn126', 'collapseBtn126')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup126"><code class="language-javascript text-sm text-gray-800">
  },
  &quot;namespace-stats&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    if (!namespace) throw new Error(&quot;namespace required&quot;);
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);
    const stats = await this.namespace(client, namespace);
    return stats
      ? stats
      : { message: &quot;No stats were able to be fetched from DB for namespace&quot; };
  },
  &quot;delete-namespace&quot;: async function (reqBody = {}) {
    const { namespace = null } = reqBody;
    const { client } = await this.connect();
    if (!(await this.namespaceExists(client, namespace)))
      throw new Error(&quot;Namespace by that name does not exist.&quot;);

    const details = await this.namespace(client, namespace);
    await this.deleteVectorsInNamespace(client, namespace);
    return {
      message: `Namespace ${namespace} was deleted along with ${
        details</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/vectorDbProviders/astra/index.js (Line 428:7 - Line 448:8), server/utils/vectorDbProviders/zilliz/index.js (Line 379:12 - Line 406:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn127" onclick="toggleCodeBlock('cloneGroup127', 'expandBtn127', 'collapseBtn127')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn127" onclick="toggleCodeBlock('cloneGroup127', 'expandBtn127', 'collapseBtn127')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup127"><code class="language-javascript text-sm text-gray-800">} vectors.`,
    };
  },
  curateSources: function (sources = []) {
    const documents = [];
    for (const source of sources) {
      if (Object.keys(source).length &gt; 0) {
        const metadata = source.hasOwnProperty(&quot;metadata&quot;)
          ? source.metadata
          : source;
        documents.push({
          ...metadata,
        });
      }
    }

    return documents;
  },
};

module.exports.AstraDB</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/helpers/chat/index.js (Line 233:5 - Line 304:1), server/utils/helpers/chat/index.js (Line 119:7 - Line 189:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn128" onclick="toggleCodeBlock('cloneGroup128', 'expandBtn128', 'collapseBtn128')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn128" onclick="toggleCodeBlock('cloneGroup128', 'expandBtn128', 'collapseBtn128')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup128"><code class="language-javascript text-sm text-gray-800">);
  });

  // Prompt is allowed to take up to 70% of window - we know its under
  // if we are here, so passthrough.
  const compressedPrompt = new Promise(async (resolve) =&gt; resolve(user));

  // We always aggressively compress history because it is the least
  // important data to retain in full-fidelity.
  const compressedHistory = new Promise((resolve) =&gt; {
    const eligibleHistoryItems = [];
    var historyTokenCount = 0;

    for (const [i, history] of rawHistory.reverse().entries()) {
      const [user, assistant] = convertToPromptHistory([history]);
      const [userTokens, assistantTokens] = [
        tokenManager.countFromString(user.content),
        tokenManager.countFromString(assistant.content),
      ];
      const total = userTokens + assistantTokens;

      // If during the loop the token cost of adding this history
      // is small, we can add it to history and move onto next.
      if (historyTokenCount + total &lt; llm.limits.history) {
        eligibleHistoryItems.unshift(user, assistant);
        historyTokenCount += total;
        continue;
      }

      // If we reach here the overhead of adding this history item will
      // be too much of the limit. So now, we are prioritizing
      // the most recent 3 message pairs - if we are already past those - exit loop and stop
      // trying to make history work.
      if (i &gt; 2) break;

      // We are over the limit and we are within the first 3 most recent chats.
      // so now we cannonball them to make them fit into the window.
      // max size = llm.limit.history; Each component of the message, can at most
      // be 50% of the history. We cannonball whichever is the problem.
      // The math isnt perfect for tokens, so we have to add a fudge factor for safety.
      const maxTargetSize = Math.floor(llm.limits.history / 2.2);
      if (userTokens &gt; maxTargetSize) {
        user.content = cannonball({
          input: user.content,
          targetTokenSize: maxTargetSize,
          tiktokenInstance: tokenManager,
        });
      }

      if (assistantTokens &gt; maxTargetSize) {
        assistant.content = cannonball({
          input: assistant.content,
          targetTokenSize: maxTargetSize,
          tiktokenInstance: tokenManager,
        });
      }

      const newTotal = tokenManager.statsFrom([user, assistant]);
      if (historyTokenCount + newTotal &gt; llm.limits.history) continue;
      eligibleHistoryItems.unshift(user, assistant);
      historyTokenCount += newTotal;
    }
    resolve(eligibleHistoryItems);
  });

  const [cSystem, cHistory, cPrompt] = await Promise.all([
    compressedSystem,
    compressedHistory,
    compressedPrompt,
  ]);

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/TextToSpeech/openAi/index.js (Line 11:1 - Line 28:10), server/utils/TextToSpeech/openAiGeneric/index.js (Line 32:6 - Line 49:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn129" onclick="toggleCodeBlock('cloneGroup129', 'expandBtn129', 'collapseBtn129')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn129" onclick="toggleCodeBlock('cloneGroup129', 'expandBtn129', 'collapseBtn129')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup129"><code class="language-javascript text-sm text-gray-800">
  async ttsBuffer(textInput) {
    try {
      const result = await this.openai.audio.speech.create({
        model: &quot;tts-1&quot;,
        voice: this.voice,
        input: textInput,
      });
      return Buffer.from(await result.arrayBuffer());
    } catch (e) {
      console.error(e);
    }
    return null;
  }
}

module.exports = {
  OpenAiTTS</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/ollama/index.js (Line 36:2 - Line 59:6), server/utils/EmbeddingEngines/openAi/index.js (Line 21:5 - Line 31:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn130" onclick="toggleCodeBlock('cloneGroup130', 'expandBtn130', 'collapseBtn130')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn130" onclick="toggleCodeBlock('cloneGroup130', 'expandBtn130', 'collapseBtn130')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup130"><code class="language-javascript text-sm text-gray-800">);
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  /**
   * This function takes an array of text chunks and embeds them using the Ollama API.
   * chunks are processed sequentially to avoid overwhelming the API with too many requests
   * or running out of resources on the endpoint running the ollama instance.
   *
   * We will use the num_ctx option to set the maximum context window to the max chunk length defined by the user in the settings
   * so that the maximum context window is used and content is not truncated.
   *
   * We also assume the default keep alive option. This could cause issues with models being unloaded and reloaded
   * on load memory machines, but that is simply a user-end issue we cannot control. If the LLM and embedder are
   * constantly being loaded and unloaded, the user should use another LLM or Embedder to avoid this issue.
   * @param {string[]} textChunks - An array of text chunks to embed.
   * @returns {Promise&lt;Array&lt;number[]&gt;&gt;} - A promise that resolves to an array of embeddings.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/native/index.js (Line 124:6 - Line 134:76), server/utils/EmbeddingEngines/openAi/index.js (Line 21:2 - Line 31:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn131" onclick="toggleCodeBlock('cloneGroup131', 'expandBtn131', 'collapseBtn131')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn131" onclick="toggleCodeBlock('cloneGroup131', 'expandBtn131', 'collapseBtn131')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup131"><code class="language-javascript text-sm text-gray-800">;
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  // If you are thinking you want to edit this function - you probably don't.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/localAi/index.js (Line 18:2 - Line 29:6), server/utils/EmbeddingEngines/openAi/index.js (Line 21:5 - Line 32:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn132" onclick="toggleCodeBlock('cloneGroup132', 'expandBtn132', 'collapseBtn132')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn132" onclick="toggleCodeBlock('cloneGroup132', 'expandBtn132', 'collapseBtn132')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup132"><code class="language-javascript text-sm text-gray-800">);
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  async embedChunks(textChunks = []) {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/localAi/index.js (Line 35:21 - Line 56:93), server/utils/EmbeddingEngines/openAi/index.js (Line 43:6 - Line 64:92)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn133" onclick="toggleCodeBlock('cloneGroup133', 'expandBtn133', 'collapseBtn133')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn133" onclick="toggleCodeBlock('cloneGroup133', 'expandBtn133', 'collapseBtn133')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup133"><code class="language-javascript text-sm text-gray-800">,
              input: chunk,
            })
            .then((result) =&gt; {
              resolve({ data: result?.data, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      // If any errors were returned from LocalAI abort the entire sequence because the embeddings</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/localAi/index.js (Line 56:93 - Line 79:27), server/utils/EmbeddingEngines/openAi/index.js (Line 64:92 - Line 87:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn134" onclick="toggleCodeBlock('cloneGroup134', 'expandBtn134', 'collapseBtn134')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn134" onclick="toggleCodeBlock('cloneGroup134', 'expandBtn134', 'collapseBtn134')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup134"><code class="language-javascript text-sm text-gray-800">
      // will be incomplete.
      const errors = results
        .filter((res) =&gt; !!res.error)
        .map((res) =&gt; res.error)
        .flat();
      if (errors.length &gt; 0) {
        let uniqueErrors = new Set();
        errors.map((error) =&gt;
          uniqueErrors.add(`[${error.type}]: ${error.message}`)
        );

        return {
          data: [],
          error: Array.from(uniqueErrors).join(&quot;, &quot;),
        };
      }
      return {
        data: results.map((res) =&gt; res?.data || []).flat(),
        error: null,
      };
    });

    if (!!error) throw new Error(`LocalAI Failed to embed: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/lmstudio/index.js (Line 30:2 - Line 45:3), server/utils/EmbeddingEngines/ollama/index.js (Line 32:3 - Line 32:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn135" onclick="toggleCodeBlock('cloneGroup135', 'expandBtn135', 'collapseBtn135')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn135" onclick="toggleCodeBlock('cloneGroup135', 'expandBtn135', 'collapseBtn135')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup135"><code class="language-javascript text-sm text-gray-800">)
      .catch((e) =&gt; {
        this.log(e.message);
        return false;
      });
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  async embedChunks(textChunks = []) {
    if</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/liteLLM/index.js (Line 18:4 - Line 30:95), server/utils/EmbeddingEngines/localAi/index.js (Line 17:3 - Line 32:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn136" onclick="toggleCodeBlock('cloneGroup136', 'expandBtn136', 'collapseBtn136')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn136" onclick="toggleCodeBlock('cloneGroup136', 'expandBtn136', 'collapseBtn136')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup136"><code class="language-javascript text-sm text-gray-800">;
    this.embeddingMaxChunkLength = maximumChunkLength();
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  async embedChunks(textChunks = []) {
    // Because there is a hard POST limit on how many chunks can be sent at once to LiteLLM (~8mb)</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/liteLLM/index.js (Line 30:95 - Line 60:93), server/utils/EmbeddingEngines/openAi/index.js (Line 34:94 - Line 64:92)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn137" onclick="toggleCodeBlock('cloneGroup137', 'expandBtn137', 'collapseBtn137')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn137" onclick="toggleCodeBlock('cloneGroup137', 'expandBtn137', 'collapseBtn137')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup137"><code class="language-javascript text-sm text-gray-800">
    // we concurrently execute each max batch of text chunks possible.
    // Refer to constructor maxConcurrentChunks for more info.
    const embeddingRequests = [];
    for (const chunk of toChunks(textChunks, this.maxConcurrentChunks)) {
      embeddingRequests.push(
        new Promise((resolve) =&gt; {
          this.openai.embeddings
            .create({
              model: this.model,
              input: chunk,
            })
            .then((result) =&gt; {
              resolve({ data: result?.data, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      // If any errors were returned from LiteLLM abort the entire sequence because the embeddings</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/liteLLM/index.js (Line 60:93 - Line 83:27), server/utils/EmbeddingEngines/openAi/index.js (Line 64:92 - Line 87:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn138" onclick="toggleCodeBlock('cloneGroup138', 'expandBtn138', 'collapseBtn138')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn138" onclick="toggleCodeBlock('cloneGroup138', 'expandBtn138', 'collapseBtn138')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup138"><code class="language-javascript text-sm text-gray-800">
      // will be incomplete.
      const errors = results
        .filter((res) =&gt; !!res.error)
        .map((res) =&gt; res.error)
        .flat();
      if (errors.length &gt; 0) {
        let uniqueErrors = new Set();
        errors.map((error) =&gt;
          uniqueErrors.add(`[${error.type}]: ${error.message}`)
        );

        return {
          data: [],
          error: Array.from(uniqueErrors).join(&quot;, &quot;),
        };
      }
      return {
        data: results.map((res) =&gt; res?.data || []).flat(),
        error: null,
      };
    });

    if (!!error) throw new Error(`LiteLLM Failed to embed: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/genericOpenAi/index.js (Line 43:48 - Line 54:94), server/utils/EmbeddingEngines/openAi/index.js (Line 21:5 - Line 32:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn139" onclick="toggleCodeBlock('cloneGroup139', 'expandBtn139', 'collapseBtn139')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn139" onclick="toggleCodeBlock('cloneGroup139', 'expandBtn139', 'collapseBtn139')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup139"><code class="language-javascript text-sm text-gray-800">);
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  async embedChunks(textChunks = []) {
    // Because there is a hard POST limit on how many chunks can be sent at once to OpenAI (~8mb)</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/genericOpenAi/index.js (Line 53:2 - Line 107:33), server/utils/EmbeddingEngines/openAi/index.js (Line 33:1 - Line 87:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn140" onclick="toggleCodeBlock('cloneGroup140', 'expandBtn140', 'collapseBtn140')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn140" onclick="toggleCodeBlock('cloneGroup140', 'expandBtn140', 'collapseBtn140')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup140"><code class="language-javascript text-sm text-gray-800">
    // Because there is a hard POST limit on how many chunks can be sent at once to OpenAI (~8mb)
    // we concurrently execute each max batch of text chunks possible.
    // Refer to constructor maxConcurrentChunks for more info.
    const embeddingRequests = [];
    for (const chunk of toChunks(textChunks, this.maxConcurrentChunks)) {
      embeddingRequests.push(
        new Promise((resolve) =&gt; {
          this.openai.embeddings
            .create({
              model: this.model,
              input: chunk,
            })
            .then((result) =&gt; {
              resolve({ data: result?.data, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      // If any errors were returned from OpenAI abort the entire sequence because the embeddings
      // will be incomplete.
      const errors = results
        .filter((res) =&gt; !!res.error)
        .map((res) =&gt; res.error)
        .flat();
      if (errors.length &gt; 0) {
        let uniqueErrors = new Set();
        errors.map((error) =&gt;
          uniqueErrors.add(`[${error.type}]: ${error.message}`)
        );

        return {
          data: [],
          error: Array.from(uniqueErrors).join(&quot;, &quot;),
        };
      }
      return {
        data: results.map((res) =&gt; res?.data || []).flat(),
        error: null,
      };
    });

    if (!!error) throw new Error(`GenericOpenAI Failed to embed: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/gemini/index.js (Line 39:6 - Line 51:6), server/utils/EmbeddingEngines/openAi/index.js (Line 23:1 - Line 31:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn141" onclick="toggleCodeBlock('cloneGroup141', 'expandBtn141', 'collapseBtn141')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn141" onclick="toggleCodeBlock('cloneGroup141', 'expandBtn141', 'collapseBtn141')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup141"><code class="language-javascript text-sm text-gray-800">
  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  /**
   * Embeds a list of text inputs
   * @param {string[]} textChunks - The list of text to embed
   * @returns {Promise&lt;Array&lt;Array&lt;number&gt;&gt;&gt;} The embedding values
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/gemini/index.js (Line 51:6 - Line 108:26), server/utils/EmbeddingEngines/openAi/index.js (Line 30:1 - Line 87:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn142" onclick="toggleCodeBlock('cloneGroup142', 'expandBtn142', 'collapseBtn142')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn142" onclick="toggleCodeBlock('cloneGroup142', 'expandBtn142', 'collapseBtn142')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup142"><code class="language-javascript text-sm text-gray-800">
  async embedChunks(textChunks = []) {
    this.log(`Embedding ${textChunks.length} chunks...`);

    // Because there is a hard POST limit on how many chunks can be sent at once to OpenAI (~8mb)
    // we concurrently execute each max batch of text chunks possible.
    // Refer to constructor maxConcurrentChunks for more info.
    const embeddingRequests = [];
    for (const chunk of toChunks(textChunks, this.maxConcurrentChunks)) {
      embeddingRequests.push(
        new Promise((resolve) =&gt; {
          this.openai.embeddings
            .create({
              model: this.model,
              input: chunk,
            })
            .then((result) =&gt; {
              resolve({ data: result?.data, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      // If any errors were returned from OpenAI abort the entire sequence because the embeddings
      // will be incomplete.
      const errors = results
        .filter((res) =&gt; !!res.error)
        .map((res) =&gt; res.error)
        .flat();
      if (errors.length &gt; 0) {
        let uniqueErrors = new Set();
        errors.map((error) =&gt;
          uniqueErrors.add(`[${error.type}]: ${error.message}`)
        );

        return {
          data: [],
          error: Array.from(uniqueErrors).join(&quot;, &quot;),
        };
      }
      return {
        data: results.map((res) =&gt; res?.data || []).flat(),
        error: null,
      };
    });

    if (!!error) throw new Error(`Gemini Failed to embed: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/cohere/index.js (Line 42:11 - Line 59:6), server/utils/EmbeddingEngines/openAi/index.js (Line 47:5 - Line 64:92)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn143" onclick="toggleCodeBlock('cloneGroup143', 'expandBtn143', 'collapseBtn143')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn143" onclick="toggleCodeBlock('cloneGroup143', 'expandBtn143', 'collapseBtn143')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup143"><code class="language-javascript text-sm text-gray-800">, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/azureOpenAi/index.js (Line 32:39 - Line 43:5), server/utils/EmbeddingEngines/openAi/index.js (Line 21:34 - Line 45:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn144" onclick="toggleCodeBlock('cloneGroup144', 'expandBtn144', 'collapseBtn144')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn144" onclick="toggleCodeBlock('cloneGroup144', 'expandBtn144', 'collapseBtn144')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup144"><code class="language-javascript text-sm text-gray-800">${text}`, ...args);
  }

  async embedTextInput(textInput) {
    const result = await this.embedChunks(
      Array.isArray(textInput) ? textInput : [textInput]
    );
    return result?.[0] || [];
  }

  async embedChunks(textChunks = []) {
    if (!this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/azureOpenAi/index.js (Line 46:83 - Line 58:4), server/utils/EmbeddingEngines/openAi/index.js (Line 34:94 - Line 46:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn145" onclick="toggleCodeBlock('cloneGroup145', 'expandBtn145', 'collapseBtn145')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn145" onclick="toggleCodeBlock('cloneGroup145', 'expandBtn145', 'collapseBtn145')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup145"><code class="language-javascript text-sm text-gray-800">
    // we concurrently execute each max batch of text chunks possible.
    // Refer to constructor maxConcurrentChunks for more info.
    const embeddingRequests = [];
    for (const chunk of toChunks(textChunks, this.maxConcurrentChunks)) {
      embeddingRequests.push(
        new Promise((resolve) =&gt; {
          this.openai.embeddings
            .create({
              model: this.model,
              input: chunk,
            })
            .then((res</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/azureOpenAi/index.js (Line 59:4 - Line 76:91), server/utils/EmbeddingEngines/openAi/index.js (Line 47:2 - Line 64:92)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn146" onclick="toggleCodeBlock('cloneGroup146', 'expandBtn146', 'collapseBtn146')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn146" onclick="toggleCodeBlock('cloneGroup146', 'expandBtn146', 'collapseBtn146')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup146"><code class="language-javascript text-sm text-gray-800">.data, error: null });
            })
            .catch((e) =&gt; {
              e.type =
                e?.response?.data?.error?.code ||
                e?.response?.status ||
                &quot;failed_to_embed&quot;;
              e.message = e?.response?.data?.error?.message || e.message;
              resolve({ data: [], error: e });
            });
        })
      );
    }

    const { data = [], error = null } = await Promise.all(
      embeddingRequests
    ).then((results) =&gt; {
      // If any errors were returned from Azure abort the entire sequence because the embeddings</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/EmbeddingEngines/azureOpenAi/index.js (Line 76:91 - Line 99:32), server/utils/EmbeddingEngines/openAi/index.js (Line 64:92 - Line 87:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn147" onclick="toggleCodeBlock('cloneGroup147', 'expandBtn147', 'collapseBtn147')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn147" onclick="toggleCodeBlock('cloneGroup147', 'expandBtn147', 'collapseBtn147')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup147"><code class="language-javascript text-sm text-gray-800">
      // will be incomplete.
      const errors = results
        .filter((res) =&gt; !!res.error)
        .map((res) =&gt; res.error)
        .flat();
      if (errors.length &gt; 0) {
        let uniqueErrors = new Set();
        errors.map((error) =&gt;
          uniqueErrors.add(`[${error.type}]: ${error.message}`)
        );

        return {
          data: [],
          error: Array.from(uniqueErrors).join(&quot;, &quot;),
        };
      }
      return {
        data: results.map((res) =&gt; res?.data || []).flat(),
        error: null,
      };
    });

    if (!!error) throw new Error(`Azure OpenAI Failed to embed: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/togetherAi/index.js (Line 97:4 - Line 112:2), server/utils/AiProviders/xai/index.js (Line 37:2 - Line 52:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn148" onclick="toggleCodeBlock('cloneGroup148', 'expandBtn148', 'collapseBtn148')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn148" onclick="toggleCodeBlock('cloneGroup148', 'expandBtn148', 'collapseBtn148')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup148"><code class="language-javascript text-sm text-gray-800">;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  #</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/togetherAi/index.js (Line 111:1 - Line 123:9), server/utils/AiProviders/xai/index.js (Line 72:6 - Line 84:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn149" onclick="toggleCodeBlock('cloneGroup149', 'expandBtn149', 'collapseBtn149')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn149" onclick="toggleCodeBlock('cloneGroup149', 'expandBtn149', 'collapseBtn149')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup149"><code class="language-javascript text-sm text-gray-800">
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/togetherAi/index.js (Line 183:19 - Line 207:2), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 144:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn150" onclick="toggleCodeBlock('cloneGroup150', 'expandBtn150', 'collapseBtn150')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn150" onclick="toggleCodeBlock('cloneGroup150', 'expandBtn150', 'collapseBtn150')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup150"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/togetherAi/index.js (Line 219:19 - Line 232:5), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 170:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn151" onclick="toggleCodeBlock('cloneGroup151', 'expandBtn151', 'collapseBtn151')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn151" onclick="toggleCodeBlock('cloneGroup151', 'expandBtn151', 'collapseBtn151')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup151"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages,
      false
    );
    </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/togetherAi/index.js (Line 231:2 - Line 255:14), server/utils/AiProviders/xai/index.js (Line 169:1 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn152" onclick="toggleCodeBlock('cloneGroup152', 'expandBtn152', 'collapseBtn152')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn152" onclick="toggleCodeBlock('cloneGroup152', 'expandBtn152', 'collapseBtn152')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup152"><code class="language-javascript text-sm text-gray-800">
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  TogetherAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 32:6 - Line 55:11), server/utils/MCP/hypervisor/index.js (Line 87:18 - Line 56:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn153" onclick="toggleCodeBlock('cloneGroup153', 'expandBtn153', 'collapseBtn153')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn153" onclick="toggleCodeBlock('cloneGroup153', 'expandBtn153', 'collapseBtn153')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup153"><code class="language-javascript text-sm text-gray-800">}`);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 72:39 - Line 103:6), server/utils/AiProviders/xai/index.js (Line 63:1 - Line 129:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn154" onclick="toggleCodeBlock('cloneGroup154', 'expandBtn154', 'collapseBtn154')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn154" onclick="toggleCodeBlock('cloneGroup154', 'expandBtn154', 'collapseBtn154')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup154"><code class="language-javascript text-sm text-gray-800">
  isValidChatCompletionModel(_modelName = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 92:14 - Line 110:1), server/utils/AiProviders/xai/index.js (Line 84:7 - Line 101:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn155" onclick="toggleCodeBlock('cloneGroup155', 'expandBtn155', 'collapseBtn155')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn155" onclick="toggleCodeBlock('cloneGroup155', 'expandBtn155', 'collapseBtn155')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup155"><code class="language-javascript text-sm text-gray-800">,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 103:6 - Line 126:6), server/utils/AiProviders/togetherAi/index.js (Line 158:1 - Line 118:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn156" onclick="toggleCodeBlock('cloneGroup156', 'expandBtn156', 'collapseBtn156')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn156" onclick="toggleCodeBlock('cloneGroup156', 'expandBtn156', 'collapseBtn156')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup156"><code class="language-javascript text-sm text-gray-800">
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 125:2 - Line 157:6), server/utils/AiProviders/xai/index.js (Line 122:1 - Line 154:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn157" onclick="toggleCodeBlock('cloneGroup157', 'expandBtn157', 'collapseBtn157')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn157" onclick="toggleCodeBlock('cloneGroup157', 'expandBtn157', 'collapseBtn157')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup157"><code class="language-javascript text-sm text-gray-800">
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps: result.output.usage?.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/textGenWebUI/index.js (Line 164:9 - Line 189:16), server/utils/AiProviders/togetherAi/index.js (Line 230:6 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn158" onclick="toggleCodeBlock('cloneGroup158', 'expandBtn158', 'collapseBtn158')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn158" onclick="toggleCodeBlock('cloneGroup158', 'expandBtn158', 'collapseBtn158')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup158"><code class="language-javascript text-sm text-gray-800">
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  TextGenWebUILLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 34:28 - Line 44:1), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 31:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn159" onclick="toggleCodeBlock('cloneGroup159', 'expandBtn159', 'collapseBtn159')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn159" onclick="toggleCodeBlock('cloneGroup159', 'expandBtn159', 'collapseBtn159')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup159"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 70:10 - Line 85:7), server/utils/AiProviders/xai/index.js (Line 37:2 - Line 52:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn160" onclick="toggleCodeBlock('cloneGroup160', 'expandBtn160', 'collapseBtn160')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn160" onclick="toggleCodeBlock('cloneGroup160', 'expandBtn160', 'collapseBtn160')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup160"><code class="language-javascript text-sm text-gray-800">;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  models</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 106:2 - Line 125:7), server/utils/AiProviders/xai/index.js (Line 65:5 - Line 84:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn161" onclick="toggleCodeBlock('cloneGroup161', 'expandBtn161', 'collapseBtn161')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn161" onclick="toggleCodeBlock('cloneGroup161', 'expandBtn161', 'collapseBtn161')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup161"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 149:13 - Line 165:7), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 136:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn162" onclick="toggleCodeBlock('cloneGroup162', 'expandBtn162', 'collapseBtn162')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn162" onclick="toggleCodeBlock('cloneGroup162', 'expandBtn162', 'collapseBtn162')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup162"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !Object</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 165:2 - Line 188:22), server/utils/AiProviders/xai/index.js (Line 136:2 - Line 152:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn163" onclick="toggleCodeBlock('cloneGroup163', 'expandBtn163', 'collapseBtn163')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn163" onclick="toggleCodeBlock('cloneGroup163', 'expandBtn163', 'collapseBtn163')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup163"><code class="language-javascript text-sm text-gray-800">&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `PPIO chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 185:13 - Line 204:6), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 173:89)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn164" onclick="toggleCodeBlock('cloneGroup164', 'expandBtn164', 'collapseBtn164')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn164" onclick="toggleCodeBlock('cloneGroup164', 'expandBtn164', 'collapseBtn164')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup164"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ppio/index.js (Line 203:1 - Line 218:6), server/utils/AiProviders/xai/index.js (Line 177:89 - Line 192:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn165" onclick="toggleCodeBlock('cloneGroup165', 'expandBtn165', 'collapseBtn165')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn165" onclick="toggleCodeBlock('cloneGroup165', 'expandBtn165', 'collapseBtn165')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup165"><code class="language-javascript text-sm text-gray-800">
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/perplexity/index.js (Line 36:2 - Line 52:20), server/utils/AiProviders/togetherAi/index.js (Line 96:9 - Line 52:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn166" onclick="toggleCodeBlock('cloneGroup166', 'expandBtn166', 'collapseBtn166')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn166" onclick="toggleCodeBlock('cloneGroup166', 'expandBtn166', 'collapseBtn166')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup166"><code class="language-javascript text-sm text-gray-800">;
    this.defaultTemp = 0.7;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  allModelInformation</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/perplexity/index.js (Line 79:3 - Line 91:19), server/utils/AiProviders/togetherAi/index.js (Line 164:2 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn167" onclick="toggleCodeBlock('cloneGroup167', 'expandBtn167', 'collapseBtn167')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn167" onclick="toggleCodeBlock('cloneGroup167', 'expandBtn167', 'collapseBtn167')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup167"><code class="language-javascript text-sm text-gray-800">,
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [prompt, ...chatHistory, { role: &quot;user&quot;, content: userPrompt }];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Perplexity chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/perplexity/index.js (Line 91:19 - Line 130:22), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 94:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn168" onclick="toggleCodeBlock('cloneGroup168', 'expandBtn168', 'collapseBtn168')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn168" onclick="toggleCodeBlock('cloneGroup168', 'expandBtn168', 'collapseBtn168')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup168"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps: result.output.usage?.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Perplexity chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/perplexity/index.js (Line 127:19 - Line 147:6), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 169:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn169" onclick="toggleCodeBlock('cloneGroup169', 'expandBtn169', 'collapseBtn169')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn169" onclick="toggleCodeBlock('cloneGroup169', 'expandBtn169', 'collapseBtn169')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup169"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  /**
   * Enrich a token with citations if available for in-line citations.
   * @param {string} token - The token to enrich.
   * @param {Array} citations - The citations to enrich the token with.
   * @returns {string} The enriched token.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/perplexity/index.js (Line 276:2 - Line 295:14), server/utils/AiProviders/xai/index.js (Line 174:14 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn170" onclick="toggleCodeBlock('cloneGroup170', 'expandBtn170', 'collapseBtn170')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn170" onclick="toggleCodeBlock('cloneGroup170', 'expandBtn170', 'collapseBtn170')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup170"><code class="language-javascript text-sm text-gray-800">);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  PerplexityLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 6:18 - Line 16:13), server/utils/AiProviders/ppio/index.js (Line 3:30 - Line 13:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn171" onclick="toggleCodeBlock('cloneGroup171', 'expandBtn171', 'collapseBtn171')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn171" onclick="toggleCodeBlock('cloneGroup171', 'expandBtn171', 'collapseBtn171')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup171"><code class="language-javascript text-sm text-gray-800">,
} = require(&quot;../../helpers/chat/responses&quot;);
const fs = require(&quot;fs&quot;);
const path = require(&quot;path&quot;);
const { safeJsonParse } = require(&quot;../../http&quot;);
const {
  LLMPerformanceMonitor,
} = require(&quot;../../helpers/chat/LLMPerformanceMonitor&quot;);
const cacheFolder = path.resolve(
  process.env.STORAGE_DIR
    ? path.resolve(process.env.STORAGE_DIR, &quot;models&quot;, &quot;openrouter&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 70:2 - Line 80:4), server/utils/AiProviders/perplexity/index.js (Line 148:10 - Line 158:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn172" onclick="toggleCodeBlock('cloneGroup172', 'expandBtn172', 'collapseBtn172')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn172" onclick="toggleCodeBlock('cloneGroup172', 'expandBtn172', 'collapseBtn172')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup172"><code class="language-javascript text-sm text-gray-800">) {
    if (!Array.isArray(citations) || citations.length === 0) return token;
    return token.replace(/\[(\d+)\]/g, (match, index) =&gt; {
      const citationIndex = parseInt(index) - 1;
      return citations[citationIndex]
        ? `[[${index}](${citations[citationIndex]})]`
        : match;
    });
  }

  log</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 124:7 - Line 151:7), server/utils/AiProviders/xai/index.js (Line 37:2 - Line 97:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn173" onclick="toggleCodeBlock('cloneGroup173', 'expandBtn173', 'collapseBtn173')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn173" onclick="toggleCodeBlock('cloneGroup173', 'expandBtn173', 'collapseBtn173')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup173"><code class="language-javascript text-sm text-gray-800">;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  models() {
    if (!fs.existsSync(this.cacheModelPath)) return {};
    return safeJsonParse(
      fs.readFileSync(this.cacheModelPath, { encoding: &quot;utf-8&quot; }),
      {}
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 170:2 - Line 200:6), server/utils/AiProviders/ppio/index.js (Line 106:2 - Line 132:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn174" onclick="toggleCodeBlock('cloneGroup174', 'expandBtn174', 'collapseBtn174')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn174" onclick="toggleCodeBlock('cloneGroup174', 'expandBtn174', 'collapseBtn174')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup174"><code class="language-javascript text-sm text-gray-800">model);
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Parses and prepends reasoning from the response and returns the full text response.
   * @param {Object} response
   * @returns {string}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 205:13 - Line 232:19), server/utils/AiProviders/togetherAi/index.js (Line 156:7 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn175" onclick="toggleCodeBlock('cloneGroup175', 'expandBtn175', 'collapseBtn175')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn175" onclick="toggleCodeBlock('cloneGroup175', 'expandBtn175', 'collapseBtn175')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup175"><code class="language-javascript text-sm text-gray-800">;
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `OpenRouter chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 259:2 - Line 276:22), server/utils/AiProviders/xai/index.js (Line 142:8 - Line 235:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn176" onclick="toggleCodeBlock('cloneGroup176', 'expandBtn176', 'collapseBtn176')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn176" onclick="toggleCodeBlock('cloneGroup176', 'expandBtn176', 'collapseBtn176')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup176"><code class="language-javascript text-sm text-gray-800">,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `OpenRouter chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 343:63 - Line 355:2), server/utils/AiProviders/perplexity/index.js (Line 184:63 - Line 196:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn177" onclick="toggleCodeBlock('cloneGroup177', 'expandBtn177', 'collapseBtn177')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn177" onclick="toggleCodeBlock('cloneGroup177', 'expandBtn177', 'collapseBtn177')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup177"><code class="language-javascript text-sm text-gray-800">${timeoutThresholdMs}ms. Closing response stream.`
          );
          writeResponseChunk(response, {
            uuid,
            sources,
            type: &quot;textResponseChunk&quot;,
            textResponse: &quot;&quot;,
            close: true,
            error: false,
          });
          clearInterval(timeoutCheck);
          response.removeListener(&quot;close&quot;, handleAbort);
          stream?.endMeasurement({</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 444:2 - Line 454:14), server/utils/AiProviders/perplexity/index.js (Line 246:2 - Line 256:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn178" onclick="toggleCodeBlock('cloneGroup178', 'expandBtn178', 'collapseBtn178')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn178" onclick="toggleCodeBlock('cloneGroup178', 'expandBtn178', 'collapseBtn178')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup178"><code class="language-javascript text-sm text-gray-800">
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            clearInterval</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 475:2 - Line 495:22), server/utils/AiProviders/perplexity/index.js (Line 274:48 - Line 218:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn179" onclick="toggleCodeBlock('cloneGroup179', 'expandBtn179', 'collapseBtn179')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn179" onclick="toggleCodeBlock('cloneGroup179', 'expandBtn179', 'collapseBtn179')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup179"><code class="language-javascript text-sm text-gray-800">
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

async function fetchOpenRouterModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 516:34 - Line 534:1), server/utils/AiProviders/ppio/index.js (Line 238:1 - Line 255:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn180" onclick="toggleCodeBlock('cloneGroup180', 'expandBtn180', 'collapseBtn180')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn180" onclick="toggleCodeBlock('cloneGroup180', 'expandBtn180', 'collapseBtn180')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup180"><code class="language-javascript text-sm text-gray-800">
      if (!fs.existsSync(cacheFolder))
        fs.mkdirSync(cacheFolder, { recursive: true });
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;models.json&quot;),
        JSON.stringify(models),
        {
          encoding: &quot;utf-8&quot;,
        }
      );
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;.cached_at&quot;),
        String(Number(new Date())),
        {
          encoding: &quot;utf-8&quot;,
        }
      );

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openRouter/index.js (Line 533:1 - Line 543:14), server/utils/AiProviders/ppio/index.js (Line 254:2 - Line 264:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn181" onclick="toggleCodeBlock('cloneGroup181', 'expandBtn181', 'collapseBtn181')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn181" onclick="toggleCodeBlock('cloneGroup181', 'expandBtn181', 'collapseBtn181')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup181"><code class="language-javascript text-sm text-gray-800">
      return models;
    })
    .catch((e) =&gt; {
      console.error(e);
      return {};
    });
}

module.exports = {
  OpenRouterLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 20:9 - Line 41:6), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 29:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn182" onclick="toggleCodeBlock('cloneGroup182', 'expandBtn182', 'collapseBtn182')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn182" onclick="toggleCodeBlock('cloneGroup182', 'expandBtn182', 'collapseBtn182')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup182"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.log(
      `Initialized ${this.model} with context window ${this.promptWindowLimit()}`
    );
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  /**
   * Check if the model is an o1 model.
   * @returns {boolean}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 43:4 - Line 59:60), server/utils/AiProviders/xai/index.js (Line 37:5 - Line 53:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn183" onclick="toggleCodeBlock('cloneGroup183', 'expandBtn183', 'collapseBtn183')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn183" onclick="toggleCodeBlock('cloneGroup183', 'expandBtn183', 'collapseBtn183')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup183"><code class="language-javascript text-sm text-gray-800">);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    // o3-mini is the only o-type model that supports streaming</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 87:6 - Line 125:46), server/utils/AiProviders/xai/index.js (Line 65:5 - Line 103:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn184" onclick="toggleCodeBlock('cloneGroup184', 'expandBtn184', 'collapseBtn184')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn184" onclick="toggleCodeBlock('cloneGroup184', 'expandBtn184', 'collapseBtn184')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup184"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;high&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], // This is the specific attachment for only this prompt
  }) {
    // o1 Models do not support the &quot;system&quot; role</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 129:2 - Line 145:15), server/utils/AiProviders/xai/index.js (Line 104:5 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn185" onclick="toggleCodeBlock('cloneGroup185', 'expandBtn185', 'collapseBtn185')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn185" onclick="toggleCodeBlock('cloneGroup185', 'expandBtn185', 'collapseBtn185')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup185"><code class="language-javascript text-sm text-gray-800">: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `OpenAI chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 153:39 - Line 184:22), server/utils/AiProviders/xai/index.js (Line 128:2 - Line 148:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn186" onclick="toggleCodeBlock('cloneGroup186', 'expandBtn186', 'collapseBtn186')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn186" onclick="toggleCodeBlock('cloneGroup186', 'expandBtn186', 'collapseBtn186')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup186"><code class="language-javascript text-sm text-gray-800">
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `OpenAI chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/openAi/index.js (Line 194:92 - Line 220:10), server/utils/AiProviders/xai/index.js (Line 167:6 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn187" onclick="toggleCodeBlock('cloneGroup187', 'expandBtn187', 'collapseBtn187')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn187" onclick="toggleCodeBlock('cloneGroup187', 'expandBtn187', 'collapseBtn187')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup187"><code class="language-javascript text-sm text-gray-800">
    );

    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  OpenAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ollama/index.js (Line 43:26 - Line 63:25), server/utils/AiProviders/xai/index.js (Line 37:10 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn188" onclick="toggleCodeBlock('cloneGroup188', 'expandBtn188', 'collapseBtn188')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn188" onclick="toggleCodeBlock('cloneGroup188', 'expandBtn188', 'collapseBtn188')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup188"><code class="language-javascript text-sm text-gray-800">${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.OLLAMA_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ollama/index.js (Line 107:2 - Line 128:2), server/utils/AiProviders/xai/index.js (Line 88:2 - Line 109:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn189" onclick="toggleCodeBlock('cloneGroup189', 'expandBtn189', 'collapseBtn189')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn189" onclick="toggleCodeBlock('cloneGroup189', 'expandBtn189', 'collapseBtn189')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup189"><code class="language-javascript text-sm text-gray-800">
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent,</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ollama/index.js (Line 245:11 - Line 256:8), server/utils/AiProviders/perplexity/index.js (Line 246:2 - Line 257:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn190" onclick="toggleCodeBlock('cloneGroup190', 'expandBtn190', 'collapseBtn190')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn190" onclick="toggleCodeBlock('cloneGroup190', 'expandBtn190', 'collapseBtn190')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup190"><code class="language-javascript text-sm text-gray-800">;
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            stream?.endMeasurement(usage);
            resolve</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/ollama/index.js (Line 285:6 - Line 307:12), server/utils/AiProviders/openRouter/index.js (Line 474:2 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn191" onclick="toggleCodeBlock('cloneGroup191', 'expandBtn191', 'collapseBtn191')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn191" onclick="toggleCodeBlock('cloneGroup191', 'expandBtn191', 'collapseBtn191')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup191"><code class="language-javascript text-sm text-gray-800">);
        resolve(fullText);
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  OllamaAILLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/nvidiaNim/index.js (Line 35:2 - Line 56:6), server/utils/AiProviders/xai/index.js (Line 36:3 - Line 52:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn192" onclick="toggleCodeBlock('cloneGroup192', 'expandBtn192', 'collapseBtn192')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn192" onclick="toggleCodeBlock('cloneGroup192', 'expandBtn192', 'collapseBtn192')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup192"><code class="language-javascript text-sm text-gray-800">log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  /**
   * Set the model token limit `NVIDIA_NIM_LLM_MODEL_TOKEN_LIMIT` for the given model ID
   * @param {string} modelId
   * @param {string} basePath
   * @returns {Promise&lt;void&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/nvidiaNim/index.js (Line 101:2 - Line 132:6), server/utils/AiProviders/xai/index.js (Line 64:11 - Line 132:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn193" onclick="toggleCodeBlock('cloneGroup193', 'expandBtn193', 'collapseBtn193')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn193" onclick="toggleCodeBlock('cloneGroup193', 'expandBtn193', 'collapseBtn193')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup193"><code class="language-javascript text-sm text-gray-800"> = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/nvidiaNim/index.js (Line 121:7 - Line 155:6), server/utils/AiProviders/xai/index.js (Line 84:7 - Line 118:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn194" onclick="toggleCodeBlock('cloneGroup194', 'expandBtn194', 'collapseBtn194')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn194" onclick="toggleCodeBlock('cloneGroup194', 'expandBtn194', 'collapseBtn194')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup194"><code class="language-javascript text-sm text-gray-800">,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!this.model</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/nvidiaNim/index.js (Line 161:10 - Line 191:6), server/utils/AiProviders/xai/index.js (Line 124:7 - Line 154:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn195" onclick="toggleCodeBlock('cloneGroup195', 'expandBtn195', 'collapseBtn195')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn195" onclick="toggleCodeBlock('cloneGroup195', 'expandBtn195', 'collapseBtn195')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup195"><code class="language-javascript text-sm text-gray-800">.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!this.model</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/nvidiaNim/index.js (Line 197:10 - Line 232:4), server/utils/AiProviders/textGenWebUI/index.js (Line 158:7 - Line 192:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn196" onclick="toggleCodeBlock('cloneGroup196', 'expandBtn196', 'collapseBtn196')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn196" onclick="toggleCodeBlock('cloneGroup196', 'expandBtn196', 'collapseBtn196')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup196"><code class="language-javascript text-sm text-gray-800">.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

/**
 * Parse the base path for the Nvidia NIM container API. Since the base path must end in /v1 and cannot have a trailing slash,
 * and the user can possibly set it to anything and likely incorrectly due to pasting behaviors, we need to ensure it is in the correct format.
 * @param {string} basePath
 * @returns {string}
 */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 1:1 - Line 16:9), server/utils/AiProviders/openRouter/index.js (Line 1:1 - Line 13:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn197" onclick="toggleCodeBlock('cloneGroup197', 'expandBtn197', 'collapseBtn197')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn197" onclick="toggleCodeBlock('cloneGroup197', 'expandBtn197', 'collapseBtn197')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup197"><code class="language-javascript text-sm text-gray-800">const { NativeEmbedder } = require(&quot;../../EmbeddingEngines/native&quot;);
const { v4: uuidv4 } = require(&quot;uuid&quot;);
const {
  writeResponseChunk,
  clientAbortedHandler,
  formatChatHistory,
} = require(&quot;../../helpers/chat/responses&quot;);
const fs = require(&quot;fs&quot;);
const path = require(&quot;path&quot;);
const { safeJsonParse } = require(&quot;../../http&quot;);
const {
  LLMPerformanceMonitor,
} = require(&quot;../../helpers/chat/LLMPerformanceMonitor&quot;);
const cacheFolder = path.resolve(
  process.env.STORAGE_DIR
    ? path.resolve(process.env.STORAGE_DIR, &quot;models&quot;, &quot;novita&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 38:23 - Line 66:6), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 97:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn198" onclick="toggleCodeBlock('cloneGroup198', 'expandBtn198', 'collapseBtn198')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn198" onclick="toggleCodeBlock('cloneGroup198', 'expandBtn198', 'collapseBtn198')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup198"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.timeout = this.#parseTimeout();

    if (!fs.existsSync(cacheFolder))
      fs.mkdirSync(cacheFolder, { recursive: true });
    this.cacheModelPath = path.resolve(cacheFolder, &quot;models.json&quot;);
    this.cacheAtPath = path.resolve(cacheFolder, &quot;.cached_at&quot;);

    this.log(`Loaded with model: ${this.model}`);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  /**
   * Novita has various models that never return `finish_reasons` and thus leave the stream open
   * which causes issues in subsequent messages. This timeout value forces us to close the stream after
   * x milliseconds. This is a configurable value via the NOVITA_LLM_TIMEOUT_MS value
   * @returns {number} The timeout value in milliseconds (default: 500)
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 69:22 - Line 85:87), server/utils/AiProviders/openRouter/index.js (Line 95:22 - Line 73:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn199" onclick="toggleCodeBlock('cloneGroup199', 'expandBtn199', 'collapseBtn199')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn199" onclick="toggleCodeBlock('cloneGroup199', 'expandBtn199', 'collapseBtn199')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup199"><code class="language-javascript text-sm text-gray-800">);
    if (setValue &lt; 500) return 500;
    return setValue;
  }

  // This checks if the .cached_at file has a timestamp that is more than 1Week (in millis)
  // from the current date. If it is, then we will refetch the API so that all the models are up
  // to date.
  #cacheIsStale() {
    const MAX_STALE = 6.048e8; // 1 Week in MS
    if (!fs.existsSync(this.cacheAtPath)) return true;
    const now = Number(new Date());
    const timestampMs = Number(fs.readFileSync(this.cacheAtPath));
    return now - timestampMs &gt; MAX_STALE;
  }

  // The Novita model API has a lot of models, so we cache this locally in the directory</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 95:18 - Line 173:12), server/utils/AiProviders/openRouter/index.js (Line 123:22 - Line 137:37)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn200" onclick="toggleCodeBlock('cloneGroup200', 'expandBtn200', 'collapseBtn200')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn200" onclick="toggleCodeBlock('cloneGroup200', 'expandBtn200', 'collapseBtn200')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup200"><code class="language-javascript text-sm text-gray-800">();
    return;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  models() {
    if (!fs.existsSync(this.cacheModelPath)) return {};
    return safeJsonParse(
      fs.readFileSync(this.cacheModelPath, { encoding: &quot;utf-8&quot; }),
      {}
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(modelName) {
    const cacheModelPath = path.resolve(cacheFolder, &quot;models.json&quot;);
    const availableModels = fs.existsSync(cacheModelPath)
      ? safeJsonParse(
          fs.readFileSync(cacheModelPath, { encoding: &quot;utf-8&quot; }),
          {}
        )
      : {};
    return availableModels[modelName]?.maxLength || 4096;
  }

  promptWindowLimit() {
    const availableModels = this.models();
    return availableModels[this.model]?.maxLength || 4096;
  }

  async isValidChatCompletionModel(model = &quot;&quot;) {
    await this.#syncModels();
    const availableModels = this.models();
    return availableModels.hasOwnProperty(model);
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 165:2 - Line 192:15), server/utils/AiProviders/togetherAi/index.js (Line 156:7 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn201" onclick="toggleCodeBlock('cloneGroup201', 'expandBtn201', 'collapseBtn201')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn201" onclick="toggleCodeBlock('cloneGroup201', 'expandBtn201', 'collapseBtn201')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup201"><code class="language-javascript text-sm text-gray-800">;
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Novita chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 192:15 - Line 231:22), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 195:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn202" onclick="toggleCodeBlock('cloneGroup202', 'expandBtn202', 'collapseBtn202')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn202" onclick="toggleCodeBlock('cloneGroup202', 'expandBtn202', 'collapseBtn202')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup202"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Novita chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 228:15 - Line 249:6), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 169:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn203" onclick="toggleCodeBlock('cloneGroup203', 'expandBtn203', 'collapseBtn203')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn203" onclick="toggleCodeBlock('cloneGroup203', 'expandBtn203', 'collapseBtn203')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup203"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  /**
   * Handles the default stream response for a chat.
   * @param {import(&quot;express&quot;).Response} response
   * @param {import('../../helpers/chat/LLMPerformanceMonitor').MonitoredStream} stream
   * @param {Object} responseProps
   * @returns {Promise&lt;string&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 239:2 - Line 256:14), server/utils/AiProviders/openRouter/index.js (Line 294:1 - Line 311:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn204" onclick="toggleCodeBlock('cloneGroup204', 'expandBtn204', 'collapseBtn204')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn204" onclick="toggleCodeBlock('cloneGroup204', 'expandBtn204', 'collapseBtn204')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup204"><code class="language-javascript text-sm text-gray-800">
    return measuredStreamRequest;
  }

  /**
   * Handles the default stream response for a chat.
   * @param {import(&quot;express&quot;).Response} response
   * @param {import('../../helpers/chat/LLMPerformanceMonitor').MonitoredStream} stream
   * @param {Object} responseProps
   * @returns {Promise&lt;string&gt;}
   */
  handleStream(response, stream, responseProps) {
    const timeoutThresholdMs = this.timeout;
    const { uuid = uuidv4(), sources = [] } = responseProps;

    return new Promise(async (resolve) =&gt; {
      let fullText = &quot;&quot;;
      let lastChunkTime</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 256:48 - Line 270:59), server/utils/AiProviders/openRouter/index.js (Line 314:2 - Line 328:63)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn205" onclick="toggleCodeBlock('cloneGroup205', 'expandBtn205', 'collapseBtn205')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn205" onclick="toggleCodeBlock('cloneGroup205', 'expandBtn205', 'collapseBtn205')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup205"><code class="language-javascript text-sm text-gray-800">

      // Establish listener to early-abort a streaming response
      // in case things go sideways or the user does not like the response.
      // We preserve the generated text but continue as if chat was completed
      // to preserve previously generated content.
      const handleAbort = () =&gt; {
        stream?.endMeasurement({
          completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
        });
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      // NOTICE: Not all Novita models will return a stop reason</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 284:59 - Line 307:14), server/utils/AiProviders/perplexity/index.js (Line 184:63 - Line 366:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn206" onclick="toggleCodeBlock('cloneGroup206', 'expandBtn206', 'collapseBtn206')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn206" onclick="toggleCodeBlock('cloneGroup206', 'expandBtn206', 'collapseBtn206')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup206"><code class="language-javascript text-sm text-gray-800">${timeoutThresholdMs}ms. Closing response stream.`
          );
          writeResponseChunk(response, {
            uuid,
            sources,
            type: &quot;textResponseChunk&quot;,
            textResponse: &quot;&quot;,
            close: true,
            error: false,
          });
          clearInterval(timeoutCheck);
          response.removeListener(&quot;close&quot;, handleAbort);
          stream?.endMeasurement({
            completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
          });
          resolve(fullText);
        }
      }, 500);

      try {
        for await (const chunk of stream) {
          const message = chunk?.choices?.[0];
          const token = message?.delta?.content;
          lastChunkTime</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 315:6 - Line 331:2), server/utils/AiProviders/openRouter/index.js (Line 438:15 - Line 256:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn207" onclick="toggleCodeBlock('cloneGroup207', 'expandBtn207', 'collapseBtn207')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn207" onclick="toggleCodeBlock('cloneGroup207', 'expandBtn207', 'collapseBtn207')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup207"><code class="language-javascript text-sm text-gray-800">,
              close: false,
              error: false,
            });
          }

          if (message.finish_reason !== null) {
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            stream?.endMeasurement({</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 330:12 - Line 347:7), server/utils/AiProviders/openRouter/index.js (Line 454:13 - Line 471:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn208" onclick="toggleCodeBlock('cloneGroup208', 'expandBtn208', 'collapseBtn208')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn208" onclick="toggleCodeBlock('cloneGroup208', 'expandBtn208', 'collapseBtn208')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup208"><code class="language-javascript text-sm text-gray-800">);
            stream?.endMeasurement({
              completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
            });
            resolve(fullText);
          }
        }
      } catch (e) {
        writeResponseChunk(response, {
          uuid,
          sources,
          type: &quot;abort&quot;,
          textResponse: null,
          close: true,
          error: e.message,
        });
        response.removeListener(&quot;close&quot;, handleAbort);
        stream</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 346:12 - Line 370:18), server/utils/AiProviders/openRouter/index.js (Line 471:13 - Line 218:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn209" onclick="toggleCodeBlock('cloneGroup209', 'expandBtn209', 'collapseBtn209')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn209" onclick="toggleCodeBlock('cloneGroup209', 'expandBtn209', 'collapseBtn209')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup209"><code class="language-javascript text-sm text-gray-800">);
        stream?.endMeasurement({
          completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
        });
        resolve(fullText);
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

async function fetchNovitaModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 371:41 - Line 383:6), server/utils/AiProviders/openRouter/index.js (Line 496:38 - Line 508:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn210" onclick="toggleCodeBlock('cloneGroup210', 'expandBtn210', 'collapseBtn210')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn210" onclick="toggleCodeBlock('cloneGroup210', 'expandBtn210', 'collapseBtn210')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup210"><code class="language-javascript text-sm text-gray-800">, {
    method: &quot;GET&quot;,
    headers: {
      &quot;Content-Type&quot;: &quot;application/json&quot;,
    },
  })
    .then((res) =&gt; res.json())
    .then(({ data = [] }) =&gt; {
      const models = {};
      data.forEach((model) =&gt; {
        models[model.id] = {
          id: model.id,
          name: model.title</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/novita/index.js (Line 387:13 - Line 417:10), server/utils/AiProviders/openRouter/index.js (Line 512:15 - Line 264:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn211" onclick="toggleCodeBlock('cloneGroup211', 'expandBtn211', 'collapseBtn211')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn211" onclick="toggleCodeBlock('cloneGroup211', 'expandBtn211', 'collapseBtn211')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup211"><code class="language-javascript text-sm text-gray-800">,
        };
      });

      // Cache all response information
      if (!fs.existsSync(cacheFolder))
        fs.mkdirSync(cacheFolder, { recursive: true });
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;models.json&quot;),
        JSON.stringify(models),
        {
          encoding: &quot;utf-8&quot;,
        }
      );
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;.cached_at&quot;),
        String(Number(new Date())),
        {
          encoding: &quot;utf-8&quot;,
        }
      );
      return models;
    })
    .catch((e) =&gt; {
      console.error(e);
      return {};
    });
}

module.exports = {
  NovitaLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 11:5 - Line 21:1), server/utils/EmbeddingEngines/mistral/index.js (Line 2:2 - Line 11:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn212" onclick="toggleCodeBlock('cloneGroup212', 'expandBtn212', 'collapseBtn212')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn212" onclick="toggleCodeBlock('cloneGroup212', 'expandBtn212', 'collapseBtn212')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup212"><code class="language-javascript text-sm text-gray-800">) {
    if (!process.env.MISTRAL_API_KEY)
      throw new Error(&quot;No Mistral API key was set.&quot;);

    const { OpenAI: OpenAIApi } = require(&quot;openai&quot;);
    this.openai = new OpenAIApi({
      baseURL: &quot;https://api.mistral.ai/v1&quot;,
      apiKey: process.env.MISTRAL_API_KEY ?? null,
    });
    this.model =
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 30:6 - Line 53:2), server/utils/AiProviders/xai/index.js (Line 33:5 - Line 56:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn213" onclick="toggleCodeBlock('cloneGroup213', 'expandBtn213', 'collapseBtn213')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn213" onclick="toggleCodeBlock('cloneGroup213', 'expandBtn213', 'collapseBtn213')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup213"><code class="language-javascript text-sm text-gray-800">);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit()</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 61:10 - Line 71:7), server/utils/AiProviders/xai/index.js (Line 64:11 - Line 74:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn214" onclick="toggleCodeBlock('cloneGroup214', 'expandBtn214', 'collapseBtn214')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn214" onclick="toggleCodeBlock('cloneGroup214', 'expandBtn214', 'collapseBtn214')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup214"><code class="language-javascript text-sm text-gray-800"> = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) return</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 77:14 - Line 112:16), server/utils/AiProviders/xai/index.js (Line 85:2 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn215" onclick="toggleCodeBlock('cloneGroup215', 'expandBtn215', 'collapseBtn215')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn215" onclick="toggleCodeBlock('cloneGroup215', 'expandBtn215', 'collapseBtn215')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup215"><code class="language-javascript text-sm text-gray-800">,
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], // This is the specific attachment for only this prompt
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Mistral chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 112:16 - Line 151:22), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 115:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn216" onclick="toggleCodeBlock('cloneGroup216', 'expandBtn216', 'collapseBtn216')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn216" onclick="toggleCodeBlock('cloneGroup216', 'expandBtn216', 'collapseBtn216')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup216"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Mistral chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/mistral/index.js (Line 148:16 - Line 184:11), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn217" onclick="toggleCodeBlock('cloneGroup217', 'expandBtn217', 'collapseBtn217')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn217" onclick="toggleCodeBlock('cloneGroup217', 'expandBtn217', 'collapseBtn217')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup217"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages,
      false
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  MistralLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/localAi/index.js (Line 20:20 - Line 48:27), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn218" onclick="toggleCodeBlock('cloneGroup218', 'expandBtn218', 'collapseBtn218')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn218" onclick="toggleCodeBlock('cloneGroup218', 'expandBtn218', 'collapseBtn218')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup218"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.LOCAL_AI_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/localAi/index.js (Line 59:42 - Line 118:16), server/utils/AiProviders/nvidiaNim/index.js (Line 97:45 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn219" onclick="toggleCodeBlock('cloneGroup219', 'expandBtn219', 'collapseBtn219')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn219" onclick="toggleCodeBlock('cloneGroup219', 'expandBtn219', 'collapseBtn219')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup219"><code class="language-javascript text-sm text-gray-800">);
    return Number(limit);
  }

  async isValidChatCompletionModel(_ = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `LocalAI chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/localAi/index.js (Line 155:16 - Line 190:11), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn220" onclick="toggleCodeBlock('cloneGroup220', 'expandBtn220', 'collapseBtn220')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn220" onclick="toggleCodeBlock('cloneGroup220', 'expandBtn220', 'collapseBtn220')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup220"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  LocalAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/lmStudio/index.js (Line 31:22 - Line 59:27), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn221" onclick="toggleCodeBlock('cloneGroup221', 'expandBtn221', 'collapseBtn221')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn221" onclick="toggleCodeBlock('cloneGroup221', 'expandBtn221', 'collapseBtn221')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup221"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.LMSTUDIO_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/lmStudio/index.js (Line 76:59 - Line 132:17), server/utils/AiProviders/xai/index.js (Line 64:2 - Line 157:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn222" onclick="toggleCodeBlock('cloneGroup222', 'expandBtn222', 'collapseBtn222')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn222" onclick="toggleCodeBlock('cloneGroup222', 'expandBtn222', 'collapseBtn222')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup222"><code class="language-javascript text-sm text-gray-800">
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!this.model)
      throw new Error(
        `LMStudio chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/lmStudio/index.js (Line 136:9 - Line 164:17), server/utils/AiProviders/localAi/index.js (Line 122:7 - Line 193:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn223" onclick="toggleCodeBlock('cloneGroup223', 'expandBtn223', 'collapseBtn223')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn223" onclick="toggleCodeBlock('cloneGroup223', 'expandBtn223', 'collapseBtn223')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup223"><code class="language-javascript text-sm text-gray-800">.chat.completions.create({
        model: this.model,
        messages,
        temperature,
      })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps: result.output.usage?.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!this.model)
      throw new Error(
        `LMStudio chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/lmStudio/index.js (Line 168:9 - Line 203:4), server/utils/AiProviders/textGenWebUI/index.js (Line 158:7 - Line 192:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn224" onclick="toggleCodeBlock('cloneGroup224', 'expandBtn224', 'collapseBtn224')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn224" onclick="toggleCodeBlock('cloneGroup224', 'expandBtn224', 'collapseBtn224')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup224"><code class="language-javascript text-sm text-gray-800">.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

/**
 * Parse the base path for the LMStudio API. Since the base path must end in /v1 and cannot have a trailing slash,
 * and the user can possibly set it to anything and likely incorrectly due to pasting behaviors, we need to ensure it is in the correct format.
 * @param {string} basePath
 * @returns {string}
 */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/lmStudio/index.js (Line 204:22 - Line 215:12), server/utils/AiProviders/nvidiaNim/index.js (Line 233:23 - Line 244:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn225" onclick="toggleCodeBlock('cloneGroup225', 'expandBtn225', 'collapseBtn225')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn225" onclick="toggleCodeBlock('cloneGroup225', 'expandBtn225', 'collapseBtn225')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup225"><code class="language-javascript text-sm text-gray-800">(providedBasePath = &quot;&quot;) {
  try {
    const baseURL = new URL(providedBasePath);
    const basePath = `${baseURL.origin}/v1`;
    return basePath;
  } catch (e) {
    return providedBasePath;
  }
}

module.exports = {
  LMStudioLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/liteLLM/index.js (Line 25:2 - Line 58:27), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn226" onclick="toggleCodeBlock('cloneGroup226', 'expandBtn226', 'collapseBtn226')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn226" onclick="toggleCodeBlock('cloneGroup226', 'expandBtn226', 'collapseBtn226')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup226"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.log(`Inference API: ${this.basePath} Model: ${this.model}`);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.LITE_LLM_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/liteLLM/index.js (Line 66:2 - Line 134:11), server/utils/AiProviders/liteLLM/index.js (Line 57:11 - Line 132:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn227" onclick="toggleCodeBlock('cloneGroup227', 'expandBtn227', 'collapseBtn227')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn227" onclick="toggleCodeBlock('cloneGroup227', 'expandBtn227', 'collapseBtn227')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup227"><code class="language-javascript text-sm text-gray-800">) {
    const limit = process.env.LITE_LLM_MODEL_TOKEN_LIMIT || 4096;
    if (!limit || isNaN(Number(limit)))
      throw new Error(&quot;No token context limit was set.&quot;);
    return Number(limit);
  }

  // Short circuit since we have no idea if the model is valid or not
  // in pre-flight for generic endpoints
  isValidChatCompletionModel(_modelName = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
          </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/liteLLM/index.js (Line 134:24 - Line 154:1), server/utils/AiProviders/xai/index.js (Line 128:2 - Line 210:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn228" onclick="toggleCodeBlock('cloneGroup228', 'expandBtn228', 'collapseBtn228')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn228" onclick="toggleCodeBlock('cloneGroup228', 'expandBtn228', 'collapseBtn228')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup228"><code class="language-javascript text-sm text-gray-800">
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps:
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/liteLLM/index.js (Line 154:2 - Line 167:11), server/utils/AiProviders/xai/index.js (Line 147:18 - Line 282:82)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn229" onclick="toggleCodeBlock('cloneGroup229', 'expandBtn229', 'collapseBtn229')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn229" onclick="toggleCodeBlock('cloneGroup229', 'expandBtn229', 'collapseBtn229')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup229"><code class="language-javascript text-sm text-gray-800"> / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
        max_tokens</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/liteLLM/index.js (Line 171:117 - Line 197:8), server/utils/AiProviders/xai/index.js (Line 167:6 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn230" onclick="toggleCodeBlock('cloneGroup230', 'expandBtn230', 'collapseBtn230')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn230" onclick="toggleCodeBlock('cloneGroup230', 'expandBtn230', 'collapseBtn230')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup230"><code class="language-javascript text-sm text-gray-800">
    );

    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  LiteLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 35:5 - Line 60:29), server/utils/AiProviders/textGenWebUI/index.js (Line 31:4 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn231" onclick="toggleCodeBlock('cloneGroup231', 'expandBtn231', 'collapseBtn231')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn231" onclick="toggleCodeBlock('cloneGroup231', 'expandBtn231', 'collapseBtn231')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup231"><code class="language-javascript text-sm text-gray-800">;
    this.log(`Inference API: ${this.basePath} Model: ${this.model}`);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.KOBOLD_CPP_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 68:2 - Line 136:5), server/utils/AiProviders/koboldCPP/index.js (Line 59:11 - Line 134:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn232" onclick="toggleCodeBlock('cloneGroup232', 'expandBtn232', 'collapseBtn232')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn232" onclick="toggleCodeBlock('cloneGroup232', 'expandBtn232', 'collapseBtn232')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup232"><code class="language-javascript text-sm text-gray-800">) {
    const limit = process.env.KOBOLD_CPP_MODEL_TOKEN_LIMIT || 4096;
    if (!limit || isNaN(Number(limit)))
      throw new Error(&quot;No token context limit was set.&quot;);
    return Number(limit);
  }

  // Short circuit since we have no idea if the model is valid or not
  // in pre-flight for generic endpoints
  isValidChatCompletionModel(_modelName = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
          max_tokens: this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 136:10 - Line 150:2), server/utils/AiProviders/xai/index.js (Line 128:12 - Line 137:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn233" onclick="toggleCodeBlock('cloneGroup233', 'expandBtn233', 'collapseBtn233')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn233" onclick="toggleCodeBlock('cloneGroup233', 'expandBtn233', 'collapseBtn233')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup233"><code class="language-javascript text-sm text-gray-800">,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    const promptTokens = LLMPerformanceMonitor.countTokens(messages);
    const completionTokens = LLMPerformanceMonitor.countTokens([</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 152:2 - Line 173:5), server/utils/AiProviders/localAi/index.js (Line 138:5 - Line 167:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn234" onclick="toggleCodeBlock('cloneGroup234', 'expandBtn234', 'collapseBtn234')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn234" onclick="toggleCodeBlock('cloneGroup234', 'expandBtn234', 'collapseBtn234')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup234"><code class="language-javascript text-sm text-gray-800">);

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: promptTokens,
        completion_tokens: completionTokens,
        total_tokens: promptTokens + completionTokens,
        outputTps: completionTokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
        max_tokens: this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 204:6 - Line 215:46), server/utils/helpers/chat/responses.js (Line 75:3 - Line 86:91)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn235" onclick="toggleCodeBlock('cloneGroup235', 'expandBtn235', 'collapseBtn235')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn235" onclick="toggleCodeBlock('cloneGroup235', 'expandBtn235', 'collapseBtn235')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup235"><code class="language-javascript text-sm text-gray-800">;
          writeResponseChunk(response, {
            uuid,
            sources: [],
            type: &quot;textResponseChunk&quot;,
            textResponse: token,
            close: false,
            error: false,
          });
        }

        // KoboldCPP finishes with &quot;length&quot; or &quot;stop&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 219:2 - Line 230:6), server/utils/helpers/chat/responses.js (Line 91:5 - Line 102:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn236" onclick="toggleCodeBlock('cloneGroup236', 'expandBtn236', 'collapseBtn236')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn236" onclick="toggleCodeBlock('cloneGroup236', 'expandBtn236', 'collapseBtn236')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup236"><code class="language-javascript text-sm text-gray-800">
        ) {
          writeResponseChunk(response, {
            uuid,
            sources,
            type: &quot;textResponseChunk&quot;,
            textResponse: &quot;&quot;,
            close: true,
            error: false,
          });
          response.removeListener(&quot;close&quot;, handleAbort);
          usage</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/koboldCPP/index.js (Line 235:2 - Line 256:13), server/utils/AiProviders/perplexity/index.js (Line 274:48 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn237" onclick="toggleCodeBlock('cloneGroup237', 'expandBtn237', 'collapseBtn237')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn237" onclick="toggleCodeBlock('cloneGroup237', 'expandBtn237', 'collapseBtn237')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup237"><code class="language-javascript text-sm text-gray-800">
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  KoboldCPPLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/huggingface/index.js (Line 32:4 - Line 52:29), server/utils/AiProviders/xai/index.js (Line 37:2 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn238" onclick="toggleCodeBlock('cloneGroup238', 'expandBtn238', 'collapseBtn238')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn238" onclick="toggleCodeBlock('cloneGroup238', 'expandBtn238', 'collapseBtn238')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup238"><code class="language-javascript text-sm text-gray-800">;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.HUGGING_FACE_LLM_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/huggingface/index.js (Line 88:2 - Line 157:15), server/utils/AiProviders/textGenWebUI/index.js (Line 121:7 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn239" onclick="toggleCodeBlock('cloneGroup239', 'expandBtn239', 'collapseBtn239')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn239" onclick="toggleCodeBlock('cloneGroup239', 'expandBtn239', 'collapseBtn239')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup239"><code class="language-javascript text-sm text-gray-800">},
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps:
          (result.output.usage?.completion_tokens || 0) / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  HuggingFaceLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/groq/index.js (Line 20:23 - Line 43:4), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 112:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn240" onclick="toggleCodeBlock('cloneGroup240', 'expandBtn240', 'collapseBtn240')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn240" onclick="toggleCodeBlock('cloneGroup240', 'expandBtn240', 'collapseBtn240')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup240"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  #log</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/groq/index.js (Line 60:28 - Line 94:6), server/utils/AiProviders/mistral/index.js (Line 62:2 - Line 129:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn241" onclick="toggleCodeBlock('cloneGroup241', 'expandBtn241', 'collapseBtn241')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn241" onclick="toggleCodeBlock('cloneGroup241', 'expandBtn241', 'collapseBtn241')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup241"><code class="language-javascript text-sm text-gray-800">
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) return userPrompt;

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  /**
   * Last Updated: October 21, 2024
   * According to https://console.groq.com/docs/vision
   * the vision models supported all make a mess of prompting depending on the model.
   * Currently the llama3.2 models are only in preview and subject to change and the llava model is deprecated - so we will not support attachments for that at all.
   *
   * Since we can only explicitly support the current models, this is a temporary solution.
   * If the attachments are empty or the model is not a vision model, we will return the default prompt structure which will work for all models.
   * If the attachments are present and the model is a vision model - we only return the user prompt with attachments - see comment at end of function for more.
   *
   * Historical attachments are also omitted from prompt chat history for the reasons above. (TDC: Dec 30, 2024)
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/groq/index.js (Line 147:2 - Line 162:111), server/utils/AiProviders/xai/index.js (Line 88:2 - Line 103:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn242" onclick="toggleCodeBlock('cloneGroup242', 'expandBtn242', 'collapseBtn242')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn242" onclick="toggleCodeBlock('cloneGroup242', 'expandBtn242', 'collapseBtn242')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup242"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], // This is the specific attachment for only this prompt
  }) {
    // NOTICE: SEE GroqLLM.#conditionalPromptStruct for more information on how attachments are handled with Groq.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/groq/index.js (Line 175:25 - Line 203:1), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 147:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn243" onclick="toggleCodeBlock('cloneGroup243', 'expandBtn243', 'collapseBtn243')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn243" onclick="toggleCodeBlock('cloneGroup243', 'expandBtn243', 'collapseBtn243')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup243"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps:
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/groq/index.js (Line 213:31 - Line 250:8), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn244" onclick="toggleCodeBlock('cloneGroup244', 'expandBtn244', 'collapseBtn244')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn244" onclick="toggleCodeBlock('cloneGroup244', 'expandBtn244', 'collapseBtn244')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup244"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages,
      false
    );

    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  GroqLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 31:45 - Line 64:34), server/utils/AiProviders/liteLLM/index.js (Line 25:39 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn245" onclick="toggleCodeBlock('cloneGroup245', 'expandBtn245', 'collapseBtn245')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn245" onclick="toggleCodeBlock('cloneGroup245', 'expandBtn245', 'collapseBtn245')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup245"><code class="language-javascript text-sm text-gray-800">);
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.log(`Inference API: ${this.basePath} Model: ${this.model}`);
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.GENERIC_OPEN_AI_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 72:2 - Line 101:6), server/utils/AiProviders/genericOpenAi/index.js (Line 63:11 - Line 81:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn246" onclick="toggleCodeBlock('cloneGroup246', 'expandBtn246', 'collapseBtn246')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn246" onclick="toggleCodeBlock('cloneGroup246', 'expandBtn246', 'collapseBtn246')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup246"><code class="language-javascript text-sm text-gray-800">) {
    const limit = process.env.GENERIC_OPEN_AI_MODEL_TOKEN_LIMIT || 4096;
    if (!limit || isNaN(Number(limit)))
      throw new Error(&quot;No token context limit was set.&quot;);
    return Number(limit);
  }

  // Short circuit since we have no idea if the model is valid or not
  // in pre-flight for generic endpoints
  isValidChatCompletionModel(_modelName = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   *
   * ## Developer Note
   * This function assumes the generic OpenAI provider is _actually_ OpenAI compatible.
   * For example, Ollama is &quot;OpenAI compatible&quot; but does not support images as a content array.
   * The contentString also is the base64 string WITH `data:image/xxx;base64,` prefix, which may not be the case for all providers.
   * If your provider does not work exactly this way, then attachments will not function or potentially break vision requests.
   * If you encounter this issue, you are welcome to open an issue asking for your specific provider to be supported.
   *
   * This function will **not** be updated for providers that **do not** support images as a content array like OpenAI does.
   * Do not open issues to update this function due to your specific provider not being compatible. Open an issue to request support for your specific provider.
   * @param {Object} props
   * @param {string} props.userPrompt - the user prompt to be sent to the model
   * @param {import(&quot;../../helpers&quot;).Attachment[]} props.attachments - the array of attachments to be sent to the model
   * @returns {string|object[]}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 101:6 - Line 150:6), server/utils/AiProviders/xai/index.js (Line 72:6 - Line 117:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn247" onclick="toggleCodeBlock('cloneGroup247', 'expandBtn247', 'collapseBtn247')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn247" onclick="toggleCodeBlock('cloneGroup247', 'expandBtn247', 'collapseBtn247')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup247"><code class="language-javascript text-sm text-gray-800">
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;high&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  /**
   * Parses and prepends reasoning from the response and returns the full text response.
   * @param {Object} response
   * @returns {string}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 158:13 - Line 182:5), server/utils/AiProviders/textGenWebUI/index.js (Line 122:2 - Line 142:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn248" onclick="toggleCodeBlock('cloneGroup248', 'expandBtn248', 'collapseBtn248')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn248" onclick="toggleCodeBlock('cloneGroup248', 'expandBtn248', 'collapseBtn248')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup248"><code class="language-javascript text-sm text-gray-800">;
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
          max_tokens: this.maxTokens,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: this</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 188:2 - Line 204:7), server/utils/AiProviders/liteLLM/index.js (Line 154:7 - Line 176:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn249" onclick="toggleCodeBlock('cloneGroup249', 'expandBtn249', 'collapseBtn249')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn249" onclick="toggleCodeBlock('cloneGroup249', 'expandBtn249', 'collapseBtn249')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup249"><code class="language-javascript text-sm text-gray-800">.usage?.completion_tokens || 0) / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
        max_tokens: this.maxTokens,
      }),
      messages
      </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 222:3 - Line 236:6), server/utils/AiProviders/ollama/index.js (Line 224:2 - Line 238:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn250" onclick="toggleCodeBlock('cloneGroup250', 'expandBtn250', 'collapseBtn250')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn250" onclick="toggleCodeBlock('cloneGroup250', 'expandBtn250', 'collapseBtn250')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup250"><code class="language-javascript text-sm text-gray-800">;

      // Establish listener to early-abort a streaming response
      // in case things go sideways or the user does not like the response.
      // We preserve the generated text but continue as if chat was completed
      // to preserve previously generated content.
      const handleAbort = () =&gt; {
        stream?.endMeasurement(usage);
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      try {
        for await (const chunk of stream) {
          const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 239:1 - Line 255:81), server/utils/AiProviders/perplexity/index.js (Line 214:67 - Line 230:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn251" onclick="toggleCodeBlock('cloneGroup251', 'expandBtn251', 'collapseBtn251')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn251" onclick="toggleCodeBlock('cloneGroup251', 'expandBtn251', 'collapseBtn251')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup251"><code class="language-javascript text-sm text-gray-800">
          if (
            chunk.hasOwnProperty(&quot;usage&quot;) &amp;&amp; // exists
            !!chunk.usage &amp;&amp; // is not null
            Object.values(chunk.usage).length &gt; 0 // has values
          ) {
            if (chunk.usage.hasOwnProperty(&quot;prompt_tokens&quot;)) {
              usage.prompt_tokens = Number(chunk.usage.prompt_tokens);
            }

            if (chunk.usage.hasOwnProperty(&quot;completion_tokens&quot;)) {
              hasUsageMetrics = true; // to stop estimating counter
              usage.completion_tokens = Number(chunk.usage.completion_tokens);
            }
          }

          // Reasoning models will always return the reasoning text before the token text.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 279:15 - Line 299:9), server/utils/AiProviders/openRouter/index.js (Line 409:24 - Line 429:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn252" onclick="toggleCodeBlock('cloneGroup252', 'expandBtn252', 'collapseBtn252')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn252" onclick="toggleCodeBlock('cloneGroup252', 'expandBtn252', 'collapseBtn252')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup252"><code class="language-javascript text-sm text-gray-800">;
            }
          }

          // If the reasoning text is not empty, but the reasoning token is empty
          // and the token text is not empty we need to close the reasoning text and begin sending the token text.
          if (!!reasoningText &amp;&amp; !reasoningToken &amp;&amp; token) {
            writeResponseChunk(response, {
              uuid,
              sources: [],
              type: &quot;textResponseChunk&quot;,
              textResponse: `&lt;/think&gt;`,
              close: false,
              error: false,
            });
            fullText += `${reasoningText}&lt;/think&gt;`;
            reasoningText = &quot;&quot;;
          }

          if (token) {
            fullText</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 301:3 - Line 313:1), server/utils/AiProviders/novita/index.js (Line 310:6 - Line 321:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn253" onclick="toggleCodeBlock('cloneGroup253', 'expandBtn253', 'collapseBtn253')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn253" onclick="toggleCodeBlock('cloneGroup253', 'expandBtn253', 'collapseBtn253')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup253"><code class="language-javascript text-sm text-gray-800">;
            writeResponseChunk(response, {
              uuid,
              sources: [],
              type: &quot;textResponseChunk&quot;,
              textResponse: token,
              close: false,
              error: false,
            });
          }

          if (
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 316:11 - Line 328:2), server/utils/AiProviders/openRouter/index.js (Line 444:5 - Line 258:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn254" onclick="toggleCodeBlock('cloneGroup254', 'expandBtn254', 'collapseBtn254')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn254" onclick="toggleCodeBlock('cloneGroup254', 'expandBtn254', 'collapseBtn254')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup254"><code class="language-javascript text-sm text-gray-800">) {
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            stream?.endMeasurement(usage);
            resolve(fullText);
            break; </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 326:6 - Line 342:8), server/utils/AiProviders/perplexity/index.js (Line 257:13 - Line 273:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn255" onclick="toggleCodeBlock('cloneGroup255', 'expandBtn255', 'collapseBtn255')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn255" onclick="toggleCodeBlock('cloneGroup255', 'expandBtn255', 'collapseBtn255')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup255"><code class="language-javascript text-sm text-gray-800">);
            resolve(fullText);
            break; // Break streaming when a valid finish_reason is first encountered
          }
        }
      } catch (e) {
        console.log(`\x1b[43m\x1b[34m[STREAMING ERROR]\x1b[0m ${e.message}`);
        writeResponseChunk(response, {
          uuid,
          type: &quot;abort&quot;,
          textResponse: null,
          sources: [],
          close: true,
          error: e.message,
        });
        stream?.endMeasurement(usage);
        resolve</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/genericOpenAi/index.js (Line 340:2 - Line 363:17), server/utils/AiProviders/ollama/index.js (Line 284:12 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn256" onclick="toggleCodeBlock('cloneGroup256', 'expandBtn256', 'collapseBtn256')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn256" onclick="toggleCodeBlock('cloneGroup256', 'expandBtn256', 'collapseBtn256')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup256"><code class="language-javascript text-sm text-gray-800">);
        stream?.endMeasurement(usage);
        resolve(fullText);
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  GenericOpenAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 44:1 - Line 58:2), server/utils/AiProviders/xai/index.js (Line 22:2 - Line 51:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn257" onclick="toggleCodeBlock('cloneGroup257', 'expandBtn257', 'collapseBtn257')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn257" onclick="toggleCodeBlock('cloneGroup257', 'expandBtn257', 'collapseBtn257')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup257"><code class="language-javascript text-sm text-gray-800">
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;

    if (!fs.existsSync(cacheFolder))
      fs.mkdirSync(cacheFolder, { recursive: true });
    this.cacheModelPath = path.resolve(cacheFolder, &quot;models.json&quot;);
    this.cacheAtPath = path.resolve(cacheFolder, &quot;.cached_at&quot;);
    this.#</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 86:5 - Line 107:4), server/utils/AiProviders/ppio/index.js (Line 69:2 - Line 57:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn258" onclick="toggleCodeBlock('cloneGroup258', 'expandBtn258', 'collapseBtn258')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn258" onclick="toggleCodeBlock('cloneGroup258', 'expandBtn258', 'collapseBtn258')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup258"><code class="language-javascript text-sm text-gray-800">);
    return now - timestampMs &gt; MAX_STALE;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(modelName) {
    try</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 236:58 - Line 252:2), server/utils/AiProviders/gemini/index.js (Line 188:54 - Line 205:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn259" onclick="toggleCodeBlock('cloneGroup259', 'expandBtn259', 'collapseBtn259')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn259" onclick="toggleCodeBlock('cloneGroup259', 'expandBtn259', 'collapseBtn259')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup259"><code class="language-javascript text-sm text-gray-800">
      );
      url.searchParams.set(&quot;pageSize&quot;, limit);
      url.searchParams.set(&quot;key&quot;, apiKey);
      if (pageToken) url.searchParams.set(&quot;pageToken&quot;, pageToken);
      await fetch(url.toString(), {
        method: &quot;GET&quot;,
        headers: { &quot;Content-Type&quot;: &quot;application/json&quot; },
      })
        .then((res) =&gt; res.json())
        .then((data) =&gt; {
          if (data.error) throw new Error(data.error.message);
          return data.models ?? [];
        })
        .then((models) =&gt; {
          return models
            .filter((</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 252:56 - Line 265:10), server/utils/AiProviders/gemini/index.js (Line 203:7 - Line 216:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn260" onclick="toggleCodeBlock('cloneGroup260', 'expandBtn260', 'collapseBtn260')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn260" onclick="toggleCodeBlock('cloneGroup260', 'expandBtn260', 'collapseBtn260')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup260"><code class="language-javascript text-sm text-gray-800">
            .filter(
              (model) =&gt; !model.displayName?.toLowerCase()?.includes(&quot;tuning&quot;)
            ) // remove tuning models
            .filter(
              (model) =&gt;
                !model.description?.toLowerCase()?.includes(&quot;deprecated&quot;)
            ) // remove deprecated models (in comment)
            .filter((model) =&gt;
              //  Only generateContent is supported
              model.supportedGenerationMethods.includes(&quot;generateContent&quot;)
            )
            .map((model) =&gt; {
              allModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 311:2 - Line 347:4), server/utils/AiProviders/mistral/index.js (Line 62:5 - Line 103:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn261" onclick="toggleCodeBlock('cloneGroup261', 'expandBtn261', 'collapseBtn261')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn261" onclick="toggleCodeBlock('cloneGroup261', 'expandBtn261', 'collapseBtn261')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup261"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) return userPrompt;

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;high&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], // This is the specific attachment for only this prompt
  }) {
    let</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 370:4 - Line 385:2), server/utils/AiProviders/xai/index.js (Line 108:7 - Line 131:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn262" onclick="toggleCodeBlock('cloneGroup262', 'expandBtn262', 'collapseBtn262')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn262" onclick="toggleCodeBlock('cloneGroup262', 'expandBtn262', 'collapseBtn262')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup262"><code class="language-javascript text-sm text-gray-800">prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature:</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 388:2 - Line 417:12), server/utils/AiProviders/xai/index.js (Line 130:2 - Line 189:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn263" onclick="toggleCodeBlock('cloneGroup263', 'expandBtn263', 'collapseBtn263')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn263" onclick="toggleCodeBlock('cloneGroup263', 'expandBtn263', 'collapseBtn263')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup263"><code class="language-javascript text-sm text-gray-800">
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature: temperature</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 420:5 - Line 430:6), server/utils/AiProviders/xai/index.js (Line 167:6 - Line 177:89)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn264" onclick="toggleCodeBlock('cloneGroup264', 'expandBtn264', 'collapseBtn264')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn264" onclick="toggleCodeBlock('cloneGroup264', 'expandBtn264', 'collapseBtn264')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup264"><code class="language-javascript text-sm text-gray-800">
    );

    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/gemini/index.js (Line 433:11 - Line 443:2), server/utils/AiProviders/xai/index.js (Line 174:14 - Line 185:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn265" onclick="toggleCodeBlock('cloneGroup265', 'expandBtn265', 'collapseBtn265')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn265" onclick="toggleCodeBlock('cloneGroup265', 'expandBtn265', 'collapseBtn265')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup265"><code class="language-javascript text-sm text-gray-800">);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }
}</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/fireworksAi/index.js (Line 23:28 - Line 47:18), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 53:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn266" onclick="toggleCodeBlock('cloneGroup266', 'expandBtn266', 'collapseBtn266')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn266" onclick="toggleCodeBlock('cloneGroup266', 'expandBtn266', 'collapseBtn266')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup266"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = !embedder ? new NativeEmbedder() : embedder;
    this.defaultTemp = 0.7;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  allModelInformation() {
    return fireworksAiModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/fireworksAi/index.js (Line 60:42 - Line 87:20), server/utils/AiProviders/perplexity/index.js (Line 64:1 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn267" onclick="toggleCodeBlock('cloneGroup267', 'expandBtn267', 'collapseBtn267')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn267" onclick="toggleCodeBlock('cloneGroup267', 'expandBtn267', 'collapseBtn267')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup267"><code class="language-javascript text-sm text-gray-800">
  promptWindowLimit() {
    const availableModels = this.allModelInformation();
    return availableModels[this.model]?.maxLength || 4096;
  }

  async isValidChatCompletionModel(model = &quot;&quot;) {
    const availableModels = this.allModelInformation();
    return availableModels.hasOwnProperty(model);
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [prompt, ...chatHistory, { role: &quot;user&quot;, content: userPrompt }];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `FireworksAI chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/fireworksAi/index.js (Line 87:20 - Line 122:22), server/utils/AiProviders/localAi/index.js (Line 118:16 - Line 90:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn268" onclick="toggleCodeBlock('cloneGroup268', 'expandBtn268', 'collapseBtn268')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn268" onclick="toggleCodeBlock('cloneGroup268', 'expandBtn268', 'collapseBtn268')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup268"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions.create({
        model: this.model,
        messages,
        temperature,
      })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `FireworksAI chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/fireworksAi/index.js (Line 119:20 - Line 155:15), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn269" onclick="toggleCodeBlock('cloneGroup269', 'expandBtn269', 'collapseBtn269')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn269" onclick="toggleCodeBlock('cloneGroup269', 'expandBtn269', 'collapseBtn269')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup269"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages,
      false
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  FireworksAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 22:21 - Line 32:42), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 32:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn270" onclick="toggleCodeBlock('cloneGroup270', 'expandBtn270', 'collapseBtn270')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn270" onclick="toggleCodeBlock('cloneGroup270', 'expandBtn270', 'collapseBtn270')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup270"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.log(
      `Dell Pro AI Studio LLM initialized with </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 49:2 - Line 73:28), server/utils/AiProviders/xai/index.js (Line 33:2 - Line 56:34)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn271" onclick="toggleCodeBlock('cloneGroup271', 'expandBtn271', 'collapseBtn271')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn271" onclick="toggleCodeBlock('cloneGroup271', 'expandBtn271', 'collapseBtn271')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup271"><code class="language-javascript text-sm text-gray-800">
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(_modelName) {
    const limit = process.env.DPAIS_LLM_MODEL_TOKEN_LIMIT</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 84:53 - Line 123:13), server/utils/AiProviders/nvidiaNim/index.js (Line 97:45 - Line 101:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn272" onclick="toggleCodeBlock('cloneGroup272', 'expandBtn272', 'collapseBtn272')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn272" onclick="toggleCodeBlock('cloneGroup272', 'expandBtn272', 'collapseBtn272')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup272"><code class="language-javascript text-sm text-gray-800">);
    return Number(limit);
  }

  async isValidChatCompletionModel(_ = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) return userPrompt;

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  /**
   * Construct the user prompt for this model.
   * @param {{attachments: import(&quot;../../helpers&quot;).Attachment[]}} param0
   * @returns
   */
  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    _attachments</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 123:72 - Line 134:13), server/utils/AiProviders/xai/index.js (Line 101:56 - Line 112:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn273" onclick="toggleCodeBlock('cloneGroup273', 'expandBtn273', 'collapseBtn273')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn273" onclick="toggleCodeBlock('cloneGroup273', 'expandBtn273', 'collapseBtn273')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup273"><code class="language-javascript text-sm text-gray-800">
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, _attachments</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 146:6 - Line 174:27), server/utils/AiProviders/localAi/index.js (Line 122:7 - Line 193:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn274" onclick="toggleCodeBlock('cloneGroup274', 'expandBtn274', 'collapseBtn274')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn274" onclick="toggleCodeBlock('cloneGroup274', 'expandBtn274', 'collapseBtn274')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup274"><code class="language-javascript text-sm text-gray-800">.chat.completions.create({
        model: this.model,
        messages,
        temperature,
      })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps: result.output.usage?.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!this.model)
      throw new Error(
        `Dell Pro AI Studio chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/dellProAiStudio/index.js (Line 178:6 - Line 209:19), server/utils/AiProviders/textGenWebUI/index.js (Line 158:7 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn275" onclick="toggleCodeBlock('cloneGroup275', 'expandBtn275', 'collapseBtn275')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn275" onclick="toggleCodeBlock('cloneGroup275', 'expandBtn275', 'collapseBtn275')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup275"><code class="language-javascript text-sm text-gray-800">.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  DellProAiStudioLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 23:16 - Line 58:11), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 57:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn276" onclick="toggleCodeBlock('cloneGroup276', 'expandBtn276', 'collapseBtn276')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn276" onclick="toggleCodeBlock('cloneGroup276', 'expandBtn276', 'collapseBtn276')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup276"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.log(
      `Initialized ${this.model} with context window ${this.promptWindowLimit()}`
    );
  }

  log(text, ...args) {
    console.log(`\x1b[36m[${this.constructor.name}]\x1b[0m ${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(modelName) {
    return MODEL_MAP.get(&quot;deepseek&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 67:10 - Line 87:6), server/utils/AiProviders/perplexity/index.js (Line 72:6 - Line 146:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn277" onclick="toggleCodeBlock('cloneGroup277', 'expandBtn277', 'collapseBtn277')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn277" onclick="toggleCodeBlock('cloneGroup277', 'expandBtn277', 'collapseBtn277')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup277"><code class="language-javascript text-sm text-gray-800">);
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [prompt, ...chatHistory, { role: &quot;user&quot;, content: userPrompt }];
  }

  /**
   * Parses and prepends reasoning from the response and returns the full text response.
   * @param {Object} response
   * @returns {string}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 80:2 - Line 99:3), server/utils/AiProviders/genericOpenAi/index.js (Line 143:5 - Line 162:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn278" onclick="toggleCodeBlock('cloneGroup278', 'expandBtn278', 'collapseBtn278')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn278" onclick="toggleCodeBlock('cloneGroup278', 'expandBtn278', 'collapseBtn278')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup278"><code class="language-javascript text-sm text-gray-800">];
  }

  /**
   * Parses and prepends reasoning from the response and returns the full text response.
   * @param {Object} response
   * @returns {string}
   */
  #parseReasoningFromResponse({ message }) {
    let textResponse = message?.content;
    if (
      !!message?.reasoning_content &amp;&amp;
      message.reasoning_content.trim().length &gt; 0
    )
      textResponse = `&lt;think&gt;${message.reasoning_content}&lt;/think&gt;${textResponse}`;
    return textResponse;
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 101:17 - Line 117:2), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 136:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn279" onclick="toggleCodeBlock('cloneGroup279', 'expandBtn279', 'collapseBtn279')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn279" onclick="toggleCodeBlock('cloneGroup279', 'expandBtn279', 'collapseBtn279')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup279"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result?</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 109:12 - Line 121:48), server/utils/AiProviders/openRouter/index.js (Line 243:5 - Line 255:50)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn280" onclick="toggleCodeBlock('cloneGroup280', 'expandBtn280', 'collapseBtn280')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn280" onclick="toggleCodeBlock('cloneGroup280', 'expandBtn280', 'collapseBtn280')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup280"><code class="language-javascript text-sm text-gray-800">,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result?.output?.hasOwnProperty(&quot;choices&quot;) ||
      result?.output?.choices?.length === 0
    )
      throw new Error(
        `Invalid response body returned from DeepSeek: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 121:2 - Line 142:22), server/utils/AiProviders/openRouter/index.js (Line 255:15 - Line 104:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn281" onclick="toggleCodeBlock('cloneGroup281', 'expandBtn281', 'collapseBtn281')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn281" onclick="toggleCodeBlock('cloneGroup281', 'expandBtn281', 'collapseBtn281')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup281"><code class="language-javascript text-sm text-gray-800">}`
      );

    return {
      textResponse: this.#parseReasoningFromResponse(result.output.choices[0]),
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `DeepSeek chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 139:17 - Line 156:77), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 173:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn282" onclick="toggleCodeBlock('cloneGroup282', 'expandBtn282', 'collapseBtn282')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn282" onclick="toggleCodeBlock('cloneGroup282', 'expandBtn282', 'collapseBtn282')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup282"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages,
      false
    );

    return measuredStreamRequest;
  }

  // TODO: This is a copy of the generic handleStream function in responses.js</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 152:1 - Line 258:91), server/utils/AiProviders/genericOpenAi/index.js (Line 206:2 - Line 321:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn283" onclick="toggleCodeBlock('cloneGroup283', 'expandBtn283', 'collapseBtn283')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn283" onclick="toggleCodeBlock('cloneGroup283', 'expandBtn283', 'collapseBtn283')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup283"><code class="language-javascript text-sm text-gray-800">
    return measuredStreamRequest;
  }

  // TODO: This is a copy of the generic handleStream function in responses.js
  // to specifically handle the DeepSeek reasoning model `reasoning_content` field.
  // When or if ever possible, we should refactor this to be in the generic function.
  handleStream(response, stream, responseProps) {
    const { uuid = uuidv4(), sources = [] } = responseProps;
    let hasUsageMetrics = false;
    let usage = {
      completion_tokens: 0,
    };

    return new Promise(async (resolve) =&gt; {
      let fullText = &quot;&quot;;
      let reasoningText = &quot;&quot;;

      // Establish listener to early-abort a streaming response
      // in case things go sideways or the user does not like the response.
      // We preserve the generated text but continue as if chat was completed
      // to preserve previously generated content.
      const handleAbort = () =&gt; {
        stream?.endMeasurement(usage);
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      try {
        for await (const chunk of stream) {
          const message = chunk?.choices?.[0];
          const token = message?.delta?.content;
          const reasoningToken = message?.delta?.reasoning_content;

          if (
            chunk.hasOwnProperty(&quot;usage&quot;) &amp;&amp; // exists
            !!chunk.usage &amp;&amp; // is not null
            Object.values(chunk.usage).length &gt; 0 // has values
          ) {
            if (chunk.usage.hasOwnProperty(&quot;prompt_tokens&quot;)) {
              usage.prompt_tokens = Number(chunk.usage.prompt_tokens);
            }

            if (chunk.usage.hasOwnProperty(&quot;completion_tokens&quot;)) {
              hasUsageMetrics = true; // to stop estimating counter
              usage.completion_tokens = Number(chunk.usage.completion_tokens);
            }
          }

          // Reasoning models will always return the reasoning text before the token text.
          if (reasoningToken) {
            // If the reasoning text is empty (''), we need to initialize it
            // and send the first chunk of reasoning text.
            if (reasoningText.length === 0) {
              writeResponseChunk(response, {
                uuid,
                sources: [],
                type: &quot;textResponseChunk&quot;,
                textResponse: `&lt;think&gt;${reasoningToken}`,
                close: false,
                error: false,
              });
              reasoningText += `&lt;think&gt;${reasoningToken}`;
              continue;
            } else {
              writeResponseChunk(response, {
                uuid,
                sources: [],
                type: &quot;textResponseChunk&quot;,
                textResponse: reasoningToken,
                close: false,
                error: false,
              });
              reasoningText += reasoningToken;
            }
          }

          // If the reasoning text is not empty, but the reasoning token is empty
          // and the token text is not empty we need to close the reasoning text and begin sending the token text.
          if (!!reasoningText &amp;&amp; !reasoningToken &amp;&amp; token) {
            writeResponseChunk(response, {
              uuid,
              sources: [],
              type: &quot;textResponseChunk&quot;,
              textResponse: `&lt;/think&gt;`,
              close: false,
              error: false,
            });
            fullText += `${reasoningText}&lt;/think&gt;`;
            reasoningText = &quot;&quot;;
          }

          if (token) {
            fullText += token;
            // If we never saw a usage metric, we can estimate them by number of completion chunks
            if (!hasUsageMetrics) usage.completion_tokens++;
            writeResponseChunk(response, {
              uuid,
              sources: [],
              type: &quot;textResponseChunk&quot;,
              textResponse: token,
              close: false,
              error: false,
            });
          }

          // LocalAi returns '' and others return null on chunks - the last chunk is not &quot;&quot; or null.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 259:82 - Line 290:2), server/utils/AiProviders/genericOpenAi/index.js (Line 311:1 - Line 343:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn284" onclick="toggleCodeBlock('cloneGroup284', 'expandBtn284', 'collapseBtn284')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn284" onclick="toggleCodeBlock('cloneGroup284', 'expandBtn284', 'collapseBtn284')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup284"><code class="language-javascript text-sm text-gray-800">
          if (
            message?.hasOwnProperty(&quot;finish_reason&quot;) &amp;&amp; // Got valid message and it is an object with finish_reason
            message.finish_reason !== &quot;&quot; &amp;&amp;
            message.finish_reason !== null
          ) {
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            stream?.endMeasurement(usage);
            resolve(fullText);
            break; // Break streaming when a valid finish_reason is first encountered
          }
        }
      } catch (e) {
        console.log(`\x1b[43m\x1b[34m[STREAMING ERROR]\x1b[0m ${e.message}`);
        writeResponseChunk(response, {
          uuid,
          type: &quot;abort&quot;,
          textResponse: null,
          sources: [],
          close: true,
          error: e.message,
        });
        stream?.endMeasurement(usage);
        resolve(fullText); </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/deepseek/index.js (Line 292:2 - Line 310:12), server/utils/AiProviders/ppio/index.js (Line 201:14 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn285" onclick="toggleCodeBlock('cloneGroup285', 'expandBtn285', 'collapseBtn285')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn285" onclick="toggleCodeBlock('cloneGroup285', 'expandBtn285', 'collapseBtn285')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup285"><code class="language-javascript text-sm text-gray-800">);
  }

  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  DeepSeekLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/cohere/index.js (Line 27:2 - Line 42:25), server/utils/AiProviders/xai/index.js (Line 37:5 - Line 112:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn286" onclick="toggleCodeBlock('cloneGroup286', 'expandBtn286', 'collapseBtn286')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn286" onclick="toggleCodeBlock('cloneGroup286', 'expandBtn286', 'collapseBtn286')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup286"><code class="language-javascript text-sm text-gray-800">);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  #convertChatHistoryCohere</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/cohere/index.js (Line 82:9 - Line 101:15), server/utils/AiProviders/perplexity/index.js (Line 72:15 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn287" onclick="toggleCodeBlock('cloneGroup287', 'expandBtn287', 'collapseBtn287')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn287" onclick="toggleCodeBlock('cloneGroup287', 'expandBtn287', 'collapseBtn287')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup287"><code class="language-javascript text-sm text-gray-800">(model);
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [prompt, ...chatHistory, { role: &quot;user&quot;, content: userPrompt }];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Cohere chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/cohere/index.js (Line 125:5 - Line 144:5), server/utils/AiProviders/localAi/index.js (Line 141:8 - Line 107:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn288" onclick="toggleCodeBlock('cloneGroup288', 'expandBtn288', 'collapseBtn288')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn288" onclick="toggleCodeBlock('cloneGroup288', 'expandBtn288', 'collapseBtn288')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup288"><code class="language-javascript text-sm text-gray-800">,
      metrics: {
        prompt_tokens: promptTokens,
        completion_tokens: completionTokens,
        total_tokens: promptTokens + completionTokens,
        outputTps: completionTokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `Cohere chat: ${this.model} is not valid for chat completion!`
      );

    const message = messages[messages.length - 1].content; // Get the last message
    const cohereHistory = this.#convertChatHistoryCohere(messages.slice(0, -1)); // Remove the last message and convert to Cohere
    </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/cohere/index.js (Line 233:7 - Line 255:10), server/utils/AiProviders/ollama/index.js (Line 285:2 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn289" onclick="toggleCodeBlock('cloneGroup289', 'expandBtn289', 'collapseBtn289')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn289" onclick="toggleCodeBlock('cloneGroup289', 'expandBtn289', 'collapseBtn289')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup289"><code class="language-javascript text-sm text-gray-800">.endMeasurement(usage);
        resolve(fullText);
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  CohereLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/bedrock/index.js (Line 87:2 - Line 131:6), server/utils/agents/aibitat/providers/bedrock.js (Line 31:5 - Line 70:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn290" onclick="toggleCodeBlock('cloneGroup290', 'expandBtn290', 'collapseBtn290')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn290" onclick="toggleCodeBlock('cloneGroup290', 'expandBtn290', 'collapseBtn290')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup290"><code class="language-javascript text-sm text-gray-800">;
  }

  /**
   * Gets the credentials for the AWS Bedrock LLM based on the authentication method provided.
   * @returns {object} The credentials object.
   */
  get credentials() {
    switch (this.authMethod) {
      case &quot;iam&quot;: // explicit credentials
        return {
          accessKeyId: process.env.AWS_BEDROCK_LLM_ACCESS_KEY_ID,
          secretAccessKey: process.env.AWS_BEDROCK_LLM_ACCESS_KEY,
        };
      case &quot;sessionToken&quot;: // Session token is used for temporary credentials
        return {
          accessKeyId: process.env.AWS_BEDROCK_LLM_ACCESS_KEY_ID,
          secretAccessKey: process.env.AWS_BEDROCK_LLM_ACCESS_KEY,
          sessionToken: process.env.AWS_BEDROCK_LLM_SESSION_TOKEN,
        };
      // IAM role is used for long-term credentials implied by system process
      // is filled by the AWS SDK automatically if we pass in no credentials
      case &quot;iam_role&quot;:
        return {};
      default:
        return {};
    }
  }

  /**
   * Gets the configured AWS authentication method ('iam' or 'sessionToken').
   * Defaults to 'iam' if the environment variable is invalid.
   * @returns {&quot;iam&quot; | &quot;iam_role&quot; | &quot;sessionToken&quot;} The authentication method.
   */
  get authMethod() {
    const method = process.env.AWS_BEDROCK_LLM_CONNECTION_METHOD || &quot;iam&quot;;
    return SUPPORTED_CONNECTION_METHODS.includes(method) ? method : &quot;iam&quot;;
  }

  /**
   * Appends context texts to a string with standard formatting.
   * @param {string[]} contextTexts - An array of context text snippets.
   * @returns {string} Formatted context string or empty string if no context provided.
   * @private
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/bedrock/index.js (Line 729:37 - Line 750:14), server/utils/AiProviders/perplexity/index.js (Line 274:48 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn291" onclick="toggleCodeBlock('cloneGroup291', 'expandBtn291', 'collapseBtn291')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn291" onclick="toggleCodeBlock('cloneGroup291', 'expandBtn291', 'collapseBtn291')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup291"><code class="language-javascript text-sm text-gray-800">
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  AWSBedrockLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 26:6 - Line 36:22), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 31:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn292" onclick="toggleCodeBlock('cloneGroup292', 'expandBtn292', 'collapseBtn292')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn292" onclick="toggleCodeBlock('cloneGroup292', 'expandBtn292', 'collapseBtn292')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup292"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;
    this.#log(
      `Initialized. Model &quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 41:31 - Line 57:50), server/utils/AiProviders/xai/index.js (Line 37:10 - Line 53:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn293" onclick="toggleCodeBlock('cloneGroup293', 'expandBtn293', 'collapseBtn293')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn293" onclick="toggleCodeBlock('cloneGroup293', 'expandBtn293', 'collapseBtn293')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup293"><code class="language-javascript text-sm text-gray-800">${text}`, ...args);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  streamingEnabled() {
    // Streaming of reasoning models is not supported</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 85:12 - Line 111:16), server/utils/AiProviders/xai/index.js (Line 64:2 - Line 129:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn294" onclick="toggleCodeBlock('cloneGroup294', 'expandBtn294', 'collapseBtn294')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn294" onclick="toggleCodeBlock('cloneGroup294', 'expandBtn294', 'collapseBtn294')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup294"><code class="language-javascript text-sm text-gray-800">
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
        },
      });
    }
    return content.flat();
  }

  constructPrompt</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 104:14 - Line 116:2), server/utils/AiProviders/ppio/index.js (Line 125:7 - Line 165:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn295" onclick="toggleCodeBlock('cloneGroup295', 'expandBtn295', 'collapseBtn295')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn295" onclick="toggleCodeBlock('cloneGroup295', 'expandBtn295', 'collapseBtn295')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup295"><code class="language-javascript text-sm text-gray-800">,
        },
      });
    }
    return content.flat();
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 117:2 - Line 132:2), server/utils/AiProviders/openAi/index.js (Line 127:97 - Line 117:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn296" onclick="toggleCodeBlock('cloneGroup296', 'expandBtn296', 'collapseBtn296')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn296" onclick="toggleCodeBlock('cloneGroup296', 'expandBtn296', 'collapseBtn296')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup296"><code class="language-javascript text-sm text-gray-800">
    const prompt = {
      role: this.isOTypeModel ? &quot;user&quot; : &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = [</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 142:2 - Line 164:2), server/utils/AiProviders/localAi/index.js (Line 125:12 - Line 153:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn297" onclick="toggleCodeBlock('cloneGroup297', 'expandBtn297', 'collapseBtn297')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn297" onclick="toggleCodeBlock('cloneGroup297', 'expandBtn297', 'collapseBtn297')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup297"><code class="language-javascript text-sm text-gray-800">,
      })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage.prompt_tokens || 0,
        completion_tokens: result.output.usage.completion_tokens || 0,
        total_tokens: result.output.usage.total_tokens || 0,
        outputTps: result.output.usage.completion_tokens / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = [</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/azureOpenAi/index.js (Line 178:9 - Line 204:15), server/utils/AiProviders/xai/index.js (Line 167:6 - Line 193:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn298" onclick="toggleCodeBlock('cloneGroup298', 'expandBtn298', 'collapseBtn298')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn298" onclick="toggleCodeBlock('cloneGroup298', 'expandBtn298', 'collapseBtn298')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup298"><code class="language-javascript text-sm text-gray-800">
    );

    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    return handleDefaultStreamResponseV2(response, stream, responseProps);
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

module.exports = {
  AzureOpenAiLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 1:1 - Line 15:1), server/utils/AiProviders/openRouter/index.js (Line 1:1 - Line 11:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn299" onclick="toggleCodeBlock('cloneGroup299', 'expandBtn299', 'collapseBtn299')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn299" onclick="toggleCodeBlock('cloneGroup299', 'expandBtn299', 'collapseBtn299')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup299"><code class="language-javascript text-sm text-gray-800">const { NativeEmbedder } = require(&quot;../../EmbeddingEngines/native&quot;);
const { v4: uuidv4 } = require(&quot;uuid&quot;);
const {
  writeResponseChunk,
  clientAbortedHandler,
  formatChatHistory,
} = require(&quot;../../helpers/chat/responses&quot;);
const fs = require(&quot;fs&quot;);
const path = require(&quot;path&quot;);
const { safeJsonParse } = require(&quot;../../http&quot;);
const {
  LLMPerformanceMonitor,
} = require(&quot;../../helpers/chat/LLMPerformanceMonitor&quot;);

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 35:33 - Line 49:3), server/utils/AiProviders/xai/index.js (Line 22:12 - Line 49:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn300" onclick="toggleCodeBlock('cloneGroup300', 'expandBtn300', 'collapseBtn300')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn300" onclick="toggleCodeBlock('cloneGroup300', 'expandBtn300', 'collapseBtn300')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup300"><code class="language-javascript text-sm text-gray-800">;
    this.limits = {
      history: this.promptWindowLimit() * 0.15,
      system: this.promptWindowLimit() * 0.15,
      user: this.promptWindowLimit() * 0.7,
    };

    this.embedder = embedder ?? new NativeEmbedder();
    this.defaultTemp = 0.7;

    if (!fs.existsSync(cacheFolder))
      fs.mkdirSync(cacheFolder, { recursive: true });
    this.cacheModelPath = path.resolve(cacheFolder, &quot;models.json&quot;);
    this.cacheAtPath = path.resolve(cacheFolder, &quot;.cached_at&quot;);
  </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 52:2 - Line 66:81), server/utils/AiProviders/openRouter/index.js (Line 97:9 - Line 73:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn301" onclick="toggleCodeBlock('cloneGroup301', 'expandBtn301', 'collapseBtn301')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn301" onclick="toggleCodeBlock('cloneGroup301', 'expandBtn301', 'collapseBtn301')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup301"><code class="language-javascript text-sm text-gray-800">;
  }

  // This checks if the .cached_at file has a timestamp that is more than 1Week (in millis)
  // from the current date. If it is, then we will refetch the API so that all the models are up
  // to date.
  #cacheIsStale() {
    const MAX_STALE = 6.048e8; // 1 Week in MS
    if (!fs.existsSync(this.cacheAtPath)) return true;
    const now = Number(new Date());
    const timestampMs = Number(fs.readFileSync(this.cacheAtPath));
    return now - timestampMs &gt; MAX_STALE;
  }

  // This function fetches the models from the ApiPie API and caches them locally.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 77:18 - Line 101:11), server/utils/AiProviders/openRouter/index.js (Line 123:22 - Line 93:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn302" onclick="toggleCodeBlock('cloneGroup302', 'expandBtn302', 'collapseBtn302')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn302" onclick="toggleCodeBlock('cloneGroup302', 'expandBtn302', 'collapseBtn302')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup302"><code class="language-javascript text-sm text-gray-800">();
    return;
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  models() {
    if (!fs.existsSync(this.cacheModelPath)) return {};
    return safeJsonParse(
      fs.readFileSync(this.cacheModelPath, { encoding: &quot;utf-8&quot; }),
      {}
    );
  }

  chatModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 114:2 - Line 135:11), server/utils/AiProviders/openRouter/index.js (Line 142:2 - Line 163:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn303" onclick="toggleCodeBlock('cloneGroup303', 'expandBtn303', 'collapseBtn303')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn303" onclick="toggleCodeBlock('cloneGroup303', 'expandBtn303', 'collapseBtn303')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup303"><code class="language-javascript text-sm text-gray-800">,
      {}
    );
  }

  streamingEnabled() {
    return &quot;streamGetChatCompletion&quot; in this;
  }

  static promptWindowLimit(modelName) {
    const cacheModelPath = path.resolve(cacheFolder, &quot;models.json&quot;);
    const availableModels = fs.existsSync(cacheModelPath)
      ? safeJsonParse(
          fs.readFileSync(cacheModelPath, { encoding: &quot;utf-8&quot; }),
          {}
        )
      : {};
    return availableModels[modelName]?.maxLength || 4096;
  }

  promptWindowLimit() {
    const availableModels = this.chatModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 141:11 - Line 192:15), server/utils/AiProviders/openRouter/index.js (Line 169:7 - Line 183:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn304" onclick="toggleCodeBlock('cloneGroup304', 'expandBtn304', 'collapseBtn304')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn304" onclick="toggleCodeBlock('cloneGroup304', 'expandBtn304', 'collapseBtn304')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup304"><code class="language-javascript text-sm text-gray-800">();
    return availableModels.hasOwnProperty(model);
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image_url&quot;,
        image_url: {
          url: attachment.contentString,
          detail: &quot;auto&quot;,
        },
      });
    }
    return content.flat();
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [],
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `ApiPie chat: </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 192:15 - Line 232:22), server/utils/AiProviders/xai/index.js (Line 120:12 - Line 195:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn305" onclick="toggleCodeBlock('cloneGroup305', 'expandBtn305', 'collapseBtn305')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn305" onclick="toggleCodeBlock('cloneGroup305', 'expandBtn305', 'collapseBtn305')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup305"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const result = await LLMPerformanceMonitor.measureAsyncFunction(
      this.openai.chat.completions
        .create({
          model: this.model,
          messages,
          temperature,
        })
        .catch((e) =&gt; {
          throw new Error(e.message);
        })
    );

    if (
      !result.output.hasOwnProperty(&quot;choices&quot;) ||
      result.output.choices.length === 0
    )
      return null;

    return {
      textResponse: result.output.choices[0].message.content,
      metrics: {
        prompt_tokens: result.output.usage?.prompt_tokens || 0,
        completion_tokens: result.output.usage?.completion_tokens || 0,
        total_tokens: result.output.usage?.total_tokens || 0,
        outputTps:
          (result.output.usage?.completion_tokens || 0) / result.duration,
        duration: result.duration,
      },
    };
  }

  async streamGetChatCompletion(messages = null, { temperature = 0.7 }) {
    if (!(await this.isValidChatCompletionModel(this.model)))
      throw new Error(
        `ApiPie chat: ${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 229:15 - Line 245:6), server/utils/AiProviders/xai/index.js (Line 156:12 - Line 170:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn306" onclick="toggleCodeBlock('cloneGroup306', 'expandBtn306', 'collapseBtn306')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn306" onclick="toggleCodeBlock('cloneGroup306', 'expandBtn306', 'collapseBtn306')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup306"><code class="language-javascript text-sm text-gray-800">${this.model} is not valid for chat completion!`
      );

    const measuredStreamRequest = await LLMPerformanceMonitor.measureStream(
      this.openai.chat.completions.create({
        model: this.model,
        stream: true,
        messages,
        temperature,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 237:12 - Line 250:1), server/utils/AiProviders/koboldCPP/index.js (Line 173:10 - Line 311:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn307" onclick="toggleCodeBlock('cloneGroup307', 'expandBtn307', 'collapseBtn307')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn307" onclick="toggleCodeBlock('cloneGroup307', 'expandBtn307', 'collapseBtn307')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup307"><code class="language-javascript text-sm text-gray-800">,
      }),
      messages
    );
    return measuredStreamRequest;
  }

  handleStream(response, stream, responseProps) {
    const { uuid = uuidv4(), sources = [] } = responseProps;

    return new Promise(async (resolve) =&gt; {
      let fullText = &quot;&quot;;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 248:3 - Line 262:4), server/utils/AiProviders/openRouter/index.js (Line 314:18 - Line 328:63)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn308" onclick="toggleCodeBlock('cloneGroup308', 'expandBtn308', 'collapseBtn308')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn308" onclick="toggleCodeBlock('cloneGroup308', 'expandBtn308', 'collapseBtn308')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup308"><code class="language-javascript text-sm text-gray-800">;

      // Establish listener to early-abort a streaming response
      // in case things go sideways or the user does not like the response.
      // We preserve the generated text but continue as if chat was completed
      // to preserve previously generated content.
      const handleAbort = () =&gt; {
        stream?.endMeasurement({
          completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
        });
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      try</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 257:2 - Line 267:1), server/utils/AiProviders/ollama/index.js (Line 231:6 - Line 366:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn309" onclick="toggleCodeBlock('cloneGroup309', 'expandBtn309', 'collapseBtn309')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn309" onclick="toggleCodeBlock('cloneGroup309', 'expandBtn309', 'collapseBtn309')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup309"><code class="language-javascript text-sm text-gray-800">);
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      try {
        for await (const chunk of stream) {
          const message = chunk?.choices?.[0];
          const token = message?.delta?.content;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 265:8 - Line 279:2), server/utils/AiProviders/novita/index.js (Line 307:2 - Line 321:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn310" onclick="toggleCodeBlock('cloneGroup310', 'expandBtn310', 'collapseBtn310')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn310" onclick="toggleCodeBlock('cloneGroup310', 'expandBtn310', 'collapseBtn310')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup310"><code class="language-javascript text-sm text-gray-800">;

          if (token) {
            fullText += token;
            writeResponseChunk(response, {
              uuid,
              sources: [],
              type: &quot;textResponseChunk&quot;,
              textResponse: token,
              close: false,
              error: false,
            });
          }

          if (message </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 279:2 - Line 328:18), server/utils/AiProviders/openRouter/index.js (Line 444:2 - Line 218:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn311" onclick="toggleCodeBlock('cloneGroup311', 'expandBtn311', 'collapseBtn311')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn311" onclick="toggleCodeBlock('cloneGroup311', 'expandBtn311', 'collapseBtn311')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup311"><code class="language-javascript text-sm text-gray-800">message.finish_reason !== null) {
            writeResponseChunk(response, {
              uuid,
              sources,
              type: &quot;textResponseChunk&quot;,
              textResponse: &quot;&quot;,
              close: true,
              error: false,
            });
            response.removeListener(&quot;close&quot;, handleAbort);
            stream?.endMeasurement({
              completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
            });
            resolve(fullText);
          }
        }
      } catch (e) {
        writeResponseChunk(response, {
          uuid,
          sources,
          type: &quot;abort&quot;,
          textResponse: null,
          close: true,
          error: e.message,
        });
        response.removeListener(&quot;close&quot;, handleAbort);
        stream?.endMeasurement({
          completion_tokens: LLMPerformanceMonitor.countTokens(fullText),
        });
        resolve(fullText);
      }
    });
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }

  async compressMessages(promptArgs = {}, rawHistory = []) {
    const { messageArrayCompressor } = require(&quot;../../helpers/chat&quot;);
    const messageArray = this.constructPrompt(promptArgs);
    return await messageArrayCompressor(this, messageArray, rawHistory);
  }
}

async function fetchApiPieModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/apipie/index.js (Line 346:11 - Line 377:10), server/utils/AiProviders/openRouter/index.js (Line 512:15 - Line 264:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn312" onclick="toggleCodeBlock('cloneGroup312', 'expandBtn312', 'collapseBtn312')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn312" onclick="toggleCodeBlock('cloneGroup312', 'expandBtn312', 'collapseBtn312')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup312"><code class="language-javascript text-sm text-gray-800">,
        };
      });

      // Cache all response information
      if (!fs.existsSync(cacheFolder))
        fs.mkdirSync(cacheFolder, { recursive: true });
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;models.json&quot;),
        JSON.stringify(models),
        {
          encoding: &quot;utf-8&quot;,
        }
      );
      fs.writeFileSync(
        path.resolve(cacheFolder, &quot;.cached_at&quot;),
        String(Number(new Date())),
        {
          encoding: &quot;utf-8&quot;,
        }
      );

      return models;
    })
    .catch((e) =&gt; {
      console.error(e);
      return {};
    });
}

module.exports = {
  ApiPieLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 52:5 - Line 72:8), server/utils/AiProviders/xai/index.js (Line 61:5 - Line 81:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn313" onclick="toggleCodeBlock('cloneGroup313', 'expandBtn313', 'collapseBtn313')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn313" onclick="toggleCodeBlock('cloneGroup313', 'expandBtn313', 'collapseBtn313')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup313"><code class="language-javascript text-sm text-gray-800">;
  }

  isValidChatCompletionModel(_modelName = &quot;&quot;) {
    return true;
  }

  /**
   * Generates appropriate content array for a message + attachments.
   * @param {{userPrompt:string, attachments: import(&quot;../../helpers&quot;).Attachment[]}}
   * @returns {string|object[]}
   */
  #generateContent({ userPrompt, attachments = [] }) {
    if (!attachments.length) {
      return userPrompt;
    }

    const content = [{ type: &quot;text&quot;, text: userPrompt }];
    for (let attachment of attachments) {
      content.push({
        type: &quot;image&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 76:2 - Line 95:1), server/utils/AiProviders/ppio/index.js (Line 125:7 - Line 107:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn314" onclick="toggleCodeBlock('cloneGroup314', 'expandBtn314', 'collapseBtn314')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn314" onclick="toggleCodeBlock('cloneGroup314', 'expandBtn314', 'collapseBtn314')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup314"><code class="language-javascript text-sm text-gray-800">,
        },
      });
    }
    return content.flat();
  }

  constructPrompt({
    systemPrompt = &quot;&quot;,
    contextTexts = [],
    chatHistory = [],
    userPrompt = &quot;&quot;,
    attachments = [], // This is the specific attachment for only this prompt
  }) {
    const prompt = {
      role: &quot;system&quot;,
      content: `${systemPrompt}${this.#appendContext(contextTexts)}`,
    };

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 94:1 - Line 106:4), server/utils/AiProviders/xai/index.js (Line 106:2 - Line 118:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn315" onclick="toggleCodeBlock('cloneGroup315', 'expandBtn315', 'collapseBtn315')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn315" onclick="toggleCodeBlock('cloneGroup315', 'expandBtn315', 'collapseBtn315')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup315"><code class="language-javascript text-sm text-gray-800">
    return [
      prompt,
      ...formatChatHistory(chatHistory, this.#generateContent),
      {
        role: &quot;user&quot;,
        content: this.#generateContent({ userPrompt, attachments }),
      },
    ];
  }

  async getChatCompletion(messages = null, { temperature = 0.7 }) {
    try</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 161:14 - Line 177:7), server/utils/AiProviders/ollama/index.js (Line 220:3 - Line 177:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn316" onclick="toggleCodeBlock('cloneGroup316', 'expandBtn316', 'collapseBtn316')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn316" onclick="toggleCodeBlock('cloneGroup316', 'expandBtn316', 'collapseBtn316')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup316"><code class="language-javascript text-sm text-gray-800">;
      let usage = {
        prompt_tokens: 0,
        completion_tokens: 0,
      };

      // Establish listener to early-abort a streaming response
      // in case things go sideways or the user does not like the response.
      // We preserve the generated text but continue as if chat was completed
      // to preserve previously generated content.
      const handleAbort = () =&gt; {
        stream?.endMeasurement(usage);
        clientAbortedHandler(resolve, fullText);
      };
      response.on(&quot;close&quot;, handleAbort);

      stream</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 227:11 - Line 240:9), server/utils/AiProviders/koboldCPP/index.js (Line 219:7 - Line 104:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn317" onclick="toggleCodeBlock('cloneGroup317', 'expandBtn317', 'collapseBtn317')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn317" onclick="toggleCodeBlock('cloneGroup317', 'expandBtn317', 'collapseBtn317')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup317"><code class="language-javascript text-sm text-gray-800">)
        ) {
          writeResponseChunk(response, {
            uuid,
            sources,
            type: &quot;textResponseChunk&quot;,
            textResponse: &quot;&quot;,
            close: true,
            error: false,
          });
          response.removeListener(&quot;close&quot;, handleAbort);
          stream?.endMeasurement(usage);
          resolve(fullText);
        </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 242:2 - Line 257:6), server/utils/AiProviders/xai/index.js (Line 37:5 - Line 52:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn318" onclick="toggleCodeBlock('cloneGroup318', 'expandBtn318', 'collapseBtn318')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn318" onclick="toggleCodeBlock('cloneGroup318', 'expandBtn318', 'collapseBtn318')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup318"><code class="language-javascript text-sm text-gray-800">);
  }

  #appendContext(contextTexts = []) {
    if (!contextTexts || !contextTexts.length) return &quot;&quot;;
    return (
      &quot;\nContext:\n&quot; +
      contextTexts
        .map((text, i) =&gt; {
          return `[CONTEXT ${i}]:\n${text}\n[END CONTEXT ${i}]\n\n`;
        })
        .join(&quot;&quot;)
    );
  }

  async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/AiProviders/anthropic/index.js (Line 264:17 - Line 277:13), server/utils/AiProviders/xai/index.js (Line 174:2 - Line 446:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn319" onclick="toggleCodeBlock('cloneGroup319', 'expandBtn319', 'collapseBtn319')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn319" onclick="toggleCodeBlock('cloneGroup319', 'expandBtn319', 'collapseBtn319')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup319"><code class="language-javascript text-sm text-gray-800">;
  }

  // Simple wrapper for dynamic embedder &amp; normalize interface for all LLM implementations
  async embedTextInput(textInput) {
    return await this.embedder.embedTextInput(textInput);
  }
  async embedChunks(textChunks = []) {
    return await this.embedder.embedChunks(textChunks);
  }
}

module.exports = {
  AnthropicLLM</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/workspaceThread/index.js (Line 290:7 - Line 302:8), server/endpoints/api/workspaceThread/index.js (Line 168:2 - Line 180:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn320" onclick="toggleCodeBlock('cloneGroup320', 'expandBtn320', 'collapseBtn320')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn320" onclick="toggleCodeBlock('cloneGroup320', 'expandBtn320', 'collapseBtn320')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup320"><code class="language-javascript text-sm text-gray-800">;
        const workspace = await Workspace.get({ slug });
        const thread = await WorkspaceThread.get({
          slug: threadSlug,
          workspace_id: workspace.id,
        });

        if (!workspace || !thread) {
          response.sendStatus(400).end();
          return;
        }

        const history</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/workspaceThread/index.js (Line 546:9 - Line 590:1), server/endpoints/api/workspaceThread/index.js (Line 383:9 - Line 426:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn321" onclick="toggleCodeBlock('cloneGroup321', 'expandBtn321', 'collapseBtn321')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn321" onclick="toggleCodeBlock('cloneGroup321', 'expandBtn321', 'collapseBtn321')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup321"><code class="language-javascript text-sm text-gray-800">
      try {
        const { slug, threadSlug } = request.params;
        const {
          message,
          mode = &quot;query&quot;,
          userId,
          attachments = [],
          reset = false,
        } = reqBody(request);
        const workspace = await Workspace.get({ slug });
        const thread = await WorkspaceThread.get({
          slug: threadSlug,
          workspace_id: workspace.id,
        });

        if (!workspace || !thread) {
          response.status(400).json({
            id: uuidv4(),
            type: &quot;abort&quot;,
            textResponse: null,
            sources: [],
            close: true,
            error: `Workspace ${slug} or thread ${threadSlug} is not valid.`,
          });
          return;
        }

        if ((!message?.length || !VALID_CHAT_MODE.includes(mode)) &amp;&amp; !reset) {
          response.status(400).json({
            id: uuidv4(),
            type: &quot;abort&quot;,
            textResponse: null,
            sources: [],
            close: true,
            error: !message?.length
              ? &quot;Message is empty&quot;
              : `${mode} is not a valid mode.`,
          });
          return;
        }

        const user = userId ? await User.get({ id: Number(userId) }) : null;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/workspaceThread/index.js (Line 597:2 - Line 619:4), server/endpoints/api/workspaceThread/index.js (Line 426:2 - Line 448:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn322" onclick="toggleCodeBlock('cloneGroup322', 'expandBtn322', 'collapseBtn322')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn322" onclick="toggleCodeBlock('cloneGroup322', 'expandBtn322', 'collapseBtn322')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup322"><code class="language-javascript text-sm text-gray-800">
          workspace,
          message,
          mode,
          user,
          thread,
          attachments,
          reset,
        });
        await Telemetry.sendTelemetry(&quot;sent_chat&quot;, {
          LLMSelection: process.env.LLM_PROVIDER || &quot;openai&quot;,
          Embedder: process.env.EMBEDDING_ENGINE || &quot;inherit&quot;,
          VectorDbSelection: process.env.VECTOR_DB || &quot;lancedb&quot;,
          TTSSelection: process.env.TTS_PROVIDER || &quot;native&quot;,
          LLMModel: getModelTag(),
        });
        await EventLogs.logEvent(&quot;api_sent_chat&quot;, {
          workspaceName: workspace?.name,
          chatModel: workspace?.chatModel || &quot;System Default&quot;,
          threadName: thread?.name,
          userId: user?.id,
        });
        response.end</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/openai/index.js (Line 178:9 - Line 190:9), server/endpoints/api/workspaceThread/index.js (Line 433:6 - Line 445:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn323" onclick="toggleCodeBlock('cloneGroup323', 'expandBtn323', 'collapseBtn323')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn323" onclick="toggleCodeBlock('cloneGroup323', 'expandBtn323', 'collapseBtn323')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup323"><code class="language-javascript text-sm text-gray-800">,
        });
        await Telemetry.sendTelemetry(&quot;sent_chat&quot;, {
          LLMSelection: process.env.LLM_PROVIDER || &quot;openai&quot;,
          Embedder: process.env.EMBEDDING_ENGINE || &quot;inherit&quot;,
          VectorDbSelection: process.env.VECTOR_DB || &quot;lancedb&quot;,
          TTSSelection: process.env.TTS_PROVIDER || &quot;native&quot;,
          LLMModel: getModelTag(),
        });
        await EventLogs.logEvent(&quot;api_sent_chat&quot;, {
          workspaceName: workspace?.name,
          chatModel: workspace?.chatModel || &quot;System Default&quot;,
        </code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/embed/index.js (Line 191:2 - Line 201:16), server/endpoints/api/embed/index.js (Line 130:2 - Line 112:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn324" onclick="toggleCodeBlock('cloneGroup324', 'expandBtn324', 'collapseBtn324')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn324" onclick="toggleCodeBlock('cloneGroup324', 'expandBtn324', 'collapseBtn324')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup324"><code class="language-javascript text-sm text-gray-800">,
        });
        response.status(200).json({ chats });
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(&quot;/v1/embed/new&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/api/admin/index.js (Line 538:9 - Line 548:51), server/endpoints/api/admin/index.js (Line 416:3 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn325" onclick="toggleCodeBlock('cloneGroup325', 'expandBtn325', 'collapseBtn325')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn325" onclick="toggleCodeBlock('cloneGroup325', 'expandBtn325', 'collapseBtn325')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup325"><code class="language-javascript text-sm text-gray-800">);
        response.status(200).json({ success, error });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/v1/admin/workspaces/:workspaceSlug/manage-users&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/middleware/validatedRequest.js (Line 71:2 - Line 82:6), server/utils/middleware/validatedRequest.js (Line 30:1 - Line 41:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn326" onclick="toggleCodeBlock('cloneGroup326', 'expandBtn326', 'collapseBtn326')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn326" onclick="toggleCodeBlock('cloneGroup326', 'expandBtn326', 'collapseBtn326')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup326"><code class="language-javascript text-sm text-gray-800">
  const auth = request.header(&quot;Authorization&quot;);
  const token = auth ? auth.split(&quot; &quot;)[1] : null;

  if (!token) {
    response.status(401).json({
      error: &quot;No auth token found.&quot;,
    });
    return;
  }

  const valid</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/middleware/validWorkspace.js (Line 24:11 - Line 35:6), server/utils/middleware/validWorkspace.js (Line 7:5 - Line 18:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn327" onclick="toggleCodeBlock('cloneGroup327', 'expandBtn327', 'collapseBtn327')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn327" onclick="toggleCodeBlock('cloneGroup327', 'expandBtn327', 'collapseBtn327')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup327"><code class="language-javascript text-sm text-gray-800"> } = request.params;
  const user = await userFromSession(request, response);
  const workspace = multiUserMode(response)
    ? await Workspace.getWithUser(user, { slug })
    : await Workspace.get({ slug });

  if (!workspace) {
    response.status(404).send(&quot;Workspace does not exist.&quot;);
    return;
  }

  const</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/middleware/multiUserProtected.js (Line 62:2 - Line 74:68), server/utils/middleware/multiUserProtected.js (Line 28:2 - Line 45:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn328" onclick="toggleCodeBlock('cloneGroup328', 'expandBtn328', 'collapseBtn328')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn328" onclick="toggleCodeBlock('cloneGroup328', 'expandBtn328', 'collapseBtn328')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup328"><code class="language-javascript text-sm text-gray-800">

    const user =
      response.locals?.user ?? (await userFromSession(request, response));
    if (allowedRoles.includes(user?.role)) {
      next();
      return;
    }
    return response.sendStatus(401).end();
  };
}

// Middleware check on a public route if the instance is in a valid</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/middleware/embedMiddleware.js (Line 33:2 - Line 43:6), server/utils/middleware/embedMiddleware.js (Line 12:8 - Line 22:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn329" onclick="toggleCodeBlock('cloneGroup329', 'expandBtn329', 'collapseBtn329')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn329" onclick="toggleCodeBlock('cloneGroup329', 'expandBtn329', 'collapseBtn329')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup329"><code class="language-javascript text-sm text-gray-800"> });
  if (!embed) {
    response.sendStatus(404).end();
    return;
  }

  response.locals.embedConfig = embed;
  next();
}

async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/helpers/customModels.js (Line 422:22 - Line 436:16), server/utils/helpers/customModels.js (Line 393:18 - Line 407:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn330" onclick="toggleCodeBlock('cloneGroup330', 'expandBtn330', 'collapseBtn330')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn330" onclick="toggleCodeBlock('cloneGroup330', 'expandBtn330', 'collapseBtn330')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup330"><code class="language-javascript text-sm text-gray-800">();
  if (!Object.keys(knownModels).length === 0)
    return { models: [], error: null };

  const models = Object.values(knownModels).map((model) =&gt; {
    return {
      id: model.id,
      organization: model.organization,
      name: model.name,
    };
  });
  return { models, error: null };
}

async function getNovitaModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/helpers/customModels.js (Line 439:2 - Line 450:16), server/utils/helpers/customModels.js (Line 396:1 - Line 407:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn331" onclick="toggleCodeBlock('cloneGroup331', 'expandBtn331', 'collapseBtn331')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn331" onclick="toggleCodeBlock('cloneGroup331', 'expandBtn331', 'collapseBtn331')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup331"><code class="language-javascript text-sm text-gray-800">
  const models = Object.values(knownModels).map((model) =&gt; {
    return {
      id: model.id,
      organization: model.organization,
      name: model.name,
    };
  });
  return { models, error: null };
}

async function getAPIPieModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/helpers/customModels.js (Line 631:11 - Line 641:25), server/utils/helpers/customModels.js (Line 397:12 - Line 407:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn332" onclick="toggleCodeBlock('cloneGroup332', 'expandBtn332', 'collapseBtn332')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn332" onclick="toggleCodeBlock('cloneGroup332', 'expandBtn332', 'collapseBtn332')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup332"><code class="language-javascript text-sm text-gray-800">).map((model) =&gt; {
    return {
      id: model.id,
      organization: model.organization,
      name: model.name,
    };
  });
  return { models, error: null };
}

async function getDellProAiStudioModels</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/pfp.js (Line 46:10 - Line 59:7), server/utils/files/pfp.js (Line 31:5 - Line 44:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn333" onclick="toggleCodeBlock('cloneGroup333', 'expandBtn333', 'collapseBtn333')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn333" onclick="toggleCodeBlock('cloneGroup333', 'expandBtn333', 'collapseBtn333')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup333"><code class="language-javascript text-sm text-gray-800">?.pfpFilename || null;
  if (!pfpFilename) return null;

  const basePath = process.env.STORAGE_DIR
    ? path.join(process.env.STORAGE_DIR, &quot;assets/pfp&quot;)
    : path.join(__dirname, &quot;../../storage/assets/pfp&quot;);
  const pfpFilepath = path.join(basePath, normalizePath(pfpFilename));

  if (!isWithin(path.resolve(basePath), path.resolve(pfpFilepath))) return null;
  if (!fs.existsSync(pfpFilepath)) return null;
  return pfpFilepath;
}

module</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/multer.js (Line 32:21 - Line 49:27), server/utils/files/multer.js (Line 11:18 - Line 31:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn334" onclick="toggleCodeBlock('cloneGroup334', 'expandBtn334', 'collapseBtn334')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn334" onclick="toggleCodeBlock('cloneGroup334', 'expandBtn334', 'collapseBtn334')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup334"><code class="language-javascript text-sm text-gray-800"> = multer.diskStorage({
  destination: function (_, __, cb) {
    const baseStoragePath =
      process.env.NODE_ENV === &quot;development&quot;
        ? path.resolve(__dirname, &quot;../../&quot;)
        : process.env.STORAGE_DIR || path.resolve(__dirname, &quot;../../&quot;);
    const uploadOutput = path.resolve(baseStoragePath, &quot;collector/hotdir&quot;);
    cb(null, uploadOutput);
  },
  filename: function (_, file, cb) {
    file.originalname = normalizePath(
      Buffer.from(file.originalname, &quot;latin1&quot;).toString(&quot;utf8&quot;)
    );
    cb(null, file.originalname);
  },
});

// Asset storage for logos</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/multer.js (Line 58:2 - Line 70:4), server/utils/files/multer.js (Line 18:5 - Line 31:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn335" onclick="toggleCodeBlock('cloneGroup335', 'expandBtn335', 'collapseBtn335')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn335" onclick="toggleCodeBlock('cloneGroup335', 'expandBtn335', 'collapseBtn335')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup335"><code class="language-javascript text-sm text-gray-800">cb(null, uploadOutput);
  },
  filename: function (_, file, cb) {
    file.originalname = normalizePath(
      Buffer.from(file.originalname, &quot;latin1&quot;).toString(&quot;utf8&quot;)
    );
    cb(null, file.originalname);
  },
});

/**
 * Handle PFP file upload as logos
 */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/multer.js (Line 121:21 - Line 139:4), server/utils/files/multer.js (Line 97:18 - Line 119:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn336" onclick="toggleCodeBlock('cloneGroup336', 'expandBtn336', 'collapseBtn336')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn336" onclick="toggleCodeBlock('cloneGroup336', 'expandBtn336', 'collapseBtn336')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup336"><code class="language-javascript text-sm text-gray-800"> }).single(&quot;file&quot;);
  upload(request, response, function (err) {
    if (err) {
      response
        .status(500)
        .json({
          success: false,
          error: `Invalid file upload. ${err.message}`,
        })
        .end();
      return;
    }
    next();
  });
}

/**
 * Handle logo asset uploads
 */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/multer.js (Line 141:7 - Line 159:4), server/utils/files/multer.js (Line 97:7 - Line 119:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn337" onclick="toggleCodeBlock('cloneGroup337', 'expandBtn337', 'collapseBtn337')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn337" onclick="toggleCodeBlock('cloneGroup337', 'expandBtn337', 'collapseBtn337')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup337"><code class="language-javascript text-sm text-gray-800">);
  upload(request, response, function (err) {
    if (err) {
      response
        .status(500)
        .json({
          success: false,
          error: `Invalid file upload. ${err.message}`,
        })
        .end();
      return;
    }
    next();
  });
}

/**
 * Handle PFP file upload as logos
 */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/files/multer.js (Line 161:17 - Line 177:7), server/utils/files/multer.js (Line 97:18 - Line 119:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn338" onclick="toggleCodeBlock('cloneGroup338', 'expandBtn338', 'collapseBtn338')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn338" onclick="toggleCodeBlock('cloneGroup338', 'expandBtn338', 'collapseBtn338')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup338"><code class="language-javascript text-sm text-gray-800"> }).single(&quot;file&quot;);
  upload(request, response, function (err) {
    if (err) {
      response
        .status(500)
        .json({
          success: false,
          error: `Invalid file upload. ${err.message}`,
        })
        .end();
      return;
    }
    next();
  });
}

module</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/database/index.js (Line 81:2 - Line 105:6), server/utils/telemetry/index.js (Line 2:2 - Line 26:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn339" onclick="toggleCodeBlock('cloneGroup339', 'expandBtn339', 'collapseBtn339')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn339" onclick="toggleCodeBlock('cloneGroup339', 'expandBtn339', 'collapseBtn339')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup339"><code class="language-javascript text-sm text-gray-800">

// Telemetry is anonymized and your data is never read. This can be disabled by setting
// DISABLE_TELEMETRY=true in the `.env` of however you setup. Telemetry helps us determine use
// of how AnythingLLM is used and how to improve this product!
// You can see all Telemetry events by ctrl+f `Telemetry.sendTelemetry` calls to verify this claim.
async function setupTelemetry() {
  if (process.env.DISABLE_TELEMETRY === &quot;true&quot;) {
    console.log(
      `\x1b[31m[TELEMETRY DISABLED]\x1b[0m Telemetry is marked as disabled - no events will send. Telemetry helps Mintplex Labs Inc improve AnythingLLM.`
    );
    return true;
  }

  if (Telemetry.isDev()) {
    console.log(
      `\x1b[33m[TELEMETRY STUBBED]\x1b[0m Anonymous Telemetry stubbed in development.`
    );
    return;
  }

  console.log(
    `\x1b[32m[TELEMETRY ENABLED]\x1b[0m Anonymous Telemetry enabled. Telemetry helps Mintplex Labs Inc improve AnythingLLM.`
  );
  await</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/collectorApi/index.js (Line 116:15 - Line 144:6), server/utils/collectorApi/index.js (Line 78:10 - Line 106:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn340" onclick="toggleCodeBlock('cloneGroup340', 'expandBtn340', 'collapseBtn340')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn340" onclick="toggleCodeBlock('cloneGroup340', 'expandBtn340', 'collapseBtn340')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup340"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;X-Integrity&quot;: this.comkey.sign(data),
        &quot;X-Payload-Signer&quot;: this.comkey.encrypt(
          new EncryptionManager().xPayload
        ),
      },
      body: data,
    })
      .then((res) =&gt; {
        if (!res.ok) throw new Error(&quot;Response could not be completed&quot;);
        return res.json();
      })
      .then((res) =&gt; res)
      .catch((e) =&gt; {
        this.log(e.message);
        return { success: false, reason: e.message, documents: [] };
      });
  }

  /**
   * Process raw text as a document for the collector
   * - Will append the options to the request body
   * @param {string} textContent - The text to process
   * @param {Object} metadata - The metadata to process
   * @returns {Promise&lt;Object&gt;} - The response from the collector API
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/collectorApi/index.js (Line 151:19 - Line 173:90), server/utils/collectorApi/index.js (Line 78:10 - Line 106:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn341" onclick="toggleCodeBlock('cloneGroup341', 'expandBtn341', 'collapseBtn341')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn341" onclick="toggleCodeBlock('cloneGroup341', 'expandBtn341', 'collapseBtn341')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup341"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;X-Integrity&quot;: this.comkey.sign(data),
        &quot;X-Payload-Signer&quot;: this.comkey.encrypt(
          new EncryptionManager().xPayload
        ),
      },
      body: data,
    })
      .then((res) =&gt; {
        if (!res.ok) throw new Error(&quot;Response could not be completed&quot;);
        return res.json();
      })
      .then((res) =&gt; res)
      .catch((e) =&gt; {
        this.log(e.message);
        return { success: false, reason: e.message, documents: [] };
      });
  }

  // We will not ever expose the document processor to the frontend API so instead we relay</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/collectorApi/index.js (Line 214:16 - Line 232:8), server/utils/collectorApi/index.js (Line 78:10 - Line 96:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn342" onclick="toggleCodeBlock('cloneGroup342', 'expandBtn342', 'collapseBtn342')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn342" onclick="toggleCodeBlock('cloneGroup342', 'expandBtn342', 'collapseBtn342')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup342"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;X-Integrity&quot;: this.comkey.sign(data),
        &quot;X-Payload-Signer&quot;: this.comkey.encrypt(
          new EncryptionManager().xPayload
        ),
      },
      body: data,
    })
      .then((res) =&gt; {
        if (!res.ok) throw new Error(&quot;Response could not be completed&quot;);
        return res.json();
      })
      .then((res) =&gt; res)
      .catch((e) =&gt; {
        this.log(e.message);
        return { success: false, content</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/stream.js (Line 195:1 - Line 212:90), server/utils/chats/stream.js (Line 76:2 - Line 93:62)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn343" onclick="toggleCodeBlock('cloneGroup343', 'expandBtn343', 'collapseBtn343')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn343" onclick="toggleCodeBlock('cloneGroup343', 'expandBtn343', 'collapseBtn343')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup343"><code class="language-javascript text-sm text-gray-800">
    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: message,
      response: {
        text: textResponse,
        sources: [],
        type: chatMode,
        attachments,
      },
      threadId: thread?.id || null,
      include: false,
      user,
    });
    return;
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 23:2 - Line 34:1), server/utils/chats/stream.js (Line 58:3 - Line 68:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn344" onclick="toggleCodeBlock('cloneGroup344', 'expandBtn344', 'collapseBtn344')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn344" onclick="toggleCodeBlock('cloneGroup344', 'expandBtn344', 'collapseBtn344')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup344"><code class="language-javascript text-sm text-gray-800">;
  const hasVectorizedSpace = await VectorDb.hasNamespace(workspace.slug);
  const embeddingsCount = await VectorDb.namespaceCount(workspace.slug);

  // User is trying to query-mode chat a workspace that has no data in it - so
  // we should exit early as no information can be found under these conditions.
  if ((!hasVectorizedSpace || embeddingsCount === 0) &amp;&amp; chatMode === &quot;query&quot;) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 63:2 - Line 87:7), server/utils/chats/stream.js (Line 113:35 - Line 137:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn345" onclick="toggleCodeBlock('cloneGroup345', 'expandBtn345', 'collapseBtn345')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn345" onclick="toggleCodeBlock('cloneGroup345', 'expandBtn345', 'collapseBtn345')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup345"><code class="language-javascript text-sm text-gray-800">
  await new DocumentManager({
    workspace,
    maxTokens: LLMConnector.promptWindowLimit(),
  })
    .pinnedDocs()
    .then((pinnedDocs) =&gt; {
      pinnedDocs.forEach((doc) =&gt; {
        const { pageContent, ...metadata } = doc;
        pinnedDocIdentifiers.push(sourceIdentifier(doc));
        contextTexts.push(doc.pageContent);
        sources.push({
          text:
            pageContent.slice(0, 1_000) +
            &quot;...continued on in source document...&quot;,
          ...metadata,
        });
      });
    });

  const vectorSearchResults =
    embeddingsCount !== 0
      ? await VectorDb.performSimilaritySearch({
          namespace: workspace.slug,
          input: prompt</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 87:7 - Line 102:7), server/utils/chats/stream.js (Line 137:15 - Line 152:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn346" onclick="toggleCodeBlock('cloneGroup346', 'expandBtn346', 'collapseBtn346')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn346" onclick="toggleCodeBlock('cloneGroup346', 'expandBtn346', 'collapseBtn346')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup346"><code class="language-javascript text-sm text-gray-800">,
          LLMConnector,
          similarityThreshold: workspace?.similarityThreshold,
          topN: workspace?.topN,
          filterIdentifiers: pinnedDocIdentifiers,
          rerank: workspace?.vectorSearchMode === &quot;rerank&quot;,
        })
      : {
          contextTexts: [],
          sources: [],
          message: null,
        };

  // Failed similarity search if it was run at all and failed.
  if (!!vectorSearchResults.message) {
    return</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 116:20 - Line 126:1), server/utils/chats/stream.js (Line 178:14 - Line 187:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn347" onclick="toggleCodeBlock('cloneGroup347', 'expandBtn347', 'collapseBtn347')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn347" onclick="toggleCodeBlock('cloneGroup347', 'expandBtn347', 'collapseBtn347')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup347"><code class="language-javascript text-sm text-gray-800">.contextTexts];
  sources = [...sources, ...vectorSearchResults.sources];

  // If in query mode and no context chunks are found from search, backfill, or pins -  do not
  // let the LLM try to hallucinate a response or use general knowledge and exit early
  if (chatMode === &quot;query&quot; &amp;&amp; contextTexts.length === 0) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 128:7 - Line 146:13), server/utils/chats/openaiCompatible.js (Line 36:2 - Line 54:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn348" onclick="toggleCodeBlock('cloneGroup348', 'expandBtn348', 'collapseBtn348')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn348" onclick="toggleCodeBlock('cloneGroup348', 'expandBtn348', 'collapseBtn348')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup348"><code class="language-javascript text-sm text-gray-800">,
      response: {
        text: textResponse,
        sources: [],
        type: chatMode,
      },
      include: false,
    });

    return formatJSON(
      {
        id: uuid,
        type: &quot;textResponse&quot;,
        sources: [],
        close: true,
        error: null,
        textResponse,
      },
      { model: workspace.slug, finish_reason: &quot;no_content&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 204:9 - Line 220:77), server/utils/chats/openaiCompatible.js (Line 11:10 - Line 27:77)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn349" onclick="toggleCodeBlock('cloneGroup349', 'expandBtn349', 'collapseBtn349')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn349" onclick="toggleCodeBlock('cloneGroup349', 'expandBtn349', 'collapseBtn349')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup349"><code class="language-javascript text-sm text-gray-800">,
  systemPrompt = null,
  history = [],
  prompt = null,
  temperature = null,
}) {
  const uuid = uuidv4();
  const chatMode = workspace?.chatMode ?? &quot;chat&quot;;
  const LLMConnector = getLLMProvider({
    provider: workspace?.chatProvider,
    model: workspace?.chatModel,
  });
  const VectorDb = getVectorDbClass();
  const hasVectorizedSpace = await VectorDb.hasNamespace(workspace.slug);
  const embeddingsCount = await VectorDb.namespaceCount(workspace.slug);

  // We don't want to write a new method for every LLM to support openAI calls</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 237:2 - Line 257:19), server/utils/chats/stream.js (Line 60:5 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn350" onclick="toggleCodeBlock('cloneGroup350', 'expandBtn350', 'collapseBtn350')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn350" onclick="toggleCodeBlock('cloneGroup350', 'expandBtn350', 'collapseBtn350')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup350"><code class="language-javascript text-sm text-gray-800">);

  // User is trying to query-mode chat a workspace that has no data in it - so
  // we should exit early as no information can be found under these conditions.
  if ((!hasVectorizedSpace || embeddingsCount === 0) &amp;&amp; chatMode === &quot;query&quot;) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: String(prompt),
      response: {
        text: textResponse,
        sources: [],
        type: chatMode,
      },
      include: false,
    });

    writeResponseChunk</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 271:7 - Line 319:1), server/utils/chats/openaiCompatible.js (Line 55:2 - Line 152:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn351" onclick="toggleCodeBlock('cloneGroup351', 'expandBtn351', 'collapseBtn351')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn351" onclick="toggleCodeBlock('cloneGroup351', 'expandBtn351', 'collapseBtn351')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup351"><code class="language-javascript text-sm text-gray-800">;
  }

  // If we are here we know that we are in a workspace that is:
  // 1. Chatting in &quot;chat&quot; mode and may or may _not_ have embeddings
  // 2. Chatting in &quot;query&quot; mode and has at least 1 embedding
  let contextTexts = [];
  let sources = [];
  let pinnedDocIdentifiers = [];
  await new DocumentManager({
    workspace,
    maxTokens: LLMConnector.promptWindowLimit(),
  })
    .pinnedDocs()
    .then((pinnedDocs) =&gt; {
      pinnedDocs.forEach((doc) =&gt; {
        const { pageContent, ...metadata } = doc;
        pinnedDocIdentifiers.push(sourceIdentifier(doc));
        contextTexts.push(doc.pageContent);
        sources.push({
          text:
            pageContent.slice(0, 1_000) +
            &quot;...continued on in source document...&quot;,
          ...metadata,
        });
      });
    });

  const vectorSearchResults =
    embeddingsCount !== 0
      ? await VectorDb.performSimilaritySearch({
          namespace: workspace.slug,
          input: prompt,
          LLMConnector,
          similarityThreshold: workspace?.similarityThreshold,
          topN: workspace?.topN,
          filterIdentifiers: pinnedDocIdentifiers,
          rerank: workspace?.vectorSearchMode === &quot;rerank&quot;,
        })
      : {
          contextTexts: [],
          sources: [],
          message: null,
        };

  // Failed similarity search if it was run at all and failed.
  if (!!vectorSearchResults.message) {
    writeResponseChunk(
</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 332:7 - Line 357:19), server/utils/chats/openaiCompatible.js (Line 112:2 - Line 137:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn352" onclick="toggleCodeBlock('cloneGroup352', 'expandBtn352', 'collapseBtn352')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn352" onclick="toggleCodeBlock('cloneGroup352', 'expandBtn352', 'collapseBtn352')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup352"><code class="language-javascript text-sm text-gray-800">;
  }

  // For OpenAI Compatible chats, we cannot do backfilling so we simply aggregate results here.
  contextTexts = [...contextTexts, ...vectorSearchResults.contextTexts];
  sources = [...sources, ...vectorSearchResults.sources];

  // If in query mode and no context chunks are found from search, backfill, or pins -  do not
  // let the LLM try to hallucinate a response or use general knowledge and exit early
  if (chatMode === &quot;query&quot; &amp;&amp; contextTexts.length === 0) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: prompt,
      response: {
        text: textResponse,
        sources: [],
        type: chatMode,
      },
      include: false,
    });

    writeResponseChunk</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 348:7 - Line 368:13), server/utils/chats/openaiCompatible.js (Line 248:2 - Line 268:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn353" onclick="toggleCodeBlock('cloneGroup353', 'expandBtn353', 'collapseBtn353')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn353" onclick="toggleCodeBlock('cloneGroup353', 'expandBtn353', 'collapseBtn353')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup353"><code class="language-javascript text-sm text-gray-800">,
      response: {
        text: textResponse,
        sources: [],
        type: chatMode,
      },
      include: false,
    });

    writeResponseChunk(
      response,
      formatJSON(
        {
          id: uuid,
          type: &quot;textResponse&quot;,
          sources: [],
          close: true,
          error: null,
          textResponse,
        },
        { chunked: true, model: workspace.slug, finish_reason: &quot;no_content&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/openaiCompatible.js (Line 371:7 - Line 383:3), server/utils/chats/openaiCompatible.js (Line 147:2 - Line 159:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn354" onclick="toggleCodeBlock('cloneGroup354', 'expandBtn354', 'collapseBtn354')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn354" onclick="toggleCodeBlock('cloneGroup354', 'expandBtn354', 'collapseBtn354')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup354"><code class="language-javascript text-sm text-gray-800">;
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response
  // and build system messages based on inputs and history.
  const messages = await LLMConnector.compressMessages({
    systemPrompt: systemPrompt ?? (await chatPrompt(workspace)),
    userPrompt: prompt,
    contextTexts,
    chatHistory: history,
  });

  if</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/index.js (Line 50:11 - Line 61:6), server/utils/chats/index.js (Line 28:12 - Line 43:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn355" onclick="toggleCodeBlock('cloneGroup355', 'expandBtn355', 'collapseBtn355')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn355" onclick="toggleCodeBlock('cloneGroup355', 'expandBtn355', 'collapseBtn355')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup355"><code class="language-javascript text-sm text-gray-800">) {
    const regex = new RegExp(
      `(?:\\b\\s|^)(${preset.command})(?:\\b\\s|$)`,
      &quot;g&quot;
    );
    updatedMessage = updatedMessage.replace(regex, preset.prompt);
  }

  return updatedMessage;
}

async</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/embed.js (Line 69:2 - Line 90:6), server/utils/chats/stream.js (Line 115:5 - Line 136:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn356" onclick="toggleCodeBlock('cloneGroup356', 'expandBtn356', 'collapseBtn356')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn356" onclick="toggleCodeBlock('cloneGroup356', 'expandBtn356', 'collapseBtn356')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup356"><code class="language-javascript text-sm text-gray-800">workspace,
    maxTokens: LLMConnector.promptWindowLimit(),
  })
    .pinnedDocs()
    .then((pinnedDocs) =&gt; {
      pinnedDocs.forEach((doc) =&gt; {
        const { pageContent, ...metadata } = doc;
        pinnedDocIdentifiers.push(sourceIdentifier(doc));
        contextTexts.push(doc.pageContent);
        sources.push({
          text:
            pageContent.slice(0, 1_000) +
            &quot;...continued on in source document...&quot;,
          ...metadata,
        });
      });
    });

  const vectorSearchResults =
    embeddingsCount !== 0
      ? await VectorDb.performSimilaritySearch({
          namespace: embed</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/embed.js (Line 96:2 - Line 112:49), server/utils/chats/stream.js (Line 142:2 - Line 158:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn357" onclick="toggleCodeBlock('cloneGroup357', 'expandBtn357', 'collapseBtn357')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn357" onclick="toggleCodeBlock('cloneGroup357', 'expandBtn357', 'collapseBtn357')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup357"><code class="language-javascript text-sm text-gray-800">workspace?.vectorSearchMode === &quot;rerank&quot;,
        })
      : {
          contextTexts: [],
          sources: [],
          message: null,
        };

  // Failed similarity search if it was run at all and failed.
  if (!!vectorSearchResults.message) {
    writeResponseChunk(response, {
      id: uuid,
      type: &quot;abort&quot;,
      textResponse: null,
      sources: [],
      close: true,
      error: &quot;Failed to connect to vector database provider.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/embed.js (Line 119:2 - Line 135:98), server/utils/chats/stream.js (Line 165:2 - Line 181:93)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn358" onclick="toggleCodeBlock('cloneGroup358', 'expandBtn358', 'collapseBtn358')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn358" onclick="toggleCodeBlock('cloneGroup358', 'expandBtn358', 'collapseBtn358')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup358"><code class="language-javascript text-sm text-gray-800">workspace?.topN || 4,
    searchResults: vectorSearchResults.sources,
    history: rawHistory,
    filterIdentifiers: pinnedDocIdentifiers,
  });

  // Why does contextTexts get all the info, but sources only get current search?
  // This is to give the ability of the LLM to &quot;comprehend&quot; a contextual response without
  // populating the Citations under a response with documents the user &quot;thinks&quot; are irrelevant
  // due to how we manage backfilling of the context to keep chats with the LLM more correct in responses.
  // If a past citation was used to answer the question - that is visible in the history so it logically makes sense
  // and does not appear to the user that a new response used information that is otherwise irrelevant for a given prompt.
  // TLDR; reduces GitHub issues for &quot;LLM citing document that has no answer in it&quot; while keep answers highly accurate.
  contextTexts = [...contextTexts, ...filledSources.contextTexts];
  sources = [...sources, ...vectorSearchResults.sources];

  // If in query mode and no sources are found in current search or backfilled from history, do not</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/embed.js (Line 158:12 - Line 171:6), server/utils/chats/stream.js (Line 220:12 - Line 233:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn359" onclick="toggleCodeBlock('cloneGroup359', 'expandBtn359', 'collapseBtn359')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn359" onclick="toggleCodeBlock('cloneGroup359', 'expandBtn359', 'collapseBtn359')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup359"><code class="language-javascript text-sm text-gray-800">,
    },
    rawHistory
  );

  // If streaming is not explicitly enabled for connector
  // we do regular waiting of a response and send a single chunk.
  if (LLMConnector.streamingEnabled() !== true) {
    console.log(
      `\x1b[31m[STREAMING DISABLED]\x1b[0m Streaming is not available for ${LLMConnector.constructor.name}. Will use regular chat method.`
    );
    const { textResponse, metrics: performanceMetrics } =
      await LLMConnector.getChatCompletion(messages, {
        temperature: embed</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 141:2 - Line 155:8), server/utils/chats/stream.js (Line 57:1 - Line 36:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn360" onclick="toggleCodeBlock('cloneGroup360', 'expandBtn360', 'collapseBtn360')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn360" onclick="toggleCodeBlock('cloneGroup360', 'expandBtn360', 'collapseBtn360')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup360"><code class="language-javascript text-sm text-gray-800">
  const messageLimit = workspace?.openAiHistory || 20;
  const hasVectorizedSpace = await VectorDb.hasNamespace(workspace.slug);
  const embeddingsCount = await VectorDb.namespaceCount(workspace.slug);

  // User is trying to query-mode chat a workspace that has no data in it - so
  // we should exit early as no information can be found under these conditions.
  if ((!hasVectorizedSpace || embeddingsCount === 0) &amp;&amp; chatMode === &quot;query&quot;) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: String(message</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 191:1 - Line 215:8), server/utils/chats/stream.js (Line 113:35 - Line 137:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn361" onclick="toggleCodeBlock('cloneGroup361', 'expandBtn361', 'collapseBtn361')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn361" onclick="toggleCodeBlock('cloneGroup361', 'expandBtn361', 'collapseBtn361')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup361"><code class="language-javascript text-sm text-gray-800">
  await new DocumentManager({
    workspace,
    maxTokens: LLMConnector.promptWindowLimit(),
  })
    .pinnedDocs()
    .then((pinnedDocs) =&gt; {
      pinnedDocs.forEach((doc) =&gt; {
        const { pageContent, ...metadata } = doc;
        pinnedDocIdentifiers.push(sourceIdentifier(doc));
        contextTexts.push(doc.pageContent);
        sources.push({
          text:
            pageContent.slice(0, 1_000) +
            &quot;...continued on in source document...&quot;,
          ...metadata,
        });
      });
    });

  const vectorSearchResults =
    embeddingsCount !== 0
      ? await VectorDb.performSimilaritySearch({
          namespace: workspace.slug,
          input: message</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 215:8 - Line 230:2), server/utils/chats/stream.js (Line 137:15 - Line 102:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn362" onclick="toggleCodeBlock('cloneGroup362', 'expandBtn362', 'collapseBtn362')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn362" onclick="toggleCodeBlock('cloneGroup362', 'expandBtn362', 'collapseBtn362')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup362"><code class="language-javascript text-sm text-gray-800">,
          LLMConnector,
          similarityThreshold: workspace?.similarityThreshold,
          topN: workspace?.topN,
          filterIdentifiers: pinnedDocIdentifiers,
          rerank: workspace?.vectorSearchMode === &quot;rerank&quot;,
        })
      : {
          contextTexts: [],
          sources: [],
          message: null,
        };

  // Failed similarity search if it was run at all and failed.
  if (!!vectorSearchResults.message) {
    return {</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 238:2 - Line 268:8), server/utils/chats/stream.js (Line 160:7 - Line 128:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn363" onclick="toggleCodeBlock('cloneGroup363', 'expandBtn363', 'collapseBtn363')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn363" onclick="toggleCodeBlock('cloneGroup363', 'expandBtn363', 'collapseBtn363')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup363"><code class="language-javascript text-sm text-gray-800">;
  }

  const { fillSourceWindow } = require(&quot;../helpers/chat&quot;);
  const filledSources = fillSourceWindow({
    nDocs: workspace?.topN || 4,
    searchResults: vectorSearchResults.sources,
    history: rawHistory,
    filterIdentifiers: pinnedDocIdentifiers,
  });

  // Why does contextTexts get all the info, but sources only get current search?
  // This is to give the ability of the LLM to &quot;comprehend&quot; a contextual response without
  // populating the Citations under a response with documents the user &quot;thinks&quot; are irrelevant
  // due to how we manage backfilling of the context to keep chats with the LLM more correct in responses.
  // If a past citation was used to answer the question - that is visible in the history so it logically makes sense
  // and does not appear to the user that a new response used information that is otherwise irrelevant for a given prompt.
  // TLDR; reduces GitHub issues for &quot;LLM citing document that has no answer in it&quot; while keep answers highly accurate.
  contextTexts = [...contextTexts, ...filledSources.contextTexts];
  sources = [...sources, ...vectorSearchResults.sources];

  // If in query mode and no context chunks are found from search, backfill, or pins -  do not
  // let the LLM try to hallucinate a response or use general knowledge and exit early
  if (chatMode === &quot;query&quot; &amp;&amp; contextTexts.length === 0) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;

    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: message</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 279:5 - Line 293:90), server/utils/chats/apiChatHandler.js (Line 164:10 - Line 178:62)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn364" onclick="toggleCodeBlock('cloneGroup364', 'expandBtn364', 'collapseBtn364')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn364" onclick="toggleCodeBlock('cloneGroup364', 'expandBtn364', 'collapseBtn364')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup364"><code class="language-javascript text-sm text-gray-800">,
    });

    return {
      id: uuid,
      type: &quot;textResponse&quot;,
      sources: [],
      close: true,
      error: null,
      textResponse,
      metrics: {},
    };
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 367:2 - Line 391:19), server/utils/chats/apiChatHandler.js (Line 43:2 - Line 67:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn365" onclick="toggleCodeBlock('cloneGroup365', 'expandBtn365', 'collapseBtn365')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn365" onclick="toggleCodeBlock('cloneGroup365', 'expandBtn365', 'collapseBtn365')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup365"><code class="language-javascript text-sm text-gray-800">
  workspace,
  message = null,
  mode = &quot;chat&quot;,
  user = null,
  thread = null,
  sessionId = null,
  attachments = [],
  reset = false,
}) {
  const uuid = uuidv4();
  const chatMode = mode ?? &quot;chat&quot;;

  // If the user wants to reset the chat history we do so pre-flight
  // and continue execution. If no message is provided then the user intended
  // to reset the chat history only and we can exit early with a confirmation.
  if (reset) {
    await WorkspaceChats.markThreadHistoryInvalidV2({
      workspaceId: workspace.id,
      user_id: user?.id,
      thread_id: thread?.id,
      api_session_id: sessionId,
    });
    if (!message?.length) {
      writeResponseChunk</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 405:40 - Line 433:67), server/utils/chats/apiChatHandler.js (Line 79:26 - Line 107:77)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn366" onclick="toggleCodeBlock('cloneGroup366', 'expandBtn366', 'collapseBtn366')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn366" onclick="toggleCodeBlock('cloneGroup366', 'expandBtn366', 'collapseBtn366')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup366"><code class="language-javascript text-sm text-gray-800">
  // Since preset commands are not supported in API calls, we can just process the message here
  const processedMessage = await grepAllSlashCommands(message);
  message = processedMessage;

  if (EphemeralAgentHandler.isAgentInvocation({ message })) {
    await Telemetry.sendTelemetry(&quot;agent_chat_started&quot;);

    // Initialize the EphemeralAgentHandler to handle non-continuous
    // conversations with agents since this is over REST.
    const agentHandler = new EphemeralAgentHandler({
      uuid,
      workspace,
      prompt: message,
      userId: user?.id || null,
      threadId: thread?.id || null,
      sessionId,
    });

    // Establish event listener that emulates websocket calls
    // in Aibitat so that we can keep the same interface in Aibitat
    // but use HTTP.
    const eventListener = new EphemeralEventListener();
    await agentHandler.init();
    await agentHandler.createAIbitat({ handler: eventListener });
    agentHandler.startAgentCluster();

    // The cluster has started and now we wait for close event since
    // and stream back any results we get from agents as they come in.</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 466:1 - Line 483:2), server/utils/chats/apiChatHandler.js (Line 140:2 - Line 73:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn367" onclick="toggleCodeBlock('cloneGroup367', 'expandBtn367', 'collapseBtn367')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn367" onclick="toggleCodeBlock('cloneGroup367', 'expandBtn367', 'collapseBtn367')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup367"><code class="language-javascript text-sm text-gray-800">
  const VectorDb = getVectorDbClass();
  const messageLimit = workspace?.openAiHistory || 20;
  const hasVectorizedSpace = await VectorDb.hasNamespace(workspace.slug);
  const embeddingsCount = await VectorDb.namespaceCount(workspace.slug);

  // User is trying to query-mode chat a workspace that has no data in it - so
  // we should exit early as no information can be found under these conditions.
  if ((!hasVectorizedSpace || embeddingsCount === 0) &amp;&amp; chatMode === &quot;query&quot;) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;
    writeResponseChunk(response, {
      id: uuid,
      type: &quot;textResponse&quot;,
      textResponse,
      sources: [],
      attachments:</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 487:2 - Line 499:13), server/utils/chats/apiChatHandler.js (Line 265:1 - Line 277:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn368" onclick="toggleCodeBlock('cloneGroup368', 'expandBtn368', 'collapseBtn368')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn368" onclick="toggleCodeBlock('cloneGroup368', 'expandBtn368', 'collapseBtn368')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup368"><code class="language-javascript text-sm text-gray-800">
    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: message,
      response: {
        text: textResponse,
        sources: [],
        attachments: attachments,
        type: chatMode,
        metrics: {},
      },
      threadId: thread?.id || null,
      apiSessionId</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 499:10 - Line 522:110), server/utils/chats/stream.js (Line 86:5 - Line 192:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn369" onclick="toggleCodeBlock('cloneGroup369', 'expandBtn369', 'collapseBtn369')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn369" onclick="toggleCodeBlock('cloneGroup369', 'expandBtn369', 'collapseBtn369')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup369"><code class="language-javascript text-sm text-gray-800">,
      include: false,
      user,
    });
    return;
  }

  // If we are here we know that we are in a workspace that is:
  // 1. Chatting in &quot;chat&quot; mode and may or may _not_ have embeddings
  // 2. Chatting in &quot;query&quot; mode and has at least 1 embedding
  let completeText;
  let metrics = {};
  let contextTexts = [];
  let sources = [];
  let pinnedDocIdentifiers = [];
  const { rawHistory, chatHistory } = await recentChatHistory({
    user,
    workspace,
    thread,
    messageLimit,
    apiSessionId: sessionId,
  });

  // Look for pinned documents and see if the user decided to use this feature. We will also do a vector search</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 519:10 - Line 573:7), server/utils/chats/stream.js (Line 105:13 - Line 159:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn370" onclick="toggleCodeBlock('cloneGroup370', 'expandBtn370', 'collapseBtn370')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn370" onclick="toggleCodeBlock('cloneGroup370', 'expandBtn370', 'collapseBtn370')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup370"><code class="language-javascript text-sm text-gray-800">,
  });

  // Look for pinned documents and see if the user decided to use this feature. We will also do a vector search
  // as pinning is a supplemental tool but it should be used with caution since it can easily blow up a context window.
  // However we limit the maximum of appended context to 80% of its overall size, mostly because if it expands beyond this
  // it will undergo prompt compression anyway to make it work. If there is so much pinned that the context here is bigger than
  // what the model can support - it would get compressed anyway and that really is not the point of pinning. It is really best
  // suited for high-context models.
  await new DocumentManager({
    workspace,
    maxTokens: LLMConnector.promptWindowLimit(),
  })
    .pinnedDocs()
    .then((pinnedDocs) =&gt; {
      pinnedDocs.forEach((doc) =&gt; {
        const { pageContent, ...metadata } = doc;
        pinnedDocIdentifiers.push(sourceIdentifier(doc));
        contextTexts.push(doc.pageContent);
        sources.push({
          text:
            pageContent.slice(0, 1_000) +
            &quot;...continued on in source document...&quot;,
          ...metadata,
        });
      });
    });

  const vectorSearchResults =
    embeddingsCount !== 0
      ? await VectorDb.performSimilaritySearch({
          namespace: workspace.slug,
          input: message,
          LLMConnector,
          similarityThreshold: workspace?.similarityThreshold,
          topN: workspace?.topN,
          filterIdentifiers: pinnedDocIdentifiers,
          rerank: workspace?.vectorSearchMode === &quot;rerank&quot;,
        })
      : {
          contextTexts: [],
          sources: [],
          message: null,
        };

  // Failed similarity search if it was run at all and failed.
  if (!!vectorSearchResults.message) {
    writeResponseChunk(response, {
      id: uuid,
      type: &quot;abort&quot;,
      textResponse: null,
      sources: [],
      close: true,
      error: vectorSearchResults.message,
      </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 573:2 - Line 609:7), server/utils/chats/stream.js (Line 158:8 - Line 194:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn371" onclick="toggleCodeBlock('cloneGroup371', 'expandBtn371', 'collapseBtn371')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn371" onclick="toggleCodeBlock('cloneGroup371', 'expandBtn371', 'collapseBtn371')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup371"><code class="language-javascript text-sm text-gray-800">,
    });
    return;
  }

  const { fillSourceWindow } = require(&quot;../helpers/chat&quot;);
  const filledSources = fillSourceWindow({
    nDocs: workspace?.topN || 4,
    searchResults: vectorSearchResults.sources,
    history: rawHistory,
    filterIdentifiers: pinnedDocIdentifiers,
  });

  // Why does contextTexts get all the info, but sources only get current search?
  // This is to give the ability of the LLM to &quot;comprehend&quot; a contextual response without
  // populating the Citations under a response with documents the user &quot;thinks&quot; are irrelevant
  // due to how we manage backfilling of the context to keep chats with the LLM more correct in responses.
  // If a past citation was used to answer the question - that is visible in the history so it logically makes sense
  // and does not appear to the user that a new response used information that is otherwise irrelevant for a given prompt.
  // TLDR; reduces GitHub issues for &quot;LLM citing document that has no answer in it&quot; while keep answers highly accurate.
  contextTexts = [...contextTexts, ...filledSources.contextTexts];
  sources = [...sources, ...vectorSearchResults.sources];

  // If in query mode and no context chunks are found from search, backfill, or pins -  do not
  // let the LLM try to hallucinate a response or use general knowledge and exit early
  if (chatMode === &quot;query&quot; &amp;&amp; contextTexts.length === 0) {
    const textResponse =
      workspace?.queryRefusalResponse ??
      &quot;There is no relevant information in this workspace to answer your query.&quot;;
    writeResponseChunk(response, {
      id: uuid,
      type: &quot;textResponse&quot;,
      textResponse,
      sources: [],
      close: true,
      error: null,
      </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 609:2 - Line 630:90), server/utils/chats/stream.js (Line 193:5 - Line 506:62)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn372" onclick="toggleCodeBlock('cloneGroup372', 'expandBtn372', 'collapseBtn372')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn372" onclick="toggleCodeBlock('cloneGroup372', 'expandBtn372', 'collapseBtn372')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup372"><code class="language-javascript text-sm text-gray-800">,
    });

    await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: message,
      response: {
        text: textResponse,
        sources: [],
        attachments: attachments,
        type: chatMode,
        metrics: {},
      },
      threadId: thread?.id || null,
      apiSessionId: sessionId,
      include: false,
      user,
    });
    return;
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 623:10 - Line 635:8), server/utils/chats/stream.js (Line 205:5 - Line 217:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn373" onclick="toggleCodeBlock('cloneGroup373', 'expandBtn373', 'collapseBtn373')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn373" onclick="toggleCodeBlock('cloneGroup373', 'expandBtn373', 'collapseBtn373')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup373"><code class="language-javascript text-sm text-gray-800">,
      include: false,
      user,
    });
    return;
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response
  // and build system messages based on inputs and history.
  const messages = await LLMConnector.compressMessages(
    {
      systemPrompt: await chatPrompt(workspace, user),
      userPrompt: message</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 627:7 - Line 643:56), server/utils/chats/apiChatHandler.js (Line 290:2 - Line 306:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn374" onclick="toggleCodeBlock('cloneGroup374', 'expandBtn374', 'collapseBtn374')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn374" onclick="toggleCodeBlock('cloneGroup374', 'expandBtn374', 'collapseBtn374')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup374"><code class="language-javascript text-sm text-gray-800">;
  }

  // Compress &amp; Assemble message to ensure prompt passes token limit with room for response
  // and build system messages based on inputs and history.
  const messages = await LLMConnector.compressMessages(
    {
      systemPrompt: await chatPrompt(workspace, user),
      userPrompt: message,
      contextTexts,
      chatHistory,
      attachments,
    },
    rawHistory
  );

  // If streaming is not explicitly enabled for connector</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 635:8 - Line 653:5), server/utils/chats/stream.js (Line 217:15 - Line 236:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn375" onclick="toggleCodeBlock('cloneGroup375', 'expandBtn375', 'collapseBtn375')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn375" onclick="toggleCodeBlock('cloneGroup375', 'expandBtn375', 'collapseBtn375')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup375"><code class="language-javascript text-sm text-gray-800">,
      contextTexts,
      chatHistory,
      attachments,
    },
    rawHistory
  );

  // If streaming is not explicitly enabled for connector
  // we do regular waiting of a response and send a single chunk.
  if (LLMConnector.streamingEnabled() !== true) {
    console.log(
      `\x1b[31m[STREAMING DISABLED]\x1b[0m Streaming is not available for ${LLMConnector.constructor.name}. Will use regular chat method.`
    );
    const { textResponse, metrics: performanceMetrics } =
      await LLMConnector.getChatCompletion(messages, {
        temperature: workspace?.openAiTemp ?? LLMConnector.defaultTemp,
      });
    </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 652:2 - Line 683:8), server/utils/chats/stream.js (Line 235:1 - Line 266:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn376" onclick="toggleCodeBlock('cloneGroup376', 'expandBtn376', 'collapseBtn376')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn376" onclick="toggleCodeBlock('cloneGroup376', 'expandBtn376', 'collapseBtn376')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup376"><code class="language-javascript text-sm text-gray-800">
    completeText = textResponse;
    metrics = performanceMetrics;
    writeResponseChunk(response, {
      uuid,
      sources,
      type: &quot;textResponseChunk&quot;,
      textResponse: completeText,
      close: true,
      error: false,
      metrics,
    });
  } else {
    const stream = await LLMConnector.streamGetChatCompletion(messages, {
      temperature: workspace?.openAiTemp ?? LLMConnector.defaultTemp,
    });
    completeText = await LLMConnector.handleStream(response, stream, {
      uuid,
      sources,
    });
    metrics = stream.metrics;
  }

  if (completeText?.length &gt; 0) {
    const { chat } = await WorkspaceChats.new({
      workspaceId: workspace.id,
      prompt: message,
      response: {
        text: completeText,
        sources,
        type: chatMode,
        metrics</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/chats/apiChatHandler.js (Line 687:10 - Line 707:3), server/utils/chats/stream.js (Line 269:5 - Line 289:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn377" onclick="toggleCodeBlock('cloneGroup377', 'expandBtn377', 'collapseBtn377')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn377" onclick="toggleCodeBlock('cloneGroup377', 'expandBtn377', 'collapseBtn377')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup377"><code class="language-javascript text-sm text-gray-800">,
      user,
    });

    writeResponseChunk(response, {
      uuid,
      type: &quot;finalizeResponseStream&quot;,
      close: true,
      error: false,
      chatId: chat.id,
      metrics,
    });
    return;
  }

  writeResponseChunk(response, {
    uuid,
    type: &quot;finalizeResponseStream&quot;,
    close: true,
    error: false,
  </code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/imported.js (Line 91:1 - Line 101:8), server/utils/agents/imported.js (Line 68:2 - Line 78:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn378" onclick="toggleCodeBlock('cloneGroup378', 'expandBtn378', 'collapseBtn378')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn378" onclick="toggleCodeBlock('cloneGroup378', 'expandBtn378', 'collapseBtn378')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup378"><code class="language-javascript text-sm text-gray-800">
    const folders = fs.readdirSync(path.resolve(pluginsPath));
    for (const folder of folders) {
      const configLocation = path.resolve(
        pluginsPath,
        normalizePath(folder),
        &quot;plugin.json&quot;
      );
      if (!this.isValidLocation(configLocation)) continue;
      const config = safeJsonParse(fs.readFileSync(configLocation, &quot;utf8&quot;));
      plugins</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 78:41 - Line 90:11), server/utils/agents/index.js (Line 27:32 - Line 39:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn379" onclick="toggleCodeBlock('cloneGroup379', 'expandBtn379', 'collapseBtn379')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn379" onclick="toggleCodeBlock('cloneGroup379', 'expandBtn379', 'collapseBtn379')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup379"><code class="language-javascript text-sm text-gray-800">${text}`, ...args);
  }

  closeAlert() {
    this.log(`End ${this.#invocationUUID}::${this.provider}:${this.model}`);
  }

  async #chatHistory(limit = 10) {
    try {
      const rawHistory = (
        await WorkspaceChats.where(
          {
            workspaceId: this.#workspace</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 93:11 - Line 132:6), server/utils/agents/index.js (Line 42:5 - Line 74:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn380" onclick="toggleCodeBlock('cloneGroup380', 'expandBtn380', 'collapseBtn380')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn380" onclick="toggleCodeBlock('cloneGroup380', 'expandBtn380', 'collapseBtn380')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup380"><code class="language-javascript text-sm text-gray-800">,
            include: true,
          },
          limit,
          { id: &quot;desc&quot; }
        )
      ).reverse();

      const agentHistory = [];
      rawHistory.forEach((chatLog) =&gt; {
        agentHistory.push(
          {
            from: USER_AGENT.name,
            to: WORKSPACE_AGENT.name,
            content: chatLog.prompt,
            state: &quot;success&quot;,
          },
          {
            from: WORKSPACE_AGENT.name,
            to: USER_AGENT.name,
            content: safeJsonParse(chatLog.response)?.text || &quot;&quot;,
            state: &quot;success&quot;,
          }
        );
      });
      return agentHistory;
    } catch (e) {
      this.log(&quot;Error loading chat history&quot;, e.message);
      return [];
    }
  }

  /**
   * Attempts to find a fallback provider and model to use if the workspace
   * does not have an explicit `agentProvider` and `agentModel` set.
   * 1. Fallback to the workspace `chatProvider` and `chatModel` if they exist.
   * 2. Fallback to the system `LLM_PROVIDER` and try to load the associated default model via ENV params or a base available model.
   * 3. Otherwise, return null - will likely throw an error the user can act on.
   * @returns {object|null} - An object with provider and model keys.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 138:11 - Line 174:11), server/utils/agents/index.js (Line 292:10 - Line 328:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn381" onclick="toggleCodeBlock('cloneGroup381', 'expandBtn381', 'collapseBtn381')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn381" onclick="toggleCodeBlock('cloneGroup381', 'expandBtn381', 'collapseBtn381')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup381"><code class="language-javascript text-sm text-gray-800">.chatModel,
      };
    }

    // If workspace does not have chat provider and model fallback
    // to system provider and try to load provider default model
    const systemProvider = process.env.LLM_PROVIDER;
    const systemModel = this.providerDefault(systemProvider);
    if (systemProvider &amp;&amp; systemModel) {
      return {
        provider: systemProvider,
        model: systemModel,
      };
    }

    return null;
  }

  /**
   * Finds or assumes the model preference value to use for API calls.
   * If multi-model loading is supported, we use their agent model selection of the workspace
   * If not supported, we attempt to fallback to the system provider value for the LLM preference
   * and if that fails - we assume a reasonable base model to exist.
   * @returns {string|null} the model preference value to use in API calls
   */
  #fetchModel() {
    // Provider was not explicitly set for workspace, so we are going to run our fallback logic
    // that will set a provider and model for us to use.
    if (!this.provider) {
      const fallback = this.#getFallbackProvider();
      if (!fallback) throw new Error(&quot;No valid provider found for the agent.&quot;);
      this.provider = fallback.provider; // re-set the provider to the fallback provider so it is not null.
      return fallback.model; // set its defined model based on fallback logic.
    }

    // The provider was explicitly set, so check if the workspace has an agent model set.
    if (this.#workspace</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 196:2 - Line 302:13), server/utils/agents/index.js (Line 380:2 - Line 486:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn382" onclick="toggleCodeBlock('cloneGroup382', 'expandBtn382', 'collapseBtn382')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn382" onclick="toggleCodeBlock('cloneGroup382', 'expandBtn382', 'collapseBtn382')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup382"><code class="language-javascript text-sm text-gray-800">parent)) {
          this.log(
            `${parent} is not a valid plugin. Skipping inclusion to agent cluster.`
          );
          continue;
        }

        const childPlugin = AgentPlugins[parent].plugin.find(
          (child) =&gt; child.name === childPluginName
        );
        if (!childPlugin) {
          this.log(
            `${parent} does not have child plugin named ${childPluginName}. Skipping inclusion to agent cluster.`
          );
          continue;
        }

        const callOpts = this.parseCallOptions(
          args,
          childPlugin?.startupConfig?.params,
          name
        );
        this.aibitat.use(childPlugin.plugin(callOpts));
        this.log(
          `Attached ${parent}:${childPluginName} plugin to Agent cluster`
        );
        continue;
      }

      // Load flow plugin. This is marked by `@@flow_` in the array of functions to load.
      if (name.startsWith(&quot;@@flow_&quot;)) {
        const uuid = name.replace(&quot;@@flow_&quot;, &quot;&quot;);
        const plugin = AgentFlows.loadFlowPlugin(uuid, this.aibitat);
        if (!plugin) {
          this.log(
            `Flow ${uuid} not found in flows directory. Skipping inclusion to agent cluster.`
          );
          continue;
        }

        this.aibitat.use(plugin.plugin());
        this.log(
          `Attached flow ${plugin.name} (${plugin.flowName}) plugin to Agent cluster`
        );
        continue;
      }

      // Load MCP plugin. This is marked by `@@mcp_` in the array of functions to load.
      // All sub-tools are loaded here and are denoted by `pluginName:toolName` as their identifier.
      // This will replace the parent MCP server plugin with the sub-tools as child plugins so they
      // can be called directly by the agent when invoked.
      // Since to get to this point, the `activeMCPServers` method has already been called, we can
      // safely assume that the MCP server is running and the tools are available/loaded.
      if (name.startsWith(&quot;@@mcp_&quot;)) {
        const mcpPluginName = name.replace(&quot;@@mcp_&quot;, &quot;&quot;);
        const plugins =
          await new MCPCompatibilityLayer().convertServerToolsToPlugins(
            mcpPluginName,
            this.aibitat
          );
        if (!plugins) {
          this.log(
            `MCP ${mcpPluginName} not found in MCP server config. Skipping inclusion to agent cluster.`
          );
          continue;
        }

        // Remove the old function from the agent functions directly
        // and push the new ones onto the end of the array so that they are loaded properly.
        this.aibitat.agents.get(&quot;@agent&quot;).functions = this.aibitat.agents
          .get(&quot;@agent&quot;)
          .functions.filter((f) =&gt; f.name !== name);
        for (const plugin of plugins)
          this.aibitat.agents.get(&quot;@agent&quot;).functions.push(plugin.name);

        plugins.forEach((plugin) =&gt; {
          this.aibitat.use(plugin.plugin());
          this.log(
            `Attached MCP::${plugin.toolName} MCP tool to Agent cluster`
          );
        });
        continue;
      }

      // Load imported plugin. This is marked by `@@` in the array of functions to load.
      // and is the @@hubID of the plugin.
      if (name.startsWith(&quot;@@&quot;)) {
        const hubId = name.replace(&quot;@@&quot;, &quot;&quot;);
        const valid = ImportedPlugin.validateImportedPluginHandler(hubId);
        if (!valid) {
          this.log(
            `Imported plugin by hubId ${hubId} not found in plugin directory. Skipping inclusion to agent cluster.`
          );
          continue;
        }

        const plugin = ImportedPlugin.loadPluginByHubId(hubId);
        const callOpts = plugin.parseCallOptions();
        this.aibitat.use(plugin.plugin(callOpts));
        this.log(
          `Attached ${plugin.name} (${hubId}) imported plugin to Agent cluster`
        );
        continue;
      }

      // Load single-stage plugin.
      if (!AgentPlugins</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 302:2 - Line 329:6), server/utils/agents/index.js (Line 486:2 - Line 513:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn383" onclick="toggleCodeBlock('cloneGroup383', 'expandBtn383', 'collapseBtn383')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn383" onclick="toggleCodeBlock('cloneGroup383', 'expandBtn383', 'collapseBtn383')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup383"><code class="language-javascript text-sm text-gray-800">name)) {
        this.log(
          `${name} is not a valid plugin. Skipping inclusion to agent cluster.`
        );
        continue;
      }

      const callOpts = this.parseCallOptions(
        args,
        AgentPlugins[name].startupConfig.params
      );
      const AIbitatPlugin = AgentPlugins[name];
      this.aibitat.use(AIbitatPlugin.plugin(callOpts));
      this.log(`Attached ${name} plugin to Agent cluster`);
    }
  }

  async #loadAgents() {
    // Default User agent and workspace agent
    this.log(`Attaching user and default agent to Agent cluster.`);
    this.aibitat.agent(USER_AGENT.name, await USER_AGENT.getDefinition());
    this.aibitat.agent(
      WORKSPACE_AGENT.name,
      await WORKSPACE_AGENT.getDefinition(this.provider)
    );

    this.#funcsToLoad = [
      ...(await</code></pre></div><div class="py-4"><p class="text-gray-600">server/utils/agents/ephemeral.js (Line 367:5 - Line 380:8), server/utils/agents/index.js (Line 553:2 - Line 566:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn384" onclick="toggleCodeBlock('cloneGroup384', 'expandBtn384', 'collapseBtn384')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn384" onclick="toggleCodeBlock('cloneGroup384', 'expandBtn384', 'collapseBtn384')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup384"><code class="language-javascript text-sm text-gray-800">);

    // Load required agents (Default + custom)
    await this.#loadAgents();

    // Attach all required plugins for functions to operate.
    await this.#attachPlugins(args);
  }

  startAgentCluster() {
    return this.aibitat.start({
      from: USER_AGENT.name,
      to: this.channel ?? WORKSPACE_AGENT.name,
      content: this.#prompt</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/extensions/index.js (Line 40:27 - Line 51:7), server/endpoints/extensions/index.js (Line 16:31 - Line 27:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn385" onclick="toggleCodeBlock('cloneGroup385', 'expandBtn385', 'collapseBtn385')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn385" onclick="toggleCodeBlock('cloneGroup385', 'expandBtn385', 'collapseBtn385')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup385"><code class="language-javascript text-sm text-gray-800">,
    [
      validatedRequest,
      flexUserRoleValid([ROLES.admin, ROLES.manager]),
      isSupportedRepoProvider,
    ],
    async (request, response) =&gt; {
      try {
        const { repo_platform } = request.params;
        const responseFromProcessor =
          await new CollectorApi().forwardExtensionRequest({
            endpoint: `/ext/${repo_platform}-repo`</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/extensions/index.js (Line 57:9 - Line 67:26), server/endpoints/extensions/index.js (Line 30:11 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn386" onclick="toggleCodeBlock('cloneGroup386', 'expandBtn386', 'collapseBtn386')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn386" onclick="toggleCodeBlock('cloneGroup386', 'expandBtn386', 'collapseBtn386')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup386"><code class="language-javascript text-sm text-gray-800">});
        response.status(200).json(responseFromProcessor);
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/ext/youtube/transcript&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/extensions/index.js (Line 78:21 - Line 89:18), server/endpoints/extensions/index.js (Line 56:7 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn387" onclick="toggleCodeBlock('cloneGroup387', 'expandBtn387', 'collapseBtn387')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn387" onclick="toggleCodeBlock('cloneGroup387', 'expandBtn387', 'collapseBtn387')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup387"><code class="language-javascript text-sm text-gray-800">,
        });
        response.status(200).json(responseFromProcessor);
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/ext/confluence&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/extensions/index.js (Line 121:16 - Line 131:18), server/endpoints/extensions/index.js (Line 56:7 - Line 110:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn388" onclick="toggleCodeBlock('cloneGroup388', 'expandBtn388', 'collapseBtn388')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn388" onclick="toggleCodeBlock('cloneGroup388', 'expandBtn388', 'collapseBtn388')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup388"><code class="language-javascript text-sm text-gray-800">,
        });
        response.status(200).json(responseFromProcessor);
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );
  app.post(
    &quot;/ext/drupalwiki&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/extensions/index.js (Line 142:13 - Line 153:22), server/endpoints/extensions/index.js (Line 56:7 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn389" onclick="toggleCodeBlock('cloneGroup389', 'expandBtn389', 'collapseBtn389')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn389" onclick="toggleCodeBlock('cloneGroup389', 'expandBtn389', 'collapseBtn389')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup389"><code class="language-javascript text-sm text-gray-800">,
        });
        response.status(200).json(responseFromProcessor);
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/ext/obsidian/vault&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/embed/index.js (Line 81:5 - Line 93:29), server/endpoints/api/workspaceThread/index.js (Line 310:2 - Line 193:41)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn390" onclick="toggleCodeBlock('cloneGroup390', 'expandBtn390', 'collapseBtn390')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn390" onclick="toggleCodeBlock('cloneGroup390', 'expandBtn390', 'collapseBtn390')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup390"><code class="language-javascript text-sm text-gray-800">
        );

        response.status(200).json({ history: convertToChatHistory(history) });
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/embed/:embedId/:sessionId&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceChats.js (Line 71:5 - Line 83:13), server/models/workspaceChats.js (Line 46:5 - Line 58:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn391" onclick="toggleCodeBlock('cloneGroup391', 'expandBtn391', 'collapseBtn391')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn391" onclick="toggleCodeBlock('cloneGroup391', 'expandBtn391', 'collapseBtn391')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup391"><code class="language-javascript text-sm text-gray-800">,
        },
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : { orderBy: { id: &quot;asc&quot; } }),
      });
      return chats;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  forWorkspace</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceChats.js (Line 93:71 - Line 109:6), server/models/workspaceChats.js (Line 44:81 - Line 58:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn392" onclick="toggleCodeBlock('cloneGroup392', 'expandBtn392', 'collapseBtn392')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn392" onclick="toggleCodeBlock('cloneGroup392', 'expandBtn392', 'collapseBtn392')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup392"><code class="language-javascript text-sm text-gray-800">
          api_session_id: null, // do not include api-session chats in the frontend for anyone.
          include: true,
        },
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : { orderBy: { id: &quot;asc&quot; } }),
      });
      return chats;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  /**
   * @deprecated Use markThreadHistoryInvalidV2 instead.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceChats.js (Line 143:2 - Line 161:6), server/models/workspaceChats.js (Line 117:71 - Line 131:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn393" onclick="toggleCodeBlock('cloneGroup393', 'expandBtn393', 'collapseBtn393')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn393" onclick="toggleCodeBlock('cloneGroup393', 'expandBtn393', 'collapseBtn393')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup393"><code class="language-javascript text-sm text-gray-800">
        },
        data: {
          include: false,
        },
      });
      return;
    } catch (error) {
      console.error(error.message);
    }
  },

  /**
   * @description This function is used to mark a thread's history as invalid.
   * and works with an arbitrary where clause.
   * @param {Object} whereClause - The where clause to update the chats.
   * @param {Object} data - The data to update the chats with.
   * @returns {Promise&lt;void&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceChats.js (Line 166:12 - Line 177:4), server/models/workspaceChats.js (Line 118:2 - Line 131:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn394" onclick="toggleCodeBlock('cloneGroup394', 'expandBtn394', 'collapseBtn394')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn394" onclick="toggleCodeBlock('cloneGroup394', 'expandBtn394', 'collapseBtn394')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup394"><code class="language-javascript text-sm text-gray-800">,
        data: {
          include: false,
        },
      });
      return;
    } catch (error) {
      console.error(error.message);
    }
  },

  get</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceChats.js (Line 193:16 - Line 204:1), server/models/workspaceThread.js (Line 93:18 - Line 103:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn395" onclick="toggleCodeBlock('cloneGroup395', 'expandBtn395', 'collapseBtn395')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn395" onclick="toggleCodeBlock('cloneGroup395', 'expandBtn395', 'collapseBtn395')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup395"><code class="language-javascript text-sm text-gray-800">.deleteMany({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (
</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceAgentInvocation.js (Line 60:2 - Line 70:7), server/models/workspaceAgentInvocation.js (Line 44:7 - Line 54:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn396" onclick="toggleCodeBlock('cloneGroup396', 'expandBtn396', 'collapseBtn396')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn396" onclick="toggleCodeBlock('cloneGroup396', 'expandBtn396', 'collapseBtn396')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup396"><code class="language-javascript text-sm text-gray-800">,
      });

      return invocation || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  delete</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceAgentInvocation.js (Line 72:7 - Line 84:28), server/models/workspaceThread.js (Line 93:11 - Line 105:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn397" onclick="toggleCodeBlock('cloneGroup397', 'expandBtn397', 'collapseBtn397')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn397" onclick="toggleCodeBlock('cloneGroup397', 'expandBtn397', 'collapseBtn397')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup397"><code class="language-javascript text-sm text-gray-800">({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (clause = {}, limit = null, orderBy = null) {
    try {
      const results = await prisma.workspace_agent_invocations</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspaceAgentInvocation.js (Line 84:28 - Line 95:2), server/models/workspaceThread.js (Line 105:18 - Line 83:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn398" onclick="toggleCodeBlock('cloneGroup398', 'expandBtn398', 'collapseBtn398')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn398" onclick="toggleCodeBlock('cloneGroup398', 'expandBtn398', 'collapseBtn398')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup398"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },
}</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspace.js (Line 140:6 - Line 163:6), server/models/workspaceThread.js (Line 15:6 - Line 34:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn399" onclick="toggleCodeBlock('cloneGroup399', 'expandBtn399', 'collapseBtn399')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn399" onclick="toggleCodeBlock('cloneGroup399', 'expandBtn399', 'collapseBtn399')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup399"><code class="language-javascript text-sm text-gray-800">
  slugify: function (...args) {
    slugifyModule.extend({
      &quot;+&quot;: &quot; plus &quot;,
      &quot;!&quot;: &quot; bang &quot;,
      &quot;@&quot;: &quot; at &quot;,
      &quot;*&quot;: &quot; splat &quot;,
      &quot;.&quot;: &quot; dot &quot;,
      &quot;:&quot;: &quot;&quot;,
      &quot;~&quot;: &quot;&quot;,
      &quot;(&quot;: &quot;&quot;,
      &quot;)&quot;: &quot;&quot;,
      &quot;'&quot;: &quot;&quot;,
      '&quot;': &quot;&quot;,
      &quot;|&quot;: &quot;&quot;,
    });
    return slugifyModule(...args);
  },

  /**
   * Validate the fields for a workspace update.
   * @param {Object} updates - The updates to validate - should be writable fields
   * @returns {Object} The validated updates. Only valid fields are returned.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspace.js (Line 311:11 - Line 323:11), server/models/workspaceAgentInvocation.js (Line 72:28 - Line 105:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn400" onclick="toggleCodeBlock('cloneGroup400', 'expandBtn400', 'collapseBtn400')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn400" onclick="toggleCodeBlock('cloneGroup400', 'expandBtn400', 'collapseBtn400')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup400"><code class="language-javascript text-sm text-gray-800">.delete({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (clause = {}, limit = null, orderBy = null) {
    try {
      const results = await prisma.workspaces</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/workspace.js (Line 323:11 - Line 335:14), server/models/workspaceThread.js (Line 105:18 - Line 83:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn401" onclick="toggleCodeBlock('cloneGroup401', 'expandBtn401', 'collapseBtn401')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn401" onclick="toggleCodeBlock('cloneGroup401', 'expandBtn401', 'collapseBtn401')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup401"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  whereWithUser</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/welcomeMessages.js (Line 6:17 - Line 18:17), server/models/workspacesSuggestedMessages.js (Line 6:29 - Line 18:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn402" onclick="toggleCodeBlock('cloneGroup402', 'expandBtn402', 'collapseBtn402')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn402" onclick="toggleCodeBlock('cloneGroup402', 'expandBtn402', 'collapseBtn402')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup402"><code class="language-javascript text-sm text-gray-800">.findFirst({
        where: clause,
      });
      return message || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  where: async function (clause = {}, limit) {
    try {
      const messages = await prisma.welcome_messages</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/welcomeMessages.js (Line 18:17 - Line 29:2), server/models/workspacesSuggestedMessages.js (Line 18:29 - Line 29:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn403" onclick="toggleCodeBlock('cloneGroup403', 'expandBtn403', 'collapseBtn403')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn403" onclick="toggleCodeBlock('cloneGroup403', 'expandBtn403', 'collapseBtn403')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup403"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        take: limit || undefined,
      });
      return messages;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  saveAll: async function (messages)</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/user.js (Line 241:6 - Line 251:6), server/models/workspaceUsers.js (Line 85:16 - Line 95:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn404" onclick="toggleCodeBlock('cloneGroup404', 'expandBtn404', 'collapseBtn404')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn404" onclick="toggleCodeBlock('cloneGroup404', 'expandBtn404', 'collapseBtn404')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup404"><code class="language-javascript text-sm text-gray-800">.count({ where: clause });
      return count;
    } catch (error) {
      console.error(error.message);
      return 0;
    }
  },

  delete: async function (clause = {}) {
    try {
      await prisma.users</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/promptHistory.js (Line 80:15 - Line 93:6), server/models/user.js (Line 251:6 - Line 259:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn405" onclick="toggleCodeBlock('cloneGroup405', 'expandBtn405', 'collapseBtn405')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn405" onclick="toggleCodeBlock('cloneGroup405', 'expandBtn405', 'collapseBtn405')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup405"><code class="language-javascript text-sm text-gray-800">.deleteMany({ where: clause });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  /**
   * Utility method to handle prompt changes and create history entries
   * @param {import('./workspace').Workspace} workspaceData - The workspace object (previous state)
   * @param {{id: number, role: string}|null} user - The user making the change
   * @returns {Promise&lt;void&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/invite.js (Line 84:8 - Line 94:8), server/models/workspaceUsers.js (Line 85:16 - Line 95:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn406" onclick="toggleCodeBlock('cloneGroup406', 'expandBtn406', 'collapseBtn406')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn406" onclick="toggleCodeBlock('cloneGroup406', 'expandBtn406', 'collapseBtn406')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup406"><code class="language-javascript text-sm text-gray-800">.count({ where: clause });
      return count;
    } catch (error) {
      console.error(error.message);
      return 0;
    }
  },

  delete: async function (clause = {}) {
    try {
      await prisma.invites</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 44:7 - Line 57:6), server/models/promptHistory.js (Line 35:2 - Line 41:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn407" onclick="toggleCodeBlock('cloneGroup407', 'expandBtn407', 'collapseBtn407')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn407" onclick="toggleCodeBlock('cloneGroup407', 'expandBtn407', 'collapseBtn407')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup407"><code class="language-javascript text-sm text-gray-800"> },
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null
          ? { orderBy }
          : { orderBy: { occurredAt: &quot;desc&quot; } }),
      });
      return logs;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  where</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 53:2 - Line 64:5), server/models/workspaceChats.js (Line 199:6 - Line 210:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn408" onclick="toggleCodeBlock('cloneGroup408', 'expandBtn408', 'collapseBtn408')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn408" onclick="toggleCodeBlock('cloneGroup408', 'expandBtn408', 'collapseBtn408')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup408"><code class="language-javascript text-sm text-gray-800">;
    }
  },

  where: async function (
    clause = {},
    limit = null,
    orderBy = null,
    offset = null
  ) {
    try {
      const logs</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 67:7 - Line 79:14), server/models/eventLogs.js (Line 29:6 - Line 41:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn409" onclick="toggleCodeBlock('cloneGroup409', 'expandBtn409', 'collapseBtn409')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn409" onclick="toggleCodeBlock('cloneGroup409', 'expandBtn409', 'collapseBtn409')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup409"><code class="language-javascript text-sm text-gray-800"> } : {}),
        ...(orderBy !== null
          ? { orderBy }
          : { orderBy: { occurredAt: &quot;desc&quot; } }),
      });
      return logs;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  whereWithData</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 75:2 - Line 85:5), server/models/workspaceChats.js (Line 231:2 - Line 241:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn410" onclick="toggleCodeBlock('cloneGroup410', 'expandBtn410', 'collapseBtn410')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn410" onclick="toggleCodeBlock('cloneGroup410', 'expandBtn410', 'collapseBtn410')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup410"><code class="language-javascript text-sm text-gray-800">;
    }
  },

  whereWithData: async function (
    clause = {},
    limit = null,
    offset = null,
    orderBy = null
  ) {
    const { User</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 94:9 - Line 104:1), server/models/workspaceChats.js (Line 256:2 - Line 265:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn411" onclick="toggleCodeBlock('cloneGroup411', 'expandBtn411', 'collapseBtn411')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn411" onclick="toggleCodeBlock('cloneGroup411', 'expandBtn411', 'collapseBtn411')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup411"><code class="language-javascript text-sm text-gray-800">: &quot;unknown user&quot; };
      }

      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 96:1 - Line 106:11), server/models/workspaceUsers.js (Line 75:2 - Line 85:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn412" onclick="toggleCodeBlock('cloneGroup412', 'expandBtn412', 'collapseBtn412')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn412" onclick="toggleCodeBlock('cloneGroup412', 'expandBtn412', 'collapseBtn412')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup412"><code class="language-javascript text-sm text-gray-800">
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  count: async function (clause = {}) {
    try {
      const count = await prisma.event_logs</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 106:11 - Line 116:7), server/models/workspaceChats.js (Line 225:16 - Line 235:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn413" onclick="toggleCodeBlock('cloneGroup413', 'expandBtn413', 'collapseBtn413')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn413" onclick="toggleCodeBlock('cloneGroup413', 'expandBtn413', 'collapseBtn413')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup413"><code class="language-javascript text-sm text-gray-800">.count({
        where: clause,
      });
      return count;
    } catch (error) {
      console.error(error.message);
      return 0;
    }
  },

  delete</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/eventLogs.js (Line 108:7 - Line 118:11), server/models/workspaceUsers.js (Line 85:2 - Line 95:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn414" onclick="toggleCodeBlock('cloneGroup414', 'expandBtn414', 'collapseBtn414')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn414" onclick="toggleCodeBlock('cloneGroup414', 'expandBtn414', 'collapseBtn414')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup414"><code class="language-javascript text-sm text-gray-800">});
      return count;
    } catch (error) {
      console.error(error.message);
      return 0;
    }
  },

  delete: async function (clause = {}) {
    try {
      await prisma.event_logs</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedConfig.js (Line 79:8 - Line 90:12), server/models/invite.js (Line 30:2 - Line 74:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn415" onclick="toggleCodeBlock('cloneGroup415', 'expandBtn415', 'collapseBtn415')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn415" onclick="toggleCodeBlock('cloneGroup415', 'expandBtn415', 'collapseBtn415')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup415"><code class="language-javascript text-sm text-gray-800">,
      });
      return { success: true, error: null };
    } catch (error) {
      console.error(error.message);
      return { success: false, error: error.message };
    }
  },

  get: async function (clause = {}) {
    try {
      const embedConfig</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedConfig.js (Line 107:2 - Line 117:7), server/models/embedConfig.js (Line 91:7 - Line 101:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn416" onclick="toggleCodeBlock('cloneGroup416', 'expandBtn416', 'collapseBtn416')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn416" onclick="toggleCodeBlock('cloneGroup416', 'expandBtn416', 'collapseBtn416')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup416"><code class="language-javascript text-sm text-gray-800">,
      });

      return embedConfig || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  delete</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedConfig.js (Line 119:14 - Line 131:14), server/models/workspaceAgentInvocation.js (Line 72:28 - Line 105:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn417" onclick="toggleCodeBlock('cloneGroup417', 'expandBtn417', 'collapseBtn417')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn417" onclick="toggleCodeBlock('cloneGroup417', 'expandBtn417', 'collapseBtn417')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup417"><code class="language-javascript text-sm text-gray-800">.delete({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (clause = {}, limit = null, orderBy = null) {
    try {
      const results = await prisma.embed_configs</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedConfig.js (Line 131:14 - Line 143:19), server/models/workspaceThread.js (Line 105:18 - Line 83:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn418" onclick="toggleCodeBlock('cloneGroup418', 'expandBtn418', 'collapseBtn418')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn418" onclick="toggleCodeBlock('cloneGroup418', 'expandBtn418', 'collapseBtn418')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup418"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  whereWithWorkspace</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedConfig.js (Line 154:2 - Line 167:49), server/models/workspace.js (Line 351:13 - Line 83:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn419" onclick="toggleCodeBlock('cloneGroup419', 'expandBtn419', 'collapseBtn419')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn419" onclick="toggleCodeBlock('cloneGroup419', 'expandBtn419', 'collapseBtn419')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup419"><code class="language-javascript text-sm text-gray-800">},
          },
        },
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  // Will return null if process should be skipped</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 30:2 - Line 46:6), server/models/workspaceChats.js (Line 22:8 - Line 32:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn420" onclick="toggleCodeBlock('cloneGroup420', 'expandBtn420', 'collapseBtn420')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn420" onclick="toggleCodeBlock('cloneGroup420', 'expandBtn420', 'collapseBtn420')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup420"><code class="language-javascript text-sm text-gray-800">,
        },
      });
      return { chat, message: null };
    } catch (error) {
      console.error(error.message);
      return { chat: null, message: error.message };
    }
  },

  /**
   * Loops through each chat and filters out the sources from the response object.
   * We do this when returning /history of an embed to the frontend to prevent inadvertent leaking
   * of private sources the user may not have intended to share with users.
   * @param {EmbedChat[]} chats
   * @returns {EmbedChat[]} Returns a new array of chats with the sources filtered out of responses
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 97:2 - Line 111:12), server/models/workspaceChats.js (Line 143:3 - Line 179:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn421" onclick="toggleCodeBlock('cloneGroup421', 'expandBtn421', 'collapseBtn421')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn421" onclick="toggleCodeBlock('cloneGroup421', 'expandBtn421', 'collapseBtn421')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup421"><code class="language-javascript text-sm text-gray-800">,
        },
        data: {
          include: false,
        },
      });
      return;
    } catch (error) {
      console.error(error.message);
    }
  },

  get: async function (clause = {}, limit = null, orderBy = null) {
    try {
      const chat = await prisma.embed_chats</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 111:12 - Line 125:12), server/models/workspaceChats.js (Line 179:16 - Line 93:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn422" onclick="toggleCodeBlock('cloneGroup422', 'expandBtn422', 'collapseBtn422')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn422" onclick="toggleCodeBlock('cloneGroup422', 'expandBtn422', 'collapseBtn422')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup422"><code class="language-javascript text-sm text-gray-800">.findFirst({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return chat || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  delete: async function (clause = {}) {
    try {
      await prisma.embed_chats</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 125:12 - Line 142:12), server/models/workspaceThread.js (Line 93:18 - Line 210:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn423" onclick="toggleCodeBlock('cloneGroup423', 'expandBtn423', 'collapseBtn423')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn423" onclick="toggleCodeBlock('cloneGroup423', 'expandBtn423', 'collapseBtn423')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup423"><code class="language-javascript text-sm text-gray-800">.deleteMany({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (
    clause = {},
    limit = null,
    orderBy = null,
    offset = null
  ) {
    try {
      const chats = await prisma.embed_chats</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 142:12 - Line 155:27), server/models/workspaceChats.js (Line 210:16 - Line 58:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn424" onclick="toggleCodeBlock('cloneGroup424', 'expandBtn424', 'collapseBtn424')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn424" onclick="toggleCodeBlock('cloneGroup424', 'expandBtn424', 'collapseBtn424')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup424"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(offset !== null ? { skip: offset } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return chats;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  whereWithEmbedAndWorkspace</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/embedChats.js (Line 174:2 - Line 188:12), server/models/workspaceChats.js (Line 211:7 - Line 85:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn425" onclick="toggleCodeBlock('cloneGroup425', 'expandBtn425', 'collapseBtn425')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn425" onclick="toggleCodeBlock('cloneGroup425', 'expandBtn425', 'collapseBtn425')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup425"><code class="language-javascript text-sm text-gray-800">,
        ...(limit !== null ? { take: limit } : {}),
        ...(offset !== null ? { skip: offset } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
      });
      return chats;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  count: async function (clause = {}) {
    try {
      const count = await prisma.embed_chats</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncRun.js (Line 36:6 - Line 47:2), server/models/workspacesSuggestedMessages.js (Line 9:8 - Line 65:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn426" onclick="toggleCodeBlock('cloneGroup426', 'expandBtn426', 'collapseBtn426')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn426" onclick="toggleCodeBlock('cloneGroup426', 'expandBtn426', 'collapseBtn426')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup426"><code class="language-javascript text-sm text-gray-800"> || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  where: async function (
    clause = {},
    limit = null,
    orderBy = null,
    include = {</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 99:7 - Line 110:6), server/models/documentSyncRun.js (Line 35:2 - Line 43:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn427" onclick="toggleCodeBlock('cloneGroup427', 'expandBtn427', 'collapseBtn427')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn427" onclick="toggleCodeBlock('cloneGroup427', 'expandBtn427', 'collapseBtn427')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup427"><code class="language-javascript text-sm text-gray-800">);
      return queue || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  /**
   * Deletes Queue record and updates document watch status to false on Document record
   * @param {import(&quot;@prisma/client&quot;).workspace_documents} document - document record to unwatch, must have `id`
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 137:21 - Line 148:1), server/models/workspaceChats.js (Line 290:16 - Line 300:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn428" onclick="toggleCodeBlock('cloneGroup428', 'expandBtn428', 'collapseBtn428')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn428" onclick="toggleCodeBlock('cloneGroup428', 'expandBtn428', 'collapseBtn428')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup428"><code class="language-javascript text-sm text-gray-800">.update({
        where: { id },
        data,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 140:7 - Line 150:6), server/models/documents.js (Line 41:2 - Line 51:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn429" onclick="toggleCodeBlock('cloneGroup429', 'expandBtn429', 'collapseBtn429')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn429" onclick="toggleCodeBlock('cloneGroup429', 'expandBtn429', 'collapseBtn429')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup429"><code class="language-javascript text-sm text-gray-800">});
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  get: async function (clause = {}) {
    try {
      const queue</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 150:21 - Line 167:21), server/models/documentSyncRun.js (Line 33:25 - Line 50:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn430" onclick="toggleCodeBlock('cloneGroup430', 'expandBtn430', 'collapseBtn430')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn430" onclick="toggleCodeBlock('cloneGroup430', 'expandBtn430', 'collapseBtn430')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup430"><code class="language-javascript text-sm text-gray-800">.findFirst({
        where: clause,
      });
      return queue || null;
    } catch (error) {
      console.error(error.message);
      return null;
    }
  },

  where: async function (
    clause = {},
    limit = null,
    orderBy = null,
    include = {}
  ) {
    try {
      const results = await prisma.document_sync_queues</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 167:21 - Line 180:2), server/models/workspaceThread.js (Line 105:18 - Line 63:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn431" onclick="toggleCodeBlock('cloneGroup431', 'expandBtn431', 'collapseBtn431')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn431" onclick="toggleCodeBlock('cloneGroup431', 'expandBtn431', 'collapseBtn431')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup431"><code class="language-javascript text-sm text-gray-800">.findMany({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
        ...(orderBy !== null ? { orderBy } : {}),
        ...(include !== null ? { include } : {}),
      });
      return results;
    } catch (error) {
      console.error(error.message);
      return [];
    }
  },

  count: async function (clause = {}, limit = null)</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 182:21 - Line 195:21), server/models/documents.js (Line 187:20 - Line 79:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn432" onclick="toggleCodeBlock('cloneGroup432', 'expandBtn432', 'collapseBtn432')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn432" onclick="toggleCodeBlock('cloneGroup432', 'expandBtn432', 'collapseBtn432')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup432"><code class="language-javascript text-sm text-gray-800">.count({
        where: clause,
        ...(limit !== null ? { take: limit } : {}),
      });
      return count;
    } catch (error) {
      console.error(&quot;FAILED TO COUNT DOCUMENTS.&quot;, error.message);
      return 0;
    }
  },

  delete: async function (clause = {}) {
    try {
      await prisma.document_sync_queues</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/documentSyncQueue.js (Line 195:21 - Line 210:6), server/models/user.js (Line 251:6 - Line 259:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn433" onclick="toggleCodeBlock('cloneGroup433', 'expandBtn433', 'collapseBtn433')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn433" onclick="toggleCodeBlock('cloneGroup433', 'expandBtn433', 'collapseBtn433')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup433"><code class="language-javascript text-sm text-gray-800">.deleteMany({ where: clause });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  /**
   * Gets the &quot;stale&quot; queues where the queue's nextSyncAt is less than the current time
   * @returns {Promise&lt;(
   *  import(&quot;@prisma/client&quot;).document_sync_queues &amp;
   * { workspaceDoc: import(&quot;@prisma/client&quot;).workspace_documents &amp;
   *  { workspace: import(&quot;@prisma/client&quot;).workspaces }
   * })[]}&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/cacheData.js (Line 32:11 - Line 44:7), server/models/workspaceThread.js (Line 93:18 - Line 105:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn434" onclick="toggleCodeBlock('cloneGroup434', 'expandBtn434', 'collapseBtn434')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn434" onclick="toggleCodeBlock('cloneGroup434', 'expandBtn434', 'collapseBtn434')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup434"><code class="language-javascript text-sm text-gray-800">.deleteMany({
        where: clause,
      });
      return true;
    } catch (error) {
      console.error(error.message);
      return false;
    }
  },

  where: async function (clause = {}, limit = null, orderBy = null) {
    try {
      const caches</code></pre></div><div class="py-4"><p class="text-gray-600">server/models/cacheData.js (Line 58:11 - Line 69:10), server/models/workspaceChats.js (Line 225:16 - Line 199:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn435" onclick="toggleCodeBlock('cloneGroup435', 'expandBtn435', 'collapseBtn435')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn435" onclick="toggleCodeBlock('cloneGroup435', 'expandBtn435', 'collapseBtn435')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup435"><code class="language-javascript text-sm text-gray-800">.count({
        where: clause,
      });
      return count;
    } catch (error) {
      console.error(error.message);
      return 0;
    }
  },
};

module.exports = { CacheData</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 56:9 - Line 66:27), server/endpoints/api/workspaceThread/index.js (Line 102:2 - Line 242:47)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn436" onclick="toggleCodeBlock('cloneGroup436', 'expandBtn436', 'collapseBtn436')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn436" onclick="toggleCodeBlock('cloneGroup436', 'expandBtn436', 'collapseBtn436')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup436"><code class="language-javascript text-sm text-gray-800">);
        response.status(200).json({ thread, message });
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.get(
    &quot;/workspace/:slug/threads&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 94:2 - Line 104:38), server/endpoints/api/workspaceThread/index.js (Line 232:9 - Line 193:41)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn437" onclick="toggleCodeBlock('cloneGroup437', 'expandBtn437', 'collapseBtn437')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn437" onclick="toggleCodeBlock('cloneGroup437', 'expandBtn437', 'collapseBtn437')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup437"><code class="language-javascript text-sm text-gray-800">});
        response.sendStatus(200).end();
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/workspace/:slug/thread-bulk-delete&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 115:5 - Line 127:44), server/endpoints/api/workspaceThread/index.js (Line 230:11 - Line 242:47)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn438" onclick="toggleCodeBlock('cloneGroup438', 'expandBtn438', 'collapseBtn438')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn438" onclick="toggleCodeBlock('cloneGroup438', 'expandBtn438', 'collapseBtn438')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup438"><code class="language-javascript text-sm text-gray-800">,
          workspace_id: workspace.id,
        });
        response.sendStatus(200).end();
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.get(
    &quot;/workspace/:slug/thread/:threadSlug/chats&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 141:5 - Line 159:45), server/endpoints/api/workspaceThread/index.js (Line 304:3 - Line 112:48)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn439" onclick="toggleCodeBlock('cloneGroup439', 'expandBtn439', 'collapseBtn439')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn439" onclick="toggleCodeBlock('cloneGroup439', 'expandBtn439', 'collapseBtn439')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup439"><code class="language-javascript text-sm text-gray-800">,
            thread_id: thread.id,
            api_session_id: null, // Do not include API session chats.
            include: true,
          },
          null,
          { id: &quot;asc&quot; }
        );

        response.status(200).json({ history: convertToChatHistory(history) });
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/workspace/:slug/thread/:threadSlug/update&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 171:5 - Line 182:58), server/endpoints/workspaceThreads.js (Line 55:3 - Line 193:41)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn440" onclick="toggleCodeBlock('cloneGroup440', 'expandBtn440', 'collapseBtn440')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn440" onclick="toggleCodeBlock('cloneGroup440', 'expandBtn440', 'collapseBtn440')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup440"><code class="language-javascript text-sm text-gray-800">
        );
        response.status(200).json({ thread, message });
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/workspace/:slug/thread/:threadSlug/delete-edited-chats&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 201:1 - Line 211:50), server/endpoints/api/workspaceThread/index.js (Line 232:2 - Line 112:48)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn441" onclick="toggleCodeBlock('cloneGroup441', 'expandBtn441', 'collapseBtn441')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn441" onclick="toggleCodeBlock('cloneGroup441', 'expandBtn441', 'collapseBtn441')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup441"><code class="language-javascript text-sm text-gray-800">
        response.sendStatus(200).end();
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/workspace/:slug/thread/:threadSlug/update-chat&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/workspaceThreads.js (Line 241:2 - Line 253:25), server/endpoints/workspaceThreads.js (Line 199:2 - Line 124:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn442" onclick="toggleCodeBlock('cloneGroup442', 'expandBtn442', 'collapseBtn442')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn442" onclick="toggleCodeBlock('cloneGroup442', 'expandBtn442', 'collapseBtn442')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup442"><code class="language-javascript text-sm text-gray-800">,
        });

        response.sendStatus(200).end();
      } catch (e) {
        console.error(e.message, e);
        response.sendStatus(500).end();
      }
    }
  );
}

module.exports = { workspaceThreadEndpoints</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/mcpServers.js (Line 69:29 - Line 79:22), server/endpoints/mcpServers.js (Line 46:29 - Line 56:22)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn443" onclick="toggleCodeBlock('cloneGroup443', 'expandBtn443', 'collapseBtn443')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn443" onclick="toggleCodeBlock('cloneGroup443', 'expandBtn443', 'collapseBtn443')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup443"><code class="language-javascript text-sm text-gray-800">, error);
        return response.status(500).json({
          success: false,
          error: error.message,
        });
      }
    }
  );

  app.post(
    &quot;/mcp-servers/delete&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/embedManagement.js (Line 84:9 - Line 94:15), server/endpoints/api/admin/index.js (Line 261:2 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn444" onclick="toggleCodeBlock('cloneGroup444', 'expandBtn444', 'collapseBtn444')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn444" onclick="toggleCodeBlock('cloneGroup444', 'expandBtn444', 'collapseBtn444')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup444"><code class="language-javascript text-sm text-gray-800">);
        response.status(200).json({ success: true, error: null });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/embed/chats&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/embedManagement.js (Line 121:2 - Line 131:25), server/endpoints/api/admin/index.js (Line 261:9 - Line 775:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn445" onclick="toggleCodeBlock('cloneGroup445', 'expandBtn445', 'collapseBtn445')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn445" onclick="toggleCodeBlock('cloneGroup445', 'expandBtn445', 'collapseBtn445')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup445"><code class="language-javascript text-sm text-gray-800">});
        response.status(200).json({ success: true, error: null });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );
}

module.exports = { embedManagementEndpoints</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/communityHub.js (Line 116:1 - Line 129:6), server/endpoints/communityHub.js (Line 40:2 - Line 33:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn446" onclick="toggleCodeBlock('cloneGroup446', 'expandBtn446', 'collapseBtn446')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn446" onclick="toggleCodeBlock('cloneGroup446', 'expandBtn446', 'collapseBtn446')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup446"><code class="language-javascript text-sm text-gray-800">
        response.status(200).json({ success: true, error: null });
      } catch (error) {
        console.error(error);
        response.status(500).json({ success: false, error: error.message });
      }
    }
  );

  /**
   * Import a bundle item to the AnythingLLM instance by downloading the zip file and importing it.
   * or whatever the item type requires. This is not used if the item is a simple text responses like
   * slash commands or system prompts.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/communityHub.js (Line 144:12 - Line 163:1), server/endpoints/communityHub.js (Line 102:11 - Line 44:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn447" onclick="toggleCodeBlock('cloneGroup447', 'expandBtn447', 'collapseBtn447')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn447" onclick="toggleCodeBlock('cloneGroup447', 'expandBtn447', 'collapseBtn447')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup447"><code class="language-javascript text-sm text-gray-800">);

        await Telemetry.sendTelemetry(&quot;community_hub_import&quot;, {
          itemType: response.locals.bundleItem.itemType,
          visibility: response.locals.bundleItem.visibility,
        });
        await EventLogs.logEvent(
          &quot;community_hub_import&quot;,
          {
            itemId: response.locals.bundleItem.id,
            itemType: response.locals.bundleItem.itemType,
          },
          response.locals?.user?.id
        );

        response.status(200).json({ success: true, error: null });
      } catch (error) {
        console.error(error);
        response.status(500).json({
</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/chat.js (Line 92:2 - Line 106:1), server/endpoints/api/workspaceThread/index.js (Line 621:2 - Line 634:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn448" onclick="toggleCodeBlock('cloneGroup448', 'expandBtn448', 'collapseBtn448')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn448" onclick="toggleCodeBlock('cloneGroup448', 'expandBtn448', 'collapseBtn448')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup448"><code class="language-javascript text-sm text-gray-800">e);
        writeResponseChunk(response, {
          id: uuidv4(),
          type: &quot;abort&quot;,
          textResponse: null,
          sources: [],
          close: true,
          error: e.message,
        });
        response.end();
      }
    }
  );

</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/chat.js (Line 118:7 - Line 156:7), server/endpoints/chat.js (Line 31:10 - Line 69:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn449" onclick="toggleCodeBlock('cloneGroup449', 'expandBtn449', 'collapseBtn449')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn449" onclick="toggleCodeBlock('cloneGroup449', 'expandBtn449', 'collapseBtn449')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup449"><code class="language-javascript text-sm text-gray-800">;

        if (!message?.length) {
          response.status(400).json({
            id: uuidv4(),
            type: &quot;abort&quot;,
            textResponse: null,
            sources: [],
            close: true,
            error: !message?.length ? &quot;Message is empty.&quot; : null,
          });
          return;
        }

        response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);
        response.setHeader(&quot;Content-Type&quot;, &quot;text/event-stream&quot;);
        response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);
        response.setHeader(&quot;Connection&quot;, &quot;keep-alive&quot;);
        response.flushHeaders();

        if (multiUserMode(response) &amp;&amp; !(await User.canSendChat(user))) {
          writeResponseChunk(response, {
            id: uuidv4(),
            type: &quot;abort&quot;,
            textResponse: null,
            sources: [],
            close: true,
            error: `You have met your maximum 24 hour chat quota of ${user.dailyMessageLimit} chats. Try again later.`,
          });
          return;
        }

        await streamChatWithWorkspace(
          response,
          workspace,
          message,
          workspace?.chatMode,
          user,
          thread</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/chat.js (Line 176:1 - Line 190:2), server/endpoints/chat.js (Line 71:2 - Line 85:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn450" onclick="toggleCodeBlock('cloneGroup450', 'expandBtn450', 'collapseBtn450')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn450" onclick="toggleCodeBlock('cloneGroup450', 'expandBtn450', 'collapseBtn450')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup450"><code class="language-javascript text-sm text-gray-800">
        await Telemetry.sendTelemetry(&quot;sent_chat&quot;, {
          multiUserMode: multiUserMode(response),
          LLMSelection: process.env.LLM_PROVIDER || &quot;openai&quot;,
          Embedder: process.env.EMBEDDING_ENGINE || &quot;inherit&quot;,
          VectorDbSelection: process.env.VECTOR_DB || &quot;lancedb&quot;,
          multiModal: Array.isArray(attachments) &amp;&amp; attachments?.length !== 0,
          TTSSelection: process.env.TTS_PROVIDER || &quot;native&quot;,
          LLMModel: getModelTag(),
        });

        await EventLogs.logEvent(
          &quot;sent_chat&quot;,
          {
            workspaceName: workspace.</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/chat.js (Line 191:7 - Line 213:14), server/endpoints/chat.js (Line 85:2 - Line 636:28)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn451" onclick="toggleCodeBlock('cloneGroup451', 'expandBtn451', 'collapseBtn451')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn451" onclick="toggleCodeBlock('cloneGroup451', 'expandBtn451', 'collapseBtn451')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup451"><code class="language-javascript text-sm text-gray-800">.name,
            chatModel: workspace?.chatModel || &quot;System Default&quot;,
          },
          user?.id
        );
        response.end();
      } catch (e) {
        console.error(e);
        writeResponseChunk(response, {
          id: uuidv4(),
          type: &quot;abort&quot;,
          textResponse: null,
          sources: [],
          close: true,
          error: e.message,
        });
        response.end();
      }
    }
  );
}

module.exports = { chatEndpoints</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/browserExtension.js (Line 135:7 - Line 145:6), server/endpoints/browserExtension.js (Line 98:10 - Line 108:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn452" onclick="toggleCodeBlock('cloneGroup452', 'expandBtn452', 'collapseBtn452')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn452" onclick="toggleCodeBlock('cloneGroup452', 'expandBtn452', 'collapseBtn452')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup452"><code class="language-javascript text-sm text-gray-800"> } = await Collector.processRawText(
          textContent,
          metadata
        );

        if (!success) {
          response.status(500).json({ success: false, error: reason });
          return;
        }

        await</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 37:2 - Line 47:19), server/endpoints/api/admin/index.js (Line 471:1 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn453" onclick="toggleCodeBlock('cloneGroup453', 'expandBtn453', 'collapseBtn453')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn453" onclick="toggleCodeBlock('cloneGroup453', 'expandBtn453', 'collapseBtn453')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup453"><code class="language-javascript text-sm text-gray-800">
        response.status(200).json({ users });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/admin/users/new&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 114:8 - Line 124:18), server/endpoints/api/admin/index.js (Line 416:3 - Line 74:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn454" onclick="toggleCodeBlock('cloneGroup454', 'expandBtn454', 'collapseBtn454')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn454" onclick="toggleCodeBlock('cloneGroup454', 'expandBtn454', 'collapseBtn454')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup454"><code class="language-javascript text-sm text-gray-800">);
        response.status(200).json({ success, error });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/admin/user/:id&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 145:9 - Line 156:17), server/endpoints/embedManagement.js (Line 83:2 - Line 426:42)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn455" onclick="toggleCodeBlock('cloneGroup455', 'expandBtn455', 'collapseBtn455')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn455" onclick="toggleCodeBlock('cloneGroup455', 'expandBtn455', 'collapseBtn455')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup455"><code class="language-javascript text-sm text-gray-800">.id
        );
        response.status(200).json({ success: true, error: null });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.get(
    &quot;/admin/invites&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 207:3 - Line 218:20), server/endpoints/api/admin/index.js (Line 537:8 - Line 426:42)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn456" onclick="toggleCodeBlock('cloneGroup456', 'expandBtn456', 'collapseBtn456')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn456" onclick="toggleCodeBlock('cloneGroup456', 'expandBtn456', 'collapseBtn456')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup456"><code class="language-javascript text-sm text-gray-800">
        );
        response.status(200).json({ success, error });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.get(
    &quot;/admin/workspaces&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 237:12 - Line 247:24), server/endpoints/admin.js (Line 37:2 - Line 481:49)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn457" onclick="toggleCodeBlock('cloneGroup457', 'expandBtn457', 'collapseBtn457')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn457" onclick="toggleCodeBlock('cloneGroup457', 'expandBtn457', 'collapseBtn457')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup457"><code class="language-javascript text-sm text-gray-800">);
        response.status(200).json({ users });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.post(
    &quot;/admin/workspaces/new&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 269:2 - Line 285:24), server/endpoints/api/admin/index.js (Line 532:1 - Line 74:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn458" onclick="toggleCodeBlock('cloneGroup458', 'expandBtn458', 'collapseBtn458')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn458" onclick="toggleCodeBlock('cloneGroup458', 'expandBtn458', 'collapseBtn458')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup458"><code class="language-javascript text-sm text-gray-800">
        const { workspaceId } = request.params;
        const { userIds } = reqBody(request);
        const { success, error } = await Workspace.updateUsers(
          workspaceId,
          userIds
        );
        response.status(200).json({ success, error });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/admin/workspaces/:id&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 478:2 - Line 490:18), server/endpoints/api/admin/index.js (Line 763:1 - Line 426:42)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn459" onclick="toggleCodeBlock('cloneGroup459', 'expandBtn459', 'collapseBtn459')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn459" onclick="toggleCodeBlock('cloneGroup459', 'expandBtn459', 'collapseBtn459')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup459"><code class="language-javascript text-sm text-gray-800">
        const updates = reqBody(request);
        await SystemSettings.updateSettings(updates);
        response.status(200).json({ success: true, error: null });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.get(
    &quot;/admin/api-keys&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">server/endpoints/admin.js (Line 523:6 - Line 533:28), server/endpoints/api/admin/index.js (Line 653:2 - Line 74:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn460" onclick="toggleCodeBlock('cloneGroup460', 'expandBtn460', 'collapseBtn460')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn460" onclick="toggleCodeBlock('cloneGroup460', 'expandBtn460', 'collapseBtn460')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup460"><code class="language-javascript text-sm text-gray-800">,
        });
      } catch (e) {
        console.error(e);
        response.sendStatus(500).end();
      }
    }
  );

  app.delete(
    &quot;/admin/delete-api-key/:id&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 67:9 - Line 121:9), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 68:9 - Line 135:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn486" onclick="toggleCodeBlock('cloneGroup486', 'expandBtn486', 'collapseBtn486')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn486" onclick="toggleCodeBlock('cloneGroup486', 'expandBtn486', 'collapseBtn486')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup486"><code class="language-javascript text-sm text-gray-800">={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.github.URL&quot;)}
                  &lt;/label&gt;
                  &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
                    {t(&quot;connectors.github.URL_explained&quot;)}
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;input
                  type=&quot;url&quot;
                  name=&quot;repo&quot;
                  className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;https://github.com/Mintplex-Labs/anything-llm&quot;
                  required={true}
                  autoComplete=&quot;off&quot;
                  onChange={(e) =&gt; setRepo(e.target.value)}
                  onBlur={() =&gt; setSettings({ ...settings, repo })}
                  spellCheck={false}
                /&gt;
              &lt;/div&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white font-bold text-sm flex gap-x-2 items-center&quot;&gt;
                    &lt;p className=&quot;font-bold text-white&quot;&gt;
                      {t(&quot;connectors.github.token&quot;)}
                    &lt;/p&gt;{&quot; &quot;}
                    &lt;p className=&quot;text-xs font-light flex items-center&quot;&gt;
                      &lt;span className=&quot;text-theme-text-secondary&quot;&gt;
                        {t(&quot;connectors.github.optional&quot;)}
                      &lt;/span&gt;
                      &lt;PATTooltip accessToken={accessToken} /&gt;
                    &lt;/p&gt;
                  &lt;/label&gt;
                  &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
                    {t(&quot;connectors.github.token_explained&quot;)}
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;input
                  type=&quot;text&quot;
                  name=&quot;accessToken&quot;
                  className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;github_pat_1234_abcdefg&quot;
                  required={false}
                  autoComplete=&quot;off&quot;
                  spellCheck={false}
                  onChange={(e) =&gt; setAccessToken(e.target.value)}
                  onBlur={() =&gt; setSettings({ ...settings, accessToken })}
                /&gt;
              &lt;/div&gt;
              &lt;GitHubBranchSelection
                repo={settings</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 117:2 - Line 253:38), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 149:5 - Line 294:38)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn487" onclick="toggleCodeBlock('cloneGroup487', 'expandBtn487', 'collapseBtn487')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn487" onclick="toggleCodeBlock('cloneGroup487', 'expandBtn487', 'collapseBtn487')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup487"><code class="language-javascript text-sm text-gray-800">}
                /&gt;
              &lt;/div&gt;
              &lt;GitHubBranchSelection
                repo={settings.repo}
                accessToken={settings.accessToken}
              /&gt;
            &lt;/div&gt;

            &lt;div className=&quot;flex flex-col w-full py-4 pr-10&quot;&gt;
              &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                &lt;label className=&quot;text-white text-sm flex gap-x-2 items-center&quot;&gt;
                  &lt;p className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.github.ignores&quot;)}
                  &lt;/p&gt;
                &lt;/label&gt;
                &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
                  {t(&quot;connectors.github.git_ignore&quot;)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;TagsInput
                value={ignores}
                onChange={setIgnores}
                name=&quot;ignores&quot;
                placeholder=&quot;!*.js, images/*, .DS_Store, bin/*&quot;
                classNames={{
                  tag: &quot;bg-theme-settings-input-bg light:bg-black/10 bg-blue-300/10 text-zinc-800&quot;,
                  input:
                    &quot;flex p-1 !bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none&quot;,
                }}
              /&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div className=&quot;flex flex-col gap-y-2 w-full pr-10&quot;&gt;
            &lt;PATAlert accessToken={accessToken} /&gt;
            &lt;button
              type=&quot;submit&quot;
              disabled={loading}
              className=&quot;mt-2 w-full justify-center border-none px-4 py-2 rounded-lg text-dark-text light:text-white text-sm font-bold items-center flex gap-x-2 bg-theme-home-button-primary hover:bg-theme-home-button-primary-hover disabled:bg-theme-home-button-primary-hover disabled:cursor-not-allowed&quot;
            &gt;
              {loading ? &quot;Collecting files...&quot; : &quot;Submit&quot;}
            &lt;/button&gt;
            {loading &amp;&amp; (
              &lt;p className=&quot;text-xs text-white/50&quot;&gt;
                {t(&quot;connectors.github.task_explained&quot;)}
              &lt;/p&gt;
            )}
          &lt;/div&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function GitHubBranchSelection({ repo, accessToken }) {
  const { t } = useTranslation();
  const [allBranches, setAllBranches] = useState(DEFAULT_BRANCHES);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function fetchAllBranches() {
      if (!repo) {
        setAllBranches(DEFAULT_BRANCHES);
        setLoading(false);
        return;
      }

      setLoading(true);
      const { branches } = await System.dataConnectors.github.branches({
        repo,
        accessToken,
      });
      setAllBranches(branches.length &gt; 0 ? branches : DEFAULT_BRANCHES);
      setLoading(false);
    }
    fetchAllBranches();
  }, [repo, accessToken]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;Branch&lt;/label&gt;
          &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
            {t(&quot;connectors.github.branch&quot;)}
          &lt;/p&gt;
        &lt;/div&gt;
        &lt;select
          name=&quot;branch&quot;
          required={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white focus:outline-primary-button active:outline-primary-button outline-none text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {t(&quot;connectors.github.branch_loading&quot;)}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;Branch&lt;/label&gt;
        &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
          {t(&quot;connectors.github.branch_explained&quot;)}
        &lt;/p&gt;
      &lt;/div&gt;
      &lt;select
        name=&quot;branch&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white focus:outline-primary-button active:outline-primary-button outline-none text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {allBranches.map((branch) =&gt; {
          return (
            &lt;option key={branch} value={branch}&gt;
              {branch}
            &lt;/option&gt;
          );
        })}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}

function PATAlert({ accessToken }) {
  const { t } = useTranslation();
  if (!!accessToken) return null;
  return (
    &lt;div className=&quot;flex flex-col md:flex-row md:items-center gap-x-2 text-white mb-4 bg-blue-800/30 w-fit rounded-lg px-4 py-2&quot;&gt;
      &lt;div className=&quot;gap-x-2 flex items-center&quot;&gt;
        &lt;Info className=&quot;shrink-0&quot; size={25} /&gt;
        &lt;p className=&quot;text-sm&quot;&gt;
          &lt;span
            dangerouslySetInnerHTML={{
              __html: t(&quot;connectors.github.token_information&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 253:38 - Line 310:2), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 294:38 - Line 350:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn488" onclick="toggleCodeBlock('cloneGroup488', 'expandBtn488', 'collapseBtn488')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn488" onclick="toggleCodeBlock('cloneGroup488', 'expandBtn488', 'collapseBtn488')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup488"><code class="language-javascript text-sm text-gray-800">),
            }}
          /&gt;
          &lt;br /&gt;
          &lt;br /&gt;
          &lt;a
            href=&quot;https://github.com/settings/personal-access-tokens/new&quot;
            rel=&quot;noreferrer&quot;
            target=&quot;_blank&quot;
            className=&quot;underline&quot;
            onClick={(e) =&gt; e.stopPropagation()}
          &gt;
            {&quot; &quot;}
            {t(&quot;connectors.github.token_personal&quot;)}
          &lt;/a&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function PATTooltip({ accessToken }) {
  const { t } = useTranslation();
  if (!!accessToken) return null;
  return (
    &lt;&gt;
      {!accessToken &amp;&amp; (
        &lt;Warning
          size={14}
          className=&quot;ml-1 text-orange-500 cursor-pointer&quot;
          data-tooltip-id=&quot;access-token-tooltip&quot;
          data-tooltip-place=&quot;right&quot;
        /&gt;
      )}
      &lt;Tooltip
        delayHide={300}
        id=&quot;access-token-tooltip&quot;
        className=&quot;max-w-xs z-99&quot;
        clickable={true}
      &gt;
        &lt;p className=&quot;text-sm&quot;&gt;
          {t(&quot;connectors.github.token_explained_start&quot;)}
          &lt;a
            href=&quot;https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens&quot;
            rel=&quot;noreferrer&quot;
            target=&quot;_blank&quot;
            className=&quot;underline&quot;
            onClick={(e) =&gt; e.stopPropagation()}
          &gt;
            {t(&quot;connectors.github.token_explained_link1&quot;)}
          &lt;/a&gt;
          {t(&quot;connectors.github.token_explained_middle&quot;)}
          &lt;a
            href=&quot;https://github.com/settings/personal-access-tokens/new&quot;
            rel=&quot;noreferrer&quot;
            target=&quot;_blank&quot;
            className=&quot;underline&quot;
            onClick={(e) =&gt; e.stopPropagation()}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/AgentLLMItem/index.jsx (Line 52:8 - Line 82:20), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 52:8 - Line 80:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn512" onclick="toggleCodeBlock('cloneGroup512', 'expandBtn512', 'collapseBtn512')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn512" onclick="toggleCodeBlock('cloneGroup512', 'expandBtn512', 'collapseBtn512')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup512"><code class="language-javascript text-sm text-gray-800">={handleProviderSelection}
        className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
          checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
        }`}
      &gt;
        &lt;input
          type=&quot;checkbox&quot;
          value={value}
          className=&quot;peer hidden&quot;
          checked={checked}
          readOnly={true}
          formNoValidate={true}
        /&gt;
        &lt;div className=&quot;flex gap-x-4 items-center justify-between&quot;&gt;
          &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
            &lt;img
              src={logo}
              alt={`${name} logo`}
              className=&quot;w-10 h-10 rounded-md&quot;
            /&gt;
            &lt;div className=&quot;flex flex-col&quot;&gt;
              &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;{name}&lt;/div&gt;
              &lt;div className=&quot;mt-1 text-xs text-white/60&quot;&gt;{description}&lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          {checked &amp;&amp;
            value !== &quot;none&quot; &amp;&amp;
            !NO_SETTINGS_NEEDED.includes(value) &amp;&amp; (
              &lt;button
                onClick={(e) =&gt; {
                  e</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 182:2 - Line 270:2), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 125:14 - Line 175:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn545" onclick="toggleCodeBlock('cloneGroup545', 'expandBtn545', 'collapseBtn545')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn545" onclick="toggleCodeBlock('cloneGroup545', 'expandBtn545', 'collapseBtn545')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup545"><code class="language-javascript text-sm text-gray-800">}
              /&gt;
            &lt;/ComposedChart&gt;
          &lt;/div&gt;
        );
      case &quot;scatter&quot;:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[value]}
                  colors={[color || &quot;blue&quot;, color || &quot;blue&quot;]}
                  className=&quot;mb-5&quot;
                /&gt;
              &lt;/div&gt;
            )}
            &lt;ScatterChart width={500} height={260} data={data}&gt;
              &lt;CartesianGrid
                strokeDasharray=&quot;3 3&quot;
                horizontal
                vertical={false}
              /&gt;
              &lt;XAxis
                dataKey=&quot;name&quot;
                tickLine={false}
                axisLine={false}
                interval=&quot;preserveStartEnd&quot;
                tick={{ transform: &quot;translate(0, 6)&quot;, fill: &quot;white&quot; }}
                style={{
                  fontSize: &quot;12px&quot;,
                  fontFamily: &quot;Inter; Helvetica&quot;,
                }}
                padding={{ left: 10, right: 10 }}
              /&gt;
              &lt;YAxis
                tickLine={false}
                axisLine={false}
                type=&quot;number&quot;
                tick={{ transform: &quot;translate(-3, 0)&quot;, fill: &quot;white&quot; }}
                style={{
                  fontSize: &quot;12px&quot;,
                  fontFamily: &quot;Inter; Helvetica&quot;,
                }}
              /&gt;
              &lt;Tooltip legendColor={getTremorColor(color || &quot;blue&quot;)} /&gt;
              &lt;Scatter dataKey={value} fill={getTremorColor(color || &quot;blue&quot;)} /&gt;
            &lt;/ScatterChart&gt;
          &lt;/div&gt;
        );
      case &quot;pie&quot;:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            &lt;DonutChart
              data={data}
              category={value}
              index=&quot;name&quot;
              colors={[
                color || &quot;cyan&quot;,
                &quot;violet&quot;,
                &quot;rose&quot;,
                &quot;amber&quot;,
                &quot;emerald&quot;,
                &quot;teal&quot;,
                &quot;fuchsia&quot;,
              ]}
              // No actual legend for pie chart, but this will toggle the central text
              showLabel={showLegend}
              valueFormatter={dataFormatter}
              customTooltip={customTooltip}
            /&gt;
          &lt;/div&gt;
        );
      case &quot;radar&quot;:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentModelSelection/index.jsx (Line 81:9 - Line 120:12), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/ChatModelSelection/index.jsx (Line 29:9 - Line 67:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn552" onclick="toggleCodeBlock('cloneGroup552', 'expandBtn552', 'collapseBtn552')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn552" onclick="toggleCodeBlock('cloneGroup552', 'expandBtn552', 'collapseBtn552')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup552"><code class="language-javascript text-sm text-gray-800">={true}
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {t(&quot;agent.mode.wait&quot;)}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div&gt;
      &lt;div className=&quot;flex flex-col&quot;&gt;
        &lt;label htmlFor=&quot;name&quot; className=&quot;block input-label&quot;&gt;
          {t(&quot;agent.mode.title&quot;)}
        &lt;/label&gt;
        &lt;p className=&quot;text-white text-opacity-60 text-xs font-medium py-1.5&quot;&gt;
          {t(&quot;agent.mode.description&quot;)}
        &lt;/p&gt;
      &lt;/div&gt;

      &lt;select
        name=&quot;agentModel&quot;
        required={true}
        onChange={() =&gt; {
          setHasChanges(true);
        }}
        className=&quot;border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
      &gt;
        {defaultModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;General models&quot;&gt;
            {defaultModels.map((model) =&gt; {
              if (!supportedModel(provider, model)) return null;
              return (
                &lt;option
                  key={model}
                  value={model}
                  selected={workspace?.agentModel </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/index.jsx (Line 138:3 - Line 207:2), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 105:2 - Line 164:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn557" onclick="toggleCodeBlock('cloneGroup557', 'expandBtn557', 'collapseBtn557')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn557" onclick="toggleCodeBlock('cloneGroup557', 'expandBtn557', 'collapseBtn557')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup557"><code class="language-javascript text-sm text-gray-800">}
                  weight=&quot;bold&quot;
                  className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                /&gt;
                &lt;input
                  type=&quot;text&quot;
                  name=&quot;llm-search&quot;
                  autoComplete=&quot;off&quot;
                  placeholder=&quot;Search available LLM providers&quot;
                  className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                  onChange={(e) =&gt; setSearchQuery(e.target.value)}
                  ref={searchInputRef}
                  onKeyDown={(e) =&gt; {
                    if (e.key === &quot;Enter&quot;) e.preventDefault();
                  }}
                /&gt;
                &lt;X
                  size={20}
                  weight=&quot;bold&quot;
                  className=&quot;cursor-pointer text-theme-text-primary hover:text-x-button&quot;
                  onClick={handleXButton}
                /&gt;
              &lt;/div&gt;
              &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                {filteredLLMs.map((llm) =&gt; {
                  return (
                    &lt;AgentLLMItem
                      llm={llm}
                      key={llm.name}
                      availableLLMs={LLMS}
                      settings={settings}
                      checked={selectedLLM === llm.value}
                      onClick={() =&gt; updateLLMChoice(llm.value)}
                    /&gt;
                  );
                })}
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        ) : (
          &lt;button
            className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
            type=&quot;button&quot;
            onClick={() =&gt; setSearchMenuOpen(true)}
          &gt;
            &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
              &lt;img
                src={selectedLLMObject.logo}
                alt={`${selectedLLMObject.name} logo`}
                className=&quot;w-10 h-10 rounded-md&quot;
              /&gt;
              &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                  {selectedLLMObject.name}
                &lt;/div&gt;
                &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;
                  {selectedLLMObject.description}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;CaretUpDown size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        )}
      &lt;/div&gt;
      {selectedLLM !== &quot;none&quot; &amp;&amp; (
        &lt;div className=&quot;mt-4 flex flex-col gap-y-1&quot;&gt;
          &lt;AgentModelSelection
            provider={selectedLLM}
            workspace={workspace}
            setHasChanges={setHasChanges}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 78:9 - Line 339:8), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 71:9 - Line 160:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn564" onclick="toggleCodeBlock('cloneGroup564', 'expandBtn564', 'collapseBtn564')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn564" onclick="toggleCodeBlock('cloneGroup564', 'expandBtn564', 'collapseBtn564')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup564"><code class="language-javascript text-sm text-gray-800">={settings} /&gt;,
    description: &quot;The enterprise option of OpenAI hosted on Azure services.&quot;,
  },
  {
    name: &quot;Anthropic&quot;,
    value: &quot;anthropic&quot;,
    logo: AnthropicLogo,
    options: (settings) =&gt; &lt;AnthropicAiOptions settings={settings} /&gt;,
    description: &quot;A friendly AI Assistant hosted by Anthropic.&quot;,
  },
  {
    name: &quot;Gemini&quot;,
    value: &quot;gemini&quot;,
    logo: GeminiLogo,
    options: (settings) =&gt; &lt;GeminiLLMOptions settings={settings} /&gt;,
    description: &quot;Google's largest and most capable AI model&quot;,
  },
  {
    name: &quot;NVIDIA NIM&quot;,
    value: &quot;nvidia-nim&quot;,
    logo: NvidiaNimLogo,
    options: (settings) =&gt; &lt;NvidiaNimOptions settings={settings} /&gt;,
    description:
      &quot;Run full parameter LLMs directly on your NVIDIA RTX GPU using NVIDIA NIM.&quot;,
  },
  {
    name: &quot;HuggingFace&quot;,
    value: &quot;huggingface&quot;,
    logo: HuggingFaceLogo,
    options: (settings) =&gt; &lt;HuggingFaceOptions settings={settings} /&gt;,
    description:
      &quot;Access 150,000+ open-source LLMs and the world's AI community&quot;,
  },
  {
    name: &quot;Ollama&quot;,
    value: &quot;ollama&quot;,
    logo: OllamaLogo,
    options: (settings) =&gt; &lt;OllamaLLMOptions settings={settings} /&gt;,
    description: &quot;Run LLMs locally on your own machine.&quot;,
  },
  {
    name: &quot;Dell Pro AI Studio&quot;,
    value: &quot;dpais&quot;,
    logo: DellProAiStudioLogo,
    options: (settings) =&gt; &lt;DellProAiStudioOptions settings={settings} /&gt;,
    description:
      &quot;Run powerful LLMs quickly on NPU powered by Dell Pro AI Studio.&quot;,
  },
  {
    name: &quot;LM Studio&quot;,
    value: &quot;lmstudio&quot;,
    logo: LMStudioLogo,
    options: (settings) =&gt; &lt;LMStudioOptions settings={settings} /&gt;,
    description:
      &quot;Discover, download, and run thousands of cutting edge LLMs in a few clicks.&quot;,
  },
  {
    name: &quot;Local AI&quot;,
    value: &quot;localai&quot;,
    logo: LocalAiLogo,
    options: (settings) =&gt; &lt;LocalAiOptions settings={settings} /&gt;,
    description: &quot;Run LLMs locally on your own machine.&quot;,
  },
  {
    name: &quot;Novita AI&quot;,
    value: &quot;novita&quot;,
    logo: NovitaLogo,
    options: (settings) =&gt; &lt;NovitaLLMOptions settings={settings} /&gt;,
    description:
      &quot;Reliable, Scalable, and Cost-Effective for LLMs from Novita AI&quot;,
  },
  {
    name: &quot;KoboldCPP&quot;,
    value: &quot;koboldcpp&quot;,
    logo: KoboldCPPLogo,
    options: (settings) =&gt; &lt;KoboldCPPOptions settings={settings} /&gt;,
    description: &quot;Run local LLMs using koboldcpp.&quot;,
  },
  {
    name: &quot;Oobabooga Web UI&quot;,
    value: &quot;textgenwebui&quot;,
    logo: TextGenWebUILogo,
    options: (settings) =&gt; &lt;TextGenWebUIOptions settings={settings} /&gt;,
    description: &quot;Run local LLMs using Oobabooga's Text Generation Web UI.&quot;,
  },
  {
    name: &quot;Together AI&quot;,
    value: &quot;togetherai&quot;,
    logo: TogetherAILogo,
    options: (settings) =&gt; &lt;TogetherAiOptions settings={settings} /&gt;,
    description: &quot;Run open source models from Together AI.&quot;,
  },
  {
    name: &quot;Fireworks AI&quot;,
    value: &quot;fireworksai&quot;,
    logo: FireworksAILogo,
    options: (settings) =&gt; &lt;FireworksAiOptions settings={settings} /&gt;,
    description:
      &quot;The fastest and most efficient inference engine to build production-ready, compound AI systems.&quot;,
  },
  {
    name: &quot;Mistral&quot;,
    value: &quot;mistral&quot;,
    logo: MistralLogo,
    options: (settings) =&gt; &lt;MistralOptions settings={settings} /&gt;,
    description: &quot;Run open source models from Mistral AI.&quot;,
  },
  {
    name: &quot;Perplexity AI&quot;,
    value: &quot;perplexity&quot;,
    logo: PerplexityLogo,
    options: (settings) =&gt; &lt;PerplexityOptions settings={settings} /&gt;,
    description:
      &quot;Run powerful and internet-connected models hosted by Perplexity AI.&quot;,
  },
  {
    name: &quot;OpenRouter&quot;,
    value: &quot;openrouter&quot;,
    logo: OpenRouterLogo,
    options: (settings) =&gt; &lt;OpenRouterOptions settings={settings} /&gt;,
    description: &quot;A unified interface for LLMs.&quot;,
  },
  {
    name: &quot;Groq&quot;,
    value: &quot;groq&quot;,
    logo: GroqLogo,
    options: (settings) =&gt; &lt;GroqAiOptions settings={settings} /&gt;,
    description:
      &quot;The fastest LLM inferencing available for real-time AI applications.&quot;,
  },
  {
    name: &quot;Cohere&quot;,
    value: &quot;cohere&quot;,
    logo: CohereLogo,
    options: (settings) =&gt; &lt;CohereAiOptions settings={settings} /&gt;,
    description: &quot;Run Cohere's powerful Command models.&quot;,
  },
  {
    name: &quot;LiteLLM&quot;,
    value: &quot;litellm&quot;,
    logo: LiteLLMLogo,
    options: (settings) =&gt; &lt;LiteLLMOptions settings={settings} /&gt;,
    description: &quot;Run LiteLLM's OpenAI compatible proxy for various LLMs.&quot;,
  },
  {
    name: &quot;DeepSeek&quot;,
    value: &quot;deepseek&quot;,
    logo: DeepSeekLogo,
    options: (settings) =&gt; &lt;DeepSeekOptions settings={settings} /&gt;,
    description: &quot;Run DeepSeek's powerful LLMs.&quot;,
  },
  {
    name: &quot;PPIO&quot;,
    value: &quot;ppio&quot;,
    logo: PPIOLogo,
    options: (settings) =&gt; &lt;PPIOLLMOptions settings={settings} /&gt;,
    description:
      &quot;Run stable and cost-efficient open-source LLM APIs, such as DeepSeek, Llama, Qwen etc.&quot;,
  },
  {
    name: &quot;APIpie&quot;,
    value: &quot;apipie&quot;,
    logo: APIPieLogo,
    options: (settings) =&gt; &lt;ApiPieLLMOptions settings={settings} /&gt;,
    description: &quot;A unified API of AI services from leading providers&quot;,
  },
  {
    name: &quot;Generic OpenAI&quot;,
    value: &quot;generic-openai&quot;,
    logo: GenericOpenAiLogo,
    options: (settings) =&gt; &lt;GenericOpenAiOptions settings={settings} /&gt;,
    description:
      &quot;Connect to any OpenAi-compatible service via a custom configuration&quot;,
  },
  {
    name: &quot;AWS Bedrock&quot;,
    value: &quot;bedrock&quot;,
    logo: AWSBedrockLogo,
    options: (settings) =&gt; &lt;AWSBedrockLLMOptions settings={settings} /&gt;,
    description: &quot;Run powerful foundation models privately with AWS Bedrock.&quot;,
  },
  {
    name: &quot;xAI&quot;,
    value: &quot;xai&quot;,
    logo: XAILogo,
    options: (settings) =&gt; &lt;XAILLMOptions settings={settings} /&gt;,
    description: &quot;Run xAI's powerful LLMs like Grok-2 and more.&quot;,
  },
];

export default function LLMPreference({
  setHeader,
  setForwardBtn,
  setBackBtn,
}) {
  const { t } = useTranslation();
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredLLMs, setFilteredLLMs] = useState([]);
  const [selectedLLM, setSelectedLLM] = useState(null);
  const [settings, setSettings] = useState(null);
  const formRef = useRef(null);
  const hiddenSubmitButtonRef = useRef(null);
  const isHosted = window.location.hostname.includes(&quot;useanything.com&quot;);
  const navigate = useNavigate();

  const TITLE = t(&quot;onboarding.llm.title&quot;);
  const DESCRIPTION = t(&quot;onboarding.llm.description&quot;);

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedLLM(_settings?.LLMProvider || &quot;openai&quot;);
    }
    fetchKeys();
  }, []);

  function handleForward() {
    if (hiddenSubmitButtonRef.current) {
      hiddenSubmitButtonRef.current.click();
    }
  }

  function handleBack() {
    navigate(paths.onboarding.home());
  }

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = e.target;
    const data = {};
    const formData = new FormData(form);
    data.LLMProvider = selectedLLM;
    // Default to AnythingLLM embedder and LanceDB
    data.EmbeddingEngine = &quot;native&quot;;
    data.VectorDB = &quot;lancedb&quot;;
    for (var [key, value] of formData.entries()) data[key] = value;

    const { error } = await System.updateSystem(data);
    if (error) {
      showToast(`Failed to save LLM settings: ${error}`, &quot;error&quot;);
      return;
    }
    navigate(paths.onboarding.userSetup());
  };

  useEffect(() =&gt; {
    setHeader({ title: TITLE, description: DESCRIPTION });
    setForwardBtn({ showing: true, disabled: false, onClick: handleForward });
    setBackBtn({ showing: true, disabled: false, onClick: handleBack });
  }, []);

  useEffect(() =&gt; {
    const filtered = LLMS.filter((llm) =&gt;
      llm.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredLLMs(filtered);
  }, [searchQuery, selectedLLM]);

  return (
    &lt;div&gt;
      &lt;form ref={formRef</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Main/Home/Checklist/constants.js (Line 86:18 - Line 97:21), frontend/src/pages/Main/Home/Checklist/constants.js (Line 62:9 - Line 73:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn565" onclick="toggleCodeBlock('cloneGroup565', 'expandBtn565', 'collapseBtn565')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn565" onclick="toggleCodeBlock('cloneGroup565', 'expandBtn565', 'collapseBtn565')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup565"><code class="language-javascript text-sm text-gray-800"> = noop,
      showToast = noop,
      showNewWsModal = noop,
    }) =&gt; {
      if (workspaces.length === 0) {
        showToast(t(&quot;main-page.noWorkspaceError&quot;), &quot;warning&quot;, {
          clear: true,
        });
        showNewWsModal();
        return false;
      }
      setSelectedWorkspace</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Main/Home/Checklist/constants.js (Line 112:10 - Line 122:1), frontend/src/pages/Main/Home/Checklist/constants.js (Line 64:15 - Line 73:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn566" onclick="toggleCodeBlock('cloneGroup566', 'expandBtn566', 'collapseBtn566')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn566" onclick="toggleCodeBlock('cloneGroup566', 'expandBtn566', 'collapseBtn566')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup566"><code class="language-javascript text-sm text-gray-800"> = noop,
    }) =&gt; {
      if (workspaces.length === 0) {
        showToast(t(&quot;main-page.noWorkspaceError&quot;), &quot;warning&quot;, {
          clear: true,
        });
        showNewWsModal();
        return false;
      }
      navigate(
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 21:9 - Line 181:9), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 170:9 - Line 268:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn623" onclick="toggleCodeBlock('cloneGroup623', 'expandBtn623', 'collapseBtn623')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn623" onclick="toggleCodeBlock('cloneGroup623', 'expandBtn623', 'collapseBtn623')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup623"><code class="language-javascript text-sm text-gray-800">={settings} /&gt;,
    description: &quot;Leverage the OpenAI Whisper-large model using your API key.&quot;,
  },
  {
    name: &quot;AnythingLLM Built-In&quot;,
    value: &quot;local&quot;,
    logo: AnythingLLMIcon,
    options: (settings) =&gt; &lt;NativeTranscriptionOptions settings={settings} /&gt;,
    description: &quot;Run a built-in whisper model on this instance privately.&quot;,
  },
];

export default function TranscriptionModelPreference() {
  const [saving, setSaving] = useState(false);
  const [hasChanges, setHasChanges] = useState(false);
  const [settings, setSettings] = useState(null);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredProviders, setFilteredProviders] = useState([]);
  const [selectedProvider, setSelectedProvider] = useState(null);
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);
  const { t } = useTranslation();

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = e.target;
    const data = { WhisperProvider: selectedProvider };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save preferences: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;Transcription preferences saved successfully.&quot;, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateProviderChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedProvider(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedProvider(_settings?.WhisperProvider || &quot;local&quot;);
      setLoading(false);
    }
    fetchKeys();
  }, []);

  useEffect(() =&gt; {
    const filtered = PROVIDERS.filter((provider) =&gt;
      provider.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredProviders(filtered);
  }, [searchQuery, selectedProvider]);

  const selectedProviderObject = PROVIDERS.find(
    (provider) =&gt; provider.value === selectedProvider
  );

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form onSubmit={handleSubmit} className=&quot;flex w-full&quot;&gt;
            &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] py-16 md:py-6&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
                &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                  &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
                    {t(&quot;transcription.title&quot;)}
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60&quot;&gt;
                  {t(&quot;transcription.description&quot;)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div className=&quot;w-full justify-end flex&quot;&gt;
                {hasChanges &amp;&amp; (
                  &lt;CTAButton
                    onClick={() =&gt; handleSubmit()}
                    className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
                  &gt;
                    {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
                  &lt;/CTAButton&gt;
                )}
              &lt;/div&gt;
              &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;
                {t(&quot;transcription.provider&quot;)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;provider-search&quot;
                          autoComplete=&quot;off&quot;
                          placeholder=&quot;Search audio transcription providers&quot;
                          className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none focus:outline-primary-button active:outline-primary-button outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredProviders.map((provider) =&gt; (
                          &lt;LLMItem
                            key={provider</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 74:9 - Line 392:2), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 71:9 - Line 160:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn637" onclick="toggleCodeBlock('cloneGroup637', 'expandBtn637', 'collapseBtn637')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn637" onclick="toggleCodeBlock('cloneGroup637', 'expandBtn637', 'collapseBtn637')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup637"><code class="language-javascript text-sm text-gray-800">={settings} /&gt;,
    description: &quot;The standard option for most non-commercial use.&quot;,
    requiredConfig: [&quot;OpenAiKey&quot;],
  },
  {
    name: &quot;Azure OpenAI&quot;,
    value: &quot;azure&quot;,
    logo: AzureOpenAiLogo,
    options: (settings) =&gt; &lt;AzureAiOptions settings={settings} /&gt;,
    description: &quot;The enterprise option of OpenAI hosted on Azure services.&quot;,
    requiredConfig: [&quot;AzureOpenAiEndpoint&quot;],
  },
  {
    name: &quot;Anthropic&quot;,
    value: &quot;anthropic&quot;,
    logo: AnthropicLogo,
    options: (settings) =&gt; &lt;AnthropicAiOptions settings={settings} /&gt;,
    description: &quot;A friendly AI Assistant hosted by Anthropic.&quot;,
    requiredConfig: [&quot;AnthropicApiKey&quot;],
  },
  {
    name: &quot;Gemini&quot;,
    value: &quot;gemini&quot;,
    logo: GeminiLogo,
    options: (settings) =&gt; &lt;GeminiLLMOptions settings={settings} /&gt;,
    description: &quot;Google's largest and most capable AI model&quot;,
    requiredConfig: [&quot;GeminiLLMApiKey&quot;],
  },
  {
    name: &quot;NVIDIA NIM&quot;,
    value: &quot;nvidia-nim&quot;,
    logo: NvidiaNimLogo,
    options: (settings) =&gt; &lt;NvidiaNimOptions settings={settings} /&gt;,
    description:
      &quot;Run full parameter LLMs directly on your NVIDIA RTX GPU using NVIDIA NIM.&quot;,
    requiredConfig: [&quot;NvidiaNimLLMBasePath&quot;],
  },
  {
    name: &quot;HuggingFace&quot;,
    value: &quot;huggingface&quot;,
    logo: HuggingFaceLogo,
    options: (settings) =&gt; &lt;HuggingFaceOptions settings={settings} /&gt;,
    description:
      &quot;Access 150,000+ open-source LLMs and the world's AI community&quot;,
    requiredConfig: [
      &quot;HuggingFaceLLMEndpoint&quot;,
      &quot;HuggingFaceLLMAccessToken&quot;,
      &quot;HuggingFaceLLMTokenLimit&quot;,
    ],
  },
  {
    name: &quot;Ollama&quot;,
    value: &quot;ollama&quot;,
    logo: OllamaLogo,
    options: (settings) =&gt; &lt;OllamaLLMOptions settings={settings} /&gt;,
    description: &quot;Run LLMs locally on your own machine.&quot;,
    requiredConfig: [&quot;OllamaLLMBasePath&quot;],
  },
  {
    name: &quot;Dell Pro AI Studio&quot;,
    value: &quot;dpais&quot;,
    logo: DellProAiStudioLogo,
    options: (settings) =&gt; &lt;DellProAiStudioOptions settings={settings} /&gt;,
    description:
      &quot;Run powerful LLMs quickly on NPU powered by Dell Pro AI Studio.&quot;,
    requiredConfig: [
      &quot;DellProAiStudioBasePath&quot;,
      &quot;DellProAiStudioModelPref&quot;,
      &quot;DellProAiStudioTokenLimit&quot;,
    ],
  },
  {
    name: &quot;LM Studio&quot;,
    value: &quot;lmstudio&quot;,
    logo: LMStudioLogo,
    options: (settings) =&gt; &lt;LMStudioOptions settings={settings} /&gt;,
    description:
      &quot;Discover, download, and run thousands of cutting edge LLMs in a few clicks.&quot;,
    requiredConfig: [&quot;LMStudioBasePath&quot;],
  },
  {
    name: &quot;Local AI&quot;,
    value: &quot;localai&quot;,
    logo: LocalAiLogo,
    options: (settings) =&gt; &lt;LocalAiOptions settings={settings} /&gt;,
    description: &quot;Run LLMs locally on your own machine.&quot;,
    requiredConfig: [&quot;LocalAiApiKey&quot;, &quot;LocalAiBasePath&quot;, &quot;LocalAiTokenLimit&quot;],
  },
  {
    name: &quot;Novita AI&quot;,
    value: &quot;novita&quot;,
    logo: NovitaLogo,
    options: (settings) =&gt; &lt;NovitaLLMOptions settings={settings} /&gt;,
    description:
      &quot;Reliable, Scalable, and Cost-Effective for LLMs from Novita AI&quot;,
    requiredConfig: [&quot;NovitaLLMApiKey&quot;],
  },
  {
    name: &quot;Together AI&quot;,
    value: &quot;togetherai&quot;,
    logo: TogetherAILogo,
    options: (settings) =&gt; &lt;TogetherAiOptions settings={settings} /&gt;,
    description: &quot;Run open source models from Together AI.&quot;,
    requiredConfig: [&quot;TogetherAiApiKey&quot;],
  },
  {
    name: &quot;Fireworks AI&quot;,
    value: &quot;fireworksai&quot;,
    logo: FireworksAILogo,
    options: (settings) =&gt; &lt;FireworksAiOptions settings={settings} /&gt;,
    description:
      &quot;The fastest and most efficient inference engine to build production-ready, compound AI systems.&quot;,
    requiredConfig: [&quot;FireworksAiLLMApiKey&quot;],
  },
  {
    name: &quot;Mistral&quot;,
    value: &quot;mistral&quot;,
    logo: MistralLogo,
    options: (settings) =&gt; &lt;MistralOptions settings={settings} /&gt;,
    description: &quot;Run open source models from Mistral AI.&quot;,
    requiredConfig: [&quot;MistralApiKey&quot;],
  },
  {
    name: &quot;Perplexity AI&quot;,
    value: &quot;perplexity&quot;,
    logo: PerplexityLogo,
    options: (settings) =&gt; &lt;PerplexityOptions settings={settings} /&gt;,
    description:
      &quot;Run powerful and internet-connected models hosted by Perplexity AI.&quot;,
    requiredConfig: [&quot;PerplexityApiKey&quot;],
  },
  {
    name: &quot;OpenRouter&quot;,
    value: &quot;openrouter&quot;,
    logo: OpenRouterLogo,
    options: (settings) =&gt; &lt;OpenRouterOptions settings={settings} /&gt;,
    description: &quot;A unified interface for LLMs.&quot;,
    requiredConfig: [&quot;OpenRouterApiKey&quot;],
  },
  {
    name: &quot;Groq&quot;,
    value: &quot;groq&quot;,
    logo: GroqLogo,
    options: (settings) =&gt; &lt;GroqAiOptions settings={settings} /&gt;,
    description:
      &quot;The fastest LLM inferencing available for real-time AI applications.&quot;,
    requiredConfig: [&quot;GroqApiKey&quot;],
  },
  {
    name: &quot;KoboldCPP&quot;,
    value: &quot;koboldcpp&quot;,
    logo: KoboldCPPLogo,
    options: (settings) =&gt; &lt;KoboldCPPOptions settings={settings} /&gt;,
    description: &quot;Run local LLMs using koboldcpp.&quot;,
    requiredConfig: [
      &quot;KoboldCPPModelPref&quot;,
      &quot;KoboldCPPBasePath&quot;,
      &quot;KoboldCPPTokenLimit&quot;,
    ],
  },
  {
    name: &quot;Oobabooga Web UI&quot;,
    value: &quot;textgenwebui&quot;,
    logo: TextGenWebUILogo,
    options: (settings) =&gt; &lt;TextGenWebUIOptions settings={settings} /&gt;,
    description: &quot;Run local LLMs using Oobabooga's Text Generation Web UI.&quot;,
    requiredConfig: [&quot;TextGenWebUIBasePath&quot;, &quot;TextGenWebUITokenLimit&quot;],
  },
  {
    name: &quot;Cohere&quot;,
    value: &quot;cohere&quot;,
    logo: CohereLogo,
    options: (settings) =&gt; &lt;CohereAiOptions settings={settings} /&gt;,
    description: &quot;Run Cohere's powerful Command models.&quot;,
    requiredConfig: [&quot;CohereApiKey&quot;],
  },
  {
    name: &quot;LiteLLM&quot;,
    value: &quot;litellm&quot;,
    logo: LiteLLMLogo,
    options: (settings) =&gt; &lt;LiteLLMOptions settings={settings} /&gt;,
    description: &quot;Run LiteLLM's OpenAI compatible proxy for various LLMs.&quot;,
    requiredConfig: [&quot;LiteLLMBasePath&quot;],
  },
  {
    name: &quot;DeepSeek&quot;,
    value: &quot;deepseek&quot;,
    logo: DeepSeekLogo,
    options: (settings) =&gt; &lt;DeepSeekOptions settings={settings} /&gt;,
    description: &quot;Run DeepSeek's powerful LLMs.&quot;,
    requiredConfig: [&quot;DeepSeekApiKey&quot;],
  },
  {
    name: &quot;PPIO&quot;,
    value: &quot;ppio&quot;,
    logo: PPIOLogo,
    options: (settings) =&gt; &lt;PPIOLLMOptions settings={settings} /&gt;,
    description:
      &quot;Run stable and cost-efficient open-source LLM APIs, such as DeepSeek, Llama, Qwen etc.&quot;,
    requiredConfig: [&quot;PPIOApiKey&quot;],
  },
  {
    name: &quot;AWS Bedrock&quot;,
    value: &quot;bedrock&quot;,
    logo: AWSBedrockLogo,
    options: (settings) =&gt; &lt;AWSBedrockLLMOptions settings={settings} /&gt;,
    description: &quot;Run powerful foundation models privately with AWS Bedrock.&quot;,
    requiredConfig: [
      &quot;AwsBedrockLLMAccessKeyId&quot;,
      &quot;AwsBedrockLLMAccessKey&quot;,
      &quot;AwsBedrockLLMRegion&quot;,
      &quot;AwsBedrockLLMModel&quot;,
    ],
  },
  {
    name: &quot;APIpie&quot;,
    value: &quot;apipie&quot;,
    logo: APIPieLogo,
    options: (settings) =&gt; &lt;ApiPieLLMOptions settings={settings} /&gt;,
    description: &quot;A unified API of AI services from leading providers&quot;,
    requiredConfig: [&quot;ApipieLLMApiKey&quot;, &quot;ApipieLLMModelPref&quot;],
  },
  {
    name: &quot;Generic OpenAI&quot;,
    value: &quot;generic-openai&quot;,
    logo: GenericOpenAiLogo,
    options: (settings) =&gt; &lt;GenericOpenAiOptions settings={settings} /&gt;,
    description:
      &quot;Connect to any OpenAi-compatible service via a custom configuration&quot;,
    requiredConfig: [
      &quot;GenericOpenAiBasePath&quot;,
      &quot;GenericOpenAiModelPref&quot;,
      &quot;GenericOpenAiTokenLimit&quot;,
      &quot;GenericOpenAiKey&quot;,
    ],
  },
  {
    name: &quot;xAI&quot;,
    value: &quot;xai&quot;,
    logo: XAILogo,
    options: (settings) =&gt; &lt;XAILLMOptions settings={settings} /&gt;,
    description: &quot;Run xAI's powerful LLMs like Grok-2 and more.&quot;,
    requiredConfig: [&quot;XAIApiKey&quot;, &quot;XAIModelPref&quot;],
  },
];

export default function GeneralLLMPreference() {
  const [saving, setSaving] = useState(false);
  const [hasChanges, setHasChanges] = useState(false);
  const [settings, setSettings] = useState(null);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredLLMs, setFilteredLLMs] = useState([]);
  const [selectedLLM, setSelectedLLM] = useState(null);
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);
  const { t } = useTranslation();

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = e.target;
    const data = { LLMProvider: selectedLLM };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save LLM settings: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;LLM preferences saved successfully.&quot;, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateLLMChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedLLM(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedLLM(_settings?.LLMProvider);
      setLoading(false);
    }
    fetchKeys();
  }, []);

  useEffect(() =&gt; {
    const filtered = AVAILABLE_LLM_PROVIDERS.filter((llm) =&gt;
      llm.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredLLMs(filtered);
  }, [searchQuery, selectedLLM]);

  const selectedLLMObject = AVAILABLE_LLM_PROVIDERS.find(
    (llm) =&gt; llm.value === selectedLLM
  );
  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 246:9 - Line 468:4), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 125:9 - Line 268:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn638" onclick="toggleCodeBlock('cloneGroup638', 'expandBtn638', 'collapseBtn638')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn638" onclick="toggleCodeBlock('cloneGroup638', 'expandBtn638', 'collapseBtn638')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup638"><code class="language-javascript text-sm text-gray-800">={settings} /&gt;,
    description: &quot;Run Cohere's powerful Command models.&quot;,
    requiredConfig: [&quot;CohereApiKey&quot;],
  },
  {
    name: &quot;LiteLLM&quot;,
    value: &quot;litellm&quot;,
    logo: LiteLLMLogo,
    options: (settings) =&gt; &lt;LiteLLMOptions settings={settings} /&gt;,
    description: &quot;Run LiteLLM's OpenAI compatible proxy for various LLMs.&quot;,
    requiredConfig: [&quot;LiteLLMBasePath&quot;],
  },
  {
    name: &quot;DeepSeek&quot;,
    value: &quot;deepseek&quot;,
    logo: DeepSeekLogo,
    options: (settings) =&gt; &lt;DeepSeekOptions settings={settings} /&gt;,
    description: &quot;Run DeepSeek's powerful LLMs.&quot;,
    requiredConfig: [&quot;DeepSeekApiKey&quot;],
  },
  {
    name: &quot;PPIO&quot;,
    value: &quot;ppio&quot;,
    logo: PPIOLogo,
    options: (settings) =&gt; &lt;PPIOLLMOptions settings={settings} /&gt;,
    description:
      &quot;Run stable and cost-efficient open-source LLM APIs, such as DeepSeek, Llama, Qwen etc.&quot;,
    requiredConfig: [&quot;PPIOApiKey&quot;],
  },
  {
    name: &quot;AWS Bedrock&quot;,
    value: &quot;bedrock&quot;,
    logo: AWSBedrockLogo,
    options: (settings) =&gt; &lt;AWSBedrockLLMOptions settings={settings} /&gt;,
    description: &quot;Run powerful foundation models privately with AWS Bedrock.&quot;,
    requiredConfig: [
      &quot;AwsBedrockLLMAccessKeyId&quot;,
      &quot;AwsBedrockLLMAccessKey&quot;,
      &quot;AwsBedrockLLMRegion&quot;,
      &quot;AwsBedrockLLMModel&quot;,
    ],
  },
  {
    name: &quot;APIpie&quot;,
    value: &quot;apipie&quot;,
    logo: APIPieLogo,
    options: (settings) =&gt; &lt;ApiPieLLMOptions settings={settings} /&gt;,
    description: &quot;A unified API of AI services from leading providers&quot;,
    requiredConfig: [&quot;ApipieLLMApiKey&quot;, &quot;ApipieLLMModelPref&quot;],
  },
  {
    name: &quot;Generic OpenAI&quot;,
    value: &quot;generic-openai&quot;,
    logo: GenericOpenAiLogo,
    options: (settings) =&gt; &lt;GenericOpenAiOptions settings={settings} /&gt;,
    description:
      &quot;Connect to any OpenAi-compatible service via a custom configuration&quot;,
    requiredConfig: [
      &quot;GenericOpenAiBasePath&quot;,
      &quot;GenericOpenAiModelPref&quot;,
      &quot;GenericOpenAiTokenLimit&quot;,
      &quot;GenericOpenAiKey&quot;,
    ],
  },
  {
    name: &quot;xAI&quot;,
    value: &quot;xai&quot;,
    logo: XAILogo,
    options: (settings) =&gt; &lt;XAILLMOptions settings={settings} /&gt;,
    description: &quot;Run xAI's powerful LLMs like Grok-2 and more.&quot;,
    requiredConfig: [&quot;XAIApiKey&quot;, &quot;XAIModelPref&quot;],
  },
];

export default function GeneralLLMPreference() {
  const [saving, setSaving] = useState(false);
  const [hasChanges, setHasChanges] = useState(false);
  const [settings, setSettings] = useState(null);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredLLMs, setFilteredLLMs] = useState([]);
  const [selectedLLM, setSelectedLLM] = useState(null);
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);
  const { t } = useTranslation();

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = e.target;
    const data = { LLMProvider: selectedLLM };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save LLM settings: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;LLM preferences saved successfully.&quot;, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateLLMChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedLLM(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedLLM(_settings?.LLMProvider);
      setLoading(false);
    }
    fetchKeys();
  }, []);

  useEffect(() =&gt; {
    const filtered = AVAILABLE_LLM_PROVIDERS.filter((llm) =&gt;
      llm.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredLLMs(filtered);
  }, [searchQuery, selectedLLM]);

  const selectedLLMObject = AVAILABLE_LLM_PROVIDERS.find(
    (llm) =&gt; llm.value === selectedLLM
  );
  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form onSubmit={handleSubmit} className=&quot;flex w-full&quot;&gt;
            &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
                &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                  &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
                    {t(&quot;llm.title&quot;)}
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60&quot;&gt;
                  {t(&quot;llm.description&quot;)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div className=&quot;w-full justify-end flex&quot;&gt;
                {hasChanges &amp;&amp; (
                  &lt;CTAButton
                    onClick={() =&gt; handleSubmit()}
                    className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
                  &gt;
                    {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
                  &lt;/CTAButton&gt;
                )}
              &lt;/div&gt;
              &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;
                {t(&quot;llm.provider&quot;)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;llm-search&quot;
                          autoComplete=&quot;off&quot;
                          placeholder=&quot;Search all LLM providers&quot;
                          className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredLLMs.map((llm) =&gt; {
                          return (
                            &lt;LLMItem
                              key={llm</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 46:9 - Line 317:9), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 71:9 - Line 268:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn649" onclick="toggleCodeBlock('cloneGroup649', 'expandBtn649', 'collapseBtn649')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn649" onclick="toggleCodeBlock('cloneGroup649', 'expandBtn649', 'collapseBtn649')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup649"><code class="language-javascript text-sm text-gray-800">={settings} /&gt;,
    description:
      &quot;Use the built-in embedding provider for AnythingLLM. Zero setup!&quot;,
  },
  {
    name: &quot;OpenAI&quot;,
    value: &quot;openai&quot;,
    logo: OpenAiLogo,
    options: (settings) =&gt; &lt;OpenAiOptions settings={settings} /&gt;,
    description: &quot;The standard option for most non-commercial use.&quot;,
  },
  {
    name: &quot;Azure OpenAI&quot;,
    value: &quot;azure&quot;,
    logo: AzureOpenAiLogo,
    options: (settings) =&gt; &lt;AzureAiOptions settings={settings} /&gt;,
    description: &quot;The enterprise option of OpenAI hosted on Azure services.&quot;,
  },
  {
    name: &quot;Gemini&quot;,
    value: &quot;gemini&quot;,
    logo: GeminiAiLogo,
    options: (settings) =&gt; &lt;GeminiOptions settings={settings} /&gt;,
    description: &quot;Run powerful embedding models from Google AI.&quot;,
  },
  {
    name: &quot;Local AI&quot;,
    value: &quot;localai&quot;,
    logo: LocalAiLogo,
    options: (settings) =&gt; &lt;LocalAiOptions settings={settings} /&gt;,
    description: &quot;Run embedding models locally on your own machine.&quot;,
  },
  {
    name: &quot;Ollama&quot;,
    value: &quot;ollama&quot;,
    logo: OllamaLogo,
    options: (settings) =&gt; &lt;OllamaEmbeddingOptions settings={settings} /&gt;,
    description: &quot;Run embedding models locally on your own machine.&quot;,
  },
  {
    name: &quot;LM Studio&quot;,
    value: &quot;lmstudio&quot;,
    logo: LMStudioLogo,
    options: (settings) =&gt; &lt;LMStudioEmbeddingOptions settings={settings} /&gt;,
    description:
      &quot;Discover, download, and run thousands of cutting edge LLMs in a few clicks.&quot;,
  },
  {
    name: &quot;Cohere&quot;,
    value: &quot;cohere&quot;,
    logo: CohereLogo,
    options: (settings) =&gt; &lt;CohereEmbeddingOptions settings={settings} /&gt;,
    description: &quot;Run powerful embedding models from Cohere.&quot;,
  },
  {
    name: &quot;Voyage AI&quot;,
    value: &quot;voyageai&quot;,
    logo: VoyageAiLogo,
    options: (settings) =&gt; &lt;VoyageAiOptions settings={settings} /&gt;,
    description: &quot;Run powerful embedding models from Voyage AI.&quot;,
  },
  {
    name: &quot;LiteLLM&quot;,
    value: &quot;litellm&quot;,
    logo: LiteLLMLogo,
    options: (settings) =&gt; &lt;LiteLLMOptions settings={settings} /&gt;,
    description: &quot;Run powerful embedding models from LiteLLM.&quot;,
  },
  {
    name: &quot;Mistral AI&quot;,
    value: &quot;mistral&quot;,
    logo: MistralAiLogo,
    options: (settings) =&gt; &lt;MistralAiOptions settings={settings} /&gt;,
    description: &quot;Run powerful embedding models from Mistral AI.&quot;,
  },
  {
    name: &quot;Generic OpenAI&quot;,
    value: &quot;generic-openai&quot;,
    logo: GenericOpenAiLogo,
    options: (settings) =&gt; (
      &lt;GenericOpenAiEmbeddingOptions settings={settings} /&gt;
    ),
    description: &quot;Run embedding models from any OpenAI compatible API service.&quot;,
  },
];

export default function GeneralEmbeddingPreference() {
  const [saving, setSaving] = useState(false);
  const [hasChanges, setHasChanges] = useState(false);
  const [hasEmbeddings, setHasEmbeddings] = useState(false);
  const [hasCachedEmbeddings, setHasCachedEmbeddings] = useState(false);
  const [settings, setSettings] = useState(null);
  const [loading, setLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredEmbedders, setFilteredEmbedders] = useState([]);
  const [selectedEmbedder, setSelectedEmbedder] = useState(null);
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);
  const { isOpen, openModal, closeModal } = useModal();
  const { t } = useTranslation();

  function embedderModelChanged(formEl) {
    try {
      const newModel = new FormData(formEl).get(&quot;EmbeddingModelPref&quot;) ?? null;
      if (newModel === null) return false;
      return settings?.EmbeddingModelPref !== newModel;
    } catch (error) {
      console.error(error);
    }
    return false;
  }

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    if (
      (selectedEmbedder !== settings?.EmbeddingEngine ||
        embedderModelChanged(e.target)) &amp;&amp;
      hasChanges &amp;&amp;
      (hasEmbeddings || hasCachedEmbeddings)
    ) {
      openModal();
    } else {
      await handleSaveSettings();
    }
  };

  const handleSaveSettings = async () =&gt; {
    setSaving(true);
    const form = document.getElementById(&quot;embedding-form&quot;);
    const settingsData = {};
    const formData = new FormData(form);
    settingsData.EmbeddingEngine = selectedEmbedder;
    for (var [key, value] of formData.entries()) settingsData[key] = value;

    const { error } = await System.updateSystem(settingsData);
    if (error) {
      showToast(`Failed to save embedding settings: ${error}`, &quot;error&quot;);
      setHasChanges(true);
    } else {
      showToast(&quot;Embedding preferences saved successfully.&quot;, &quot;success&quot;);
      setHasChanges(false);
    }
    setSaving(false);
    closeModal();
  };

  const updateChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedEmbedder(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedEmbedder(_settings?.EmbeddingEngine || &quot;native&quot;);
      setHasEmbeddings(_settings?.HasExistingEmbeddings || false);
      setHasCachedEmbeddings(_settings?.HasCachedEmbeddings || false);
      setLoading(false);
    }
    fetchKeys();
  }, []);

  useEffect(() =&gt; {
    const filtered = EMBEDDERS.filter((embedder) =&gt;
      embedder.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredEmbedders(filtered);
  }, [searchQuery, selectedEmbedder]);

  const selectedEmbedderObject = EMBEDDERS.find(
    (embedder) =&gt; embedder.value === selectedEmbedder
  );

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form
            id=&quot;embedding-form&quot;
            onSubmit={handleSubmit}
            className=&quot;flex w-full&quot;
          &gt;
            &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] py-16 md:py-6&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
                &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                  &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
                    {t(&quot;embedding.title&quot;)}
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60&quot;&gt;
                  {t(&quot;embedding.desc-start&quot;)}
                  &lt;br /&gt;
                  {t(&quot;embedding.desc-end&quot;)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div className=&quot;w-full justify-end flex&quot;&gt;
                {hasChanges &amp;&amp; (
                  &lt;CTAButton
                    onClick={() =&gt; handleSubmit()}
                    className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
                  &gt;
                    {saving ? t(&quot;common.saving&quot;) : t(&quot;common.save&quot;)}
                  &lt;/CTAButton&gt;
                )}
              &lt;/div&gt;
              &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;
                {t(&quot;embedding.provider.title&quot;)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;embedder-search&quot;
                          autoComplete=&quot;off&quot;
                          placeholder=&quot;Search all embedding providers&quot;
                          className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredEmbedders.map((embedder) =&gt; (
                          &lt;EmbedderItem
                            key={embedder</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 165:21 - Line 215:2), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 169:27 - Line 223:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn661" onclick="toggleCodeBlock('cloneGroup661', 'expandBtn661', 'collapseBtn661')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn661" onclick="toggleCodeBlock('cloneGroup661', 'expandBtn661', 'collapseBtn661')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup661"><code class="language-javascript text-sm text-gray-800">}}
                  /&gt;
                  &lt;X
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                    onClick={handleXButton}
                  /&gt;
                &lt;/div&gt;
                &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                  {filteredProviders.map((provider) =&gt; (
                    &lt;LLMItem
                      key={provider.name}
                      name={provider.name}
                      value={provider.value}
                      image={provider.logo}
                      description={provider.description}
                      checked={selectedProvider === provider.value}
                      onClick={() =&gt; updateProviderChoice(provider.value)}
                    /&gt;
                  ))}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          ) : (
            &lt;button
              className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
              type=&quot;button&quot;
              onClick={() =&gt; setSearchMenuOpen(true)}
            &gt;
              &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                &lt;img
                  src={selectedProviderObject.logo}
                  alt={`${selectedProviderObject.name} logo`}
                  className=&quot;w-10 h-10 rounded-md&quot;
                /&gt;
                &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                  &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                    {selectedProviderObject.name}
                  &lt;/div&gt;
                  &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;
                    {selectedProviderObject.description}
                  &lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;CaretUpDown size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          )}
        &lt;/div&gt;
        &lt;div
          onChange={() =&gt; setHasChanges(true)}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 15:9 - Line 129:23), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 198:2 - Line 255:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn665" onclick="toggleCodeBlock('cloneGroup665', 'expandBtn665', 'collapseBtn665')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn665" onclick="toggleCodeBlock('cloneGroup665', 'expandBtn665', 'collapseBtn665')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup665"><code class="language-javascript text-sm text-gray-800">} /&gt;,
    description: &quot;Uses your browser's built in STT service if supported.&quot;,
  },
];

export default function SpeechToTextProvider({ settings }) {
  const [saving, setSaving] = useState(false);
  const [hasChanges, setHasChanges] = useState(false);
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [filteredProviders, setFilteredProviders] = useState([]);
  const [selectedProvider, setSelectedProvider] = useState(
    settings?.SpeechToTextProvider || &quot;native&quot;
  );
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = e.target;
    const data = { SpeechToTextProvider: selectedProvider };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save preferences: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;Speech-to-text preferences saved successfully.&quot;, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateProviderChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedProvider(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    const filtered = PROVIDERS.filter((provider) =&gt;
      provider.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredProviders(filtered);
  }, [searchQuery, selectedProvider]);

  const selectedProviderObject = PROVIDERS.find(
    (provider) =&gt; provider.value === selectedProvider
  );

  return (
    &lt;form onSubmit={handleSubmit} className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
        &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
          &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
            &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
              Speech-to-text Preference
            &lt;/p&gt;
          &lt;/div&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60&quot;&gt;
            Here you can specify what kind of text-to-speech and speech-to-text
            providers you would want to use in your AnythingLLM experience. By
            default, we use the browser's built in support for these services,
            but you may want to use others.
          &lt;/p&gt;
        &lt;/div&gt;
        &lt;div className=&quot;w-full justify-end flex&quot;&gt;
          {hasChanges &amp;&amp; (
            &lt;CTAButton
              onClick={() =&gt; handleSubmit()}
              className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
            &gt;
              {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
            &lt;/CTAButton&gt;
          )}
        &lt;/div&gt;
        &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;Provider&lt;/div&gt;
        &lt;div className=&quot;relative&quot;&gt;
          {searchMenuOpen &amp;&amp; (
            &lt;div
              className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
              onClick={() =&gt; setSearchMenuOpen(false)}
            /&gt;
          )}
          {searchMenuOpen ? (
            &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                  &lt;MagnifyingGlass
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                  /&gt;
                  &lt;input
                    type=&quot;text&quot;
                    name=&quot;stt-provider-search&quot;
                    autoComplete=&quot;off&quot;
                    placeholder=&quot;Search speech to text providers&quot;
                    className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                    onChange={(e) =&gt; setSearchQuery(e.target.value)}
                    ref={searchInputRef}
                    onKeyDown={(e) =&gt; {
                      </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 96:2 - Line 180:2), frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 116:13 - Line 223:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn666" onclick="toggleCodeBlock('cloneGroup666', 'expandBtn666', 'collapseBtn666')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn666" onclick="toggleCodeBlock('cloneGroup666', 'expandBtn666', 'collapseBtn666')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup666"><code class="language-javascript text-sm text-gray-800">}
              className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
            &gt;
              {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
            &lt;/CTAButton&gt;
          )}
        &lt;/div&gt;
        &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;Provider&lt;/div&gt;
        &lt;div className=&quot;relative&quot;&gt;
          {searchMenuOpen &amp;&amp; (
            &lt;div
              className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
              onClick={() =&gt; setSearchMenuOpen(false)}
            /&gt;
          )}
          {searchMenuOpen ? (
            &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                  &lt;MagnifyingGlass
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                  /&gt;
                  &lt;input
                    type=&quot;text&quot;
                    name=&quot;stt-provider-search&quot;
                    autoComplete=&quot;off&quot;
                    placeholder=&quot;Search speech to text providers&quot;
                    className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                    onChange={(e) =&gt; setSearchQuery(e.target.value)}
                    ref={searchInputRef}
                    onKeyDown={(e) =&gt; {
                      if (e.key === &quot;Enter&quot;) e.preventDefault();
                    }}
                  /&gt;
                  &lt;X
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                    onClick={handleXButton}
                  /&gt;
                &lt;/div&gt;
                &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                  {filteredProviders.map((provider) =&gt; (
                    &lt;LLMItem
                      key={provider.name}
                      name={provider.name}
                      value={provider.value}
                      image={provider.logo}
                      description={provider.description}
                      checked={selectedProvider === provider.value}
                      onClick={() =&gt; updateProviderChoice(provider.value)}
                    /&gt;
                  ))}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          ) : (
            &lt;button
              className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
              type=&quot;button&quot;
              onClick={() =&gt; setSearchMenuOpen(true)}
            &gt;
              &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                &lt;img
                  src={selectedProviderObject.logo}
                  alt={`${selectedProviderObject.name} logo`}
                  className=&quot;w-10 h-10 rounded-md&quot;
                /&gt;
                &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                  &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                    {selectedProviderObject.name}
                  &lt;/div&gt;
                  &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;
                    {selectedProviderObject.description}
                  &lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;CaretUpDown size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          )}
        &lt;/div&gt;
        &lt;div
          onChange={() =&gt; setHasChanges(true)}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/index.jsx (Line 535:15 - Line 623:2), frontend/src/pages/Admin/Agents/index.jsx (Line 349:3 - Line 429:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn687" onclick="toggleCodeBlock('cloneGroup687', 'expandBtn687', 'collapseBtn687')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn687" onclick="toggleCodeBlock('cloneGroup687', 'expandBtn687', 'collapseBtn687')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup687"><code class="language-javascript text-sm text-gray-800">}
                    /&gt;
                  );
                }}
              &lt;/MCPServerHeader&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;

        {/* Selected agent skill setting panel */}
        &lt;div className=&quot;flex-[2] flex flex-col gap-y-[18px] mt-10&quot;&gt;
          &lt;div className=&quot;bg-theme-bg-secondary text-white rounded-xl flex-1 p-4 overflow-y-scroll no-scroll&quot;&gt;
            {SelectedSkillComponent ? (
              &lt;&gt;
                {selectedMcpServer ? (
                  &lt;ServerPanel
                    server={selectedMcpServer}
                    toggleServer={toggleMCP}
                    onDelete={handleMCPServerDelete}
                  /&gt;
                ) : selectedFlow ? (
                  &lt;FlowPanel
                    flow={selectedFlow}
                    toggleFlow={toggleFlow}
                    enabled={activeFlowIds.includes(selectedFlow.uuid)}
                    onDelete={handleFlowDelete}
                  /&gt;
                ) : selectedSkill.imported ? (
                  &lt;ImportedSkillConfig
                    key={selectedSkill.hubId}
                    selectedSkill={selectedSkill}
                    setImportedSkills={setImportedSkills}
                  /&gt;
                ) : (
                  &lt;&gt;
                    {defaultSkills?.[selectedSkill] ? (
                      // The selected skill is a default skill - show the default skill panel
                      &lt;SelectedSkillComponent
                        skill={defaultSkills[selectedSkill]?.skill}
                        settings={settings}
                        toggleSkill={toggleDefaultSkill}
                        enabled={
                          !disabledAgentSkills.includes(
                            defaultSkills[selectedSkill]?.skill
                          )
                        }
                        setHasChanges={setHasChanges}
                        {...defaultSkills[selectedSkill]}
                      /&gt;
                    ) : (
                      // The selected skill is a configurable skill - show the configurable skill panel
                      &lt;SelectedSkillComponent
                        skill={configurableSkills[selectedSkill]?.skill}
                        settings={settings}
                        toggleSkill={toggleAgentSkill}
                        enabled={agentSkills.includes(
                          configurableSkills[selectedSkill]?.skill
                        )}
                        setHasChanges={setHasChanges}
                        {...configurableSkills[selectedSkill]}
                      /&gt;
                    )}
                  &lt;/&gt;
                )}
              &lt;/&gt;
            ) : (
              &lt;div className=&quot;flex flex-col items-center justify-center h-full text-theme-text-secondary&quot;&gt;
                &lt;Robot size={40} /&gt;
                &lt;p className=&quot;font-medium&quot;&gt;
                  Select an Agent Skill, Agent Flow, or MCP Server
                &lt;/p&gt;
              &lt;/div&gt;
            )}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/SkillLayout&gt;
  );
}

function SkillLayout({ children, hasChanges, handleSubmit, handleCancel }) {
  return (
    &lt;div
      id=&quot;workspace-agent-settings-container&quot;
      className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex md:mt-0 mt-6&quot;
    &gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/TogetherAiOptions/index.jsx (Line 19:18 - Line 99:13), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 19:11 - Line 98:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn709" onclick="toggleCodeBlock('cloneGroup709', 'expandBtn709', 'collapseBtn709')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn709" onclick="toggleCodeBlock('cloneGroup709', 'expandBtn709', 'collapseBtn709')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup709"><code class="language-javascript text-sm text-gray-800">? &quot;*&quot;.repeat(20) : &quot;&quot;}
          required={true}
          autoComplete=&quot;off&quot;
          spellCheck={false}
          onChange={(e) =&gt; setInputValue(e.target.value)}
          onBlur={() =&gt; setApiKey(inputValue)}
        /&gt;
      &lt;/div&gt;
      {!settings?.credentialsOnly &amp;&amp; (
        &lt;TogetherAiModelSelection settings={settings} apiKey={apiKey} /&gt;
      )}
    &lt;/div&gt;
  );
}

function TogetherAiModelSelection({ settings, apiKey }) {
  const [groupedModels, setGroupedModels] = useState({});
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      setLoading(true);
      try {
        const key = apiKey === &quot;*&quot;.repeat(20) ? null : apiKey;
        const { models } = await System.customModels(&quot;togetherai&quot;, key);
        if (models?.length &gt; 0) {
          const modelsByOrganization = models.reduce((acc, model) =&gt; {
            if (model.type !== &quot;chat&quot;) return acc; // Only show chat models in dropdown
            const org = model.organization || &quot;Unknown&quot;;
            acc[org] = acc[org] || [];
            acc[org].push({
              id: model.id,
              name: model.name || model.id,
              organization: org,
              maxLength: model.maxLength,
            });
            return acc;
          }, {});
          setGroupedModels(modelsByOrganization);
        }
      } catch (error) {
        console.error(&quot;Error fetching Together AI models:&quot;, error);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [apiKey]);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;TogetherAiModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;TogetherAiModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 18:17 - Line 62:18), frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 18:18 - Line 60:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn725" onclick="toggleCodeBlock('cloneGroup725', 'expandBtn725', 'collapseBtn725')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn725" onclick="toggleCodeBlock('cloneGroup725', 'expandBtn725', 'collapseBtn725')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup725"><code class="language-javascript text-sm text-gray-800">? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        {!settings?.credentialsOnly &amp;&amp; (
          &lt;NovitaModelSelection settings={settings} /&gt;
        )}
      &lt;/div&gt;
      &lt;AdvancedControls settings={settings} /&gt;
    &lt;/div&gt;
  );
}

function AdvancedControls({ settings }) {
  const [showAdvancedControls, setShowAdvancedControls] = useState(false);

  return (
    &lt;div className=&quot;flex flex-col gap-y-4&quot;&gt;
      &lt;div className=&quot;flex justify-start&quot;&gt;
        &lt;button
          type=&quot;button&quot;
          onClick={() =&gt; setShowAdvancedControls(!showAdvancedControls)}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3&quot;&gt;
            Stream Timeout (ms)
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;NovitaLLMTimeout&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;Timeout value between token responses to auto-timeout the stream&quot;
            defaultValue={settings?.NovitaLLMTimeout </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 62:18 - Line 135:20), frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 60:19 - Line 132:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn726" onclick="toggleCodeBlock('cloneGroup726', 'expandBtn726', 'collapseBtn726')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn726" onclick="toggleCodeBlock('cloneGroup726', 'expandBtn726', 'collapseBtn726')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup726"><code class="language-javascript text-sm text-gray-800">?? 500}
            autoComplete=&quot;off&quot;
            onScroll={(e) =&gt; e.target.blur()}
            min={500}
            step={1}
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-theme-text-primary text-opacity-60 mt-2&quot;&gt;
            Timeout value between token responses to auto-timeout the stream.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function NovitaModelSelection({ settings }) {
  const [groupedModels, setGroupedModels] = useState({});
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      setLoading(true);
      const { models } = await System.customModels(&quot;novita&quot;);
      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});
        setGroupedModels(modelsByOrganization);
      }
      setLoading(false);
    }
    findCustomModels();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;NovitaLLMModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg text-theme-text-primary border-theme-border text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;NovitaLLMModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg text-theme-text-primary border-theme-border text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.NovitaLLMModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 86:2 - Line 178:5), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 53:5 - Line 121:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn736" onclick="toggleCodeBlock('cloneGroup736', 'expandBtn736', 'collapseBtn736')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn736" onclick="toggleCodeBlock('cloneGroup736', 'expandBtn736', 'collapseBtn736')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup736"><code class="language-javascript text-sm text-gray-800">}
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                Local AI Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;LocalAiBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:8080/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LocalAIModelSelection({ settings, basePath = null, apiKey = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath || !basePath.includes(&quot;/v1&quot;)) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;localai&quot;,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;LocalAiModelPref&quot;
          disabled={true</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 64:22 - Line 205:19), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 51:2 - Line 208:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn744" onclick="toggleCodeBlock('cloneGroup744', 'expandBtn744', 'collapseBtn744')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn744" onclick="toggleCodeBlock('cloneGroup744', 'expandBtn744', 'collapseBtn744')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup744"><code class="language-javascript text-sm text-gray-800">}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum number of tokens for context and response.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                LM Studio Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;LMStudioBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:1234/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
            &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
              Enter the URL where LM Studio is running.
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LMStudioModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(
          &quot;lmstudio&quot;,
          null,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          LM Studio Model
        &lt;/label&gt;
        &lt;select
          name=&quot;LMStudioModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter LM Studio URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the LM Studio model you want to use. Models will load after
          entering a valid LM Studio URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        LM Studio Model
      &lt;/label&gt;
      &lt;select
        name=&quot;LMStudioModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.LMStudioModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LLMItem/index.jsx (Line 11:8 - Line 27:2), frontend/src/components/VectorDBSelection/VectorDBItem/index.jsx (Line 11:8 - Line 27:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn752" onclick="toggleCodeBlock('cloneGroup752', 'expandBtn752', 'collapseBtn752')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn752" onclick="toggleCodeBlock('cloneGroup752', 'expandBtn752', 'collapseBtn752')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup752"><code class="language-javascript text-sm text-gray-800">={() =&gt; onClick(value)}
      className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
        checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
      }`}
    &gt;
      &lt;input
        type=&quot;checkbox&quot;
        value={value}
        className=&quot;peer hidden&quot;
        checked={checked}
        readOnly={true}
        formNoValidate={true}
      /&gt;
      &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
        &lt;img
          src={image}
          alt={`${name} logo`}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 57:5 - Line 213:20), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 51:6 - Line 208:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn754" onclick="toggleCodeBlock('cloneGroup754', 'expandBtn754', 'collapseBtn754')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn754" onclick="toggleCodeBlock('cloneGroup754', 'expandBtn754', 'collapseBtn754')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup754"><code class="language-javascript text-sm text-gray-800">}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum number of tokens for context and response.
          &lt;/p&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
            Max response tokens
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;KoboldCPPMaxTokens&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;2048&quot;
            min={1}
            value={maxTokens}
            onChange={handleMaxTokensChange}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum number of tokens for the response.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                KoboldCPP Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;border-none bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;KoboldCPPBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://127.0.0.1:5000/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
            &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
              Enter the URL where KoboldCPP is running.
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function KoboldCPPModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath || !basePath.includes(&quot;/v1&quot;)) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(
          &quot;koboldcpp&quot;,
          null,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          KoboldCPP Model
        &lt;/label&gt;
        &lt;select
          name=&quot;KoboldCPPModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;--loading available models--&quot;
              : &quot;Enter KoboldCPP URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the KoboldCPP model you want to use. Models will load after
          entering a valid KoboldCPP URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        KoboldCPP Model
      &lt;/label&gt;
      &lt;select
        name=&quot;KoboldCPPModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.map((model) =&gt; (
          &lt;option
            key={model.id}
            value={model.id}
            selected={settings.KoboldCPPModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GroqAiOptions/index.jsx (Line 19:12 - Line 100:15), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 19:11 - Line 100:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn759" onclick="toggleCodeBlock('cloneGroup759', 'expandBtn759', 'collapseBtn759')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn759" onclick="toggleCodeBlock('cloneGroup759', 'expandBtn759', 'collapseBtn759')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup759"><code class="language-javascript text-sm text-gray-800">? &quot;*&quot;.repeat(20) : &quot;&quot;}
          required={true}
          autoComplete=&quot;off&quot;
          spellCheck={false}
          onChange={(e) =&gt; setInputValue(e.target.value)}
          onBlur={() =&gt; setApiKey(inputValue)}
        /&gt;
      &lt;/div&gt;

      {!settings?.credentialsOnly &amp;&amp; (
        &lt;GroqAIModelSelection settings={settings} apiKey={apiKey} /&gt;
      )}
    &lt;/div&gt;
  );
}

function GroqAIModelSelection({ apiKey, settings }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!apiKey) {
        setCustomModels([]);
        setLoading(true);
        return;
      }

      try {
        setLoading(true);
        const { models } = await System.customModels(&quot;groq&quot;, apiKey);
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      } finally {
        setLoading(false);
      }
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;GroqModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            --loading available models--
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Enter a valid API key to view all available models for your account.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;GroqModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Available models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.GroqModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 45:26 - Line 170:26), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 52:2 - Line 208:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn773" onclick="toggleCodeBlock('cloneGroup773', 'expandBtn773', 'collapseBtn773')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn773" onclick="toggleCodeBlock('cloneGroup773', 'expandBtn773', 'collapseBtn773')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup773"><code class="language-javascript text-sm text-gray-800">}
                required={true}
                autoComplete=&quot;off&quot;
              /&gt;
            &lt;/div&gt;
          &lt;/&gt;
        )}
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-fit&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2 gap-x-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                Dell Pro AI Studio Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;DellProAiStudioBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:8553/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function DellProAiStudioModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;dpais&quot;,
        null,
        basePath,
        2_000
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;DellProAiStudioModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;DellProAiStudioModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.DellProAiStudioModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/ApiPieOptions/index.jsx (Line 17:17 - Line 91:20), frontend/src/components/LLMSelection/FireworksAiOptions/index.jsx (Line 16:22 - Line 89:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn781" onclick="toggleCodeBlock('cloneGroup781', 'expandBtn781', 'collapseBtn781')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn781" onclick="toggleCodeBlock('cloneGroup781', 'expandBtn781', 'collapseBtn781')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup781"><code class="language-javascript text-sm text-gray-800">? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        {!settings?.credentialsOnly &amp;&amp; (
          &lt;APIPieModelSelection settings={settings} /&gt;
        )}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function APIPieModelSelection({ settings }) {
  const [groupedModels, setGroupedModels] = useState({});
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      setLoading(true);
      const { models } = await System.customModels(&quot;apipie&quot;);
      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});

        setGroupedModels(modelsByOrganization);
      }

      setLoading(false);
    }
    findCustomModels();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;ApipieLLMModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;ApipieLLMModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.ApipieLLMModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 48:27 - Line 185:20), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 51:2 - Line 208:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn791" onclick="toggleCodeBlock('cloneGroup791', 'expandBtn791', 'collapseBtn791')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn791" onclick="toggleCodeBlock('cloneGroup791', 'expandBtn791', 'collapseBtn791')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup791"><code class="language-javascript text-sm text-gray-800">}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum length of text chunks for embedding.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                Ollama Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://127.0.0.1:11434&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
            &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
              Enter the URL where Ollama is running.
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function OllamaEmbeddingModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(&quot;ollama&quot;, null, basePath);
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Ollama Embedding Model
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter Ollama URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the Ollama model for embeddings. Models will load after
          entering a valid Ollama URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Ollama Embedding Model
      &lt;/label&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 44:6 - Line 186:2), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 64:5 - Line 208:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn802" onclick="toggleCodeBlock('cloneGroup802', 'expandBtn802', 'collapseBtn802')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn802" onclick="toggleCodeBlock('cloneGroup802', 'expandBtn802', 'collapseBtn802')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup802"><code class="language-javascript text-sm text-gray-800">}
            autoComplete=&quot;off&quot;
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;div className=&quot;flex flex-col gap-y-1 mb-2&quot;&gt;
            &lt;label className=&quot;text-white text-sm font-semibold flex items-center gap-x-2&quot;&gt;
              Local AI API Key{&quot; &quot;}
              &lt;p className=&quot;!text-xs !italic !font-thin&quot;&gt;optional&lt;/p&gt;
            &lt;/label&gt;
          &lt;/div&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;LocalAiApiKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;sk-mysecretkey&quot;
            defaultValue={settings?.LocalAiApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setApiKeyValue(e.target.value)}
            onBlur={() =&gt; setApiKey(apiKeyValue)}
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                LocalAI Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:8080/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LocalAIModelSelection({ settings, apiKey = null, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath || !basePath.includes(&quot;/v1&quot;)) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;localai&quot;,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Embedding Model Name
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;-- loading available models --&quot;
              : &quot;-- waiting for URL --&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Embedding Model Name
      &lt;/label&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 24:13 - Line 48:29), frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 22:13 - Line 46:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn810" onclick="toggleCodeBlock('cloneGroup810', 'expandBtn810', 'collapseBtn810')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn810" onclick="toggleCodeBlock('cloneGroup810', 'expandBtn810', 'collapseBtn810')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup810"><code class="language-javascript text-sm text-gray-800">={settings?.LiteLLMBasePath}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setBasePathValue(e.target.value)}
            onBlur={() =&gt; setBasePath(basePathValue)}
          /&gt;
        &lt;/div&gt;
        &lt;LiteLLMModelSelection
          settings={settings}
          basePath={basePath}
          apiKey={apiKey}
        /&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Max embedding chunk length
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;EmbeddingModelMaxChunkLength&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;8192&quot;
            min={1}
            onScroll={(e) =&gt; e.target.blur()}
            defaultValue={settings?.EmbeddingModelMaxChunkLength</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 49:6 - Line 142:20), frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 47:5 - Line 137:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn811" onclick="toggleCodeBlock('cloneGroup811', 'expandBtn811', 'collapseBtn811')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn811" onclick="toggleCodeBlock('cloneGroup811', 'expandBtn811', 'collapseBtn811')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup811"><code class="language-javascript text-sm text-gray-800">}
            autoComplete=&quot;off&quot;
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px]&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
            &lt;label className=&quot;text-white text-sm font-semibold flex items-center gap-x-2&quot;&gt;
              API Key &lt;p className=&quot;!text-xs !italic !font-thin&quot;&gt;optional&lt;/p&gt;
            &lt;/label&gt;
          &lt;/div&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;LiteLLMAPIKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;sk-mysecretkey&quot;
            defaultValue={settings?.LiteLLMAPIKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setApiKeyValue(e.target.value)}
            onBlur={() =&gt; setApiKey(apiKeyValue)}
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LiteLLMModelSelection({ settings, basePath = null, apiKey = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;litellm&quot;,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Embedding Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;-- loading available models --&quot;
              : &quot;-- waiting for URL --&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;div className=&quot;flex items-center&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Embedding Model Selection
        &lt;/label&gt;
        &lt;EmbeddingModelTooltip /&gt;
      &lt;/div&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 33:9 - Line 186:2), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 34:9 - Line 185:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn816" onclick="toggleCodeBlock('cloneGroup816', 'expandBtn816', 'collapseBtn816')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn816" onclick="toggleCodeBlock('cloneGroup816', 'expandBtn816', 'collapseBtn816')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup816"><code class="language-javascript text-sm text-gray-800">={settings} basePath={basePath.value} /&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
            Max Embedding Chunk Length
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;EmbeddingModelMaxChunkLength&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;8192&quot;
            min={1}
            value={maxChunkLength}
            onChange={handleMaxChunkLengthChange}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum length of text chunks for embedding.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                LM Studio Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:1234/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
            &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
              Enter the URL where LM Studio is running.
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LMStudioModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(
          &quot;lmstudio&quot;,
          null,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          LM Studio Embedding Model
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter LM Studio URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the LM Studio model for embeddings. Models will load after
          entering a valid LM Studio URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        LM Studio Embedding Model
      &lt;/label&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref === model.id}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/EmbedderItem/index.jsx (Line 11:8 - Line 27:2), frontend/src/components/VectorDBSelection/VectorDBItem/index.jsx (Line 11:8 - Line 27:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn829" onclick="toggleCodeBlock('cloneGroup829', 'expandBtn829', 'collapseBtn829')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn829" onclick="toggleCodeBlock('cloneGroup829', 'expandBtn829', 'collapseBtn829')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup829"><code class="language-javascript text-sm text-gray-800">={() =&gt; onClick(value)}
      className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
        checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
      }`}
    &gt;
      &lt;input
        type=&quot;checkbox&quot;
        value={value}
        className=&quot;peer hidden&quot;
        checked={checked}
        readOnly={true}
        formNoValidate={true}
      /&gt;
      &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
        &lt;img
          src={image}
          alt={`${name} logo`}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/utils/piperTTS/index.js (Line 68:8 - Line 84:6), frontend/src/utils/piperTTS/index.js (Line 43:7 - Line 56:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn838" onclick="toggleCodeBlock('cloneGroup838', 'expandBtn838', 'collapseBtn838')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn838" onclick="toggleCodeBlock('cloneGroup838', 'expandBtn838', 'collapseBtn838')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup838"><code class="language-javascript text-sm text-gray-800">);
        tmpWorker.removeEventListener(&quot;message&quot;, handleMessage);
        timeout &amp;&amp; clearTimeout(timeout);
        tmpWorker.terminate();
      };

      timeout = setTimeout(() =&gt; {
        reject(&quot;TTS Worker timed out.&quot;);
      }, 30_000);
      tmpWorker.addEventListener(&quot;message&quot;, handleMessage);
    });
  }

  /**
   * Runs prediction via webworker so we can get an audio blob back.
   * @returns {Promise&lt;{blobURL: string|null, error: string|null}&gt;} objectURL blob: type.
   */</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/utils/chat/agent.js (Line 59:2 - Line 73:5), frontend/src/utils/chat/agent.js (Line 33:2 - Line 47:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn839" onclick="toggleCodeBlock('cloneGroup839', 'expandBtn839', 'collapseBtn839')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn839" onclick="toggleCodeBlock('cloneGroup839', 'expandBtn839', 'collapseBtn839')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup839"><code class="language-javascript text-sm text-gray-800">
          uuid: v4(),
          content: data.content,
          role: &quot;assistant&quot;,
          sources: [],
          closed: true,
          error: null,
          animate: false,
          pending: false,
        },
      ];
    });
  }

  if (data</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/utils/chat/agent.js (Line 73:13 - Line 83:5), frontend/src/utils/chat/agent.js (Line 29:2 - Line 39:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn840" onclick="toggleCodeBlock('cloneGroup840', 'expandBtn840', 'collapseBtn840')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn840" onclick="toggleCodeBlock('cloneGroup840', 'expandBtn840', 'collapseBtn840')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup840"><code class="language-javascript text-sm text-gray-800">) {
    return setChatHistory((prev) =&gt; {
      return [
        ...prev.filter((msg) =&gt; !!msg.content),
        {
          uuid: v4(),
          content: data.content,
          role: &quot;assistant&quot;,
          sources: [],
          closed: true,
          error: data</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/experimental/agentPlugins.js (Line 47:2 - Line 57:13), frontend/src/models/experimental/liveSync.js (Line 49:2 - Line 59:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn843" onclick="toggleCodeBlock('cloneGroup843', 'expandBtn843', 'collapseBtn843')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn843" onclick="toggleCodeBlock('cloneGroup843', 'expandBtn843', 'collapseBtn843')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup843"><code class="language-javascript text-sm text-gray-800">
        return true;
      })
      .catch((e) =&gt; {
        console.error(e);
        return false;
      });
  },
};

export default AgentPlugins</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/zh/common.js (Line 524:10 - Line 538:10), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn844" onclick="toggleCodeBlock('cloneGroup844', 'expandBtn844', 'collapseBtn844')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn844" onclick="toggleCodeBlock('cloneGroup844', 'expandBtn844', 'collapseBtn844')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup844"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;转录模型首选项&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/zh/common.js (Line 847:15 - Line 890:7), frontend/src/locales/zh_TW/common.js (Line 679:5 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn845" onclick="toggleCodeBlock('cloneGroup845', 'expandBtn845', 'collapseBtn845')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn845" onclick="toggleCodeBlock('cloneGroup845', 'expandBtn845', 'collapseBtn845')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup845"><code class="language-javascript text-sm text-gray-800">,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;编辑帐户&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/zh/common.js (Line 901:7 - Line 911:21), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 742:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn846" onclick="toggleCodeBlock('cloneGroup846', 'expandBtn846', 'collapseBtn846')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn846" onclick="toggleCodeBlock('cloneGroup846', 'expandBtn846', 'collapseBtn846')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup846"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  &quot;keyboard-shortcuts&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/zh/common.js (Line 909:5 - Line 928:1), frontend/src/locales/zh_TW/common.js (Line 910:2 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn847" onclick="toggleCodeBlock('cloneGroup847', 'expandBtn847', 'collapseBtn847')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn847" onclick="toggleCodeBlock('cloneGroup847', 'expandBtn847', 'collapseBtn847')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup847"><code class="language-javascript text-sm text-gray-800">,
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 225:227 - Line 238:30), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn848" onclick="toggleCodeBlock('cloneGroup848', 'expandBtn848', 'collapseBtn848')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn848" onclick="toggleCodeBlock('cloneGroup848', 'expandBtn848', 'collapseBtn848')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup848"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Query mode refusal response&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 366:15 - Line 380:40), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn849" onclick="toggleCodeBlock('cloneGroup849', 'expandBtn849', 'collapseBtn849')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn849" onclick="toggleCodeBlock('cloneGroup849', 'expandBtn849', 'collapseBtn849')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup849"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Chuyển đổi giọng nói Model Preference&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 541:13 - Line 551:8), frontend/src/locales/vn/common.js (Line 517:20 - Line 527:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn850" onclick="toggleCodeBlock('cloneGroup850', 'expandBtn850', 'collapseBtn850')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn850" onclick="toggleCodeBlock('cloneGroup850', 'expandBtn850', 'collapseBtn850')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup850"><code class="language-javascript text-sm text-gray-800">: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 648:5 - Line 663:5), frontend/src/locales/zh_TW/common.js (Line 651:9 - Line 666:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn851" onclick="toggleCodeBlock('cloneGroup851', 'expandBtn851', 'collapseBtn851')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn851" onclick="toggleCodeBlock('cloneGroup851', 'expandBtn851', 'collapseBtn851')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup851"><code class="language-javascript text-sm text-gray-800">,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 675:5 - Line 741:5), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 744:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn852" onclick="toggleCodeBlock('cloneGroup852', 'expandBtn852', 'collapseBtn852')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn852" onclick="toggleCodeBlock('cloneGroup852', 'expandBtn852', 'collapseBtn852')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup852"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/vn/common.js (Line 904:5 - Line 926:1), frontend/src/locales/zh_TW/common.js (Line 907:14 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn853" onclick="toggleCodeBlock('cloneGroup853', 'expandBtn853', 'collapseBtn853')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn853" onclick="toggleCodeBlock('cloneGroup853', 'expandBtn853', 'collapseBtn853')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup853"><code class="language-javascript text-sm text-gray-800">,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/tr/common.js (Line 1:1 - Line 52:23), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn854" onclick="toggleCodeBlock('cloneGroup854', 'expandBtn854', 'collapseBtn854')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn854" onclick="toggleCodeBlock('cloneGroup854', 'expandBtn854', 'collapseBtn854')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup854"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Çalışma Alanları Adı&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/tr/common.js (Line 226:190 - Line 239:24), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn855" onclick="toggleCodeBlock('cloneGroup855', 'expandBtn855', 'collapseBtn855')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn855" onclick="toggleCodeBlock('cloneGroup855', 'expandBtn855', 'collapseBtn855')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup855"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Sorgu Modu Ret Yanıtı&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/tr/common.js (Line 367:18 - Line 381:31), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn856" onclick="toggleCodeBlock('cloneGroup856', 'expandBtn856', 'collapseBtn856')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn856" onclick="toggleCodeBlock('cloneGroup856', 'expandBtn856', 'collapseBtn856')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup856"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Transkripsiyon Model Tercihi&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/tr/common.js (Line 501:25 - Line 927:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn857" onclick="toggleCodeBlock('cloneGroup857', 'expandBtn857', 'collapseBtn857')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn857" onclick="toggleCodeBlock('cloneGroup857', 'expandBtn857', 'collapseBtn857')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup857"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ru/common.js (Line 235:244 - Line 248:35), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn858" onclick="toggleCodeBlock('cloneGroup858', 'expandBtn858', 'collapseBtn858')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn858" onclick="toggleCodeBlock('cloneGroup858', 'expandBtn858', 'collapseBtn858')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup858"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Ответ об отказе в режиме запроса&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ru/common.js (Line 376:16 - Line 390:35), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn859" onclick="toggleCodeBlock('cloneGroup859', 'expandBtn859', 'collapseBtn859')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn859" onclick="toggleCodeBlock('cloneGroup859', 'expandBtn859', 'collapseBtn859')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup859"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Предпочтение модели транскрипции&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ru/common.js (Line 693:16 - Line 708:54), frontend/src/locales/zh_TW/common.js (Line 651:9 - Line 666:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn860" onclick="toggleCodeBlock('cloneGroup860', 'expandBtn860', 'collapseBtn860')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn860" onclick="toggleCodeBlock('cloneGroup860', 'expandBtn860', 'collapseBtn860')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup860"><code class="language-javascript text-sm text-gray-800">,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: &quot;Добро пожаловать в ваше новое рабочее пространство.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ru/common.js (Line 720:42 - Line 764:31), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn861" onclick="toggleCodeBlock('cloneGroup861', 'expandBtn861', 'collapseBtn861')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn861" onclick="toggleCodeBlock('cloneGroup861', 'expandBtn861', 'collapseBtn861')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup861"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;Редактировать учётную запись&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ru/common.js (Line 775:22 - Line 972:1), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn862" onclick="toggleCodeBlock('cloneGroup862', 'expandBtn862', 'collapseBtn862')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn862" onclick="toggleCodeBlock('cloneGroup862', 'expandBtn862', 'collapseBtn862')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup862"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/pt_BR/common.js (Line 546:18 - Line 560:29), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn863" onclick="toggleCodeBlock('cloneGroup863', 'expandBtn863', 'collapseBtn863')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn863" onclick="toggleCodeBlock('cloneGroup863', 'expandBtn863', 'collapseBtn863')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup863"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Preferência de Transcrição&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/pt_BR/common.js (Line 737:32 - Line 750:8), frontend/src/locales/pt_BR/common.js (Line 708:21 - Line 721:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn864" onclick="toggleCodeBlock('cloneGroup864', 'expandBtn864', 'collapseBtn864')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn864" onclick="toggleCodeBlock('cloneGroup864', 'expandBtn864', 'collapseBtn864')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup864"><code class="language-javascript text-sm text-gray-800">,
      ignores: &quot;Arquivos Ignorados&quot;,
      git_ignore:
        &quot;Liste no formato .gitignore para ignorar arquivos específicos. Pressione enter após cada entrada.&quot;,
      task_explained:
        &quot;Após conclusão, todos os arquivos estarão disponíveis para vínculo.&quot;,
      branch: &quot;Branch&quot;,
      branch_loading: &quot;-- carregando branches --&quot;,
      branch_explained: &quot;Branch para coletar arquivos.&quot;,
      token_information:
        &quot;Sem preencher o &lt;b&gt;Token de Acesso&lt;/b&gt;, este conector só poderá coletar arquivos &lt;b&gt;do nível superior&lt;/b&gt; devido a limitações da API pública.&quot;,
      token_personal: &quot;Obtenha um Token de Acesso Pessoal gratuito aqui.&quot;,
    },
    youtube</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/pt_BR/common.js (Line 918:9 - Line 931:15), frontend/src/locales/zh_TW/common.js (Line 709:5 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn865" onclick="toggleCodeBlock('cloneGroup865', 'expandBtn865', 'collapseBtn865')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn865" onclick="toggleCodeBlock('cloneGroup865', 'expandBtn865', 'collapseBtn865')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup865"><code class="language-javascript text-sm text-gray-800">,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;Editar conta&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/pt_BR/common.js (Line 942:19 - Line 953:21), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 912:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn866" onclick="toggleCodeBlock('cloneGroup866', 'expandBtn866', 'collapseBtn866')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn866" onclick="toggleCodeBlock('cloneGroup866', 'expandBtn866', 'collapseBtn866')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup866"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  &quot;keyboard-shortcuts&quot;: {
    title: &quot;Atalhos de Teclado&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/nl/common.js (Line 1:1 - Line 52:19), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn867" onclick="toggleCodeBlock('cloneGroup867', 'expandBtn867', 'collapseBtn867')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn867" onclick="toggleCodeBlock('cloneGroup867', 'expandBtn867', 'collapseBtn867')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup867"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Werkruimten Naam&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/nl/common.js (Line 226:246 - Line 239:34), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn868" onclick="toggleCodeBlock('cloneGroup868', 'expandBtn868', 'collapseBtn868')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn868" onclick="toggleCodeBlock('cloneGroup868', 'expandBtn868', 'collapseBtn868')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup868"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Afwijzingsreactie in Querymodus&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/nl/common.js (Line 366:194 - Line 381:29), frontend/src/locales/vn/common.js (Line 365:188 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn869" onclick="toggleCodeBlock('cloneGroup869', 'expandBtn869', 'collapseBtn869')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn869" onclick="toggleCodeBlock('cloneGroup869', 'expandBtn869', 'collapseBtn869')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup869"><code class="language-javascript text-sm text-gray-800">,
    provider: &quot;LLM Provider&quot;,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Transcriptiemodel Voorkeur&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/nl/common.js (Line 501:35 - Line 927:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn870" onclick="toggleCodeBlock('cloneGroup870', 'expandBtn870', 'collapseBtn870')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn870" onclick="toggleCodeBlock('cloneGroup870', 'expandBtn870', 'collapseBtn870')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup870"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/lv/common.js (Line 558:28 - Line 572:36), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn871" onclick="toggleCodeBlock('cloneGroup871', 'expandBtn871', 'collapseBtn871')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn871" onclick="toggleCodeBlock('cloneGroup871', 'expandBtn871', 'collapseBtn871')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup871"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Transkripcijas modeļa preferences&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/lv/common.js (Line 906:43 - Line 950:16), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn872" onclick="toggleCodeBlock('cloneGroup872', 'expandBtn872', 'collapseBtn872')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn872" onclick="toggleCodeBlock('cloneGroup872', 'expandBtn872', 'collapseBtn872')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup872"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;Rediģēt kontu&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/lv/common.js (Line 961:16 - Line 988:1), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn873" onclick="toggleCodeBlock('cloneGroup873', 'expandBtn873', 'collapseBtn873')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn873" onclick="toggleCodeBlock('cloneGroup873', 'expandBtn873', 'collapseBtn873')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup873"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ko/common.js (Line 1:1 - Line 52:12), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn874" onclick="toggleCodeBlock('cloneGroup874', 'expandBtn874', 'collapseBtn874')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn874" onclick="toggleCodeBlock('cloneGroup874', 'expandBtn874', 'collapseBtn874')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup874"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;워크스페이스 이름&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ko/common.js (Line 222:108 - Line 235:18), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn875" onclick="toggleCodeBlock('cloneGroup875', 'expandBtn875', 'collapseBtn875')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn875" onclick="toggleCodeBlock('cloneGroup875', 'expandBtn875', 'collapseBtn875')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup875"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;쿼리 모드 거부 응답 메시지&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ko/common.js (Line 361:10 - Line 375:18), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn876" onclick="toggleCodeBlock('cloneGroup876', 'expandBtn876', 'collapseBtn876')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn876" onclick="toggleCodeBlock('cloneGroup876', 'expandBtn876', 'collapseBtn876')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup876"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;텍스트 변환 모델 기본 설정&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ko/common.js (Line 491:15 - Line 917:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn877" onclick="toggleCodeBlock('cloneGroup877', 'expandBtn877', 'collapseBtn877')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn877" onclick="toggleCodeBlock('cloneGroup877', 'expandBtn877', 'collapseBtn877')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup877"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 233:61 - Line 246:13), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn878" onclick="toggleCodeBlock('cloneGroup878', 'expandBtn878', 'collapseBtn878')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn878" onclick="toggleCodeBlock('cloneGroup878', 'expandBtn878', 'collapseBtn878')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup878"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;クエリモード拒否応答&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 373:12 - Line 387:14), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn879" onclick="toggleCodeBlock('cloneGroup879', 'expandBtn879', 'collapseBtn879')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn879" onclick="toggleCodeBlock('cloneGroup879', 'expandBtn879', 'collapseBtn879')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup879"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;文字起こしモデルの設定&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 553:20 - Line 563:81), frontend/src/locales/ja/common.js (Line 523:17 - Line 533:81)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn880" onclick="toggleCodeBlock('cloneGroup880', 'expandBtn880', 'collapseBtn880')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn880" onclick="toggleCodeBlock('cloneGroup880', 'expandBtn880', 'collapseBtn880')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup880"><code class="language-javascript text-sm text-gray-800">,
      ignores: &quot;無視するファイル&quot;,
      git_ignore:
        &quot;.gitignore形式で収集時に無視したいファイルをリストしてください。エンターキーで各エントリを保存します。&quot;,
      task_explained:
        &quot;完了後、すべてのファイルがドキュメントピッカーからワークスペースに埋め込めるようになります。&quot;,
      branch: &quot;収集したいブランチ&quot;,
      branch_loading: &quot;-- 利用可能なブランチを読み込み中 --&quot;,
      branch_explained: &quot;収集したいブランチを指定します。&quot;,
      token_information:
        &quot;&lt;b&gt;GitLabアクセストークン&lt;/b&gt;を入力しない場合、GitLabの公開APIのレート制限により&lt;b&gt;トップレベル&lt;/b&gt;のファイルのみ収集可能です。&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 684:9 - Line 699:19), frontend/src/locales/zh_TW/common.js (Line 651:9 - Line 666:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn881" onclick="toggleCodeBlock('cloneGroup881', 'expandBtn881', 'collapseBtn881')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn881" onclick="toggleCodeBlock('cloneGroup881', 'expandBtn881', 'collapseBtn881')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup881"><code class="language-javascript text-sm text-gray-800">,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: &quot;新しいワークスペースへようこそ。&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 711:24 - Line 755:11), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn882" onclick="toggleCodeBlock('cloneGroup882', 'expandBtn882', 'collapseBtn882')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn882" onclick="toggleCodeBlock('cloneGroup882', 'expandBtn882', 'collapseBtn882')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup882"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;アカウントを編集&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 766:7 - Line 867:1), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 829:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn883" onclick="toggleCodeBlock('cloneGroup883', 'expandBtn883', 'collapseBtn883')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn883" onclick="toggleCodeBlock('cloneGroup883', 'expandBtn883', 'collapseBtn883')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup883"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError:
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ja/common.js (Line 944:13 - Line 966:1), frontend/src/locales/zh_TW/common.js (Line 907:14 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn884" onclick="toggleCodeBlock('cloneGroup884', 'expandBtn884', 'collapseBtn884')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn884" onclick="toggleCodeBlock('cloneGroup884', 'expandBtn884', 'collapseBtn884')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup884"><code class="language-javascript text-sm text-gray-800">,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/it/common.js (Line 1:1 - Line 52:28), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn885" onclick="toggleCodeBlock('cloneGroup885', 'expandBtn885', 'collapseBtn885')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn885" onclick="toggleCodeBlock('cloneGroup885', 'expandBtn885', 'collapseBtn885')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup885"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Nome delle aree di lavoro&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/it/common.js (Line 227:245 - Line 240:46), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn886" onclick="toggleCodeBlock('cloneGroup886', 'expandBtn886', 'collapseBtn886')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn886" onclick="toggleCodeBlock('cloneGroup886', 'expandBtn886', 'collapseBtn886')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup886"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Risposta al rifiuto nella modalità di query&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/it/common.js (Line 370:15 - Line 384:41), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn887" onclick="toggleCodeBlock('cloneGroup887', 'expandBtn887', 'collapseBtn887')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn887" onclick="toggleCodeBlock('cloneGroup887', 'expandBtn887', 'collapseBtn887')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup887"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Preferenza del modello di trascrizione&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/it/common.js (Line 504:31 - Line 930:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn888" onclick="toggleCodeBlock('cloneGroup888', 'expandBtn888', 'collapseBtn888')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn888" onclick="toggleCodeBlock('cloneGroup888', 'expandBtn888', 'collapseBtn888')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup888"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/he/common.js (Line 1:1 - Line 52:18), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn889" onclick="toggleCodeBlock('cloneGroup889', 'expandBtn889', 'collapseBtn889')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn889" onclick="toggleCodeBlock('cloneGroup889', 'expandBtn889', 'collapseBtn889')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup889"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;שם סביבת העבודה&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/he/common.js (Line 222:167 - Line 235:26), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn890" onclick="toggleCodeBlock('cloneGroup890', 'expandBtn890', 'collapseBtn890')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn890" onclick="toggleCodeBlock('cloneGroup890', 'expandBtn890', 'collapseBtn890')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup890"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;תגובת סירוב במצב שאילתה&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/he/common.js (Line 361:10 - Line 375:18), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn891" onclick="toggleCodeBlock('cloneGroup891', 'expandBtn891', 'collapseBtn891')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn891" onclick="toggleCodeBlock('cloneGroup891', 'expandBtn891', 'collapseBtn891')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup891"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;העדפת דגם תמלול&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/he/common.js (Line 491:26 - Line 917:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn892" onclick="toggleCodeBlock('cloneGroup892', 'expandBtn892', 'collapseBtn892')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn892" onclick="toggleCodeBlock('cloneGroup892', 'expandBtn892', 'collapseBtn892')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup892"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fr/common.js (Line 1:1 - Line 52:29), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn893" onclick="toggleCodeBlock('cloneGroup893', 'expandBtn893', 'collapseBtn893')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn893" onclick="toggleCodeBlock('cloneGroup893', 'expandBtn893', 'collapseBtn893')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup893"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Nom des espaces de travail&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fr/common.js (Line 229:248 - Line 242:35), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn894" onclick="toggleCodeBlock('cloneGroup894', 'expandBtn894', 'collapseBtn894')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn894" onclick="toggleCodeBlock('cloneGroup894', 'expandBtn894', 'collapseBtn894')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup894"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Réponse de refus en mode requête&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fr/common.js (Line 372:18 - Line 386:40), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn895" onclick="toggleCodeBlock('cloneGroup895', 'expandBtn895', 'collapseBtn895')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn895" onclick="toggleCodeBlock('cloneGroup895', 'expandBtn895', 'collapseBtn895')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup895"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Préférence du modèle de transcription&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fr/common.js (Line 506:29 - Line 932:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn896" onclick="toggleCodeBlock('cloneGroup896', 'expandBtn896', 'collapseBtn896')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn896" onclick="toggleCodeBlock('cloneGroup896', 'expandBtn896', 'collapseBtn896')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup896"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fa/common.js (Line 1:1 - Line 52:15), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn897" onclick="toggleCodeBlock('cloneGroup897', 'expandBtn897', 'collapseBtn897')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn897" onclick="toggleCodeBlock('cloneGroup897', 'expandBtn897', 'collapseBtn897')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup897"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;نام فضای کار&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fa/common.js (Line 224:201 - Line 237:26), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn898" onclick="toggleCodeBlock('cloneGroup898', 'expandBtn898', 'collapseBtn898')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn898" onclick="toggleCodeBlock('cloneGroup898', 'expandBtn898', 'collapseBtn898')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup898"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;پاسخ رد در حالت پرس‌وجو&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fa/common.js (Line 365:24 - Line 379:22), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn899" onclick="toggleCodeBlock('cloneGroup899', 'expandBtn899', 'collapseBtn899')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn899" onclick="toggleCodeBlock('cloneGroup899', 'expandBtn899', 'collapseBtn899')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup899"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;ترجیحات مدل رونویسی&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/fa/common.js (Line 498:33 - Line 924:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn900" onclick="toggleCodeBlock('cloneGroup900', 'expandBtn900', 'collapseBtn900')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn900" onclick="toggleCodeBlock('cloneGroup900', 'expandBtn900', 'collapseBtn900')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup900"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/es/common.js (Line 1:1 - Line 52:32), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn901" onclick="toggleCodeBlock('cloneGroup901', 'expandBtn901', 'collapseBtn901')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn901" onclick="toggleCodeBlock('cloneGroup901', 'expandBtn901', 'collapseBtn901')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup901"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Nombre de espacios de trabajo&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/es/common.js (Line 228:251 - Line 241:40), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn902" onclick="toggleCodeBlock('cloneGroup902', 'expandBtn902', 'collapseBtn902')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn902" onclick="toggleCodeBlock('cloneGroup902', 'expandBtn902', 'collapseBtn902')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup902"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Respuesta de rechazo en modo consulta&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/es/common.js (Line 371:19 - Line 385:41), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn903" onclick="toggleCodeBlock('cloneGroup903', 'expandBtn903', 'collapseBtn903')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn903" onclick="toggleCodeBlock('cloneGroup903', 'expandBtn903', 'collapseBtn903')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup903"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Preferencia de modelo de transcripción&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/es/common.js (Line 505:32 - Line 835:66), frontend/src/locales/vn/common.js (Line 500:30 - Line 867:31)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn904" onclick="toggleCodeBlock('cloneGroup904', 'expandBtn904', 'collapseBtn904')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn904" onclick="toggleCodeBlock('cloneGroup904', 'expandBtn904', 'collapseBtn904')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup904"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError:
      &quot;Por favor, crea un espacio de trabajo antes de iniciar un chat.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/es/common.js (Line 914:21 - Line 936:1), frontend/src/locales/zh_TW/common.js (Line 907:14 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn905" onclick="toggleCodeBlock('cloneGroup905', 'expandBtn905', 'collapseBtn905')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn905" onclick="toggleCodeBlock('cloneGroup905', 'expandBtn905', 'collapseBtn905')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup905"><code class="language-javascript text-sm text-gray-800">,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 1:1 - Line 52:27), frontend/src/locales/vn/common.js (Line 1:1 - Line 52:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn906" onclick="toggleCodeBlock('cloneGroup906', 'expandBtn906', 'collapseBtn906')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn906" onclick="toggleCodeBlock('cloneGroup906', 'expandBtn906', 'collapseBtn906')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup906"><code class="language-javascript text-sm text-gray-800">// Anything with &quot;null&quot; requires a translation. Contribute to translation via a PR!
const TRANSLATIONS = {
  onboarding: {
    survey: {
      email: null,
      useCase: null,
      useCaseWork: null,
      useCasePersonal: null,
      useCaseOther: null,
      comment: null,
      commentPlaceholder: null,
      skip: null,
      thankYou: null,
      title: null,
      description: null,
    },
    home: {
      title: null,
      getStarted: null,
    },
    llm: {
      title: null,
      description: null,
    },
    userSetup: {
      title: null,
      description: null,
      howManyUsers: null,
      justMe: null,
      myTeam: null,
      instancePassword: null,
      setPassword: null,
      passwordReq: null,
      passwordWarn: null,
      adminUsername: null,
      adminUsernameReq: null,
      adminPassword: null,
      adminPasswordReq: null,
      teamHint: null,
    },
    data: {
      title: null,
      description: null,
      settingsHint: null,
    },
    workspace: {
      title: null,
      description: null,
    },
  },
  common: {
    &quot;workspaces-name&quot;: &quot;Name der Arbeitsbereiche&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 226:277 - Line 239:33), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn907" onclick="toggleCodeBlock('cloneGroup907', 'expandBtn907', 'collapseBtn907')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn907" onclick="toggleCodeBlock('cloneGroup907', 'expandBtn907', 'collapseBtn907')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup907"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Abfragemodus-Ablehnungsantwort&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 368:15 - Line 382:33), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn908" onclick="toggleCodeBlock('cloneGroup908', 'expandBtn908', 'collapseBtn908')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn908" onclick="toggleCodeBlock('cloneGroup908', 'expandBtn908', 'collapseBtn908')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup908"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Transkriptionsmodell-Präferenz&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 690:38 - Line 705:39), frontend/src/locales/zh_TW/common.js (Line 651:9 - Line 666:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn909" onclick="toggleCodeBlock('cloneGroup909', 'expandBtn909', 'collapseBtn909')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn909" onclick="toggleCodeBlock('cloneGroup909', 'expandBtn909', 'collapseBtn909')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup909"><code class="language-javascript text-sm text-gray-800">,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: &quot;Willkommen zu deinem Arbeitsbereich.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 717:45 - Line 761:21), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn910" onclick="toggleCodeBlock('cloneGroup910', 'expandBtn910', 'collapseBtn910')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn910" onclick="toggleCodeBlock('cloneGroup910', 'expandBtn910', 'collapseBtn910')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup910"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;Account bearbeiten&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 772:21 - Line 873:75), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 867:31)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn911" onclick="toggleCodeBlock('cloneGroup911', 'expandBtn911', 'collapseBtn911')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn911" onclick="toggleCodeBlock('cloneGroup911', 'expandBtn911', 'collapseBtn911')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup911"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError:
      &quot;Bitte erstellen Sie einen Arbeitsbereich, bevor Sie einen Chat beginnen.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/de/common.js (Line 954:32 - Line 976:1), frontend/src/locales/zh_TW/common.js (Line 907:14 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn912" onclick="toggleCodeBlock('cloneGroup912', 'expandBtn912', 'collapseBtn912')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn912" onclick="toggleCodeBlock('cloneGroup912', 'expandBtn912', 'collapseBtn912')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup912"><code class="language-javascript text-sm text-gray-800">,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/da/common.js (Line 234:226 - Line 247:44), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn913" onclick="toggleCodeBlock('cloneGroup913', 'expandBtn913', 'collapseBtn913')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn913" onclick="toggleCodeBlock('cloneGroup913', 'expandBtn913', 'collapseBtn913')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup913"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;Afvisningssvar for forespørgsels-tilstand&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/da/common.js (Line 375:14 - Line 389:35), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn914" onclick="toggleCodeBlock('cloneGroup914', 'expandBtn914', 'collapseBtn914')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn914" onclick="toggleCodeBlock('cloneGroup914', 'expandBtn914', 'collapseBtn914')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup914"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;Foretrukken transskriptionsmodel&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/da/common.js (Line 692:25 - Line 707:39), frontend/src/locales/zh_TW/common.js (Line 651:9 - Line 666:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn915" onclick="toggleCodeBlock('cloneGroup915', 'expandBtn915', 'collapseBtn915')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn915" onclick="toggleCodeBlock('cloneGroup915', 'expandBtn915', 'collapseBtn915')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup915"><code class="language-javascript text-sm text-gray-800">,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: &quot;Velkommen til dit nye arbejdsområde.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/da/common.js (Line 719:39 - Line 763:16), frontend/src/locales/zh_TW/common.js (Line 678:14 - Line 722:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn916" onclick="toggleCodeBlock('cloneGroup916', 'expandBtn916', 'collapseBtn916')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn916" onclick="toggleCodeBlock('cloneGroup916', 'expandBtn916', 'collapseBtn916')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup916"><code class="language-javascript text-sm text-gray-800">,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: &quot;Rediger konto&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/da/common.js (Line 774:20 - Line 971:1), frontend/src/locales/zh_TW/common.js (Line 732:5 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn917" onclick="toggleCodeBlock('cloneGroup917', 'expandBtn917', 'collapseBtn917')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn917" onclick="toggleCodeBlock('cloneGroup917', 'expandBtn917', 'collapseBtn917')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup917"><code class="language-javascript text-sm text-gray-800">,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ar/common.js (Line 233:190 - Line 246:31), frontend/src/locales/zh_TW/common.js (Line 223:68 - Line 236:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn918" onclick="toggleCodeBlock('cloneGroup918', 'expandBtn918', 'collapseBtn918')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn918" onclick="toggleCodeBlock('cloneGroup918', 'expandBtn918', 'collapseBtn918')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup918"><code class="language-javascript text-sm text-gray-800">,
      history: {
        title: null,
        clearAll: null,
        noHistory: null,
        restore: null,
        delete: null,
        deleteConfirm: null,
        clearAllConfirm: null,
        expand: null,
      },
    },
    refusal: {
      title: &quot;الرد على رفض وضعية الاستعلام&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ar/common.js (Line 373:27 - Line 387:20), frontend/src/locales/zh_TW/common.js (Line 356:10 - Line 370:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn919" onclick="toggleCodeBlock('cloneGroup919', 'expandBtn919', 'collapseBtn919')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn919" onclick="toggleCodeBlock('cloneGroup919', 'expandBtn919', 'collapseBtn919')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup919"><code class="language-javascript text-sm text-gray-800">,
    providers: {
      azure_openai: {
        azure_service_endpoint: null,
        api_key: null,
        chat_deployment_name: null,
        chat_model_token_limit: null,
        model_type: null,
        default: null,
        reasoning: null,
      },
    },
  },
  transcription: {
    title: &quot;تفضيل نموذج النسخ&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/ar/common.js (Line 506:34 - Line 932:1), frontend/src/locales/vn/common.js (Line 500:30 - Line 929:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn920" onclick="toggleCodeBlock('cloneGroup920', 'expandBtn920', 'collapseBtn920')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn920" onclick="toggleCodeBlock('cloneGroup920', 'expandBtn920', 'collapseBtn920')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup920"><code class="language-javascript text-sm text-gray-800">,
  },
  connectors: {
    &quot;search-placeholder&quot;: null,
    &quot;no-connectors&quot;: null,
    github: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    gitlab: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      token: null,
      optional: null,
      token_explained: null,
      token_description: null,
      token_explained_start: null,
      token_explained_link1: null,
      token_explained_middle: null,
      token_explained_link2: null,
      token_explained_end: null,
      fetch_issues: null,
      ignores: null,
      git_ignore: null,
      task_explained: null,
      branch: null,
      branch_loading: null,
      branch_explained: null,
      token_information: null,
      token_personal: null,
    },
    youtube: {
      name: null,
      description: null,
      URL: null,
      URL_explained_start: null,
      URL_explained_link: null,
      URL_explained_end: null,
      task_explained: null,
      language: null,
      language_explained: null,
      loading_languages: null,
    },
    &quot;website-depth&quot;: {
      name: null,
      description: null,
      URL: null,
      URL_explained: null,
      depth: null,
      depth_explained: null,
      max_pages: null,
      max_pages_explained: null,
      task_explained: null,
    },
    confluence: {
      name: null,
      description: null,
      deployment_type: null,
      deployment_type_explained: null,
      base_url: null,
      base_url_explained: null,
      space_key: null,
      space_key_explained: null,
      username: null,
      username_explained: null,
      auth_type: null,
      auth_type_explained: null,
      auth_type_username: null,
      auth_type_personal: null,
      token: null,
      token_explained_start: null,
      token_explained_link: null,
      token_desc: null,
      pat_token: null,
      pat_token_explained: null,
      task_explained: null,
    },
    manage: {
      documents: null,
      &quot;data-connectors&quot;: null,
      &quot;desktop-only&quot;: null,
      dismiss: null,
      editing: null,
    },
    directory: {
      &quot;my-documents&quot;: null,
      &quot;new-folder&quot;: null,
      &quot;search-document&quot;: null,
      &quot;no-documents&quot;: null,
      &quot;move-workspace&quot;: null,
      name: null,
      &quot;delete-confirmation&quot;: null,
      &quot;removing-message&quot;: null,
      &quot;move-success&quot;: null,
      date: null,
      type: null,
      no_docs: null,
      select_all: null,
      deselect_all: null,
      remove_selected: null,
      costs: null,
      save_embed: null,
    },
    upload: {
      &quot;processor-offline&quot;: null,
      &quot;processor-offline-desc&quot;: null,
      &quot;click-upload&quot;: null,
      &quot;file-types&quot;: null,
      &quot;or-submit-link&quot;: null,
      &quot;placeholder-link&quot;: null,
      fetching: null,
      &quot;fetch-website&quot;: null,
      &quot;privacy-notice&quot;: null,
    },
    pinning: {
      what_pinning: null,
      pin_explained_block1: null,
      pin_explained_block2: null,
      pin_explained_block3: null,
      accept: null,
    },
    watching: {
      what_watching: null,
      watch_explained_block1: null,
      watch_explained_block2: null,
      watch_explained_block3_start: null,
      watch_explained_block3_link: null,
      watch_explained_block3_end: null,
      accept: null,
    },
    obsidian: {
      name: null,
      description: null,
      vault_location: null,
      vault_description: null,
      selected_files: null,
      importing: null,
      import_vault: null,
      processing_time: null,
      vault_warning: null,
    },
  },
  chat_window: {
    welcome: null,
    get_started: null,
    get_started_default: null,
    upload: null,
    or: null,
    send_chat: null,
    send_message: null,
    attach_file: null,
    slash: null,
    agents: null,
    text_size: null,
    microphone: null,
    send: null,
    attachments_processing: null,
    tts_speak_message: null,
    copy: null,
    regenerate: null,
    regenerate_response: null,
    good_response: null,
    more_actions: null,
    hide_citations: null,
    show_citations: null,
    pause_tts_speech_message: null,
    fork: null,
    delete: null,
    save_submit: null,
    cancel: null,
    edit_prompt: null,
    edit_response: null,
    at_agent: null,
    default_agent_description: null,
    custom_agents_coming_soon: null,
    slash_reset: null,
    preset_reset_description: null,
    add_new_preset: null,
    command: null,
    your_command: null,
    placeholder_prompt: null,
    description: null,
    placeholder_description: null,
    save: null,
    small: null,
    normal: null,
    large: null,
    workspace_llm_manager: {
      search: null,
      loading_workspace_settings: null,
      available_models: null,
      available_models_description: null,
      save: null,
      saving: null,
      missing_credentials: null,
      missing_credentials_description: null,
    },
  },
  profile_settings: {
    edit_account: null,
    profile_picture: null,
    remove_profile_picture: null,
    username: null,
    username_description: null,
    new_password: null,
    passwort_description: null,
    cancel: null,
    update_account: null,
    theme: null,
    language: null,
    failed_upload: null,
    upload_success: null,
    failed_remove: null,
    profile_updated: null,
    failed_update_user: null,
    account: null,
    support: null,
    signout: null,
  },
  customization: {
    interface: {
      title: null,
      description: null,
    },
    branding: {
      title: null,
      description: null,
    },
    chat: {
      title: null,
      description: null,
      auto_submit: {
        title: null,
        description: null,
      },
      auto_speak: {
        title: null,
        description: null,
      },
      spellcheck: {
        title: null,
        description: null,
      },
    },
    items: {
      theme: {
        title: null,
        description: null,
      },
      &quot;show-scrollbar&quot;: {
        title: null,
        description: null,
      },
      &quot;support-email&quot;: {
        title: null,
        description: null,
      },
      &quot;app-name&quot;: {
        title: null,
        description: null,
      },
      &quot;chat-message-alignment&quot;: {
        title: null,
        description: null,
      },
      &quot;display-language&quot;: {
        title: null,
        description: null,
      },
      logo: {
        title: null,
        description: null,
        add: null,
        recommended: null,
        remove: null,
        replace: null,
      },
      &quot;welcome-messages&quot;: {
        title: null,
        description: null,
        new: null,
        system: null,
        user: null,
        message: null,
        assistant: null,
        &quot;double-click&quot;: null,
        save: null,
      },
      &quot;browser-appearance&quot;: {
        title: null,
        description: null,
        tab: {
          title: null,
          description: null,
        },
        favicon: {
          title: null,
          description: null,
        },
      },
      &quot;sidebar-footer&quot;: {
        title: null,
        description: null,
        icon: null,
        link: null,
      },
    },
  },
  &quot;main-page&quot;: {
    noWorkspaceError: null,
    checklist: {
      title: null,
      tasksLeft: null,
      completed: null,
      dismiss: null,
      tasks: {
        create_workspace: {
          title: null,
          description: null,
          action: null,
        },
        send_chat: {
          title: null,
          description: null,
          action: null,
        },
        embed_document: {
          title: null,
          description: null,
          action: null,
        },
        setup_system_prompt: {
          title: null,
          description: null,
          action: null,
        },
        define_slash_command: {
          title: null,
          description: null,
          action: null,
        },
        visit_community: {
          title: null,
          description: null,
          action: null,
        },
      },
    },
    quickLinks: {
      title: null,
      sendChat: null,
      embedDocument: null,
      createWorkspace: null,
    },
    exploreMore: {
      title: null,
      features: {
        customAgents: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        slashCommands: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
        systemPrompts: {
          title: null,
          description: null,
          primaryAction: null,
          secondaryAction: null,
        },
      },
    },
    announcements: {
      title: null,
    },
    resources: {
      title: null,
      links: {
        docs: null,
        star: null,
      },
      keyboardShortcuts: null,
    },
  },
  &quot;keyboard-shortcuts&quot;: {
    title: null,
    shortcuts: {
      settings: null,
      workspaceSettings: null,
      home: null,
      workspaces: null,
      apiKeys: null,
      llmPreferences: null,
      chatSettings: null,
      help: null,
      showLLMSelector: null,
    },
  },
};

export default TRANSLATIONS;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/utils/keyboardShortcuts.js (Line 55:3 - Line 65:16), frontend/src/utils/keyboardShortcuts.js (Line 45:16 - Line 55:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn930" onclick="toggleCodeBlock('cloneGroup930', 'expandBtn930', 'collapseBtn930')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn930" onclick="toggleCodeBlock('cloneGroup930', 'expandBtn930', 'collapseBtn930')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup930"><code class="language-javascript text-sm text-gray-800">: {
    translationKey: &quot;help&quot;,
    action: () =&gt; {
      window.dispatchEvent(
        new CustomEvent(KEYBOARD_SHORTCUTS_HELP_EVENT, {
          detail: { show: true },
        })
      );
    },
  },
  &quot;⌘ + Shift + L&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 45:67 - Line 56:12), frontend/src/models/workspaceThread.js (Line 12:2 - Line 24:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn931" onclick="toggleCodeBlock('cloneGroup931', 'expandBtn931', 'collapseBtn931')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn931" onclick="toggleCodeBlock('cloneGroup931', 'expandBtn931', 'collapseBtn931')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup931"><code class="language-javascript text-sm text-gray-800">
        headers: baseHeaders(),
      }
    )
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        return { workspace: null, message: e.message };
      });

    return { workspace, message };
  },
  chatHistory</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 85:2 - Line 95:18), frontend/src/models/workspaceThread.js (Line 179:5 - Line 189:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn932" onclick="toggleCodeBlock('cloneGroup932', 'expandBtn932', 'collapseBtn932')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn932" onclick="toggleCodeBlock('cloneGroup932', 'expandBtn932', 'collapseBtn932')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup932"><code class="language-javascript text-sm text-gray-800">)
      .then((res) =&gt; {
        if (res.ok) return true;
        throw new Error(&quot;Failed to delete chats.&quot;);
      })
      .catch((e) =&gt; {
        console.log(e);
        return false;
      });
  },
  deleteEditedChats</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 136:2 - Line 148:2), frontend/src/models/workspaceThread.js (Line 95:3 - Line 108:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn933" onclick="toggleCodeBlock('cloneGroup933', 'expandBtn933', 'collapseBtn933')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn933" onclick="toggleCodeBlock('cloneGroup933', 'expandBtn933', 'collapseBtn933')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup933"><code class="language-javascript text-sm text-gray-800">) {
    const ctrl = new AbortController();

    // Listen for the ABORT_STREAM_EVENT key to be emitted by the client
    // to early abort the streaming response. On abort we send a special `stopGeneration`
    // event to be handled which resets the UI for us to be able to send another message.
    // The backend response abort handling is done in each LLM's handleStreamResponse.
    window.addEventListener(ABORT_STREAM_EVENT, () =&gt; {
      ctrl.abort();
      handleChat({ id: v4(), type: &quot;stopGeneration&quot; });
    });

    await fetchEventSource(`</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 308:41 - Line 318:3), frontend/src/models/experimental/liveSync.js (Line 47:43 - Line 57:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn934" onclick="toggleCodeBlock('cloneGroup934', 'expandBtn934', 'collapseBtn934')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn934" onclick="toggleCodeBlock('cloneGroup934', 'expandBtn934', 'collapseBtn934')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup934"><code class="language-javascript text-sm text-gray-800">
          );
        }
        return true;
      })
      .catch((e) =&gt; {
        console.error(e);
        return false;
      });
  },
  </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 385:2 - Line 395:3), frontend/src/models/workspaceThread.js (Line 202:5 - Line 212:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn935" onclick="toggleCodeBlock('cloneGroup935', 'expandBtn935', 'collapseBtn935')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn935" onclick="toggleCodeBlock('cloneGroup935', 'expandBtn935', 'collapseBtn935')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup935"><code class="language-javascript text-sm text-gray-800">)
      .then((res) =&gt; {
        if (res.ok) return true;
        throw new Error(&quot;Failed to update chat.&quot;);
      })
      .catch((e) =&gt; {
        console.log(e);
        return false;
      });
  },
  </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/workspace.js (Line 399:11 - Line 410:11), frontend/src/models/workspace.js (Line 84:8 - Line 189:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn936" onclick="toggleCodeBlock('cloneGroup936', 'expandBtn936', 'collapseBtn936')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn936" onclick="toggleCodeBlock('cloneGroup936', 'expandBtn936', 'collapseBtn936')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup936"><code class="language-javascript text-sm text-gray-800"> }),
    })
      .then((res) =&gt; {
        if (res.ok) return true;
        throw new Error(&quot;Failed to delete chats.&quot;);
      })
      .catch((e) =&gt; {
        console.log(e);
        return false;
      });
  },
  deleteChat</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 112:28 - Line 122:1), frontend/src/models/system.js (Line 94:28 - Line 299:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn937" onclick="toggleCodeBlock('cloneGroup937', 'expandBtn937', 'collapseBtn937')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn937" onclick="toggleCodeBlock('cloneGroup937', 'expandBtn937', 'collapseBtn937')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup937"><code class="language-javascript text-sm text-gray-800">);
        }
        return data;
      })
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },

</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 150:25 - Line 161:15), frontend/src/models/system.js (Line 138:20 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn938" onclick="toggleCodeBlock('cloneGroup938', 'expandBtn938', 'collapseBtn938')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn938" onclick="toggleCodeBlock('cloneGroup938', 'expandBtn938', 'collapseBtn938')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup938"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  setupMultiUser</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 162:27 - Line 173:16), frontend/src/models/system.js (Line 138:20 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn939" onclick="toggleCodeBlock('cloneGroup939', 'expandBtn939', 'collapseBtn939')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn939" onclick="toggleCodeBlock('cloneGroup939', 'expandBtn939', 'collapseBtn939')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup939"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  isMultiUserMode</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 210:23 - Line 221:10), frontend/src/models/system.js (Line 186:25 - Line 197:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn940" onclick="toggleCodeBlock('cloneGroup940', 'expandBtn940', 'collapseBtn940')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn940" onclick="toggleCodeBlock('cloneGroup940', 'expandBtn940', 'collapseBtn940')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup940"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
      body: JSON.stringify({ name }),
    })
      .then((res) =&gt; res.ok)
      .catch((e) =&gt; {
        console.error(e);
        return false;
      });
  },
  uploadPfp</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 222:20 - Line 236:11), frontend/src/models/workspace.js (Line 334:13 - Line 380:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn941" onclick="toggleCodeBlock('cloneGroup941', 'expandBtn941', 'collapseBtn941')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn941" onclick="toggleCodeBlock('cloneGroup941', 'expandBtn941', 'collapseBtn941')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup941"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      body: formData,
      headers: baseHeaders(),
    })
      .then((res) =&gt; {
        if (!res.ok) throw new Error(&quot;Error uploading pfp.&quot;);
        return { success: true, error: null };
      })
      .catch((e) =&gt; {
        console.log(e);
        return { success: false, error: e.message };
      });
  },
  uploadLogo</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 293:23 - Line 303:6), frontend/src/models/system.js (Line 261:21 - Line 271:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn942" onclick="toggleCodeBlock('cloneGroup942', 'expandBtn942', 'collapseBtn942')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn942" onclick="toggleCodeBlock('cloneGroup942', 'expandBtn942', 'collapseBtn942')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup942"><code class="language-javascript text-sm text-gray-800">,
      {
        method: &quot;GET&quot;,
        cache: &quot;no-cache&quot;,
        headers: baseHeaders(),
      }
    )
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.log(e);
        return { email</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 324:25 - Line 334:14), frontend/src/models/system.js (Line 261:21 - Line 271:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn943" onclick="toggleCodeBlock('cloneGroup943', 'expandBtn943', 'collapseBtn943')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn943" onclick="toggleCodeBlock('cloneGroup943', 'expandBtn943', 'collapseBtn943')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup943"><code class="language-javascript text-sm text-gray-800">,
      {
        method: &quot;GET&quot;,
        cache: &quot;no-cache&quot;,
        headers: baseHeaders(),
      }
    )
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.log(e);
        return { customAppName</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 374:3 - Line 389:3), frontend/src/models/workspace.js (Line 319:7 - Line 366:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn944" onclick="toggleCodeBlock('cloneGroup944', 'expandBtn944', 'collapseBtn944')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn944" onclick="toggleCodeBlock('cloneGroup944', 'expandBtn944', 'collapseBtn944')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup944"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;GET&quot;,
      cache: &quot;no-cache&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; {
        if (res.ok &amp;&amp; res.status !== 204) return res.blob();
        throw new Error(&quot;Failed to fetch pfp.&quot;);
      })
      .then((blob) =&gt; (blob ? URL.createObjectURL(blob) : null))
      .catch((e) =&gt; {
        // console.log(e);
        return null;
      });
  },
  </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 390:20 - Line 404:14), frontend/src/models/workspace.js (Line 367:13 - Line 349:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn945" onclick="toggleCodeBlock('cloneGroup945', 'expandBtn945', 'collapseBtn945')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn945" onclick="toggleCodeBlock('cloneGroup945', 'expandBtn945', 'collapseBtn945')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup945"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; {
        if (res.ok) return { success: true, error: null };
        throw new Error(&quot;Failed to remove pfp.&quot;);
      })
      .catch((e) =&gt; {
        console.log(e);
        return { success: false, error: e.message };
      });
  },

  isDefaultLogo</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 555:20 - Line 566:15), frontend/src/models/system.js (Line 543:25 - Line 554:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn946" onclick="toggleCodeBlock('cloneGroup946', 'expandBtn946', 'collapseBtn946')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn946" onclick="toggleCodeBlock('cloneGroup946', 'expandBtn946', 'collapseBtn946')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup946"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify({ offset }),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return [];
      });
  },
  clearEventLogs</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 578:2 - Line 588:12), frontend/src/models/system.js (Line 567:20 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn947" onclick="toggleCodeBlock('cloneGroup947', 'expandBtn947', 'collapseBtn947')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn947" onclick="toggleCodeBlock('cloneGroup947', 'expandBtn947', 'collapseBtn947')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup947"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  exportChats</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 606:14 - Line 617:15), frontend/src/models/system.js (Line 138:20 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn948" onclick="toggleCodeBlock('cloneGroup948', 'expandBtn948', 'collapseBtn948')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn948" onclick="toggleCodeBlock('cloneGroup948', 'expandBtn948', 'collapseBtn948')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup948"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  dataConnectors</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/system.js (Line 666:41 - Line 677:25), frontend/src/models/system.js (Line 645:39 - Line 656:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn949" onclick="toggleCodeBlock('cloneGroup949', 'expandBtn949', 'collapseBtn949')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn949" onclick="toggleCodeBlock('cloneGroup949', 'expandBtn949', 'collapseBtn949')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup949"><code class="language-javascript text-sm text-gray-800">
          );
        return data;
      })
      .then((res) =&gt; ({ preset: res.preset, error: null }))
      .catch((e) =&gt; {
        console.error(e);
        return { preset: null, error: e.message };
      });
  },

  deleteSlashCommandPreset</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/mcpServers.js (Line 63:21 - Line 74:2), frontend/src/models/mcpServers.js (Line 45:21 - Line 57:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn950" onclick="toggleCodeBlock('cloneGroup950', 'expandBtn950', 'collapseBtn950')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn950" onclick="toggleCodeBlock('cloneGroup950', 'expandBtn950', 'collapseBtn950')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup950"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify({ name }),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; ({
        success: false,
        error: e.message,
      }));
  },
}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/embed.js (Line 30:2 - Line 41:12), frontend/src/models/system.js (Line 138:20 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn951" onclick="toggleCodeBlock('cloneGroup951', 'expandBtn951', 'collapseBtn951')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn951" onclick="toggleCodeBlock('cloneGroup951', 'expandBtn951', 'collapseBtn951')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup951"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  deleteEmbed</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/embed.js (Line 56:14 - Line 67:11), frontend/src/models/system.js (Line 543:25 - Line 554:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn952" onclick="toggleCodeBlock('cloneGroup952', 'expandBtn952', 'collapseBtn952')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn952" onclick="toggleCodeBlock('cloneGroup952', 'expandBtn952', 'collapseBtn952')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup952"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify({ offset }),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return [];
      });
  },
  deleteChat</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/embed.js (Line 68:14 - Line 80:6), frontend/src/models/system.js (Line 578:25 - Line 27:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn953" onclick="toggleCodeBlock('cloneGroup953', 'expandBtn953', 'collapseBtn953')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn953" onclick="toggleCodeBlock('cloneGroup953', 'expandBtn953', 'collapseBtn953')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup953"><code class="language-javascript text-sm text-gray-800">${chatId}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
};

export default Embed</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/document.js (Line 25:22 - Line 38:9), frontend/src/models/system.js (Line 138:20 - Line 27:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn954" onclick="toggleCodeBlock('cloneGroup954', 'expandBtn954', 'collapseBtn954')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn954" onclick="toggleCodeBlock('cloneGroup954', 'expandBtn954', 'collapseBtn954')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup954"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
};

export default Document</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 47:22 - Line 68:1), frontend/src/models/dataConnector.js (Line 8:22 - Line 28:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn955" onclick="toggleCodeBlock('cloneGroup955', 'expandBtn955', 'collapseBtn955')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn955" onclick="toggleCodeBlock('cloneGroup955', 'expandBtn955', 'collapseBtn955')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup955"><code class="language-javascript text-sm text-gray-800">, {
        method: &quot;POST&quot;,
        headers: baseHeaders(),
        cache: &quot;force-cache&quot;,
        body: JSON.stringify({ repo, accessToken }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return res.data;
        })
        .then((data) =&gt; {
          return { branches: data?.branches || [], error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          showToast(e.message, &quot;error&quot;);
          return { branches: [], error: e.message };
        });
    },
    collect: async function ({
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 85:9 - Line 98:8), frontend/src/models/dataConnector.js (Line 12:2 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn956" onclick="toggleCodeBlock('cloneGroup956', 'expandBtn956', 'collapseBtn956')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn956" onclick="toggleCodeBlock('cloneGroup956', 'expandBtn956', 'collapseBtn956')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup956"><code class="language-javascript text-sm text-gray-800">}),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },
  youtube</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 103:4 - Line 116:13), frontend/src/models/dataConnector.js (Line 12:12 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn957" onclick="toggleCodeBlock('cloneGroup957', 'expandBtn957', 'collapseBtn957')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn957" onclick="toggleCodeBlock('cloneGroup957', 'expandBtn957', 'collapseBtn957')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup957"><code class="language-javascript text-sm text-gray-800"> }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },
  websiteDepth</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 121:9 - Line 135:1), frontend/src/models/dataConnector.js (Line 12:12 - Line 45:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn958" onclick="toggleCodeBlock('cloneGroup958', 'expandBtn958', 'collapseBtn958')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn958" onclick="toggleCodeBlock('cloneGroup958', 'expandBtn958', 'collapseBtn958')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup958"><code class="language-javascript text-sm text-gray-800"> }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },

</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 153:20 - Line 168:11), frontend/src/models/dataConnector.js (Line 84:11 - Line 135:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn959" onclick="toggleCodeBlock('cloneGroup959', 'expandBtn959', 'collapseBtn959')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn959" onclick="toggleCodeBlock('cloneGroup959', 'expandBtn959', 'collapseBtn959')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup959"><code class="language-javascript text-sm text-gray-800">,
        }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },

  drupalwiki</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 176:12 - Line 190:9), frontend/src/models/dataConnector.js (Line 84:11 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn960" onclick="toggleCodeBlock('cloneGroup960', 'expandBtn960', 'collapseBtn960')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn960" onclick="toggleCodeBlock('cloneGroup960', 'expandBtn960', 'collapseBtn960')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup960"><code class="language-javascript text-sm text-gray-800">,
        }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },
  obsidian</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/dataConnector.js (Line 196:6 - Line 210:2), frontend/src/models/dataConnector.js (Line 84:11 - Line 45:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn961" onclick="toggleCodeBlock('cloneGroup961', 'expandBtn961', 'collapseBtn961')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn961" onclick="toggleCodeBlock('cloneGroup961', 'expandBtn961', 'collapseBtn961')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup961"><code class="language-javascript text-sm text-gray-800">,
        }),
      })
        .then((res) =&gt; res.json())
        .then((res) =&gt; {
          if (!res.success) throw new Error(res.reason);
          return { data: res.data, error: null };
        })
        .catch((e) =&gt; {
          console.error(e);
          return { data: null, error: e.message };
        });
    },
  },
}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/communityHub.js (Line 141:22 - Line 151:12), frontend/src/models/mcpServers.js (Line 10:27 - Line 131:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn962" onclick="toggleCodeBlock('cloneGroup962', 'expandBtn962', 'collapseBtn962')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn962" onclick="toggleCodeBlock('cloneGroup962', 'expandBtn962', 'collapseBtn962')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup962"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;GET&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return {
          success: false,
          error: e.message,
          createdByMe</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/browserExtensionApiKey.js (Line 19:7 - Line 29:7), frontend/src/models/workspace.js (Line 412:6 - Line 122:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn963" onclick="toggleCodeBlock('cloneGroup963', 'expandBtn963', 'collapseBtn963')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn963" onclick="toggleCodeBlock('cloneGroup963', 'expandBtn963', 'collapseBtn963')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup963"><code class="language-javascript text-sm text-gray-800">,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },

  revoke</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/browserExtensionApiKey.js (Line 30:3 - Line 42:23), frontend/src/models/system.js (Line 578:7 - Line 27:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn964" onclick="toggleCodeBlock('cloneGroup964', 'expandBtn964', 'collapseBtn964')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn964" onclick="toggleCodeBlock('cloneGroup964', 'expandBtn964', 'collapseBtn964')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup964"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
};

export default BrowserExtensionApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/agentFlows.js (Line 61:21 - Line 77:6), frontend/src/models/agentFlows.js (Line 22:22 - Line 36:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn965" onclick="toggleCodeBlock('cloneGroup965', 'expandBtn965', 'collapseBtn965')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn965" onclick="toggleCodeBlock('cloneGroup965', 'expandBtn965', 'collapseBtn965')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup965"><code class="language-javascript text-sm text-gray-800">);
        return res;
      })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; ({
        success: false,
        error: e.message,
        flow: null,
      }));
  },

  /**
   * Execute a specific flow
   * @param {string} uuid - The UUID of the flow to run
   * @param {object} variables - Optional variables to pass to the flow
   * @returns {Promise&lt;{success: boolean, error: string | null, results: object | null}&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/agentFlows.js (Line 110:24 - Line 125:6), frontend/src/models/agentFlows.js (Line 22:22 - Line 61:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn966" onclick="toggleCodeBlock('cloneGroup966', 'expandBtn966', 'collapseBtn966')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn966" onclick="toggleCodeBlock('cloneGroup966', 'expandBtn966', 'collapseBtn966')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup966"><code class="language-javascript text-sm text-gray-800">);
        return res;
      })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; ({
        success: false,
        error: e.message,
      }));
  },

  /**
   * Toggle a flow's active status
   * @param {string} uuid - The UUID of the flow to toggle
   * @param {boolean} active - The new active status
   * @returns {Promise&lt;{success: boolean, error: string | null}&gt;}
   */</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 31:7 - Line 42:11), frontend/src/models/embed.js (Line 30:8 - Line 299:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn967" onclick="toggleCodeBlock('cloneGroup967', 'expandBtn967', 'collapseBtn967')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn967" onclick="toggleCodeBlock('cloneGroup967', 'expandBtn967', 'collapseBtn967')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup967"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
      body: JSON.stringify(data),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },
  deleteUser</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 43:7 - Line 54:15), frontend/src/models/system.js (Line 578:7 - Line 122:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn968" onclick="toggleCodeBlock('cloneGroup968', 'expandBtn968', 'collapseBtn968')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn968" onclick="toggleCodeBlock('cloneGroup968', 'expandBtn968', 'collapseBtn968')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup968"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },

  // Invitations</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 83:9 - Line 94:19), frontend/src/models/system.js (Line 578:7 - Line 122:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn969" onclick="toggleCodeBlock('cloneGroup969', 'expandBtn969', 'collapseBtn969')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn969" onclick="toggleCodeBlock('cloneGroup969', 'expandBtn969', 'collapseBtn969')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup969"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },

  // Workspaces Mgmt</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 108:8 - Line 119:13), frontend/src/models/workspace.js (Line 57:8 - Line 18:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn970" onclick="toggleCodeBlock('cloneGroup970', 'expandBtn970', 'collapseBtn970')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn970" onclick="toggleCodeBlock('cloneGroup970', 'expandBtn970', 'collapseBtn970')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup970"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;GET&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .then((res) =&gt; res?.users || [])
      .catch((e) =&gt; {
        console.error(e);
        return [];
      });
  },
  newWorkspace</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 147:12 - Line 158:22), frontend/src/models/system.js (Line 578:7 - Line 122:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn971" onclick="toggleCodeBlock('cloneGroup971', 'expandBtn971', 'collapseBtn971')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn971" onclick="toggleCodeBlock('cloneGroup971', 'expandBtn971', 'collapseBtn971')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup971"><code class="language-javascript text-sm text-gray-800">}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.json())
      .catch((e) =&gt; {
        console.error(e);
        return { success: false, error: e.message };
      });
  },

  // System Preferences</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 223:25 - Line 239:23), frontend/src/models/system.js (Line 482:26 - Line 498:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn972" onclick="toggleCodeBlock('cloneGroup972', 'expandBtn972', 'collapseBtn972')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn972" onclick="toggleCodeBlock('cloneGroup972', 'expandBtn972', 'collapseBtn972')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup972"><code class="language-javascript text-sm text-gray-800">, {
      method: &quot;POST&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; {
        if (!res.ok) {
          throw new Error(res.statusText || &quot;Error generating api key.&quot;);
        }
        return res.json();
      })
      .catch((e) =&gt; {
        console.error(e);
        return { apiKey: null, error: e.message };
      });
  },
  deleteApiKey: async function (apiKeyId = &quot;&quot;) {
    return fetch(`${API_BASE}/admin/delete-api-key/</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/models/admin.js (Line 239:23 - Line 249:2), frontend/src/models/system.js (Line 498:17 - Line 197:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn973" onclick="toggleCodeBlock('cloneGroup973', 'expandBtn973', 'collapseBtn973')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn973" onclick="toggleCodeBlock('cloneGroup973', 'expandBtn973', 'collapseBtn973')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup973"><code class="language-javascript text-sm text-gray-800">${apiKeyId}`, {
      method: &quot;DELETE&quot;,
      headers: baseHeaders(),
    })
      .then((res) =&gt; res.ok)
      .catch((e) =&gt; {
        console.error(e);
        return false;
      });
  },
}</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/locales/normalizeEn.mjs (Line 5:5 - Line 78:9), frontend/src/locales/verifyTranslations.mjs (Line 1:17 - Line 74:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn974" onclick="toggleCodeBlock('cloneGroup974', 'expandBtn974', 'collapseBtn974')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn974" onclick="toggleCodeBlock('cloneGroup974', 'expandBtn974', 'collapseBtn974')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup974"><code class="language-javascript text-sm text-gray-800">;
const languageNames = new Intl.DisplayNames(Object.keys(resources), {
  type: &quot;language&quot;,
});

function langDisplayName(lang) {
  return languageNames.of(lang);
}

function compareStructures(lang, a, b, subdir = null) {
  //if a and b aren't the same type, they can't be equal
  if (typeof a !== typeof b &amp;&amp; a !== null &amp;&amp; b !== null) {
    console.log(&quot;Invalid type comparison&quot;, [
      {
        lang,
        a: typeof a,
        b: typeof b,
        values: {
          a,
          b,
        },
        ...(!!subdir ? { subdir } : {}),
      },
    ]);
    return false;
  }

  // Need the truthy guard because
  // typeof null === 'object'
  if (a &amp;&amp; typeof a === &quot;object&quot;) {
    var keysA = Object.keys(a).sort(),
      keysB = Object.keys(b).sort();

    //if a and b are objects with different no of keys, unequal
    if (keysA.length !== keysB.length) {
      console.log(&quot;Keys are missing!&quot;, {
        [lang]: keysA,
        en: keysB,
        ...(!!subdir ? { subdir } : {}),
        diff: {
          added: keysB.filter((key) =&gt; !keysA.includes(key)),
          removed: keysA.filter((key) =&gt; !keysB.includes(key)),
        },
      });
      return false;
    }

    //if keys aren't all the same, unequal
    if (
      !keysA.every(function (k, i) {
        return k === keysB[i];
      })
    ) {
      console.log(&quot;Keys are not equal!&quot;, {
        [lang]: keysA,
        en: keysB,
        ...(!!subdir ? { subdir } : {}),
      });
      return false;
    }

    //recurse on the values for each key
    return keysA.every(function (key) {
      //if we made it here, they have identical keys
      return compareStructures(lang, a[key], b[key], key);
    });

    //for primitives just ignore since we don't check values.
  } else {
    return true;
  }
}

function</code></pre></div><!-- Add more clone groups for .txt format as needed         // Add more clone groups for .txt format as needed--></div><a name="jsx-clones"></a><h2 class="text-2xl font-semibold text-gray-700 mb-4">jsx</h2><div class="divide-y divide-gray-200 border-b-2"><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/SlashCommand.jsx (Line 32:32 - Line 47:6), frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/SystemPrompt.jsx (Line 46:64 - Line 61:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn461" onclick="toggleCodeBlock('cloneGroup461', 'expandBtn461', 'collapseBtn461')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn461" onclick="toggleCodeBlock('cloneGroup461', 'expandBtn461', 'collapseBtn461')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup461"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
            Created by{&quot; &quot;}
            &lt;a
              href={paths.communityHub.profile(item.creatorUsername)}
              target=&quot;_blank&quot;
              className=&quot;hover:text-blue-500 hover:underline&quot;
              rel=&quot;noreferrer&quot;
            &gt;
              @{item.creatorUsername}
            &lt;/a&gt;
          &lt;/p&gt;
        )}
      &lt;/div&gt;
      &lt;div className=&quot;flex flex-col gap-y-[25px] text-white/80 light:text-theme-text-secondary text-sm&quot;&gt;
        &lt;p&gt;
          Slash</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/AgentSkill.jsx (Line 60:6 - Line 75:9), frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/SystemPrompt.jsx (Line 43:7 - Line 58:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn462" onclick="toggleCodeBlock('cloneGroup462', 'expandBtn462', 'collapseBtn462')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn462" onclick="toggleCodeBlock('cloneGroup462', 'expandBtn462', 'collapseBtn462')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup462"><code class="language-jsx text-sm text-gray-800"> &quot;{item.name}&quot;
        &lt;/h2&gt;
        {item.creatorUsername &amp;&amp; (
          &lt;p className=&quot;text-white/60 light:text-theme-text-secondary text-xs font-mono&quot;&gt;
            Created by{&quot; &quot;}
            &lt;a
              href={paths.communityHub.profile(item.creatorUsername)}
              target=&quot;_blank&quot;
              className=&quot;hover:text-blue-500 hover:underline&quot;
              rel=&quot;noreferrer&quot;
            &gt;
              @{item.creatorUsername}
            &lt;/a&gt;
          &lt;/p&gt;
        )}
        </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/AgentFlow.jsx (Line 28:31 - Line 38:7), frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/SlashCommand.jsx (Line 19:34 - Line 29:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn463" onclick="toggleCodeBlock('cloneGroup463', 'expandBtn463', 'collapseBtn463')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn463" onclick="toggleCodeBlock('cloneGroup463', 'expandBtn463', 'collapseBtn463')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup463"><code class="language-jsx text-sm text-gray-800">${e.message}`, &quot;error&quot;);
    } finally {
      setLoading(false);
    }
  }

  return (
    &lt;div className=&quot;flex flex-col mt-4 gap-y-4&quot;&gt;
      &lt;div className=&quot;flex flex-col gap-y-1&quot;&gt;
        &lt;h2 className=&quot;text-base text-theme-text-primary font-semibold&quot;&gt;
          Import</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/AgentFlow.jsx (Line 38:7 - Line 56:6), frontend/src/pages/GeneralSettings/CommunityHub/ImportItem/Steps/PullAndReview/HubItem/SystemPrompt.jsx (Line 43:14 - Line 61:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn464" onclick="toggleCodeBlock('cloneGroup464', 'expandBtn464', 'collapseBtn464')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn464" onclick="toggleCodeBlock('cloneGroup464', 'expandBtn464', 'collapseBtn464')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup464"><code class="language-jsx text-sm text-gray-800">
        &lt;/h2&gt;
        {item.creatorUsername &amp;&amp; (
          &lt;p className=&quot;text-white/60 light:text-theme-text-secondary text-xs font-mono&quot;&gt;
            Created by{&quot; &quot;}
            &lt;a
              href={paths.communityHub.profile(item.creatorUsername)}
              target=&quot;_blank&quot;
              className=&quot;hover:text-blue-500 hover:underline&quot;
              rel=&quot;noreferrer&quot;
            &gt;
              @{item.creatorUsername}
            &lt;/a&gt;
          &lt;/p&gt;
        )}
      &lt;/div&gt;
      &lt;div className=&quot;flex flex-col gap-y-[25px] text-white/80 light:text-theme-text-secondary text-sm&quot;&gt;
        &lt;p&gt;
          Agent</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/native.jsx (Line 38:2 - Line 50:2), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/piperTTS.jsx (Line 55:2 - Line 67:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn465" onclick="toggleCodeBlock('cloneGroup465', 'expandBtn465', 'collapseBtn465')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn465" onclick="toggleCodeBlock('cloneGroup465', 'expandBtn465', 'collapseBtn465')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup465"><code class="language-jsx text-sm text-gray-800">
        data-auto-play-chat-id={chatId}
        data-tooltip-id=&quot;message-to-speech&quot;
        data-tooltip-content={
          speaking ? &quot;Pause TTS speech of message&quot; : &quot;TTS Speak message&quot;
        }
        className=&quot;border-none text-[var(--theme-sidebar-footer-icon-fill)]&quot;
        aria-label={speaking ? &quot;Pause speech&quot; : &quot;Speak message&quot;}
      &gt;
        {speaking ? (
          &lt;PauseCircle size={18} className=&quot;mb-1&quot; /&gt;
        ) : (
          &lt;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/asyncTts.jsx (Line 30:2 - Line 56:3), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/piperTTS.jsx (Line 24:6 - Line 50:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn466" onclick="toggleCodeBlock('cloneGroup466', 'expandBtn466', 'collapseBtn466')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn466" onclick="toggleCodeBlock('cloneGroup466', 'expandBtn466', 'collapseBtn466')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup466"><code class="language-jsx text-sm text-gray-800">);
      } else {
        playerRef.current.play();
      }
    } catch (e) {
      console.error(e);
      setLoading(false);
      setSpeaking(false);
    }
  }

  useEffect(() =&gt; {
    function setupPlayer() {
      if (!playerRef?.current) return;
      playerRef.current.addEventListener(&quot;play&quot;, () =&gt; {
        setSpeaking(true);
      });

      playerRef.current.addEventListener(&quot;pause&quot;, () =&gt; {
        playerRef.current.currentTime = 0;
        setSpeaking(false);
      });
    }
    setupPlayer();
  }, []);

  if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/asyncTts.jsx (Line 56:7 - Line 93:1), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/native.jsx (Line 34:10 - Line 86:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn467" onclick="toggleCodeBlock('cloneGroup467', 'expandBtn467', 'collapseBtn467')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn467" onclick="toggleCodeBlock('cloneGroup467', 'expandBtn467', 'collapseBtn467')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup467"><code class="language-jsx text-sm text-gray-800">) return null;
  return (
    &lt;div className=&quot;mt-3 relative&quot;&gt;
      &lt;button
        onClick={speakMessage}
        data-auto-play-chat-id={chatId}
        data-tooltip-id=&quot;message-to-speech&quot;
        data-tooltip-content={
          speaking
            ? t(&quot;pause_tts_speech_message&quot;)
            : t(&quot;chat_window.tts_speak_message&quot;)
        }
        className=&quot;border-none text-[var(--theme-sidebar-footer-icon-fill)]&quot;
        aria-label={speaking ? &quot;Pause speech&quot; : &quot;Speak message&quot;}
      &gt;
        {speaking ? (
          &lt;PauseCircle size={18} className=&quot;mb-1&quot; /&gt;
        ) : (
          &lt;&gt;
            {loading ? (
              &lt;CircleNotch size={18} className=&quot;mb-1 animate-spin&quot; /&gt;
            ) : (
              &lt;SpeakerHigh size={18} className=&quot;mb-1&quot; /&gt;
            )}
          &lt;/&gt;
        )}
        &lt;audio
          ref={playerRef}
          hidden={true}
          src={audioSrc}
          autoPlay={true}
          controls={false}
        /&gt;
      &lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/slashCommand.jsx (Line 6:20 - Line 21:8), frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/systemPrompt.jsx (Line 6:20 - Line 21:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn468" onclick="toggleCodeBlock('cloneGroup468', 'expandBtn468', 'collapseBtn468')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn468" onclick="toggleCodeBlock('cloneGroup468', 'expandBtn468', 'collapseBtn468')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup468"><code class="language-jsx text-sm text-gray-800">({ item }) {
  return (
    &lt;&gt;
      &lt;Link
        key={item.id}
        to={paths.communityHub.importItem(item.importId)}
        className=&quot;bg-black/70 light:bg-slate-100 rounded-lg p-3 hover:bg-black/60 light:hover:bg-slate-200 transition-all duration-200 cursor-pointer group border border-transparent hover:border-slate-400&quot;
      &gt;
        &lt;div className=&quot;flex gap-x-2 items-center&quot;&gt;
          &lt;p className=&quot;text-white text-sm font-medium&quot;&gt;{item.name}&lt;/p&gt;
          &lt;VisibilityIcon visibility={item.visibility} /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col gap-2&quot;&gt;
          &lt;p className=&quot;text-white/60 text-xs mt-1&quot;&gt;{item.description}&lt;/p&gt;
          &lt;label className=&quot;text-white/60 text-xs font-semibold mt-4&quot;&gt;
            Command</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/slashCommand.jsx (Line 26:1 - Line 46:1), frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/systemPrompt.jsx (Line 19:2 - Line 39:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn469" onclick="toggleCodeBlock('cloneGroup469', 'expandBtn469', 'collapseBtn469')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn469" onclick="toggleCodeBlock('cloneGroup469', 'expandBtn469', 'collapseBtn469')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup469"><code class="language-jsx text-sm text-gray-800">
          &lt;label className=&quot;text-white/60 text-xs font-semibold mt-4&quot;&gt;
            Prompt
          &lt;/label&gt;
          &lt;p className=&quot;text-white/60 text-xs bg-zinc-900 light:bg-slate-200 px-2 py-1 rounded-md font-mono border border-slate-800 light:border-slate-300&quot;&gt;
            {truncate(item.prompt, 90)}
          &lt;/p&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex justify-end mt-2&quot;&gt;
          &lt;Link
            to={paths.communityHub.importItem(item.importId)}
            className=&quot;text-primary-button hover:text-primary-button/80 text-sm font-medium px-3 py-1.5 rounded-md bg-black/30 light:bg-slate-200 group-hover:bg-black/50 light:group-hover:bg-slate-300 transition-all&quot;
          &gt;
            Import →
          &lt;/Link&gt;
        &lt;/div&gt;
      &lt;/Link&gt;
    &lt;/&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/agentSkill.jsx (Line 6:18 - Line 21:1), frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/systemPrompt.jsx (Line 6:20 - Line 20:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn470" onclick="toggleCodeBlock('cloneGroup470', 'expandBtn470', 'collapseBtn470')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn470" onclick="toggleCodeBlock('cloneGroup470', 'expandBtn470', 'collapseBtn470')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup470"><code class="language-jsx text-sm text-gray-800">({ item }) {
  return (
    &lt;&gt;
      &lt;Link
        key={item.id}
        to={paths.communityHub.importItem(item.importId)}
        className=&quot;bg-black/70 light:bg-slate-100 rounded-lg p-3 hover:bg-black/60 light:hover:bg-slate-200 transition-all duration-200 cursor-pointer group border border-transparent hover:border-slate-400&quot;
      &gt;
        &lt;div className=&quot;flex gap-x-2 items-center&quot;&gt;
          &lt;p className=&quot;text-white text-sm font-medium&quot;&gt;{item.name}&lt;/p&gt;
          &lt;VisibilityIcon visibility={item.visibility} /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col gap-2&quot;&gt;
          &lt;p className=&quot;text-white/60 text-xs mt-1&quot;&gt;{item.description}&lt;/p&gt;

</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/agentSkill.jsx (Line 31:6 - Line 46:1), frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/HubItemCard/systemPrompt.jsx (Line 24:2 - Line 39:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn471" onclick="toggleCodeBlock('cloneGroup471', 'expandBtn471', 'collapseBtn471')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn471" onclick="toggleCodeBlock('cloneGroup471', 'expandBtn471', 'collapseBtn471')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup471"><code class="language-jsx text-sm text-gray-800">
          &lt;/p&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex justify-end mt-2&quot;&gt;
          &lt;Link
            to={paths.communityHub.importItem(item.importId)}
            className=&quot;text-primary-button hover:text-primary-button/80 text-sm font-medium px-3 py-1.5 rounded-md bg-black/30 light:bg-slate-200 group-hover:bg-black/50 light:group-hover:bg-slate-300 transition-all&quot;
          &gt;
            Import →
          &lt;/Link&gt;
        &lt;/div&gt;
      &lt;/Link&gt;
    &lt;/&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/CodeSnippetModal/index.jsx (Line 15:5 - Line 27:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 50:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn472" onclick="toggleCodeBlock('cloneGroup472', 'expandBtn472', 'collapseBtn472')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn472" onclick="toggleCodeBlock('cloneGroup472', 'expandBtn472', 'collapseBtn472')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup472"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;px-7 py-6&quot;&gt;
          &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/EditPresetModal.jsx (Line 54:7 - Line 66:11), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 49:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn473" onclick="toggleCodeBlock('cloneGroup473', 'expandBtn473', 'collapseBtn473')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn473" onclick="toggleCodeBlock('cloneGroup473', 'expandBtn473', 'collapseBtn473')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup473"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={onClose}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div
          </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/AddPresetModal.jsx (Line 34:2 - Line 57:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:3 - Line 77:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn474" onclick="toggleCodeBlock('cloneGroup474', 'expandBtn474', 'collapseBtn474')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn474" onclick="toggleCodeBlock('cloneGroup474', 'expandBtn474', 'collapseBtn474')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup474"><code class="language-jsx text-sm text-gray-800">}
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={onClose}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div
          className=&quot;h-full w-full overflow-y-auto&quot;
          style={{ maxHeight: &quot;calc(100vh - 200px)&quot; }}
        &gt;
          &lt;form onSubmit={handleSubmit}&gt;
            &lt;div className=&quot;py-7 px-9 space-y-2 flex-col&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
                &lt;div&gt;
                  &lt;label
                    htmlFor=&quot;command&quot;
                    className=&quot;block mb-2 text-sm font-medium text-white&quot;
                  &gt;
                    {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/AddPresetModal.jsx (Line 69:2 - Line 84:3), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/EditPresetModal.jsx (Line 86:2 - Line 101:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn475" onclick="toggleCodeBlock('cloneGroup475', 'expandBtn475', 'collapseBtn475')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn475" onclick="toggleCodeBlock('cloneGroup475', 'expandBtn475', 'collapseBtn475')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup475"><code class="language-jsx text-sm text-gray-800">
                      required={true}
                      className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                    /&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
                &lt;div&gt;
                  &lt;label
                    htmlFor=&quot;prompt&quot;
                    className=&quot;block mb-2 text-sm font-medium text-white&quot;
                  &gt;
                    Prompt
                  &lt;/label&gt;
                  &lt;textarea
                    name=&quot;prompt&quot;
                    id</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/Documents/UploadFile/FileUploadProgress/index.jsx (Line 96:9 - Line 114:6), frontend/src/components/Modals/ManageWorkspace/Documents/UploadFile/FileUploadProgress/index.jsx (Line 71:9 - Line 89:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn476" onclick="toggleCodeBlock('cloneGroup476', 'expandBtn476', 'collapseBtn476')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn476" onclick="toggleCodeBlock('cloneGroup476', 'expandBtn476', 'collapseBtn476')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup476"><code class="language-jsx text-sm text-gray-800">) {
    return (
      &lt;div
        className={`${
          isFadingOut ? &quot;file-upload-fadeout&quot; : &quot;file-upload&quot;
        } h-14 px-2 py-2 flex items-center gap-x-4 rounded-lg bg-error/40 light:bg-error/30 light:border-solid light:border-error/40 border border-transparent`}
      &gt;
        &lt;div className=&quot;w-6 h-6 flex-shrink-0&quot;&gt;
          &lt;XCircle
            color=&quot;var(--theme-bg-primary)&quot;
            className=&quot;w-6 h-6 stroke-white bg-error rounded-full p-1 w-full h-full&quot;
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col&quot;&gt;
          &lt;p className=&quot;text-white light:text-red-600 text-xs font-semibold&quot;&gt;
            {truncate(file.name, 30)}
          &lt;/p&gt;
          &lt;p className=&quot;text-red-100 light:text-red-600 text-xs font-medium&quot;&gt;
            {error</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/Documents/Directory/NewFolderModal/index.jsx (Line 37:7 - Line 48:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 49:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn477" onclick="toggleCodeBlock('cloneGroup477', 'expandBtn477', 'collapseBtn477')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn477" onclick="toggleCodeBlock('cloneGroup477', 'expandBtn477', 'collapseBtn477')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup477"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/Documents/Directory/NewFolderModal/index.jsx (Line 69:2 - Line 83:7), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 100:2 - Line 114:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn478" onclick="toggleCodeBlock('cloneGroup478', 'expandBtn478', 'collapseBtn478')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn478" onclick="toggleCodeBlock('cloneGroup478', 'expandBtn478', 'collapseBtn478')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup478"><code class="language-jsx text-sm text-gray-800">
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Create</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 7:20 - Line 17:44), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 6:15 - Line 16:41)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn479" onclick="toggleCodeBlock('cloneGroup479', 'expandBtn479', 'collapseBtn479')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn479" onclick="toggleCodeBlock('cloneGroup479', 'expandBtn479', 'collapseBtn479')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup479"><code class="language-jsx text-sm text-gray-800">() {
  const { t } = useTranslation();
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = new FormData(e.target);

    try {
      setLoading(true);
      showToast(&quot;Scraping website - this may take a while.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 25:2 - Line 35:23), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 22:6 - Line 32:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn480" onclick="toggleCodeBlock('cloneGroup480', 'expandBtn480', 'collapseBtn480')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn480" onclick="toggleCodeBlock('cloneGroup480', 'expandBtn480', 'collapseBtn480')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup480"><code class="language-jsx text-sm text-gray-800">),
      });

      if (!!error) {
        showToast(error, &quot;error&quot;, { clear: true });
        setLoading(false);
        return;
      }

      showToast(
        `Successfully scraped </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 43:2 - Line 60:31), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 38:7 - Line 55:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn481" onclick="toggleCodeBlock('cloneGroup481', 'expandBtn481', 'collapseBtn481')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn481" onclick="toggleCodeBlock('cloneGroup481', 'expandBtn481', 'collapseBtn481')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup481"><code class="language-jsx text-sm text-gray-800">;
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.website-depth.URL&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 111:2 - Line 123:22), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 78:2 - Line 90:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn482" onclick="toggleCodeBlock('cloneGroup482', 'expandBtn482', 'collapseBtn482')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn482" onclick="toggleCodeBlock('cloneGroup482', 'expandBtn482', 'collapseBtn482')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup482"><code class="language-jsx text-sm text-gray-800">
                /&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div className=&quot;flex flex-col gap-y-2 w-full pr-10&quot;&gt;
            &lt;button
              type=&quot;submit&quot;
              disabled={loading}
              className=&quot;mt-2 w-full justify-center border-none px-4 py-2 rounded-lg text-dark-text light:text-white text-sm font-bold items-center flex gap-x-2 bg-theme-home-button-primary hover:bg-theme-home-button-primary-hover disabled:bg-theme-home-button-primary-hover disabled:cursor-not-allowed&quot;
            &gt;
              {loading ? &quot;Scraping website...&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Obsidian/index.jsx (Line 81:1 - Line 96:108), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 42:2 - Line 52:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn483" onclick="toggleCodeBlock('cloneGroup483', 'expandBtn483', 'collapseBtn483')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn483" onclick="toggleCodeBlock('cloneGroup483', 'expandBtn483', 'collapseBtn483')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup483"><code class="language-jsx text-sm text-gray-800">
      setLoading(false);
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col md:flex-row md:items-center gap-x-2 text-white mb-4 bg-blue-800/30 w-fit rounded-lg px-4 py-2</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 39:13 - Line 49:6), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 22:6 - Line 32:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn484" onclick="toggleCodeBlock('cloneGroup484', 'expandBtn484', 'collapseBtn484')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn484" onclick="toggleCodeBlock('cloneGroup484', 'expandBtn484', 'collapseBtn484')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup484"><code class="language-jsx text-sm text-gray-800">),
      });

      if (!!error) {
        showToast(error, &quot;error&quot;, { clear: true });
        setLoading(false);
        return;
      }

      showToast(
        `${data.files</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 51:20 - Line 74:24), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 32:44 - Line 55:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn485" onclick="toggleCodeBlock('cloneGroup485', 'expandBtn485', 'collapseBtn485')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn485" onclick="toggleCodeBlock('cloneGroup485', 'expandBtn485', 'collapseBtn485')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup485"><code class="language-jsx text-sm text-gray-800">${data.destination}.`,
        &quot;success&quot;,
        { clear: true }
      );
      e.target.reset();
      setLoading(false);
      return;
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.gitlab.URL&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 17:1 - Line 34:7), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 16:2 - Line 33:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn489" onclick="toggleCodeBlock('cloneGroup489', 'expandBtn489', 'collapseBtn489')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn489" onclick="toggleCodeBlock('cloneGroup489', 'expandBtn489', 'collapseBtn489')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup489"><code class="language-jsx text-sm text-gray-800">
  const [settings, setSettings] = useState({
    repo: null,
    accessToken: null,
  });

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = new FormData(e.target);

    try {
      setLoading(true);
      showToast(
        &quot;Fetching all files for repo - this may take a while.&quot;,
        &quot;info&quot;,
        { clear: true, autoClose: false }
      );
      const { data, error } = await System.dataConnectors.github</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 38:8 - Line 73:24), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 22:2 - Line 55:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn490" onclick="toggleCodeBlock('cloneGroup490', 'expandBtn490', 'collapseBtn490')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn490" onclick="toggleCodeBlock('cloneGroup490', 'expandBtn490', 'collapseBtn490')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup490"><code class="language-jsx text-sm text-gray-800">,
      });

      if (!!error) {
        showToast(error, &quot;error&quot;, { clear: true });
        setLoading(false);
        return;
      }

      showToast(
        `${data.files} ${pluralize(&quot;file&quot;, data.files)} collected from ${
          data.author
        }/${data.repo}:${data.branch}. Output folder is ${data.destination}.`,
        &quot;success&quot;,
        { clear: true }
      );
      e.target.reset();
      setLoading(false);
      return;
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.github.URL&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 83:46 - Line 95:26), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 84:37 - Line 96:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn491" onclick="toggleCodeBlock('cloneGroup491', 'expandBtn491', 'collapseBtn491')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn491" onclick="toggleCodeBlock('cloneGroup491', 'expandBtn491', 'collapseBtn491')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup491"><code class="language-jsx text-sm text-gray-800">&quot;
                  required={true}
                  autoComplete=&quot;off&quot;
                  onChange={(e) =&gt; setRepo(e.target.value)}
                  onBlur={() =&gt; setSettings({ ...settings, repo })}
                  spellCheck={false}
                /&gt;
              &lt;/div&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white font-bold text-sm flex gap-x-2 items-center&quot;&gt;
                    &lt;p className=&quot;font-bold text-white&quot;&gt;
                      {t(&quot;connectors.github.token&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 120:22 - Line 130:28), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 159:22 - Line 169:28)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn492" onclick="toggleCodeBlock('cloneGroup492', 'expandBtn492', 'collapseBtn492')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn492" onclick="toggleCodeBlock('cloneGroup492', 'expandBtn492', 'collapseBtn492')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup492"><code class="language-jsx text-sm text-gray-800">
                repo={settings.repo}
                accessToken={settings.accessToken}
              /&gt;
            &lt;/div&gt;

            &lt;div className=&quot;flex flex-col w-full py-4 pr-10&quot;&gt;
              &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                &lt;label className=&quot;text-white text-sm flex gap-x-2 items-center&quot;&gt;
                  &lt;p className=&quot;text-white text-sm font-bold&quot;&gt;
                    {t(&quot;connectors.github.ignores&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 134:31 - Line 162:35), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 173:31 - Line 201:35)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn493" onclick="toggleCodeBlock('cloneGroup493', 'expandBtn493', 'collapseBtn493')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn493" onclick="toggleCodeBlock('cloneGroup493', 'expandBtn493', 'collapseBtn493')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup493"><code class="language-jsx text-sm text-gray-800">)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;TagsInput
                value={ignores}
                onChange={setIgnores}
                name=&quot;ignores&quot;
                placeholder=&quot;!*.js, images/*, .DS_Store, bin/*&quot;
                classNames={{
                  tag: &quot;bg-theme-settings-input-bg light:bg-black/10 bg-blue-300/10 text-zinc-800&quot;,
                  input:
                    &quot;flex p-1 !bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none&quot;,
                }}
              /&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div className=&quot;flex flex-col gap-y-2 w-full pr-10&quot;&gt;
            &lt;PATAlert accessToken={accessToken} /&gt;
            &lt;button
              type=&quot;submit&quot;
              disabled={loading}
              className=&quot;mt-2 w-full justify-center border-none px-4 py-2 rounded-lg text-dark-text light:text-white text-sm font-bold items-center flex gap-x-2 bg-theme-home-button-primary hover:bg-theme-home-button-primary-hover disabled:bg-theme-home-button-primary-hover disabled:cursor-not-allowed&quot;
            &gt;
              {loading ? &quot;Collecting files...&quot; : &quot;Submit&quot;}
            &lt;/button&gt;
            {loading &amp;&amp; (
              &lt;p className=&quot;text-xs text-white/50&quot;&gt;
                {t(&quot;connectors.github.task_explained&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 172:22 - Line 186:7), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 211:22 - Line 225:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn494" onclick="toggleCodeBlock('cloneGroup494', 'expandBtn494', 'collapseBtn494')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn494" onclick="toggleCodeBlock('cloneGroup494', 'expandBtn494', 'collapseBtn494')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup494"><code class="language-jsx text-sm text-gray-800">({ repo, accessToken }) {
  const { t } = useTranslation();
  const [allBranches, setAllBranches] = useState(DEFAULT_BRANCHES);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function fetchAllBranches() {
      if (!repo) {
        setAllBranches(DEFAULT_BRANCHES);
        setLoading(false);
        return;
      }

      setLoading(true);
      const { branches } = await System.dataConnectors.github</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 186:7 - Line 200:7), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 225:7 - Line 240:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn495" onclick="toggleCodeBlock('cloneGroup495', 'expandBtn495', 'collapseBtn495')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn495" onclick="toggleCodeBlock('cloneGroup495', 'expandBtn495', 'collapseBtn495')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup495"><code class="language-jsx text-sm text-gray-800">.branches({
        repo,
        accessToken,
      });
      setAllBranches(branches.length &gt; 0 ? branches : DEFAULT_BRANCHES);
      setLoading(false);
    }
    fetchAllBranches();
  }, [repo, accessToken]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;Branch</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 211:35 - Line 223:37), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 252:35 - Line 264:37)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn496" onclick="toggleCodeBlock('cloneGroup496', 'expandBtn496', 'collapseBtn496')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn496" onclick="toggleCodeBlock('cloneGroup496', 'expandBtn496', 'collapseBtn496')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup496"><code class="language-jsx text-sm text-gray-800">)}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-bold&quot;&gt;Branch&lt;/label&gt;
        &lt;p className=&quot;text-xs font-normal text-theme-text-secondary&quot;&gt;
          {t(&quot;connectors.github.branch_explained&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 223:37 - Line 259:55), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 264:37 - Line 300:58)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn497" onclick="toggleCodeBlock('cloneGroup497', 'expandBtn497', 'collapseBtn497')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn497" onclick="toggleCodeBlock('cloneGroup497', 'expandBtn497', 'collapseBtn497')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup497"><code class="language-jsx text-sm text-gray-800">)}
        &lt;/p&gt;
      &lt;/div&gt;
      &lt;select
        name=&quot;branch&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white focus:outline-primary-button active:outline-primary-button outline-none text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {allBranches.map((branch) =&gt; {
          return (
            &lt;option key={branch} value={branch}&gt;
              {branch}
            &lt;/option&gt;
          );
        })}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}

function PATAlert({ accessToken }) {
  const { t } = useTranslation();
  if (!!accessToken) return null;
  return (
    &lt;div className=&quot;flex flex-col md:flex-row md:items-center gap-x-2 text-white mb-4 bg-blue-800/30 w-fit rounded-lg px-4 py-2&quot;&gt;
      &lt;div className=&quot;gap-x-2 flex items-center&quot;&gt;
        &lt;Info className=&quot;shrink-0&quot; size={25} /&gt;
        &lt;p className=&quot;text-sm&quot;&gt;
          &lt;span
            dangerouslySetInnerHTML={{
              __html: t(&quot;connectors.github.token_information&quot;),
            }}
          /&gt;
          &lt;br /&gt;
          &lt;br /&gt;
          &lt;a
            href=&quot;https://github.com/settings/personal-access-tokens/new</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Github/index.jsx (Line 266:35 - Line 294:42), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Gitlab/index.jsx (Line 306:35 - Line 334:42)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn498" onclick="toggleCodeBlock('cloneGroup498', 'expandBtn498', 'collapseBtn498')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn498" onclick="toggleCodeBlock('cloneGroup498', 'expandBtn498', 'collapseBtn498')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup498"><code class="language-jsx text-sm text-gray-800">)}
          &lt;/a&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function PATTooltip({ accessToken }) {
  const { t } = useTranslation();
  if (!!accessToken) return null;
  return (
    &lt;&gt;
      {!accessToken &amp;&amp; (
        &lt;Warning
          size={14}
          className=&quot;ml-1 text-orange-500 cursor-pointer&quot;
          data-tooltip-id=&quot;access-token-tooltip&quot;
          data-tooltip-place=&quot;right&quot;
        /&gt;
      )}
      &lt;Tooltip
        delayHide={300}
        id=&quot;access-token-tooltip&quot;
        className=&quot;max-w-xs z-99&quot;
        clickable={true}
      &gt;
        &lt;p className=&quot;text-sm&quot;&gt;
          {t(&quot;connectors.github.token_explained_start&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 14:2 - Line 24:79), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 7:2 - Line 29:55)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn499" onclick="toggleCodeBlock('cloneGroup499', 'expandBtn499', 'collapseBtn499')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn499" onclick="toggleCodeBlock('cloneGroup499', 'expandBtn499', 'collapseBtn499')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup499"><code class="language-jsx text-sm text-gray-800">
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (e) =&gt; {
    e.preventDefault();
    const form = new FormData(e.target);

    try {
      setLoading(true);
      showToast(
        &quot;Fetching all pages for the given Drupal Wiki spaces - this may take a while.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 34:14 - Line 44:42), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 22:6 - Line 32:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn500" onclick="toggleCodeBlock('cloneGroup500', 'expandBtn500', 'collapseBtn500')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn500" onclick="toggleCodeBlock('cloneGroup500', 'expandBtn500', 'collapseBtn500')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup500"><code class="language-jsx text-sm text-gray-800">),
      });

      if (!!error) {
        showToast(error, &quot;error&quot;, { clear: true });
        setLoading(false);
        return;
      }

      showToast(
        `Pages collected from Drupal Wiki spaces </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 44:3 - Line 65:55), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/WebsiteDepth/index.jsx (Line 38:3 - Line 54:29)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn501" onclick="toggleCodeBlock('cloneGroup501', 'expandBtn501', 'collapseBtn501')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn501" onclick="toggleCodeBlock('cloneGroup501', 'expandBtn501', 'collapseBtn501')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup501"><code class="language-jsx text-sm text-gray-800">,
        &quot;success&quot;,
        { clear: true }
      );
      e.target.reset();
      setLoading(false);
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold flex gap-x-2 items-center</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 162:8 - Line 177:22), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 75:35 - Line 90:27)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn502" onclick="toggleCodeBlock('cloneGroup502', 'expandBtn502', 'collapseBtn502')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn502" onclick="toggleCodeBlock('cloneGroup502', 'expandBtn502', 'collapseBtn502')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup502"><code class="language-jsx text-sm text-gray-800">&quot;
                  required={true}
                  autoComplete=&quot;off&quot;
                  spellCheck={false}
                /&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div className=&quot;flex flex-col gap-y-2 w-full pr-10&quot;&gt;
            &lt;button
              type=&quot;submit&quot;
              disabled={loading}
              className=&quot;mt-2 w-full justify-center border-none px-4 py-2 rounded-lg text-dark-text light:text-white text-sm font-bold items-center flex gap-x-2 bg-theme-home-button-primary hover:bg-theme-home-button-primary-hover disabled:bg-theme-home-button-primary-hover disabled:cursor-not-allowed&quot;
            &gt;
              {loading ? &quot;Collecting pages...&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Confluence/index.jsx (Line 33:22 - Line 43:40), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Youtube/index.jsx (Line 22:6 - Line 32:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn503" onclick="toggleCodeBlock('cloneGroup503', 'expandBtn503', 'collapseBtn503')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn503" onclick="toggleCodeBlock('cloneGroup503', 'expandBtn503', 'collapseBtn503')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup503"><code class="language-jsx text-sm text-gray-800">),
      });

      if (!!error) {
        showToast(error, &quot;error&quot;, { clear: true });
        setLoading(false);
        return;
      }

      showToast(
        `Pages collected from Confluence space </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Confluence/index.jsx (Line 43:9 - Line 65:34), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 44:9 - Line 66:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn504" onclick="toggleCodeBlock('cloneGroup504', 'expandBtn504', 'collapseBtn504')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn504" onclick="toggleCodeBlock('cloneGroup504', 'expandBtn504', 'collapseBtn504')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup504"><code class="language-jsx text-sm text-gray-800">}. Output folder is ${data.destination}.`,
        &quot;success&quot;,
        { clear: true }
      );
      e.target.reset();
      setLoading(false);
    } catch (e) {
      console.error(e);
      showToast(e.message, &quot;error&quot;, { clear: true });
      setLoading(false);
    }
  };

  return (
    &lt;div className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pb-6 pb-16&quot;&gt;
        &lt;form className=&quot;w-full&quot; onSubmit={handleSubmit}&gt;
          &lt;div className=&quot;w-full flex flex-col py-2&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-4&quot;&gt;
              &lt;div className=&quot;flex flex-col pr-10&quot;&gt;
                &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
                  &lt;label className=&quot;text-white text-sm font-bold flex gap-x-2 items-center&quot;&gt;
                    &lt;p className=&quot;font-bold text-theme-text-primary</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/Confluence/index.jsx (Line 249:2 - Line 263:2), frontend/src/components/Modals/ManageWorkspace/DataConnectors/Connectors/DrupalWiki/index.jsx (Line 167:2 - Line 181:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn505" onclick="toggleCodeBlock('cloneGroup505', 'expandBtn505', 'collapseBtn505')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn505" onclick="toggleCodeBlock('cloneGroup505', 'expandBtn505', 'collapseBtn505')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup505"><code class="language-jsx text-sm text-gray-800">
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div className=&quot;flex flex-col gap-y-2 w-full pr-10&quot;&gt;
            &lt;button
              type=&quot;submit&quot;
              disabled={loading}
              className=&quot;mt-2 w-full justify-center border-none px-4 py-2 rounded-lg text-dark-text light:text-white text-sm font-bold items-center flex gap-x-2 bg-theme-home-button-primary hover:bg-theme-home-button-primary-hover disabled:bg-theme-home-button-primary-hover disabled:cursor-not-allowed&quot;
            &gt;
              {loading ? &quot;Collecting pages...&quot; : &quot;Submit&quot;}
            &lt;/button&gt;
            {loading &amp;&amp; (
              &lt;p className=&quot;text-xs text-theme-text-secondary&quot;&gt;
                {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 113:10 - Line 123:17), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/SetupProvider/index.jsx (Line 15:7 - Line 26:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn506" onclick="toggleCodeBlock('cloneGroup506', 'expandBtn506', 'collapseBtn506')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn506" onclick="toggleCodeBlock('cloneGroup506', 'expandBtn506', 'collapseBtn506')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup506"><code class="language-jsx text-sm text-gray-800">) return null;

  async function handleUpdate(e) {
    e.preventDefault();
    e.stopPropagation();
    const data = {};
    const form = new FormData(e.target);
    for (var [key, value] of form.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    if (error) {
      showToast(`Failed to save </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 141:10 - Line 156:10), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/SetupProvider/index.jsx (Line 44:12 - Line 59:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn507" onclick="toggleCodeBlock('cloneGroup507', 'expandBtn507', 'collapseBtn507')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn507" onclick="toggleCodeBlock('cloneGroup507', 'expandBtn507', 'collapseBtn507')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup507"><code class="language-jsx text-sm text-gray-800">.name} Settings
              &lt;/h3&gt;
            &lt;/div&gt;
            &lt;button
              onClick={closeModal}
              type=&quot;button&quot;
              className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
            &gt;
              &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          &lt;/div&gt;
          &lt;form id=&quot;provider-form&quot; onSubmit={handleUpdate}&gt;
            &lt;div className=&quot;px-7 py-6&quot;&gt;
              &lt;div className=&quot;space-y-6 max-h-[60vh] overflow-y-auto p-1&quot;&gt;
                &lt;p className=&quot;text-sm text-white/60&quot;&gt;
                  To use {LLMOption</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 160:10 - Line 184:15), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/SetupProvider/index.jsx (Line 63:12 - Line 87:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn508" onclick="toggleCodeBlock('cloneGroup508', 'expandBtn508', 'collapseBtn508')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn508" onclick="toggleCodeBlock('cloneGroup508', 'expandBtn508', 'collapseBtn508')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup508"><code class="language-jsx text-sm text-gray-800">.options(settings, { credentialsOnly: true })}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border px-7 pb-6&quot;&gt;
              &lt;button
                type=&quot;button&quot;
                onClick={closeModal}
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                form=&quot;provider-form&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Save settings
              &lt;/button&gt;
            &lt;/div&gt;
          &lt;/form&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/ModalWrapper&gt;,
    document.getElementById</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/ChatModelSelection/index.jsx (Line 9:14 - Line 19:19), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 10:20 - Line 20:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn509" onclick="toggleCodeBlock('cloneGroup509', 'expandBtn509', 'collapseBtn509')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn509" onclick="toggleCodeBlock('cloneGroup509', 'expandBtn509', 'collapseBtn509')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup509"><code class="language-jsx text-sm text-gray-800">,
}) {
  const { defaultModels, customModels, loading } =
    useGetProviderModels(provider);
  const { t } = useTranslation();
  if (DISABLED_PROVIDERS.includes(provider)) return null;

  if (loading) {
    return (
      &lt;div&gt;
        &lt;div className=&quot;flex flex-col mt-6</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/ChatModelSelection/index.jsx (Line 31:210 - Line 43:19), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 35:244 - Line 47:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn510" onclick="toggleCodeBlock('cloneGroup510', 'expandBtn510', 'collapseBtn510')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn510" onclick="toggleCodeBlock('cloneGroup510', 'expandBtn510', 'collapseBtn510')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup510"><code class="language-jsx text-sm text-gray-800">&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- waiting for models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div&gt;
      &lt;div className=&quot;flex flex-col mt-6</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/ChatModelSelection/index.jsx (Line 58:160 - Line 113:1), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 66:194 - Line 121:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn511" onclick="toggleCodeBlock('cloneGroup511', 'expandBtn511', 'collapseBtn511')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn511" onclick="toggleCodeBlock('cloneGroup511', 'expandBtn511', 'collapseBtn511')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup511"><code class="language-jsx text-sm text-gray-800">&quot;
      &gt;
        {defaultModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;General models&quot;&gt;
            {defaultModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model}
                  value={model}
                  selected={workspace?.chatModel === model}
                &gt;
                  {model}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
        {Array.isArray(customModels) &amp;&amp; customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Discovered models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={workspace?.chatModel === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
        {/* For providers like TogetherAi where we partition model by creator entity. */}
        {!Array.isArray(customModels) &amp;&amp;
          Object.keys(customModels).length &gt; 0 &amp;&amp; (
            &lt;&gt;
              {Object.entries(customModels).map(([organization, models]) =&gt; (
                &lt;optgroup key={organization} label={organization}&gt;
                  {models.map((model) =&gt; (
                    &lt;option
                      key={model.id}
                      value={model.id}
                      selected={workspace?.chatModel === model.id}
                    &gt;
                      {model.name}
                    &lt;/option&gt;
                  ))}
                &lt;/optgroup&gt;
              ))}
            &lt;/&gt;
          )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/AgentLLMItem/index.jsx (Line 1:1 - Line 12:2), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 1:1 - Line 12:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn513" onclick="toggleCodeBlock('cloneGroup513', 'expandBtn513', 'collapseBtn513')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn513" onclick="toggleCodeBlock('cloneGroup513', 'expandBtn513', 'collapseBtn513')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup513"><code class="language-jsx text-sm text-gray-800">// This component differs from the main LLMItem in that it shows if a provider is
// &quot;ready for use&quot; and if not - will then highjack the click handler to show a modal
// of the provider options that must be saved to continue.
import { createPortal } from &quot;react-dom&quot;;
import ModalWrapper from &quot;@/components/ModalWrapper&quot;;
import { useModal } from &quot;@/hooks/useModal&quot;;
import { X, Gear } from &quot;@phosphor-icons/react&quot;;
import System from &quot;@/models/system&quot;;
import showToast from &quot;@/utils/toast&quot;;
import { useEffect, useState } from &quot;react&quot;;

const NO_SETTINGS_NEEDED = [&quot;default&quot;,</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/AgentLLMItem/index.jsx (Line 13:13 - Line 78:1), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 13:13 - Line 77:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn514" onclick="toggleCodeBlock('cloneGroup514', 'expandBtn514', 'collapseBtn514')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn514" onclick="toggleCodeBlock('cloneGroup514', 'expandBtn514', 'collapseBtn514')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup514"><code class="language-jsx text-sm text-gray-800">({
  llm,
  availableLLMs,
  settings,
  checked,
  onClick,
}) {
  const { isOpen, openModal, closeModal } = useModal();
  const { name, value, logo, description } = llm;
  const [currentSettings, setCurrentSettings] = useState(settings);

  useEffect(() =&gt; {
    async function getSettings() {
      if (isOpen) {
        const _settings = await System.keys();
        setCurrentSettings(_settings ?? {});
      }
    }
    getSettings();
  }, [isOpen]);

  function handleProviderSelection() {
    // Determine if provider needs additional setup because its minimum required keys are
    // not yet set in settings.
    if (!checked) {
      const requiresAdditionalSetup = (llm.requiredConfig || []).some(
        (key) =&gt; !currentSettings[key]
      );
      if (requiresAdditionalSetup) {
        openModal();
        return;
      }
      onClick(value);
    }
  }

  return (
    &lt;&gt;
      &lt;div
        onClick={handleProviderSelection}
        className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
          checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
        }`}
      &gt;
        &lt;input
          type=&quot;checkbox&quot;
          value={value}
          className=&quot;peer hidden&quot;
          checked={checked}
          readOnly={true}
          formNoValidate={true}
        /&gt;
        &lt;div className=&quot;flex gap-x-4 items-center justify-between&quot;&gt;
          &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
            &lt;img
              src={logo}
              alt={`${name} logo`}
              className=&quot;w-10 h-10 rounded-md&quot;
            /&gt;
            &lt;div className=&quot;flex flex-col&quot;&gt;
              &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;{name}&lt;/div&gt;
              &lt;div className=&quot;mt-1 text-xs text-white/60&quot;&gt;{description}&lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          {checked &amp;&amp;
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/AgentLLMItem/index.jsx (Line 90:13 - Line 158:6), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 88:11 - Line 156:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn515" onclick="toggleCodeBlock('cloneGroup515', 'expandBtn515', 'collapseBtn515')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn515" onclick="toggleCodeBlock('cloneGroup515', 'expandBtn515', 'collapseBtn515')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup515"><code class="language-jsx text-sm text-gray-800">)}
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;SetupProvider
        availableLLMs={availableLLMs}
        isOpen={isOpen}
        provider={value}
        closeModal={closeModal}
        postSubmit={onClick}
        settings={currentSettings}
      /&gt;
    &lt;/&gt;
  );
}

function SetupProvider({
  availableLLMs,
  isOpen,
  provider,
  closeModal,
  postSubmit,
  settings,
}) {
  if (!isOpen) return null;
  const LLMOption = availableLLMs.find((llm) =&gt; llm.value === provider);
  if (!LLMOption) return null;

  async function handleUpdate(e) {
    e.preventDefault();
    e.stopPropagation();
    const data = {};
    const form = new FormData(e.target);
    for (var [key, value] of form.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    if (error) {
      showToast(`Failed to save ${LLMOption.name} settings: ${error}`, &quot;error&quot;);
      return;
    }

    closeModal();
    postSubmit();
    return false;
  }

  // Cannot do nested forms, it will cause all sorts of issues, so we portal this out
  // to the parent container form so we don't have nested forms.
  return createPortal(
    &lt;ModalWrapper isOpen={isOpen}&gt;
      &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
        &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
            &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
              &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
                {LLMOption.name} Settings
              &lt;/h3&gt;
            &lt;/div&gt;
            &lt;button
              onClick={closeModal}
              type=&quot;button&quot;
              className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
            &gt;
              &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          &lt;/div&gt;
          &lt;form id=&quot;provider-form&quot; onSubmit={handleUpdate}&gt;
            &lt;div className=&quot;px-7 py-6&quot;&gt;
              &lt;div className=&quot;space-y-6 max-h-[60vh] overflow-y-auto p-1&quot;&gt;
                &lt;p className=&quot;text-sm text-white/60&quot;&gt;
                  To use {LLMOption.name} as this workspace's agent</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/AgentLLMItem/index.jsx (Line 159:2 - Line 179:2), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 157:19 - Line 80:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn516" onclick="toggleCodeBlock('cloneGroup516', 'expandBtn516', 'collapseBtn516')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn516" onclick="toggleCodeBlock('cloneGroup516', 'expandBtn516', 'collapseBtn516')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup516"><code class="language-jsx text-sm text-gray-800">set it up first.
                &lt;/p&gt;
                &lt;div&gt;
                  {LLMOption.options(settings, { credentialsOnly: true })}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border px-7 pb-6&quot;&gt;
              &lt;button
                type=&quot;button&quot;
                onClick={closeModal}
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                form=&quot;provider-form&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Save {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/components/ShowScrollbar/index.jsx (Line 44:15 - Line 57:1), frontend/src/pages/GeneralSettings/Settings/components/SpellCheck/index.jsx (Line 38:11 - Line 51:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn517" onclick="toggleCodeBlock('cloneGroup517', 'expandBtn517', 'collapseBtn517')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn517" onclick="toggleCodeBlock('cloneGroup517', 'expandBtn517', 'collapseBtn517')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup517"><code class="language-jsx text-sm text-gray-800">&quot;
            value=&quot;yes&quot;
            checked={showScrollbar}
            onChange={handleChange}
            disabled={saving}
            className=&quot;peer sr-only&quot;
          /&gt;
          &lt;div className=&quot;pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
        &lt;/label&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/components/CustomAppName/index.jsx (Line 83:16 - Line 104:1), frontend/src/pages/GeneralSettings/Settings/components/SupportEmail/index.jsx (Line 78:14 - Line 99:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn518" onclick="toggleCodeBlock('cloneGroup518', 'expandBtn518', 'collapseBtn518')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn518" onclick="toggleCodeBlock('cloneGroup518', 'expandBtn518', 'collapseBtn518')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup518"><code class="language-jsx text-sm text-gray-800"> !== &quot;&quot; &amp;&amp; (
          &lt;button
            type=&quot;button&quot;
            onClick={(e) =&gt; updateCustomAppName(e, &quot;&quot;)}
            className=&quot;text-white text-base font-medium hover:text-opacity-60&quot;
          &gt;
            Clear
          &lt;/button&gt;
        )}
      &lt;/div&gt;
      {hasChanges &amp;&amp; (
        &lt;button
          type=&quot;submit&quot;
          className=&quot;transition-all mt-2 w-fit duration-300 border border-slate-200 px-5 py-2.5 rounded-lg text-white text-sm items-center flex gap-x-2 hover:bg-slate-200 hover:text-slate-800 focus:ring-gray-800&quot;
        &gt;
          Save
        &lt;/button&gt;
      )}
    &lt;/form&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/components/AutoSubmit/index.jsx (Line 44:12 - Line 57:1), frontend/src/pages/GeneralSettings/Settings/components/SpellCheck/index.jsx (Line 38:11 - Line 51:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn519" onclick="toggleCodeBlock('cloneGroup519', 'expandBtn519', 'collapseBtn519')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn519" onclick="toggleCodeBlock('cloneGroup519', 'expandBtn519', 'collapseBtn519')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup519"><code class="language-jsx text-sm text-gray-800">&quot;
            value=&quot;yes&quot;
            checked={autoSubmitSttInput}
            onChange={handleChange}
            disabled={saving}
            className=&quot;peer sr-only&quot;
          /&gt;
          &lt;div className=&quot;pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
        &lt;/label&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/components/AutoSpeak/index.jsx (Line 47:11 - Line 60:1), frontend/src/pages/GeneralSettings/Settings/components/SpellCheck/index.jsx (Line 38:11 - Line 51:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn520" onclick="toggleCodeBlock('cloneGroup520', 'expandBtn520', 'collapseBtn520')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn520" onclick="toggleCodeBlock('cloneGroup520', 'expandBtn520', 'collapseBtn520')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup520"><code class="language-jsx text-sm text-gray-800">&quot;
            value=&quot;yes&quot;
            checked={autoPlayAssistantTtsResponse}
            onChange={handleChange}
            disabled={saving}
            className=&quot;peer sr-only&quot;
          /&gt;
          &lt;div className=&quot;pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
        &lt;/label&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/index.jsx (Line 112:4 - Line 133:5), frontend/src/pages/GeneralSettings/CommunityHub/Trending/HubItems/index.jsx (Line 92:2 - Line 113:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn521" onclick="toggleCodeBlock('cloneGroup521', 'expandBtn521', 'collapseBtn521')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn521" onclick="toggleCodeBlock('cloneGroup521', 'expandBtn521', 'collapseBtn521')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup521"><code class="language-jsx text-sm text-gray-800">&gt;
      &lt;div className=&quot;rounded-lg w-full&quot;&gt;
        &lt;div className=&quot;flex justify-between items-center&quot;&gt;
          &lt;Skeleton.default
            height=&quot;40px&quot;
            width=&quot;300px&quot;
            highlightColor=&quot;var(--theme-settings-input-active)&quot;
            baseColor=&quot;var(--theme-settings-input-bg)&quot;
            count={1}
          /&gt;
        &lt;/div&gt;
        &lt;Skeleton.default
          height=&quot;200px&quot;
          width=&quot;300px&quot;
          highlightColor=&quot;var(--theme-settings-input-active)&quot;
          baseColor=&quot;var(--theme-settings-input-bg)&quot;
          count={4}
          className=&quot;rounded-lg&quot;
          containerClassName=&quot;flex flex-wrap gap-2 mt-1&quot;
        /&gt;
      &lt;/div&gt;
    </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 35:2 - Line 45:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 28:2 - Line 37:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn522" onclick="toggleCodeBlock('cloneGroup522', 'expandBtn522', 'collapseBtn522')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn522" onclick="toggleCodeBlock('cloneGroup522', 'expandBtn522', 'collapseBtn522')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup522"><code class="language-jsx text-sm text-gray-800">
    setError(error);
  };

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Create new</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 45:10 - Line 59:3), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 52:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn523" onclick="toggleCodeBlock('cloneGroup523', 'expandBtn523', 'collapseBtn523')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn523" onclick="toggleCodeBlock('cloneGroup523', 'expandBtn523', 'collapseBtn523')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup523"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;px-7 py-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-6 max-h-[60vh] overflow-y-auto pr-2&quot;&gt;
              &lt;WorkspaceSelection /&gt;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 92:64 - Line 110:6), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 96:71 - Line 83:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn524" onclick="toggleCodeBlock('cloneGroup524', 'expandBtn524', 'collapseBtn524')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn524" onclick="toggleCodeBlock('cloneGroup524', 'expandBtn524', 'collapseBtn524')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup524"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
                  &amp;lt;script&amp;gt;
                &lt;/code&gt;{&quot; &quot;}
                tag.
              &lt;/p&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Create embed</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 211:6 - Line 235:6), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 185:2 - Line 209:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn525" onclick="toggleCodeBlock('cloneGroup525', 'expandBtn525', 'collapseBtn525')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn525" onclick="toggleCodeBlock('cloneGroup525', 'expandBtn525', 'collapseBtn525')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup525"><code class="language-jsx text-sm text-gray-800">&gt;
        &lt;label
          className={`transition-all duration-300 w-full h-11 p-2.5 rounded-lg flex justify-start items-center gap-2.5 cursor-pointer border ${
            chatMode === &quot;query&quot;
              ? &quot;border-theme-sidebar-item-workspace-active bg-theme-bg-secondary&quot;
              : &quot;border-theme-sidebar-border hover:border-theme-sidebar-border hover:bg-theme-bg-secondary&quot;
          } `}
        &gt;
          &lt;input
            type=&quot;radio&quot;
            name=&quot;chat_mode&quot;
            value={&quot;query&quot;}
            checked={chatMode === &quot;query&quot;}
            onChange={(e) =&gt; setChatMode(e.target.value)}
            className=&quot;hidden&quot;
          /&gt;
          &lt;div
            className={`w-4 h-4 rounded-full border-2 border-theme-sidebar-border mr-2 ${
              chatMode === &quot;query&quot;
                ? &quot;bg-[var(--theme-sidebar-item-workspace-active)]&quot;
                : &quot;&quot;
            }`}
          &gt;&lt;/div&gt;
          &lt;div className=&quot;text-theme-text-primary text-sm font-medium font-['Plus Jakarta Sans'] leading-tight&quot;&gt;
            Query</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 40:2 - Line 51:5), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 27:4 - Line 38:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn526" onclick="toggleCodeBlock('cloneGroup526', 'expandBtn526', 'collapseBtn526')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn526" onclick="toggleCodeBlock('cloneGroup526', 'expandBtn526', 'collapseBtn526')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup526"><code class="language-jsx text-sm text-gray-800">);
    }
    setError(error);
  };

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Edit</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 51:9 - Line 67:9), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:3 - Line 53:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn527" onclick="toggleCodeBlock('cloneGroup527', 'expandBtn527', 'collapseBtn527')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn527" onclick="toggleCodeBlock('cloneGroup527', 'expandBtn527', 'collapseBtn527')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup527"><code class="language-jsx text-sm text-gray-800">}
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleUpdate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;username</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 149:3 - Line 164:5), frontend/src/components/Modals/ManageWorkspace/Documents/Directory/NewFolderModal/index.jsx (Line 68:2 - Line 114:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn528" onclick="toggleCodeBlock('cloneGroup528', 'expandBtn528', 'collapseBtn528')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn528" onclick="toggleCodeBlock('cloneGroup528', 'expandBtn528', 'collapseBtn528')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup528"><code class="language-jsx text-sm text-gray-800">
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Update user</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 30:2 - Line 40:9), frontend/src/components/Modals/ManageWorkspace/Documents/Directory/NewFolderModal/index.jsx (Line 27:2 - Line 51:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn529" onclick="toggleCodeBlock('cloneGroup529', 'expandBtn529', 'collapseBtn529')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn529" onclick="toggleCodeBlock('cloneGroup529', 'expandBtn529', 'collapseBtn529')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup529"><code class="language-jsx text-sm text-gray-800">
    }
  };

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Edit {variable</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 40:4 - Line 56:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:3 - Line 53:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn530" onclick="toggleCodeBlock('cloneGroup530', 'expandBtn530', 'collapseBtn530')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn530" onclick="toggleCodeBlock('cloneGroup530', 'expandBtn530', 'collapseBtn530')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup530"><code class="language-jsx text-sm text-gray-800">}
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleUpdate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;key</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 108:2 - Line 125:9), frontend/src/components/Modals/ManageWorkspace/Documents/Directory/NewFolderModal/index.jsx (Line 66:2 - Line 114:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn531" onclick="toggleCodeBlock('cloneGroup531', 'expandBtn531', 'collapseBtn531')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn531" onclick="toggleCodeBlock('cloneGroup531', 'expandBtn531', 'collapseBtn531')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup531"><code class="language-jsx text-sm text-gray-800">
                /&gt;
              &lt;/div&gt;
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Update variable</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 141:4 - Line 151:23), frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 79:10 - Line 89:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn532" onclick="toggleCodeBlock('cloneGroup532', 'expandBtn532', 'collapseBtn532')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn532" onclick="toggleCodeBlock('cloneGroup532', 'expandBtn532', 'collapseBtn532')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup532"><code class="language-jsx text-sm text-gray-800">.
        &lt;/a&gt;
      &lt;/p&gt;
      &lt;div className=&quot;flex gap-x-4&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;env::AgentSerperApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 176:7 - Line 186:27), frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 79:10 - Line 89:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn533" onclick="toggleCodeBlock('cloneGroup533', 'expandBtn533', 'collapseBtn533')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn533" onclick="toggleCodeBlock('cloneGroup533', 'expandBtn533', 'collapseBtn533')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup533"><code class="language-jsx text-sm text-gray-800">.
        &lt;/a&gt;
      &lt;/p&gt;
      &lt;div className=&quot;flex gap-x-4&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;env::AgentBingSearchApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 240:3 - Line 250:23), frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 79:10 - Line 89:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn534" onclick="toggleCodeBlock('cloneGroup534', 'expandBtn534', 'collapseBtn534')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn534" onclick="toggleCodeBlock('cloneGroup534', 'expandBtn534', 'collapseBtn534')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup534"><code class="language-jsx text-sm text-gray-800">.
        &lt;/a&gt;
      &lt;/p&gt;
      &lt;div className=&quot;flex gap-x-4&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;env::AgentSerplyApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 297:7 - Line 307:23), frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderOptions/index.jsx (Line 79:10 - Line 89:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn535" onclick="toggleCodeBlock('cloneGroup535', 'expandBtn535', 'collapseBtn535')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn535" onclick="toggleCodeBlock('cloneGroup535', 'expandBtn535', 'collapseBtn535')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup535"><code class="language-jsx text-sm text-gray-800">.
        &lt;/a&gt;
      &lt;/p&gt;
      &lt;div className=&quot;flex gap-x-4&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;env::AgentTavilyApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 213:2 - Line 228:7), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/ActionMenu/index.jsx (Line 22:2 - Line 37:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn536" onclick="toggleCodeBlock('cloneGroup536', 'expandBtn536', 'collapseBtn536')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn536" onclick="toggleCodeBlock('cloneGroup536', 'expandBtn536', 'collapseBtn536')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup536"><code class="language-jsx text-sm text-gray-800">

  useEffect(() =&gt; {
    const handleClickOutside = (event) =&gt; {
      if (menuRef.current &amp;&amp; !menuRef.current.contains(event.target)) {
        setOpen(false);
      }
    };

    document.addEventListener(&quot;mousedown&quot;, handleClickOutside);
    return () =&gt; {
      document.removeEventListener(&quot;mousedown&quot;, handleClickOutside);
    };
  }, []);

  if (!config</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/AgentBuilder/nodes/LLMInstructionNode/index.jsx (Line 27:1 - Line 42:1), frontend/src/pages/Admin/AgentBuilder/nodes/WebScrapingNode/index.jsx (Line 103:2 - Line 118:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn537" onclick="toggleCodeBlock('cloneGroup537', 'expandBtn537', 'collapseBtn537')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn537" onclick="toggleCodeBlock('cloneGroup537', 'expandBtn537', 'collapseBtn537')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup537"><code class="language-jsx text-sm text-gray-800">
      &lt;div&gt;
        &lt;label className=&quot;block text-sm font-medium text-theme-text-primary mb-2&quot;&gt;
          Result Variable
        &lt;/label&gt;
        {renderVariableSelect(
          config.resultVariable,
          (value) =&gt; onConfigChange({ ...config, resultVariable: value }),
          &quot;Select or create variable&quot;,
          true
        )}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/AgentBuilder/nodes/FileNode/index.jsx (Line 59:2 - Line 73:1), frontend/src/pages/Admin/AgentBuilder/nodes/WebsiteNode/index.jsx (Line 55:2 - Line 69:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn538" onclick="toggleCodeBlock('cloneGroup538', 'expandBtn538', 'collapseBtn538')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn538" onclick="toggleCodeBlock('cloneGroup538', 'expandBtn538', 'collapseBtn538')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup538"><code class="language-jsx text-sm text-gray-800">
      &lt;div&gt;
        &lt;label className=&quot;block text-sm font-medium text-white mb-2&quot;&gt;
          Store Result In
        &lt;/label&gt;
        {renderVariableSelect(
          config.resultVariable,
          (value) =&gt; onConfigChange({ resultVariable: value }),
          &quot;Select or create variable&quot;
        )}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/AgentBuilder/nodes/CodeNode/index.jsx (Line 39:2 - Line 57:1), frontend/src/pages/Admin/AgentBuilder/nodes/WebsiteNode/index.jsx (Line 51:2 - Line 69:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn539" onclick="toggleCodeBlock('cloneGroup539', 'expandBtn539', 'collapseBtn539')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn539" onclick="toggleCodeBlock('cloneGroup539', 'expandBtn539', 'collapseBtn539')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup539"><code class="language-jsx text-sm text-gray-800">
          autoComplete=&quot;off&quot;
          spellCheck={false}
        /&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;label className=&quot;block text-sm font-medium text-white mb-2&quot;&gt;
          Store Result In
        &lt;/label&gt;
        {renderVariableSelect(
          config.resultVariable,
          (value) =&gt; onConfigChange({ resultVariable: value }),
          &quot;Select or create variable&quot;
        )}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/Attachments/index.jsx (Line 110:13 - Line 127:2), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/Attachments/index.jsx (Line 69:9 - Line 86:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn540" onclick="toggleCodeBlock('cloneGroup540', 'expandBtn540', 'collapseBtn540')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn540" onclick="toggleCodeBlock('cloneGroup540', 'expandBtn540', 'collapseBtn540')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup540"><code class="language-jsx text-sm text-gray-800">) {
    return (
      &lt;&gt;
        &lt;div
          data-tooltip-id={`attachment-uid-${uid}-success`}
          data-tooltip-content={`${file.name} will be attached to this prompt. It will not be embedded into the workspace permanently.`}
          className={`relative flex items-center gap-x-1 rounded-lg bg-theme-attachment-success-bg border-none w-[180px] group`}
        &gt;
          &lt;div className=&quot;invisible group-hover:visible absolute -top-[5px] -right-[5px] w-fit h-fit z-[10]&quot;&gt;
            &lt;button
              onClick={removeFileFromQueue}
              type=&quot;button&quot;
              className=&quot;bg-white hover:bg-error hover:text-theme-attachment-text rounded-full p-1 flex items-center justify-center hover:border-transparent border border-theme-attachment-bg&quot;
            &gt;
              &lt;X size={10} className=&quot;flex-shrink-0&quot; /&gt;
            &lt;/button&gt;
          &lt;/div&gt;
          {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/Attachments/index.jsx (Line 145:2 - Line 159:7), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/Attachments/index.jsx (Line 96:2 - Line 110:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn541" onclick="toggleCodeBlock('cloneGroup541', 'expandBtn541', 'collapseBtn541')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn541" onclick="toggleCodeBlock('cloneGroup541', 'expandBtn541', 'collapseBtn541')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup541"><code class="language-jsx text-sm text-gray-800">
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;Tooltip
          id={`attachment-uid-${uid}-success`}
          place=&quot;top&quot;
          delayShow={300}
          className=&quot;allm-tooltip !allm-text-xs&quot;
        /&gt;
      &lt;/&gt;
    );
  }

  return</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/AgentMenu/index.jsx (Line 64:2 - Line 75:17), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/TextSizeMenu/index.jsx (Line 50:3 - Line 61:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn542" onclick="toggleCodeBlock('cloneGroup542', 'expandBtn542', 'collapseBtn542')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn542" onclick="toggleCodeBlock('cloneGroup542', 'expandBtn542', 'collapseBtn542')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup542"><code class="language-jsx text-sm text-gray-800">);

  useEffect(() =&gt; {
    function listenForOutsideClick() {
      if (!showing || !formRef.current) return false;
      document.addEventListener(&quot;click&quot;, closeIfOutside);
    }
    listenForOutsideClick();
  }, [showing, formRef.current]);

  const closeIfOutside = ({ target }) =&gt; {
    if (target.id === &quot;agent-list-btn&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/index.jsx (Line 138:2 - Line 150:2), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/PromptReply/index.jsx (Line 82:2 - Line 94:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn543" onclick="toggleCodeBlock('cloneGroup543', 'expandBtn543', 'collapseBtn543')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn543" onclick="toggleCodeBlock('cloneGroup543', 'expandBtn543', 'collapseBtn543')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup543"><code class="language-jsx text-sm text-gray-800">workspace.pfpUrl) {
    return (
      &lt;div className=&quot;relative w-[35px] h-[35px] rounded-full flex-shrink-0 overflow-hidden&quot;&gt;
        &lt;img
          src={workspace.pfpUrl}
          alt=&quot;Workspace profile picture&quot;
          className=&quot;absolute top-0 left-0 w-full h-full object-cover rounded-full bg-white&quot;
        /&gt;
      &lt;/div&gt;
    );
  }

  return (</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Citation/index.jsx (Line 162:2 - Line 175:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 40:2 - Line 69:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn544" onclick="toggleCodeBlock('cloneGroup544', 'expandBtn544', 'collapseBtn544')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn544" onclick="toggleCodeBlock('cloneGroup544', 'expandBtn544', 'collapseBtn544')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup544"><code class="language-jsx text-sm text-gray-800">
          &lt;button
            onClick={onClose}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div
          className=&quot;h-full w-full overflow-y-auto&quot;
          style={{ maxHeight: &quot;calc(100vh - 200px)&quot; }}
        &gt;
          &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 202:13 - Line 231:8), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 142:14 - Line 171:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn546" onclick="toggleCodeBlock('cloneGroup546', 'expandBtn546', 'collapseBtn546')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn546" onclick="toggleCodeBlock('cloneGroup546', 'expandBtn546', 'collapseBtn546')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup546"><code class="language-jsx text-sm text-gray-800"> width={500} height={260} data={data}&gt;
              &lt;CartesianGrid
                strokeDasharray=&quot;3 3&quot;
                horizontal
                vertical={false}
              /&gt;
              &lt;XAxis
                dataKey=&quot;name&quot;
                tickLine={false}
                axisLine={false}
                interval=&quot;preserveStartEnd&quot;
                tick={{ transform: &quot;translate(0, 6)&quot;, fill: &quot;white&quot; }}
                style={{
                  fontSize: &quot;12px&quot;,
                  fontFamily: &quot;Inter; Helvetica&quot;,
                }}
                padding={{ left: 10, right: 10 }}
              /&gt;
              &lt;YAxis
                tickLine={false}
                axisLine={false}
                type=&quot;number&quot;
                tick={{ transform: &quot;translate(-3, 0)&quot;, fill: &quot;white&quot; }}
                style={{
                  fontSize: &quot;12px&quot;,
                  fontFamily: &quot;Inter; Helvetica&quot;,
                }}
              /&gt;
              &lt;Tooltip legendColor={getTremorColor(color || &quot;blue&quot;)} /&gt;
              &lt;Scatter</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 261:8 - Line 276:11), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 187:10 - Line 202:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn547" onclick="toggleCodeBlock('cloneGroup547', 'expandBtn547', 'collapseBtn547')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn547" onclick="toggleCodeBlock('cloneGroup547', 'expandBtn547', 'collapseBtn547')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup547"><code class="language-jsx text-sm text-gray-800">:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[value]}
                  colors={[color || &quot;blue&quot;, color || &quot;blue&quot;]}
                  className=&quot;mb-5&quot;
                /&gt;
              &lt;/div&gt;
            )}
            &lt;RadarChart</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 297:12 - Line 312:15), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 187:10 - Line 202:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn548" onclick="toggleCodeBlock('cloneGroup548', 'expandBtn548', 'collapseBtn548')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn548" onclick="toggleCodeBlock('cloneGroup548', 'expandBtn548', 'collapseBtn548')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup548"><code class="language-jsx text-sm text-gray-800">:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[value]}
                  colors={[color || &quot;blue&quot;, color || &quot;blue&quot;]}
                  className=&quot;mb-5&quot;
                /&gt;
              &lt;/div&gt;
            )}
            &lt;RadialBarChart</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 334:10 - Line 349:8), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 187:10 - Line 202:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn549" onclick="toggleCodeBlock('cloneGroup549', 'expandBtn549', 'collapseBtn549')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn549" onclick="toggleCodeBlock('cloneGroup549', 'expandBtn549', 'collapseBtn549')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup549"><code class="language-jsx text-sm text-gray-800">:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[value]}
                  colors={[color || &quot;blue&quot;, color || &quot;blue&quot;]}
                  className=&quot;mb-5&quot;
                /&gt;
              &lt;/div&gt;
            )}
            &lt;Treemap</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 362:9 - Line 377:12), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/Chartable/index.jsx (Line 187:10 - Line 202:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn550" onclick="toggleCodeBlock('cloneGroup550', 'expandBtn550', 'collapseBtn550')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn550" onclick="toggleCodeBlock('cloneGroup550', 'expandBtn550', 'collapseBtn550')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup550"><code class="language-jsx text-sm text-gray-800">:
        return (
          &lt;div className=&quot;bg-theme-bg-primary p-8 rounded-xl text-white light:border light:border-theme-border-primary&quot;&gt;
            &lt;h3 className=&quot;text-lg text-theme-text-primary font-medium&quot;&gt;
              {title}
            &lt;/h3&gt;
            {showLegend &amp;&amp; (
              &lt;div className=&quot;flex justify-end&quot;&gt;
                &lt;Legend
                  categories={[value]}
                  colors={[color || &quot;blue&quot;, color || &quot;blue&quot;]}
                  className=&quot;mb-5&quot;
                /&gt;
              &lt;/div&gt;
            )}
            &lt;FunnelChart</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/Documents/WorkspaceDirectory/index.jsx (Line 352:36 - Line 365:2), frontend/src/components/Modals/ManageWorkspace/Documents/WorkspaceDirectory/index.jsx (Line 287:34 - Line 301:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn551" onclick="toggleCodeBlock('cloneGroup551', 'expandBtn551', 'collapseBtn551')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn551" onclick="toggleCodeBlock('cloneGroup551', 'expandBtn551', 'collapseBtn551')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup551"><code class="language-jsx text-sm text-gray-800">)}
            &lt;/h3&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div className=&quot;py-7 px-9 space-y-2 flex-col&quot;&gt;
          &lt;div className=&quot;w-full text-white text-md flex flex-col gap-y-2&quot;&gt;
            &lt;p&gt;
              &lt;span
                dangerouslySetInnerHTML={{
                  __html: t(&quot;connectors.watching.watch_explained_block1&quot;),
                }}
              /&gt;
            &lt;/p&gt;
            &lt;p&gt;{</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentModelSelection/index.jsx (Line 86:2 - Line 97:19), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 38:3 - Line 49:53)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn553" onclick="toggleCodeBlock('cloneGroup553', 'expandBtn553', 'collapseBtn553')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn553" onclick="toggleCodeBlock('cloneGroup553', 'expandBtn553', 'collapseBtn553')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup553"><code class="language-jsx text-sm text-gray-800">
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div&gt;
      &lt;div className=&quot;flex flex-col&quot;&gt;
        &lt;label htmlFor=&quot;name&quot; className=&quot;block input-label&quot;&gt;
          {t(&quot;agent.mode.title&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentModelSelection/index.jsx (Line 105:11 - Line 115:3), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/ChatModelSelection/index.jsx (Line 53:10 - Line 63:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn554" onclick="toggleCodeBlock('cloneGroup554', 'expandBtn554', 'collapseBtn554')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn554" onclick="toggleCodeBlock('cloneGroup554', 'expandBtn554', 'collapseBtn554')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup554"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        onChange={() =&gt; {
          setHasChanges(true);
        }}
        className=&quot;border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
      &gt;
        {defaultModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;General models&quot;&gt;
            {defaultModels.map((model) =&gt; {
              if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentModelSelection/index.jsx (Line 115:2 - Line 129:14), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 70:2 - Line 84:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn555" onclick="toggleCodeBlock('cloneGroup555', 'expandBtn555', 'collapseBtn555')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn555" onclick="toggleCodeBlock('cloneGroup555', 'expandBtn555', 'collapseBtn555')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup555"><code class="language-jsx text-sm text-gray-800">
              return (
                &lt;option
                  key={model}
                  value={model}
                  selected={workspace?.agentModel === model}
                &gt;
                  {model}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
        {Array.isArray(customModels) &amp;&amp; customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Custom models</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentModelSelection/index.jsx (Line 132:1 - Line 151:2), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 85:2 - Line 104:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn556" onclick="toggleCodeBlock('cloneGroup556', 'expandBtn556', 'collapseBtn556')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn556" onclick="toggleCodeBlock('cloneGroup556', 'expandBtn556', 'collapseBtn556')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup556"><code class="language-jsx text-sm text-gray-800">
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={workspace?.agentModel === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
        {/* For providers like TogetherAi where we partition model by creator entity. */}
        {!Array.isArray(customModels) &amp;&amp;
          Object.keys(customModels).length &gt; 0 &amp;&amp; (
            &lt;&gt;
              {Object.entries(customModels).map(([organization, models]) =&gt; (
                &lt;optgroup key={organization} label={organization}&gt;
                  {models.map((model) =&gt; {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/index.jsx (Line 75:7 - Line 102:12), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 43:10 - Line 70:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn558" onclick="toggleCodeBlock('cloneGroup558', 'expandBtn558', 'collapseBtn558')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn558" onclick="toggleCodeBlock('cloneGroup558', 'expandBtn558', 'collapseBtn558')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup558"><code class="language-jsx text-sm text-gray-800">
  );
  const [searchQuery, setSearchQuery] = useState(&quot;&quot;);
  const [searchMenuOpen, setSearchMenuOpen] = useState(false);
  const searchInputRef = useRef(null);
  const { t } = useTranslation();
  function updateLLMChoice(selection) {
    setSearchQuery(&quot;&quot;);
    setSelectedLLM(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  }

  function handleXButton() {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  }

  useEffect(() =&gt; {
    const filtered = LLMS.filter((llm) =&gt;
      llm.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredLLMs(filtered);
  }, [searchQuery</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/index.jsx (Line 126:14 - Line 146:2), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 85:13 - Line 106:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn559" onclick="toggleCodeBlock('cloneGroup559', 'expandBtn559', 'collapseBtn559')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn559" onclick="toggleCodeBlock('cloneGroup559', 'expandBtn559', 'collapseBtn559')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup559"><code class="language-jsx text-sm text-gray-800">&quot; value={selectedLLM} /&gt;
        {searchMenuOpen &amp;&amp; (
          &lt;div
            className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
            onClick={() =&gt; setSearchMenuOpen(false)}
          /&gt;
        )}
        {searchMenuOpen ? (
          &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
              &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                &lt;MagnifyingGlass
                  size={20}
                  weight=&quot;bold&quot;
                  className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                /&gt;
                &lt;input
                  type=&quot;text&quot;
                  name=&quot;llm-search&quot;
                  autoComplete=&quot;off&quot;
                  placeholder=</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/index.jsx (Line 147:180 - Line 164:13), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 106:252 - Line 123:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn560" onclick="toggleCodeBlock('cloneGroup560', 'expandBtn560', 'collapseBtn560')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn560" onclick="toggleCodeBlock('cloneGroup560', 'expandBtn560', 'collapseBtn560')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup560"><code class="language-jsx text-sm text-gray-800">&quot;
                  onChange={(e) =&gt; setSearchQuery(e.target.value)}
                  ref={searchInputRef}
                  onKeyDown={(e) =&gt; {
                    if (e.key === &quot;Enter&quot;) e.preventDefault();
                  }}
                /&gt;
                &lt;X
                  size={20}
                  weight=&quot;bold&quot;
                  className=&quot;cursor-pointer text-theme-text-primary hover:text-x-button&quot;
                  onClick={handleXButton}
                /&gt;
              &lt;/div&gt;
              &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                {filteredLLMs.map((llm) =&gt; {
                  return (
                    &lt;AgentLLMItem</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/AgentConfig/AgentLLMSelection/index.jsx (Line 164:13 - Line 202:2), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 123:17 - Line 161:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn561" onclick="toggleCodeBlock('cloneGroup561', 'expandBtn561', 'collapseBtn561')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn561" onclick="toggleCodeBlock('cloneGroup561', 'expandBtn561', 'collapseBtn561')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup561"><code class="language-jsx text-sm text-gray-800">
                      llm={llm}
                      key={llm.name}
                      availableLLMs={LLMS}
                      settings={settings}
                      checked={selectedLLM === llm.value}
                      onClick={() =&gt; updateLLMChoice(llm.value)}
                    /&gt;
                  );
                })}
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        ) : (
          &lt;button
            className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
            type=&quot;button&quot;
            onClick={() =&gt; setSearchMenuOpen(true)}
          &gt;
            &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
              &lt;img
                src={selectedLLMObject.logo}
                alt={`${selectedLLMObject.name} logo`}
                className=&quot;w-10 h-10 rounded-md&quot;
              /&gt;
              &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                  {selectedLLMObject.name}
                &lt;/div&gt;
                &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;
                  {selectedLLMObject.description}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;CaretUpDown size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        )}
      &lt;/div&gt;
      {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/OnboardingFlow/Steps/Survey/index.jsx (Line 181:6 - Line 205:36), frontend/src/pages/OnboardingFlow/Steps/Survey/index.jsx (Line 155:2 - Line 179:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn562" onclick="toggleCodeBlock('cloneGroup562', 'expandBtn562', 'collapseBtn562')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn562" onclick="toggleCodeBlock('cloneGroup562', 'expandBtn562', 'collapseBtn562')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup562"><code class="language-jsx text-sm text-gray-800">&gt;
            &lt;label
              className={`border-solid transition-all duration-300 w-full h-11 p-2.5 rounded-lg flex justify-start items-center gap-2.5 cursor-pointer border-[1px] ${
                selectedOption === &quot;personal&quot;
                  ? &quot;border-theme-sidebar-item-workspace-active bg-theme-bg-secondary&quot;
                  : &quot;border-theme-sidebar-border&quot;
              } hover:border-theme-sidebar-border hover:bg-theme-bg-secondary`}
            &gt;
              &lt;input
                type=&quot;radio&quot;
                name=&quot;use_case&quot;
                value={&quot;personal&quot;}
                checked={selectedOption === &quot;personal&quot;}
                onChange={(e) =&gt; setSelectedOption(e.target.value)}
                className=&quot;hidden&quot;
              /&gt;
              &lt;div
                className={`w-4 h-4 rounded-full border-2 border-theme-sidebar-border mr-2 ${
                  selectedOption === &quot;personal&quot;
                    ? &quot;bg-[var(--theme-sidebar-item-workspace-active)]&quot;
                    : &quot;&quot;
                }`}
              &gt;&lt;/div&gt;
              &lt;div className=&quot;text-theme-text-primary text-sm font-medium font-['Plus Jakarta Sans'] leading-tight&quot;&gt;
                {t(&quot;onboarding.survey.useCasePersonal&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/OnboardingFlow/Steps/Survey/index.jsx (Line 205:36 - Line 231:33), frontend/src/pages/OnboardingFlow/Steps/Survey/index.jsx (Line 179:32 - Line 179:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn563" onclick="toggleCodeBlock('cloneGroup563', 'expandBtn563', 'collapseBtn563')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn563" onclick="toggleCodeBlock('cloneGroup563', 'expandBtn563', 'collapseBtn563')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup563"><code class="language-jsx text-sm text-gray-800">)}
              &lt;/div&gt;
            &lt;/label&gt;
            &lt;label
              className={`border-solid transition-all duration-300 w-full h-11 p-2.5 rounded-lg flex justify-start items-center gap-2.5 cursor-pointer border-[1px] ${
                selectedOption === &quot;other&quot;
                  ? &quot;border-theme-sidebar-item-workspace-active bg-theme-bg-secondary&quot;
                  : &quot;border-theme-sidebar-border&quot;
              } hover:border-theme-sidebar-border hover:bg-theme-bg-secondary`}
            &gt;
              &lt;input
                type=&quot;radio&quot;
                name=&quot;use_case&quot;
                value={&quot;other&quot;}
                checked={selectedOption === &quot;other&quot;}
                onChange={(e) =&gt; setSelectedOption(e.target.value)}
                className=&quot;hidden&quot;
              /&gt;
              &lt;div
                className={`w-4 h-4 rounded-full border-2 border-theme-sidebar-border mr-2 ${
                  selectedOption === &quot;other&quot;
                    ? &quot;bg-[var(--theme-sidebar-item-workspace-active)]&quot;
                    : &quot;&quot;
                }`}
              &gt;&lt;/div&gt;
              &lt;div className=&quot;text-theme-text-primary text-sm font-medium font-['Plus Jakarta Sans'] leading-tight&quot;&gt;
                {t(&quot;onboarding.survey.useCaseOther&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/Chat/index.jsx (Line 8:13 - Line 22:27), frontend/src/pages/GeneralSettings/Settings/Interface/index.jsx (Line 9:18 - Line 23:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn567" onclick="toggleCodeBlock('cloneGroup567', 'expandBtn567', 'collapseBtn567')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn567" onclick="toggleCodeBlock('cloneGroup567', 'expandBtn567', 'collapseBtn567')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup567"><code class="language-jsx text-sm text-gray-800">() {
  const { t } = useTranslation();

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[86px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
            &lt;div className=&quot;items-center&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
                {t(&quot;customization.chat.title&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Settings/Branding/index.jsx (Line 11:17 - Line 25:31), frontend/src/pages/GeneralSettings/Settings/Interface/index.jsx (Line 9:18 - Line 23:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn568" onclick="toggleCodeBlock('cloneGroup568', 'expandBtn568', 'collapseBtn568')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn568" onclick="toggleCodeBlock('cloneGroup568', 'expandBtn568', 'collapseBtn568')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup568"><code class="language-jsx text-sm text-gray-800">() {
  const { t } = useTranslation();

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[86px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
            &lt;div className=&quot;items-center&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
                {t(&quot;customization.branding.title&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/CommunityHub/Trending/index.jsx (Line 5:2 - Line 16:52), frontend/src/pages/GeneralSettings/Settings/Interface/index.jsx (Line 11:1 - Line 22:39)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn569" onclick="toggleCodeBlock('cloneGroup569', 'expandBtn569', 'collapseBtn569')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn569" onclick="toggleCodeBlock('cloneGroup569', 'expandBtn569', 'collapseBtn569')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup569"><code class="language-jsx text-sm text-gray-800">
  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[86px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
            &lt;div className=&quot;items-center&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/ChatRow/index.jsx (Line 21:2 - Line 35:1), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/ChatRow/index.jsx (Line 6:2 - Line 19:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn570" onclick="toggleCodeBlock('cloneGroup570', 'expandBtn570', 'collapseBtn570')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn570" onclick="toggleCodeBlock('cloneGroup570', 'expandBtn570', 'collapseBtn570')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup570"><code class="language-jsx text-sm text-gray-800">

export default function ChatRow({ chat, onDelete }) {
  const {
    isOpen: isPromptOpen,
    openModal: openPromptModal,
    closeModal: closePromptModal,
  } = useModal();
  const {
    isOpen: isResponseOpen,
    openModal: openResponseModal,
    closeModal: closeResponseModal,
  } = useModal();

</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/ChatRow/index.jsx (Line 32:19 - Line 42:7), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/ChatRow/index.jsx (Line 22:28 - Line 32:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn571" onclick="toggleCodeBlock('cloneGroup571', 'expandBtn571', 'collapseBtn571')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn571" onclick="toggleCodeBlock('cloneGroup571', 'expandBtn571', 'collapseBtn571')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup571"><code class="language-jsx text-sm text-gray-800">,
  } = useModal();

  const handleDelete = async () =&gt; {
    if (
      !window.confirm(
        `Are you sure you want to delete this chat?\n\nThis action is irreversible.`
      )
    )
      return false;
    await System</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/ChatRow/index.jsx (Line 74:3 - Line 87:5), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/ChatRow/index.jsx (Line 77:2 - Line 90:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn572" onclick="toggleCodeBlock('cloneGroup572', 'expandBtn572', 'collapseBtn572')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn572" onclick="toggleCodeBlock('cloneGroup572', 'expandBtn572', 'collapseBtn572')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup572"><code class="language-jsx text-sm text-gray-800">
          &lt;/button&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;ModalWrapper isOpen={isPromptOpen}&gt;
        &lt;TextPreview text={chat.prompt} closeModal={closePromptModal} /&gt;
      &lt;/ModalWrapper&gt;
      &lt;ModalWrapper isOpen={isResponseOpen}&gt;
        &lt;TextPreview
          text={parseText(chat.response)}
          closeModal={closeResponseModal}
        /&gt;
      &lt;/ModalWrapper&gt;
    </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/ChatRow/index.jsx (Line 89:2 - Line 113:1), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/ChatRow/index.jsx (Line 105:1 - Line 129:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn573" onclick="toggleCodeBlock('cloneGroup573', 'expandBtn573', 'collapseBtn573')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn573" onclick="toggleCodeBlock('cloneGroup573', 'expandBtn573', 'collapseBtn573')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup573"><code class="language-jsx text-sm text-gray-800">
const TextPreview = ({ text, closeModal }) =&gt; {
  return (
    &lt;div className=&quot;relative w-full md:max-w-2xl max-h-full&quot;&gt;
      &lt;div className=&quot;w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border overflow-hidden&quot;&gt;
        &lt;div className=&quot;flex items-center justify-between p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;h3 className=&quot;text-xl font-semibold text-white&quot;&gt;Viewing Text&lt;/h3&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;bg-transparent rounded-lg text-sm p-1.5 ml-auto inline-flex items-center bg-sidebar-button hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X className=&quot;text-white text-lg&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;w-full p-6&quot;&gt;
          &lt;pre className=&quot;w-full h-[200px] py-2 px-4 whitespace-pre-line overflow-auto rounded-lg bg-zinc-900 light:bg-theme-bg-secondary border border-gray-500 text-white text-sm&quot;&gt;
            {text}
          &lt;/pre&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/index.jsx (Line 25:11 - Line 36:54), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 49:10 - Line 60:59)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn574" onclick="toggleCodeBlock('cloneGroup574', 'expandBtn574', 'collapseBtn574')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn574" onclick="toggleCodeBlock('cloneGroup574', 'expandBtn574', 'collapseBtn574')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup574"><code class="language-jsx text-sm text-gray-800">();
  }, []);

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/index.jsx (Line 113:2 - Line 130:39), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 50:2 - Line 43:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn575" onclick="toggleCodeBlock('cloneGroup575', 'expandBtn575', 'collapseBtn575')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn575" onclick="toggleCodeBlock('cloneGroup575', 'expandBtn575', 'collapseBtn575')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup575"><code class="language-jsx text-sm text-gray-800">;

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm&quot;
        containerClassName=&quot;flex w-full&quot;
      /&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-full p-4 overflow-none</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 56:4 - Line 70:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 52:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn576" onclick="toggleCodeBlock('cloneGroup576', 'expandBtn576', 'collapseBtn576')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn576" onclick="toggleCodeBlock('cloneGroup576', 'expandBtn576', 'collapseBtn576')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup576"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;px-7 py-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-6 max-h-[60vh] overflow-y-auto pr-2&quot;&gt;
              {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 34:2 - Line 53:4), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 37:5 - Line 45:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn577" onclick="toggleCodeBlock('cloneGroup577', 'expandBtn577', 'collapseBtn577')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn577" onclick="toggleCodeBlock('cloneGroup577', 'expandBtn577', 'collapseBtn577')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup577"><code class="language-jsx text-sm text-gray-800">);
  };

  useEffect(() =&gt; {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() =&gt; {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Create new API</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 53:4 - Line 69:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 72:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn578" onclick="toggleCodeBlock('cloneGroup578', 'expandBtn578', 'collapseBtn578')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn578" onclick="toggleCodeBlock('cloneGroup578', 'expandBtn578', 'collapseBtn578')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup578"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;px-7 py-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-6 max-h-[60vh] overflow-y-auto pr-2&quot;&gt;
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
              {apiKey &amp;&amp; (
                &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 113:91 - Line 128:10), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 102:86 - Line 117:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn579" onclick="toggleCodeBlock('cloneGroup579', 'expandBtn579', 'collapseBtn579')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn579" onclick="toggleCodeBlock('cloneGroup579', 'expandBtn579', 'collapseBtn579')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup579"><code class="language-jsx text-sm text-gray-800">&quot;
                  &gt;
                    Cancel
                  &lt;/button&gt;
                  &lt;button
                    type=&quot;submit&quot;
                    className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
                  &gt;
                    Create API Key
                  &lt;/button&gt;
                &lt;/&gt;
              ) : (
                &lt;button
                  onClick={closeModal}
                  type=&quot;button&quot;
                  className</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/ApiKeyRow/index.jsx (Line 28:10 - Line 43:2), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 36:7 - Line 51:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn580" onclick="toggleCodeBlock('cloneGroup580', 'expandBtn580', 'collapseBtn580')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn580" onclick="toggleCodeBlock('cloneGroup580', 'expandBtn580', 'collapseBtn580')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup580"><code class="language-jsx text-sm text-gray-800">);
    setCopied(true);
  };

  useEffect(() =&gt; {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() =&gt; {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    &lt;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx (Line 46:10 - Line 56:5), frontend/src/pages/GeneralSettings/Chats/ChatRow/index.jsx (Line 68:5 - Line 78:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn581" onclick="toggleCodeBlock('cloneGroup581', 'expandBtn581', 'collapseBtn581')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn581" onclick="toggleCodeBlock('cloneGroup581', 'expandBtn581', 'collapseBtn581')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup581"><code class="language-jsx text-sm text-gray-800">.createdAt}&lt;/td&gt;
        &lt;td className=&quot;px-6 flex items-center gap-x-6 h-full mt-1&quot;&gt;
          &lt;button
            onClick={handleDelete}
            className=&quot;text-xs font-medium text-white/80 light:text-black/80 hover:light:text-red-500 hover:text-red-300 rounded-lg px-2 py-1 hover:bg-white hover:light:bg-red-50 hover:bg-opacity-10&quot;
          &gt;
            &lt;Trash className=&quot;h-5 w-5&quot; /&gt;
          &lt;/button&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx (Line 47:2 - Line 59:1), frontend/src/pages/GeneralSettings/ApiKeys/ApiKeyRow/index.jsx (Line 57:7 - Line 69:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn582" onclick="toggleCodeBlock('cloneGroup582', 'expandBtn582', 'collapseBtn582')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn582" onclick="toggleCodeBlock('cloneGroup582', 'expandBtn582', 'collapseBtn582')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup582"><code class="language-jsx text-sm text-gray-800">&gt;
          &lt;button
            onClick={handleDelete}
            className=&quot;text-xs font-medium text-white/80 light:text-black/80 hover:light:text-red-500 hover:text-red-300 rounded-lg px-2 py-1 hover:bg-white hover:light:bg-red-50 hover:bg-opacity-10&quot;
          &gt;
            &lt;Trash className=&quot;h-5 w-5&quot; /&gt;
          &lt;/button&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/NewWorkspaceModal/index.jsx (Line 14:10 - Line 24:10), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 35:6 - Line 45:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn583" onclick="toggleCodeBlock('cloneGroup583', 'expandBtn583', 'collapseBtn583')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn583" onclick="toggleCodeBlock('cloneGroup583', 'expandBtn583', 'collapseBtn583')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup583"><code class="language-jsx text-sm text-gray-800">) window.location.reload();
    setError(error);
  };

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Create new workspace</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/NewWorkspaceModal/index.jsx (Line 24:4 - Line 40:5), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/NewEmbedModal/index.jsx (Line 45:4 - Line 53:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn584" onclick="toggleCodeBlock('cloneGroup584', 'expandBtn584', 'collapseBtn584')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn584" onclick="toggleCodeBlock('cloneGroup584', 'expandBtn584', 'collapseBtn584')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup584"><code class="language-jsx text-sm text-gray-800"> workspace
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;name</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/NewWorkspaceModal/index.jsx (Line 58:8 - Line 73:10), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 99:4 - Line 83:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn585" onclick="toggleCodeBlock('cloneGroup585', 'expandBtn585', 'collapseBtn585')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn585" onclick="toggleCodeBlock('cloneGroup585', 'expandBtn585', 'collapseBtn585')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup585"><code class="language-jsx text-sm text-gray-800">.
              &lt;/p&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Create workspace</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/UserRow/index.jsx (Line 52:28 - Line 62:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/index.jsx (Line 59:29 - Line 70:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn586" onclick="toggleCodeBlock('cloneGroup586', 'expandBtn586', 'collapseBtn586')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn586" onclick="toggleCodeBlock('cloneGroup586', 'expandBtn586', 'collapseBtn586')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup586"><code class="language-jsx text-sm text-gray-800">, &quot;success&quot;, { clear: true });
    }
  };

  return (
    &lt;&gt;
      &lt;tr
        ref={rowRef}
        className=&quot;bg-transparent text-white text-opacity-80 text-xs font-medium border-b border-white/10 h-10&quot;
      &gt;
        &lt;th </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 36:9 - Line 62:10), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 77:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn587" onclick="toggleCodeBlock('cloneGroup587', 'expandBtn587', 'collapseBtn587')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn587" onclick="toggleCodeBlock('cloneGroup587', 'expandBtn587', 'collapseBtn587')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup587"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;username&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Username
                &lt;/label&gt;
                &lt;input
                  name=&quot;username&quot;
                  type=&quot;text&quot;
                  className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;User's username&quot;
                  minLength</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 61:2 - Line 76:9), frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 77:2 - Line 92:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn588" onclick="toggleCodeBlock('cloneGroup588', 'expandBtn588', 'collapseBtn588')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn588" onclick="toggleCodeBlock('cloneGroup588', 'expandBtn588', 'collapseBtn588')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup588"><code class="language-jsx text-sm text-gray-800">
                  minLength={2}
                  required={true}
                  autoComplete=&quot;off&quot;
                /&gt;
                &lt;p className=&quot;mt-2 text-xs text-white/60&quot;&gt;
                  Username must only contain lowercase letters, periods,
                  numbers, underscores, and hyphens with no spaces
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;password&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Password</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 83:2 - Line 102:13), frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 98:2 - Line 117:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn589" onclick="toggleCodeBlock('cloneGroup589', 'expandBtn589', 'collapseBtn589')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn589" onclick="toggleCodeBlock('cloneGroup589', 'expandBtn589', 'collapseBtn589')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup589"><code class="language-jsx text-sm text-gray-800">
                  autoComplete=&quot;off&quot;
                  minLength={8}
                /&gt;
                &lt;p className=&quot;mt-2 text-xs text-white/60&quot;&gt;
                  Password must be at least 8 characters long
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;bio&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Bio
                &lt;/label&gt;
                &lt;textarea
                  name=&quot;bio&quot;
                  className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;User's bio&quot;
                  autoComplete</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 101:2 - Line 122:5), frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 117:2 - Line 138:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn590" onclick="toggleCodeBlock('cloneGroup590', 'expandBtn590', 'collapseBtn590')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn590" onclick="toggleCodeBlock('cloneGroup590', 'expandBtn590', 'collapseBtn590')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup590"><code class="language-jsx text-sm text-gray-800">
                  autoComplete=&quot;off&quot;
                  rows={3}
                /&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;role&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Role
                &lt;/label&gt;
                &lt;select
                  name=&quot;role&quot;
                  required={true}
                  defaultValue={&quot;default&quot;}
                  onChange={(e) =&gt; setRole(e.target.value)}
                  className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                &gt;
                  &lt;option value=&quot;default&quot;&gt;Default&lt;/option&gt;
                  &lt;option value=&quot;manager&quot;&gt;Manager&lt;/option&gt;
                  {user</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 122:5 - Line 135:15), frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 138:12 - Line 151:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn591" onclick="toggleCodeBlock('cloneGroup591', 'expandBtn591', 'collapseBtn591')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn591" onclick="toggleCodeBlock('cloneGroup591', 'expandBtn591', 'collapseBtn591')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup591"><code class="language-jsx text-sm text-gray-800">?.role === &quot;admin&quot; &amp;&amp; (
                    &lt;option value=&quot;admin&quot;&gt;Administrator&lt;/option&gt;
                  )}
                &lt;/select&gt;
                &lt;RoleHintDisplay role={role} /&gt;
              &lt;/div&gt;
              &lt;MessageLimitInput
                role={role}
                enabled={messageLimit.enabled}
                limit={messageLimit.limit}
                updateState={setMessageLimit}
              /&gt;
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
              </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/NewUserModal/index.jsx (Line 137:7 - Line 152:4), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 99:4 - Line 114:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn592" onclick="toggleCodeBlock('cloneGroup592', 'expandBtn592', 'collapseBtn592')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn592" onclick="toggleCodeBlock('cloneGroup592', 'expandBtn592', 'collapseBtn592')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup592"><code class="language-jsx text-sm text-gray-800">.
              &lt;/p&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Add</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/AddVariableModal/index.jsx (Line 29:28 - Line 39:4), frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 30:28 - Line 36:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn593" onclick="toggleCodeBlock('cloneGroup593', 'expandBtn593', 'collapseBtn593')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn593" onclick="toggleCodeBlock('cloneGroup593', 'expandBtn593', 'collapseBtn593')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup593"><code class="language-jsx text-sm text-gray-800">);
    }
  };

  return (
    &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
      &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
        &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
            &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
              Add New</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/AddVariableModal/index.jsx (Line 39:9 - Line 62:5), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 63:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn594" onclick="toggleCodeBlock('cloneGroup594', 'expandBtn594', 'collapseBtn594')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn594" onclick="toggleCodeBlock('cloneGroup594', 'expandBtn594', 'collapseBtn594')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup594"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;key&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Key
                &lt;/label&gt;
                &lt;input
                  name=&quot;key&quot;
                  type</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/AddVariableModal/index.jsx (Line 66:2 - Line 88:9), frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 68:2 - Line 90:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn595" onclick="toggleCodeBlock('cloneGroup595', 'expandBtn595', 'collapseBtn595')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn595" onclick="toggleCodeBlock('cloneGroup595', 'expandBtn595', 'collapseBtn595')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup595"><code class="language-jsx text-sm text-gray-800">
                  required={true}
                  autoComplete=&quot;off&quot;
                  pattern=&quot;^[a-zA-Z0-9_]+$&quot;
                /&gt;
                &lt;p className=&quot;mt-2 text-xs text-white/60&quot;&gt;
                  Key must be unique and will be used in prompts as {&quot;{key}&quot;}.
                  Only letters, numbers and underscores are allowed.
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;value&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Value
                &lt;/label&gt;
                &lt;input
                  name=&quot;value&quot;
                  type=&quot;text&quot;
                  className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;e.g., Acme Corp&quot;
                  required</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/AddVariableModal/index.jsx (Line 87:2 - Line 104:13), frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 90:2 - Line 107:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn596" onclick="toggleCodeBlock('cloneGroup596', 'expandBtn596', 'collapseBtn596')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn596" onclick="toggleCodeBlock('cloneGroup596', 'expandBtn596', 'collapseBtn596')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup596"><code class="language-jsx text-sm text-gray-800">
                  required={true}
                  autoComplete=&quot;off&quot;
                /&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;description&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Description
                &lt;/label&gt;
                &lt;input
                  name=&quot;description&quot;
                  type=&quot;text&quot;
                  className=&quot;border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
                  placeholder=&quot;Optional description&quot;
                  autoComplete</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/AddVariableModal/index.jsx (Line 103:2 - Line 121:9), frontend/src/pages/Admin/SystemPromptVariables/VariableRow/EditVariableModal/index.jsx (Line 107:2 - Line 83:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn597" onclick="toggleCodeBlock('cloneGroup597', 'expandBtn597', 'collapseBtn597')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn597" onclick="toggleCodeBlock('cloneGroup597', 'expandBtn597', 'collapseBtn597')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup597"><code class="language-jsx text-sm text-gray-800">
                  autoComplete=&quot;off&quot;
                /&gt;
              &lt;/div&gt;
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
            &lt;/div&gt;
            &lt;div className=&quot;flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border&quot;&gt;
              &lt;button
                onClick={closeModal}
                type=&quot;button&quot;
                className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Cancel
              &lt;/button&gt;
              &lt;button
                type=&quot;submit&quot;
                className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
              &gt;
                Create variable</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/NewInviteModal/index.jsx (Line 46:2 - Line 59:10), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 37:5 - Line 50:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn598" onclick="toggleCodeBlock('cloneGroup598', 'expandBtn598', 'collapseBtn598')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn598" onclick="toggleCodeBlock('cloneGroup598', 'expandBtn598', 'collapseBtn598')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup598"><code class="language-jsx text-sm text-gray-800">);
  };

  useEffect(() =&gt; {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() =&gt; {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  useEffect</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/NewInviteModal/index.jsx (Line 74:7 - Line 88:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/EmbedRow/EditEmbedModal/index.jsx (Line 38:2 - Line 51:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn599" onclick="toggleCodeBlock('cloneGroup599', 'expandBtn599', 'collapseBtn599')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn599" onclick="toggleCodeBlock('cloneGroup599', 'expandBtn599', 'collapseBtn599')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup599"><code class="language-jsx text-sm text-gray-800">
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={closeModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div className=&quot;p-6&quot;&gt;
          &lt;form onSubmit={handleCreate}&gt;
            &lt;div className=&quot;space-y-4&quot;&gt;
              {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/NewInviteModal/index.jsx (Line 92:4 - Line 116:6), frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 71:5 - Line 95:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn600" onclick="toggleCodeBlock('cloneGroup600', 'expandBtn600', 'collapseBtn600')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn600" onclick="toggleCodeBlock('cloneGroup600', 'expandBtn600', 'collapseBtn600')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup600"><code class="language-jsx text-sm text-gray-800">&quot;
                    defaultValue={`${window.location.origin}/accept-invite/${invite.code}`}
                    disabled={true}
                    className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg outline-none block w-full p-2.5 pr-10&quot;
                  /&gt;
                  &lt;button
                    type=&quot;button&quot;
                    onClick={copyInviteLink}
                    disabled={copied}
                    className=&quot;absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-md hover:bg-theme-modal-border transition-all duration-300&quot;
                  &gt;
                    {copied ? (
                      &lt;Check
                        size={20}
                        className=&quot;text-green-400&quot;
                        weight=&quot;bold&quot;
                      /&gt;
                    ) : (
                      &lt;Copy size={20} className=&quot;text-white&quot; weight=&quot;bold&quot; /&gt;
                    )}
                  &lt;/button&gt;
                &lt;/div&gt;
              )}
              &lt;p className=&quot;text-white text-opacity-60 text-xs md:text-sm&quot;&gt;
                After</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/NewInviteModal/index.jsx (Line 156:7 - Line 169:7), frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 108:7 - Line 121:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn601" onclick="toggleCodeBlock('cloneGroup601', 'expandBtn601', 'collapseBtn601')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn601" onclick="toggleCodeBlock('cloneGroup601', 'expandBtn601', 'collapseBtn601')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup601"><code class="language-jsx text-sm text-gray-800"> ? (
                &lt;&gt;
                  &lt;button
                    onClick={closeModal}
                    type=&quot;button&quot;
                    className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm mr-2&quot;
                  &gt;
                    Cancel
                  &lt;/button&gt;
                  &lt;button
                    type=&quot;submit&quot;
                    className=&quot;transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm&quot;
                  &gt;
                    Create Invite</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/NewInviteModal/index.jsx (Line 169:7 - Line 188:1), frontend/src/pages/GeneralSettings/ApiKeys/NewApiKeyModal/index.jsx (Line 121:4 - Line 140:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn602" onclick="toggleCodeBlock('cloneGroup602', 'expandBtn602', 'collapseBtn602')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn602" onclick="toggleCodeBlock('cloneGroup602', 'expandBtn602', 'collapseBtn602')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup602"><code class="language-jsx text-sm text-gray-800">
                  &lt;/button&gt;
                &lt;/&gt;
              ) : (
                &lt;button
                  onClick={closeModal}
                  type=&quot;button&quot;
                  className=&quot;transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm&quot;
                &gt;
                  Close
                &lt;/button&gt;
              )}
            &lt;/div&gt;
          &lt;/form&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/InviteRow/index.jsx (Line 27:5 - Line 44:9), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/NewBrowserExtensionApiKeyModal/index.jsx (Line 36:7 - Line 44:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn603" onclick="toggleCodeBlock('cloneGroup603', 'expandBtn603', 'collapseBtn603')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn603" onclick="toggleCodeBlock('cloneGroup603', 'expandBtn603', 'collapseBtn603')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup603"><code class="language-jsx text-sm text-gray-800">);
    setCopied(true);
  };

  useEffect(() =&gt; {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() =&gt; {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    &lt;&gt;
      &lt;tr
        </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/WebSearchSelection/index.jsx (Line 120:20 - Line 135:17), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/index.jsx (Line 51:15 - Line 66:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn604" onclick="toggleCodeBlock('cloneGroup604', 'expandBtn604', 'collapseBtn604')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn604" onclick="toggleCodeBlock('cloneGroup604', 'expandBtn604', 'collapseBtn604')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup604"><code class="language-jsx text-sm text-gray-800">(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  }

  function handleXButton() {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  }

  useEffect(() =&gt; {
    const filtered = SEARCH_PROVIDERS</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/SQLConnectorSelection/index.jsx (Line 38:6 - Line 50:11), frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 116:2 - Line 128:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn605" onclick="toggleCodeBlock('cloneGroup605', 'expandBtn605', 'collapseBtn605')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn605" onclick="toggleCodeBlock('cloneGroup605', 'expandBtn605', 'collapseBtn605')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup605"><code class="language-jsx text-sm text-gray-800">
            &lt;/label&gt;
            &lt;label className=&quot;border-none relative inline-flex items-center ml-auto cursor-pointer&quot;&gt;
              &lt;input
                type=&quot;checkbox&quot;
                className=&quot;peer sr-only&quot;
                checked={enabled}
                onChange={() =&gt; toggleSkill(skill)}
              /&gt;
              &lt;div className=&quot;peer-disabled:opacity-50 pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
              &lt;span className=&quot;ml-3 text-sm font-medium&quot;&gt;&lt;/span&gt;
            &lt;/label&gt;
          </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/SQLConnectorSelection/NewConnectionModal.jsx (Line 69:12 - Line 82:4), frontend/src/pages/WorkspaceSettings/ChatSettings/WorkspaceLLMSelection/WorkspaceLLMItem/index.jsx (Line 128:11 - Line 44:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn606" onclick="toggleCodeBlock('cloneGroup606', 'expandBtn606', 'collapseBtn606')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn606" onclick="toggleCodeBlock('cloneGroup606', 'expandBtn606', 'collapseBtn606')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup606"><code class="language-jsx text-sm text-gray-800">();
    return false;
  }

  // Cannot do nested forms, it will cause all sorts of issues, so we portal this out
  // to the parent container form so we don't have nested forms.
  return createPortal(
    &lt;ModalWrapper isOpen={isOpen}&gt;
      &lt;div className=&quot;fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center&quot;&gt;
        &lt;div className=&quot;relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border&quot;&gt;
          &lt;div className=&quot;relative p-6 border-b rounded-t border-theme-modal-border&quot;&gt;
            &lt;div className=&quot;w-full flex gap-x-2 items-center&quot;&gt;
              &lt;h3 className=&quot;text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap&quot;&gt;
                New</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/SQLConnectorSelection/NewConnectionModal.jsx (Line 82:11 - Line 94:13), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/SetupProvider/index.jsx (Line 44:9 - Line 55:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn607" onclick="toggleCodeBlock('cloneGroup607', 'expandBtn607', 'collapseBtn607')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn607" onclick="toggleCodeBlock('cloneGroup607', 'expandBtn607', 'collapseBtn607')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup607"><code class="language-jsx text-sm text-gray-800">
              &lt;/h3&gt;
            &lt;/div&gt;
            &lt;button
              onClick={handleClose}
              type=&quot;button&quot;
              className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
            &gt;
              &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          &lt;/div&gt;
          &lt;form
            </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/MCPServers/index.jsx (Line 109:6 - Line 122:7), frontend/src/pages/Admin/Agents/MCPServers/index.jsx (Line 93:4 - Line 106:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn608" onclick="toggleCodeBlock('cloneGroup608', 'expandBtn608', 'collapseBtn608')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn608" onclick="toggleCodeBlock('cloneGroup608', 'expandBtn608', 'collapseBtn608')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup608"><code class="language-jsx text-sm text-gray-800">&lt;/p&gt;
        &lt;a
          href=&quot;https://docs.anythingllm.com/mcp-compatibility/overview&quot;
          target=&quot;_blank&quot;
          rel=&quot;noopener noreferrer&quot;
          className=&quot;text-theme-text-secondary underline hover:text-cta-button&quot;
        &gt;
          Learn more about MCP Servers.
        &lt;/a&gt;
      &lt;/div&gt;
    );
  }

  return</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/MCPServers/ServerPanel.jsx (Line 54:2 - Line 71:7), frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 211:8 - Line 37:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn609" onclick="toggleCodeBlock('cloneGroup609', 'expandBtn609', 'collapseBtn609')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn609" onclick="toggleCodeBlock('cloneGroup609', 'expandBtn609', 'collapseBtn609')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup609"><code class="language-jsx text-sm text-gray-800">);
    }
  }

  useEffect(() =&gt; {
    const handleClickOutside = (event) =&gt; {
      if (menuRef.current &amp;&amp; !menuRef.current.contains(event.target)) {
        setOpen(false);
      }
    };

    document.addEventListener(&quot;mousedown&quot;, handleClickOutside);
    return () =&gt; {
      document.removeEventListener(&quot;mousedown&quot;, handleClickOutside);
    };
  }, []);

  return</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/MCPServers/ServerPanel.jsx (Line 70:1 - Line 81:178), frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 228:2 - Line 239:179)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn610" onclick="toggleCodeBlock('cloneGroup610', 'expandBtn610', 'collapseBtn610')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn610" onclick="toggleCodeBlock('cloneGroup610', 'expandBtn610', 'collapseBtn610')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup610"><code class="language-jsx text-sm text-gray-800">
  return (
    &lt;div className=&quot;relative&quot; ref={menuRef}&gt;
      &lt;button
        type=&quot;button&quot;
        onClick={() =&gt; setOpen(!open)}
        className=&quot;p-1.5 rounded-lg text-white hover:bg-theme-action-menu-item-hover transition-colors duration-300&quot;
      &gt;
        &lt;Gear className=&quot;h-5 w-5&quot; weight=&quot;bold&quot; /&gt;
      &lt;/button&gt;
      {open &amp;&amp; (
        &lt;div className=&quot;absolute w-[150px] top-1 left-7 mt-1 border-[1.5px] border-white/40 rounded-lg bg-theme-action-menu-bg flex flex-col shadow-[0_4px_14px_rgba(0,0,0,0.25)] text-white z-99 md:z-10</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/DefaultSkillPanel/index.jsx (Line 34:11 - Line 48:11), frontend/src/pages/Admin/Agents/WebSearchSelection/index.jsx (Line 168:2 - Line 48:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn611" onclick="toggleCodeBlock('cloneGroup611', 'expandBtn611', 'collapseBtn611')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn611" onclick="toggleCodeBlock('cloneGroup611', 'expandBtn611', 'collapseBtn611')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup611"><code class="language-jsx text-sm text-gray-800">&gt;
            &lt;input
              type=&quot;checkbox&quot;
              className=&quot;peer sr-only&quot;
              checked={enabled}
              onChange={() =&gt; toggleSkill(skill)}
            /&gt;
            &lt;div className=&quot;peer-disabled:opacity-50 pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
            &lt;span className=&quot;ml-3 text-sm font-medium&quot;&gt;&lt;/span&gt;
          &lt;/label&gt;
        &lt;/div&gt;
        &lt;img src={image} alt={title} className=&quot;w-full rounded-md&quot; /&gt;
        &lt;p className=&quot;text-theme-text-secondary text-opacity-60 text-xs font-medium py-1.5&quot;&gt;
          {description}
          </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/AgentFlows/index.jsx (Line 45:5 - Line 58:1), frontend/src/pages/Admin/Agents/Imported/SkillList/index.jsx (Line 48:7 - Line 61:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn612" onclick="toggleCodeBlock('cloneGroup612', 'expandBtn612', 'collapseBtn612')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn612" onclick="toggleCodeBlock('cloneGroup612', 'expandBtn612', 'collapseBtn612')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup612"><code class="language-jsx text-sm text-gray-800">.active ? &quot;On&quot; : &quot;Off&quot;}
            &lt;/div&gt;
            &lt;CaretRight
              size={14}
              weight=&quot;bold&quot;
              className=&quot;text-theme-text-secondary&quot;
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/AgentFlows/FlowPanel.jsx (Line 25:25 - Line 58:5), frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 211:26 - Line 245:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn613" onclick="toggleCodeBlock('cloneGroup613', 'expandBtn613', 'collapseBtn613')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn613" onclick="toggleCodeBlock('cloneGroup613', 'expandBtn613', 'collapseBtn613')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup613"><code class="language-jsx text-sm text-gray-800">, &quot;error&quot;);
    }
  }

  useEffect(() =&gt; {
    const handleClickOutside = (event) =&gt; {
      if (menuRef.current &amp;&amp; !menuRef.current.contains(event.target)) {
        setOpen(false);
      }
    };

    document.addEventListener(&quot;mousedown&quot;, handleClickOutside);
    return () =&gt; {
      document.removeEventListener(&quot;mousedown&quot;, handleClickOutside);
    };
  }, []);

  return (
    &lt;div className=&quot;relative&quot; ref={menuRef}&gt;
      &lt;button
        type=&quot;button&quot;
        onClick={() =&gt; setOpen(!open)}
        className=&quot;p-1.5 rounded-lg text-white hover:bg-theme-action-menu-item-hover transition-colors duration-300&quot;
      &gt;
        &lt;Gear className=&quot;h-5 w-5&quot; weight=&quot;bold&quot; /&gt;
      &lt;/button&gt;
      {open &amp;&amp; (
        &lt;div className=&quot;absolute w-[100px] -top-1 left-7 mt-1 border-[1.5px] border-white/40 rounded-lg bg-theme-action-menu-bg flex flex-col shadow-[0_4px_14px_rgba(0,0,0,0.25)] text-white z-99 md:z-10&quot;&gt;
          &lt;button
            type=&quot;button&quot;
            onClick={() =&gt; navigate(paths.agents.editAgent(flow.uuid))}
            className=&quot;border-none flex items-center rounded-lg gap-x-2 hover:bg-theme-action-menu-item-hover py-1.5 px-2 transition-colors duration-200 w-full text-left&quot;
          &gt;
            &lt;span className=&quot;text-sm&quot;&gt;Edit</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/AgentFlows/FlowPanel.jsx (Line 103:5 - Line 115:15), frontend/src/pages/Admin/Agents/Imported/ImportedSkillConfig/index.jsx (Line 116:2 - Line 128:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn614" onclick="toggleCodeBlock('cloneGroup614', 'expandBtn614', 'collapseBtn614')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn614" onclick="toggleCodeBlock('cloneGroup614', 'expandBtn614', 'collapseBtn614')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup614"><code class="language-jsx text-sm text-gray-800">}
            &lt;/label&gt;
            &lt;label className=&quot;border-none relative inline-flex items-center ml-auto cursor-pointer&quot;&gt;
              &lt;input
                type=&quot;checkbox&quot;
                className=&quot;peer sr-only&quot;
                checked={isActive}
                onChange={handleToggle}
              /&gt;
              &lt;div className=&quot;peer-disabled:opacity-50 pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent&quot;&gt;&lt;/div&gt;
              &lt;span className=&quot;ml-3 text-sm font-medium&quot;&gt;&lt;/span&gt;
            &lt;/label&gt;
            &lt;ManageFlowMenu</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/AgentBuilder/HeaderMenu/index.jsx (Line 24:16 - Line 35:46), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/index.jsx (Line 83:12 - Line 72:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn615" onclick="toggleCodeBlock('cloneGroup615', 'expandBtn615', 'collapseBtn615')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn615" onclick="toggleCodeBlock('cloneGroup615', 'expandBtn615', 'collapseBtn615')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup615"><code class="language-jsx text-sm text-gray-800">(false);
      }
    }

    document.addEventListener(&quot;mousedown&quot;, handleClickOutside);
    return () =&gt; {
      document.removeEventListener(&quot;mousedown&quot;, handleClickOutside);
    };
  }, []);

  return (
    &lt;div className=&quot;absolute top-[calc(40px+16px)] left-4 right-4</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/index.jsx (Line 58:2 - Line 68:2), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SpeechToText/index.jsx (Line 83:2 - Line 93:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn616" onclick="toggleCodeBlock('cloneGroup616', 'expandBtn616', 'collapseBtn616')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn616" onclick="toggleCodeBlock('cloneGroup616', 'expandBtn616', 'collapseBtn616')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup616"><code class="language-jsx text-sm text-gray-800">

  useEffect(() =&gt; {
    if (!!window)
      window.addEventListener(PROMPT_INPUT_EVENT, handlePromptUpdate);
    return () =&gt;
      window?.removeEventListener(PROMPT_INPUT_EVENT, handlePromptUpdate);
  }, []);

  useEffect(() =&gt; {
    if (!</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/ChatContainer/DnDWrapper/index.jsx (Line 141:14 - Line 165:1), frontend/src/components/WorkspaceChat/ChatContainer/DnDWrapper/index.jsx (Line 104:6 - Line 127:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn617" onclick="toggleCodeBlock('cloneGroup617', 'expandBtn617', 'collapseBtn617')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn617" onclick="toggleCodeBlock('cloneGroup617', 'expandBtn617', 'collapseBtn617')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup617"><code class="language-jsx text-sm text-gray-800">) {
      if (file.type.startsWith(&quot;image/&quot;)) {
        newAccepted.push({
          uid: v4(),
          file,
          contentString: await toBase64(file),
          status: &quot;success&quot;,
          error: null,
          type: &quot;attachment&quot;,
        });
      } else {
        // If the user is a default user, we do not want to allow them to upload files.
        if (!!user &amp;&amp; user.role === &quot;default&quot;) continue;
        newAccepted.push({
          uid: v4(),
          file,
          contentString: null,
          status: &quot;in_progress&quot;,
          error: null,
          type: &quot;upload&quot;,
        });
      }
    }

</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/Members/index.jsx (Line 32:10 - Line 49:4), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 50:2 - Line 67:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn618" onclick="toggleCodeBlock('cloneGroup618', 'expandBtn618', 'collapseBtn618')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn618" onclick="toggleCodeBlock('cloneGroup618', 'expandBtn618', 'collapseBtn618')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup618"><code class="language-jsx text-sm text-gray-800">]);

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm mt-6&quot;
        containerClassName=&quot;flex w-full&quot;
      /&gt;
    );
  }

  return (
    &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/GeneralAppearance/index.jsx (Line 25:2 - Line 46:2), frontend/src/pages/WorkspaceSettings/VectorDatabase/index.jsx (Line 16:5 - Line 37:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn619" onclick="toggleCodeBlock('cloneGroup619', 'expandBtn619', 'collapseBtn619')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn619" onclick="toggleCodeBlock('cloneGroup619', 'expandBtn619', 'collapseBtn619')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup619"><code class="language-jsx text-sm text-gray-800">);

  const handleUpdate = async (e) =&gt; {
    setSaving(true);
    e.preventDefault();
    const data = {};
    const form = new FormData(formEl.current);
    for (var [key, value] of form.entries()) data[key] = castToType(key, value);
    const { workspace: updatedWorkspace, message } = await Workspace.update(
      workspace.slug,
      data
    );
    if (!!updatedWorkspace) {
      showToast(&quot;Workspace updated!&quot;, &quot;success&quot;, { clear: true });
    } else {
      showToast(`Error: ${message}`, &quot;error&quot;, { clear: true });
    }
    setSaving(false);
    setHasChanges(false);
  };

  if (!workspace </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/GeneralAppearance/index.jsx (Line 46:8 - Line 61:14), frontend/src/pages/WorkspaceSettings/VectorDatabase/index.jsx (Line 37:10 - Line 52:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn620" onclick="toggleCodeBlock('cloneGroup620', 'expandBtn620', 'collapseBtn620')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn620" onclick="toggleCodeBlock('cloneGroup620', 'expandBtn620', 'collapseBtn620')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup620"><code class="language-jsx text-sm text-gray-800">) return null;
  return (
    &lt;div className=&quot;w-full relative&quot;&gt;
      &lt;form
        ref={formEl}
        onSubmit={handleUpdate}
        className=&quot;w-1/2 flex flex-col gap-y-6&quot;
      &gt;
        {hasChanges &amp;&amp; (
          &lt;div className=&quot;absolute top-0 right-0&quot;&gt;
            &lt;CTAButton type=&quot;submit&quot;&gt;
              {saving ? &quot;Updating...&quot; : &quot;Update Workspace&quot;}
            &lt;/CTAButton&gt;
          &lt;/div&gt;
        )}
        &lt;WorkspaceName</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/index.jsx (Line 26:2 - Line 49:3), frontend/src/pages/WorkspaceSettings/GeneralAppearance/index.jsx (Line 25:5 - Line 39:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn621" onclick="toggleCodeBlock('cloneGroup621', 'expandBtn621', 'collapseBtn621')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn621" onclick="toggleCodeBlock('cloneGroup621', 'expandBtn621', 'collapseBtn621')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup621"><code class="language-jsx text-sm text-gray-800">]);

  const handleUpdate = async (e) =&gt; {
    setSaving(true);
    e.preventDefault();
    const data = {};
    const form = new FormData(formEl.current);
    for (var [key, value] of form.entries()) data[key] = castToType(key, value);
    const { workspace: updatedWorkspace, message } = await Workspace.update(
      workspace.slug,
      data
    );
    if (!!updatedWorkspace) {
      showToast(&quot;Workspace updated!&quot;, &quot;success&quot;, { clear: true });
    } else {
      showToast(`Error: ${message}`, &quot;error&quot;, { clear: true });
    }
    setSaving(false);
    setHasChanges(false);
  };

  if (!workspace) return null;
  return (
    &lt;div id</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceSettings/ChatSettings/index.jsx (Line 53:2 - Line 63:22), frontend/src/pages/WorkspaceSettings/VectorDatabase/index.jsx (Line 42:2 - Line 52:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn622" onclick="toggleCodeBlock('cloneGroup622', 'expandBtn622', 'collapseBtn622')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn622" onclick="toggleCodeBlock('cloneGroup622', 'expandBtn622', 'collapseBtn622')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup622"><code class="language-jsx text-sm text-gray-800">
        className=&quot;w-1/2 flex flex-col gap-y-6&quot;
      &gt;
        {hasChanges &amp;&amp; (
          &lt;div className=&quot;absolute top-0 right-0&quot;&gt;
            &lt;CTAButton type=&quot;submit&quot;&gt;
              {saving ? &quot;Updating...&quot; : &quot;Update Workspace&quot;}
            &lt;/CTAButton&gt;
          &lt;/div&gt;
        )}
        &lt;WorkspaceLLMSelection</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 66:20 - Line 84:20), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 80:15 - Line 98:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn624" onclick="toggleCodeBlock('cloneGroup624', 'expandBtn624', 'collapseBtn624')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn624" onclick="toggleCodeBlock('cloneGroup624', 'expandBtn624', 'collapseBtn624')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup624"><code class="language-jsx text-sm text-gray-800">(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedProvider</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 99:3 - Line 118:2), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 182:12 - Line 202:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn625" onclick="toggleCodeBlock('cloneGroup625', 'expandBtn625', 'collapseBtn625')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn625" onclick="toggleCodeBlock('cloneGroup625', 'expandBtn625', 'collapseBtn625')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup625"><code class="language-jsx text-sm text-gray-800">);

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 141:25 - Line 161:16), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 228:24 - Line 248:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn626" onclick="toggleCodeBlock('cloneGroup626', 'expandBtn626', 'collapseBtn626')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn626" onclick="toggleCodeBlock('cloneGroup626', 'expandBtn626', 'collapseBtn626')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup626"><code class="language-jsx text-sm text-gray-800">)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;provider-search</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 164:252 - Line 179:18), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 251:180 - Line 266:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn627" onclick="toggleCodeBlock('cloneGroup627', 'expandBtn627', 'collapseBtn627')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn627" onclick="toggleCodeBlock('cloneGroup627', 'expandBtn627', 'collapseBtn627')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup627"><code class="language-jsx text-sm text-gray-800">&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredProviders</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 180:8 - Line 207:23), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 267:13 - Line 294:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn628" onclick="toggleCodeBlock('cloneGroup628', 'expandBtn628', 'collapseBtn628')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn628" onclick="toggleCodeBlock('cloneGroup628', 'expandBtn628', 'collapseBtn628')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup628"><code class="language-jsx text-sm text-gray-800">
                            key={provider.name}
                            name={provider.name}
                            value={provider.value}
                            image={provider.logo}
                            description={provider.description}
                            checked={selectedProvider === provider.value}
                            onClick={() =&gt; updateProviderChoice(provider.value)}
                          /&gt;
                        ))}
                      &lt;/div&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                ) : (
                  &lt;button
                    className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
                    type=&quot;button&quot;
                    onClick={() =&gt; setSearchMenuOpen(true)}
                  &gt;
                    &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                      &lt;img
                        src={selectedProviderObject.logo}
                        alt={`${selectedProviderObject.name} logo`}
                        className=&quot;w-10 h-10 rounded-md&quot;
                      /&gt;
                      &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                        &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                          {selectedProviderObject</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 210:23 - Line 226:17), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 297:18 - Line 313:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn629" onclick="toggleCodeBlock('cloneGroup629', 'expandBtn629', 'collapseBtn629')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn629" onclick="toggleCodeBlock('cloneGroup629', 'expandBtn629', 'collapseBtn629')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup629"><code class="language-jsx text-sm text-gray-800">.description}
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;CaretUpDown
                      size={24}
                      weight=&quot;bold&quot;
                      className=&quot;text-white&quot;
                    /&gt;
                  &lt;/button&gt;
                )}
              &lt;/div&gt;
              &lt;div
                onChange={() =&gt; setHasChanges(true)}
                className=&quot;mt-4 flex flex-col gap-y-1&quot;
              &gt;
                {selectedProvider</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Security/index.jsx (Line 245:13 - Line 261:3), frontend/src/pages/GeneralSettings/Security/index.jsx (Line 69:21 - Line 85:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn630" onclick="toggleCodeBlock('cloneGroup630', 'expandBtn630', 'collapseBtn630')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn630" onclick="toggleCodeBlock('cloneGroup630', 'expandBtn630', 'collapseBtn630')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup630"><code class="language-jsx text-sm text-gray-800">);
      setLoading(false);
    }
    fetchIsMultiUserMode();
  }, []);

  if (loading) {
    return (
      &lt;div className=&quot;h-1/2 transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] p-[18px] h-full overflow-y-scroll&quot;&gt;
        &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
          &lt;PreLoader /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    );
  }

  if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Security/index.jsx (Line 276:29 - Line 296:2), frontend/src/pages/GeneralSettings/Security/index.jsx (Line 99:20 - Line 119:21)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn631" onclick="toggleCodeBlock('cloneGroup631', 'expandBtn631', 'collapseBtn631')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn631" onclick="toggleCodeBlock('cloneGroup631', 'expandBtn631', 'collapseBtn631')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup631"><code class="language-jsx text-sm text-gray-800">)}
          &lt;/p&gt;
        &lt;/div&gt;
        {hasChanges &amp;&amp; (
          &lt;div className=&quot;flex justify-end&quot;&gt;
            &lt;CTAButton
              onClick={() =&gt; handleSubmit()}
              className=&quot;mt-3 mr-0 -mb-20 z-10&quot;
            &gt;
              {saving ? t(&quot;common.saving&quot;) : t(&quot;common.save&quot;)}
            &lt;/CTAButton&gt;
          &lt;/div&gt;
        )}
        &lt;div className=&quot;relative w-full max-h-full&quot;&gt;
          &lt;div className=&quot;relative rounded-lg&quot;&gt;
            &lt;div className=&quot;flex items-start justify-between px-6 py-4&quot;&gt;&lt;/div&gt;
            &lt;div className=&quot;space-y-6 flex h-full w-full&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
                &lt;div className=&quot;&quot;&gt;
                  &lt;label className=&quot;mb-2.5 block font-medium text-white&quot;&gt;
                    {t</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Security/index.jsx (Line 322:23 - Line 334:73), frontend/src/pages/GeneralSettings/Security/index.jsx (Line 169:20 - Line 181:51)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn632" onclick="toggleCodeBlock('cloneGroup632', 'expandBtn632', 'collapseBtn632')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn632" onclick="toggleCodeBlock('cloneGroup632', 'expandBtn632', 'collapseBtn632')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup632"><code class="language-jsx text-sm text-gray-800">&quot;
                        minLength={8}
                        required={true}
                        autoComplete=&quot;off&quot;
                        defaultValue={usePassword ? &quot;********&quot; : &quot;&quot;}
                      /&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                )}
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;div className=&quot;flex items-center justify-between space-x-14&quot;&gt;
              &lt;p className=&quot;text-white text-opacity-80 light:text-theme-text text-xs rounded-lg w-96</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 69:2 - Line 79:100), frontend/src/pages/OnboardingFlow/Steps/DataHandling/index.jsx (Line 469:5 - Line 479:57)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn633" onclick="toggleCodeBlock('cloneGroup633', 'expandBtn633', 'collapseBtn633')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn633" onclick="toggleCodeBlock('cloneGroup633', 'expandBtn633', 'collapseBtn633')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup633"><code class="language-jsx text-sm text-gray-800">);

  const LLMSelection =
    LLM_SELECTION_PRIVACY?.[llmChoice] || FALLBACKS.LLM(llmChoice);
  const EmbeddingEngine =
    EMBEDDING_ENGINE_PRIVACY?.[embeddingEngine] ||
    FALLBACKS.EMBEDDING(embeddingEngine);
  const VectorDb = VECTOR_DB_PRIVACY?.[vectorDb] || FALLBACKS.VECTOR(vectorDb);

  return (
    &lt;div className=&quot;py-8 w-full flex items-start justify-center flex-col gap-y-6 border-b-2 border-theme-sidebar-border</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 83:2 - Line 97:34), frontend/src/pages/OnboardingFlow/Steps/DataHandling/index.jsx (Line 483:10 - Line 497:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn634" onclick="toggleCodeBlock('cloneGroup634', 'expandBtn634', 'collapseBtn634')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn634" onclick="toggleCodeBlock('cloneGroup634', 'expandBtn634', 'collapseBtn634')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup634"><code class="language-jsx text-sm text-gray-800">
          &lt;/div&gt;
          &lt;div className=&quot;flex items-center gap-2.5&quot;&gt;
            &lt;img
              src={LLMSelection.logo}
              alt=&quot;LLM Logo&quot;
              className=&quot;w-8 h-8 rounded&quot;
            /&gt;
            &lt;p className=&quot;text-theme-text-primary text-sm font-bold&quot;&gt;
              {LLMSelection.name}
            &lt;/p&gt;
          &lt;/div&gt;
          &lt;ul className=&quot;flex flex-col list-disc ml-4&quot;&gt;
            {LLMSelection.description.map((desc) =&gt; (
              &lt;li className=&quot;text-theme-text-secondary text-sm</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 103:20 - Line 117:34), frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 83:14 - Line 517:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn635" onclick="toggleCodeBlock('cloneGroup635', 'expandBtn635', 'collapseBtn635')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn635" onclick="toggleCodeBlock('cloneGroup635', 'expandBtn635', 'collapseBtn635')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup635"><code class="language-jsx text-sm text-gray-800">)}
          &lt;/div&gt;
          &lt;div className=&quot;flex items-center gap-2.5&quot;&gt;
            &lt;img
              src={EmbeddingEngine.logo}
              alt=&quot;LLM Logo&quot;
              className=&quot;w-8 h-8 rounded&quot;
            /&gt;
            &lt;p className=&quot;text-theme-text-primary text-sm font-bold&quot;&gt;
              {EmbeddingEngine.name}
            &lt;/p&gt;
          &lt;/div&gt;
          &lt;ul className=&quot;flex flex-col list-disc ml-4&quot;&gt;
            {EmbeddingEngine.description.map((desc) =&gt; (
              &lt;li className=&quot;text-theme-text-secondary text-sm</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 124:17 - Line 138:34), frontend/src/pages/GeneralSettings/PrivacyAndData/index.jsx (Line 83:14 - Line 538:32)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn636" onclick="toggleCodeBlock('cloneGroup636', 'expandBtn636', 'collapseBtn636')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn636" onclick="toggleCodeBlock('cloneGroup636', 'expandBtn636', 'collapseBtn636')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup636"><code class="language-jsx text-sm text-gray-800">)}
          &lt;/div&gt;
          &lt;div className=&quot;flex items-center gap-2.5&quot;&gt;
            &lt;img
              src={VectorDb.logo}
              alt=&quot;LLM Logo&quot;
              className=&quot;w-8 h-8 rounded&quot;
            /&gt;
            &lt;p className=&quot;text-theme-text-primary text-sm font-bold&quot;&gt;
              {VectorDb.name}
            &lt;/p&gt;
          &lt;/div&gt;
          &lt;ul className=&quot;flex flex-col list-disc ml-4&quot;&gt;
            {VectorDb.description.map((desc) =&gt; (
              &lt;li className=&quot;text-theme-text-secondary text-sm</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 14:33 - Line 26:11), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 8:33 - Line 20:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn639" onclick="toggleCodeBlock('cloneGroup639', 'expandBtn639', 'collapseBtn639')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn639" onclick="toggleCodeBlock('cloneGroup639', 'expandBtn639', 'collapseBtn639')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup639"><code class="language-jsx text-sm text-gray-800">;
import LMStudioLogo from &quot;@/media/llmprovider/lmstudio.png&quot;;
import LocalAiLogo from &quot;@/media/llmprovider/localai.png&quot;;
import TogetherAILogo from &quot;@/media/llmprovider/togetherai.png&quot;;
import FireworksAILogo from &quot;@/media/llmprovider/fireworksai.jpeg&quot;;
import MistralLogo from &quot;@/media/llmprovider/mistral.jpeg&quot;;
import HuggingFaceLogo from &quot;@/media/llmprovider/huggingface.png&quot;;
import PerplexityLogo from &quot;@/media/llmprovider/perplexity.png&quot;;
import OpenRouterLogo from &quot;@/media/llmprovider/openrouter.jpeg&quot;;
import GroqLogo from &quot;@/media/llmprovider/groq.png&quot;;
import KoboldCPPLogo from &quot;@/media/llmprovider/koboldcpp.png&quot;;
import TextGenWebUILogo from &quot;@/media/llmprovider/text-generation-webui.png&quot;;
import CohereLogo</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 49:47 - Line 60:14), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 42:47 - Line 53:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn640" onclick="toggleCodeBlock('cloneGroup640', 'expandBtn640', 'collapseBtn640')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn640" onclick="toggleCodeBlock('cloneGroup640', 'expandBtn640', 'collapseBtn640')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup640"><code class="language-jsx text-sm text-gray-800">;
import PerplexityOptions from &quot;@/components/LLMSelection/PerplexityOptions&quot;;
import OpenRouterOptions from &quot;@/components/LLMSelection/OpenRouterOptions&quot;;
import GroqAiOptions from &quot;@/components/LLMSelection/GroqAiOptions&quot;;
import CohereAiOptions from &quot;@/components/LLMSelection/CohereAiOptions&quot;;
import KoboldCPPOptions from &quot;@/components/LLMSelection/KoboldCPPOptions&quot;;
import TextGenWebUIOptions from &quot;@/components/LLMSelection/TextGenWebUIOptions&quot;;
import LiteLLMOptions from &quot;@/components/LLMSelection/LiteLLMOptions&quot;;
import AWSBedrockLLMOptions from &quot;@/components/LLMSelection/AwsBedrockLLMOptions&quot;;
import DeepSeekOptions from &quot;@/components/LLMSelection/DeepSeekOptions&quot;;
import ApiPieLLMOptions from &quot;@/components/LLMSelection/ApiPieOptions&quot;;
import XAILLMOptions</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 353:15 - Line 371:15), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 80:15 - Line 98:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn641" onclick="toggleCodeBlock('cloneGroup641', 'expandBtn641', 'collapseBtn641')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn641" onclick="toggleCodeBlock('cloneGroup641', 'expandBtn641', 'collapseBtn641')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup641"><code class="language-jsx text-sm text-gray-800">(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedLLM</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 386:2 - Line 405:61), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 183:1 - Line 119:61)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn642" onclick="toggleCodeBlock('cloneGroup642', 'expandBtn642', 'collapseBtn642')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn642" onclick="toggleCodeBlock('cloneGroup642', 'expandBtn642', 'collapseBtn642')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup642"><code class="language-jsx text-sm text-gray-800">
  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form onSubmit={handleSubmit} className=&quot;flex w-full&quot;&gt;
            &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 413:18 - Line 427:15), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 214:21 - Line 141:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn643" onclick="toggleCodeBlock('cloneGroup643', 'expandBtn643', 'collapseBtn643')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn643" onclick="toggleCodeBlock('cloneGroup643', 'expandBtn643', 'collapseBtn643')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup643"><code class="language-jsx text-sm text-gray-800">)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div className=&quot;w-full justify-end flex&quot;&gt;
                {hasChanges &amp;&amp; (
                  &lt;CTAButton
                    onClick={() =&gt; handleSubmit()}
                    className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
                  &gt;
                    {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
                  &lt;/CTAButton&gt;
                )}
              &lt;/div&gt;
              &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;
                {t(&quot;llm.provider&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 427:15 - Line 447:11), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 228:24 - Line 248:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn644" onclick="toggleCodeBlock('cloneGroup644', 'expandBtn644', 'collapseBtn644')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn644" onclick="toggleCodeBlock('cloneGroup644', 'expandBtn644', 'collapseBtn644')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup644"><code class="language-jsx text-sm text-gray-800">)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;llm-search</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 449:25 - Line 465:13), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 250:37 - Line 266:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn645" onclick="toggleCodeBlock('cloneGroup645', 'expandBtn645', 'collapseBtn645')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn645" onclick="toggleCodeBlock('cloneGroup645', 'expandBtn645', 'collapseBtn645')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup645"><code class="language-jsx text-sm text-gray-800">&quot;
                          className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredLLMs</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 477:2 - Line 495:18), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 276:2 - Line 294:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn646" onclick="toggleCodeBlock('cloneGroup646', 'expandBtn646', 'collapseBtn646')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn646" onclick="toggleCodeBlock('cloneGroup646', 'expandBtn646', 'collapseBtn646')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup646"><code class="language-jsx text-sm text-gray-800">)}
                      &lt;/div&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                ) : (
                  &lt;button
                    className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
                    type=&quot;button&quot;
                    onClick={() =&gt; setSearchMenuOpen(true)}
                  &gt;
                    &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                      &lt;img
                        src={selectedLLMObject?.logo || AnythingLLMIcon}
                        alt={`${selectedLLMObject?.name} logo`}
                        className=&quot;w-10 h-10 rounded-md&quot;
                      /&gt;
                      &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                        &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                          {selectedLLMObject</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/LLMPreference/index.jsx (Line 499:28 - Line 515:12), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 297:12 - Line 313:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn647" onclick="toggleCodeBlock('cloneGroup647', 'expandBtn647', 'collapseBtn647')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn647" onclick="toggleCodeBlock('cloneGroup647', 'expandBtn647', 'collapseBtn647')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup647"><code class="language-jsx text-sm text-gray-800">}
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;CaretUpDown
                      size={24}
                      weight=&quot;bold&quot;
                      className=&quot;text-white&quot;
                    /&gt;
                  &lt;/button&gt;
                )}
              &lt;/div&gt;
              &lt;div
                onChange={() =&gt; setHasChanges(true)}
                className=&quot;mt-4 flex flex-col gap-y-1&quot;
              &gt;
                {selectedLLM</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingTextSplitterPreference/index.jsx (Line 63:2 - Line 83:9), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 182:12 - Line 202:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn648" onclick="toggleCodeBlock('cloneGroup648', 'expandBtn648', 'collapseBtn648')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn648" onclick="toggleCodeBlock('cloneGroup648', 'expandBtn648', 'collapseBtn648')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup648"><code class="language-jsx text-sm text-gray-800">);

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form
            onSubmit</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 49:2 - Line 65:9), frontend/src/pages/OnboardingFlow/Steps/LLMPreference/index.jsx (Line 66:2 - Line 82:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn650" onclick="toggleCodeBlock('cloneGroup650', 'expandBtn650', 'collapseBtn650')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn650" onclick="toggleCodeBlock('cloneGroup650', 'expandBtn650', 'collapseBtn650')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup650"><code class="language-jsx text-sm text-gray-800">
  {
    name: &quot;OpenAI&quot;,
    value: &quot;openai&quot;,
    logo: OpenAiLogo,
    options: (settings) =&gt; &lt;OpenAiOptions settings={settings} /&gt;,
    description: &quot;The standard option for most non-commercial use.&quot;,
  },
  {
    name: &quot;Azure OpenAI&quot;,
    value: &quot;azure&quot;,
    logo: AzureOpenAiLogo,
    options: (settings) =&gt; &lt;AzureAiOptions settings={settings} /&gt;,
    description: &quot;The enterprise option of OpenAI hosted on Azure services.&quot;,
  },
  {
    name: &quot;Gemini&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 194:20 - Line 212:20), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 80:15 - Line 98:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn651" onclick="toggleCodeBlock('cloneGroup651', 'expandBtn651', 'collapseBtn651')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn651" onclick="toggleCodeBlock('cloneGroup651', 'expandBtn651', 'collapseBtn651')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup651"><code class="language-jsx text-sm text-gray-800">(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    async function fetchKeys() {
      const _settings = await System.keys();
      setSettings(_settings);
      setSelectedEmbedder</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 228:17 - Line 249:15), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 98:17 - Line 202:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn652" onclick="toggleCodeBlock('cloneGroup652', 'expandBtn652', 'collapseBtn652')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn652" onclick="toggleCodeBlock('cloneGroup652', 'expandBtn652', 'collapseBtn652')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup652"><code class="language-jsx text-sm text-gray-800">
  );

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;form
            id=&quot;embedding-form</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 263:21 - Line 277:27), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 214:21 - Line 228:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn653" onclick="toggleCodeBlock('cloneGroup653', 'expandBtn653', 'collapseBtn653')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn653" onclick="toggleCodeBlock('cloneGroup653', 'expandBtn653', 'collapseBtn653')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup653"><code class="language-jsx text-sm text-gray-800">)}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div className=&quot;w-full justify-end flex&quot;&gt;
                {hasChanges &amp;&amp; (
                  &lt;CTAButton
                    onClick={() =&gt; handleSubmit()}
                    className=&quot;mt-3 mr-0 -mb-14 z-10&quot;
                  &gt;
                    {saving ? t(&quot;common.saving&quot;) : t(&quot;common.save&quot;)}
                  &lt;/CTAButton&gt;
                )}
              &lt;/div&gt;
              &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;
                {t(&quot;embedding.provider.title&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 277:27 - Line 297:16), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 228:24 - Line 248:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn654" onclick="toggleCodeBlock('cloneGroup654', 'expandBtn654', 'collapseBtn654')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn654" onclick="toggleCodeBlock('cloneGroup654', 'expandBtn654', 'collapseBtn654')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup654"><code class="language-jsx text-sm text-gray-800">)}
              &lt;/div&gt;
              &lt;div className=&quot;relative&quot;&gt;
                {searchMenuOpen &amp;&amp; (
                  &lt;div
                    className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
                    onClick={() =&gt; setSearchMenuOpen(false)}
                  /&gt;
                )}
                {searchMenuOpen ? (
                  &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
                    &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                      &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                        &lt;MagnifyingGlass
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                        /&gt;
                        &lt;input
                          type=&quot;text&quot;
                          name=&quot;embedder-search</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 299:31 - Line 315:18), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 250:37 - Line 266:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn655" onclick="toggleCodeBlock('cloneGroup655', 'expandBtn655', 'collapseBtn655')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn655" onclick="toggleCodeBlock('cloneGroup655', 'expandBtn655', 'collapseBtn655')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup655"><code class="language-jsx text-sm text-gray-800">&quot;
                          className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                          onChange={(e) =&gt; setSearchQuery(e.target.value)}
                          ref={searchInputRef}
                          onKeyDown={(e) =&gt; {
                            if (e.key === &quot;Enter&quot;) e.preventDefault();
                          }}
                        /&gt;
                        &lt;X
                          size={20}
                          weight=&quot;bold&quot;
                          className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                          onClick={handleXButton}
                        /&gt;
                      &lt;/div&gt;
                      &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                        {filteredEmbedders</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 316:13 - Line 343:23), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 267:13 - Line 294:18)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn656" onclick="toggleCodeBlock('cloneGroup656', 'expandBtn656', 'collapseBtn656')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn656" onclick="toggleCodeBlock('cloneGroup656', 'expandBtn656', 'collapseBtn656')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup656"><code class="language-jsx text-sm text-gray-800">
                            key={embedder.name}
                            name={embedder.name}
                            value={embedder.value}
                            image={embedder.logo}
                            description={embedder.description}
                            checked={selectedEmbedder === embedder.value}
                            onClick={() =&gt; updateChoice(embedder.value)}
                          /&gt;
                        ))}
                      &lt;/div&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                ) : (
                  &lt;button
                    className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
                    type=&quot;button&quot;
                    onClick={() =&gt; setSearchMenuOpen(true)}
                  &gt;
                    &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                      &lt;img
                        src={selectedEmbedderObject.logo}
                        alt={`${selectedEmbedderObject.name} logo`}
                        className=&quot;w-10 h-10 rounded-md&quot;
                      /&gt;
                      &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                        &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                          {selectedEmbedderObject</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/EmbeddingPreference/index.jsx (Line 346:23 - Line 362:17), frontend/src/pages/GeneralSettings/VectorDatabase/index.jsx (Line 297:18 - Line 313:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn657" onclick="toggleCodeBlock('cloneGroup657', 'expandBtn657', 'collapseBtn657')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn657" onclick="toggleCodeBlock('cloneGroup657', 'expandBtn657', 'collapseBtn657')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup657"><code class="language-jsx text-sm text-gray-800">.description}
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;CaretUpDown
                      size={24}
                      weight=&quot;bold&quot;
                      className=&quot;text-white&quot;
                    /&gt;
                  &lt;/button&gt;
                )}
              &lt;/div&gt;
              &lt;div
                onChange={() =&gt; setHasChanges(true)}
                className=&quot;mt-4 flex flex-col gap-y-1&quot;
              &gt;
                {selectedEmbedder</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/index.jsx (Line 83:2 - Line 109:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/index.jsx (Line 69:2 - Line 95:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn658" onclick="toggleCodeBlock('cloneGroup658', 'expandBtn658', 'collapseBtn658')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn658" onclick="toggleCodeBlock('cloneGroup658', 'expandBtn658', 'collapseBtn658')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup658"><code class="language-jsx text-sm text-gray-800">
  };

  const toggleMenu = () =&gt; {
    setShowMenu(!showMenu);
  };

  useEffect(() =&gt; {
    function handleClickOutside(event) {
      if (
        menuRef.current &amp;&amp;
        !menuRef.current.contains(event.target) &amp;&amp;
        !openMenuButton.current.contains(event.target)
      ) {
        setShowMenu(false);
      }
    }

    document.addEventListener(&quot;mousedown&quot;, handleClickOutside);
    return () =&gt; {
      document.removeEventListener(&quot;mousedown&quot;, handleClickOutside);
    };
  }, []);

  useEffect(() =&gt; {
    async function fetchChats() {
      const { chats: _chats </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/Chats/index.jsx (Line 213:2 - Line 232:2), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/index.jsx (Line 111:2 - Line 43:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn659" onclick="toggleCodeBlock('cloneGroup659', 'expandBtn659', 'collapseBtn659')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn659" onclick="toggleCodeBlock('cloneGroup659', 'expandBtn659', 'collapseBtn659')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup659"><code class="language-jsx text-sm text-gray-800">
    setChats((prevChats) =&gt; prevChats.filter((chat) =&gt; chat.id !== chatId));
  };

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm&quot;
        containerClassName=&quot;flex w-full&quot;
      /&gt;
    );
  }

  return (
    &lt;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 41:1 - Line 53:8), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 9:2 - Line 21:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn660" onclick="toggleCodeBlock('cloneGroup660', 'expandBtn660', 'collapseBtn660')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn660" onclick="toggleCodeBlock('cloneGroup660', 'expandBtn660', 'collapseBtn660')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup660"><code class="language-jsx text-sm text-gray-800">
  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                Browser</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 72:21 - Line 82:49), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 48:16 - Line 58:48)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn662" onclick="toggleCodeBlock('cloneGroup662', 'expandBtn662', 'collapseBtn662')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn662" onclick="toggleCodeBlock('cloneGroup662', 'expandBtn662', 'collapseBtn662')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup662"><code class="language-jsx text-sm text-gray-800">: selectedProvider };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save preferences: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;Text-to-speech preferences saved successfully.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 82:49 - Line 105:6), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 58:48 - Line 95:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn663" onclick="toggleCodeBlock('cloneGroup663', 'expandBtn663', 'collapseBtn663')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn663" onclick="toggleCodeBlock('cloneGroup663', 'expandBtn663', 'collapseBtn663')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup663"><code class="language-jsx text-sm text-gray-800">, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateProviderChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedProvider(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    const</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 102:2 - Line 116:5), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 88:2 - Line 102:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn664" onclick="toggleCodeBlock('cloneGroup664', 'expandBtn664', 'collapseBtn664')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn664" onclick="toggleCodeBlock('cloneGroup664', 'expandBtn664', 'collapseBtn664')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup664"><code class="language-jsx text-sm text-gray-800">;

  useEffect(() =&gt; {
    const filtered = PROVIDERS.filter((provider) =&gt;
      provider.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredProviders(filtered);
  }, [searchQuery, selectedProvider]);

  const selectedProviderObject = PROVIDERS.find(
    (provider) =&gt; provider.value === selectedProvider
  );

  return (
    &lt;form</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 34:21 - Line 44:49), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 48:16 - Line 58:48)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn667" onclick="toggleCodeBlock('cloneGroup667', 'expandBtn667', 'collapseBtn667')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn667" onclick="toggleCodeBlock('cloneGroup667', 'expandBtn667', 'collapseBtn667')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup667"><code class="language-jsx text-sm text-gray-800">: selectedProvider };
    const formData = new FormData(form);

    for (var [key, value] of formData.entries()) data[key] = value;
    const { error } = await System.updateSystem(data);
    setSaving(true);

    if (error) {
      showToast(`Failed to save preferences: ${error}`, &quot;error&quot;);
    } else {
      showToast(&quot;Speech-to-text preferences saved successfully.&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 44:49 - Line 83:7), frontend/src/pages/GeneralSettings/TranscriptionPreference/index.jsx (Line 58:48 - Line 121:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn668" onclick="toggleCodeBlock('cloneGroup668', 'expandBtn668', 'collapseBtn668')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn668" onclick="toggleCodeBlock('cloneGroup668', 'expandBtn668', 'collapseBtn668')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup668"><code class="language-jsx text-sm text-gray-800">, &quot;success&quot;);
    }
    setSaving(false);
    setHasChanges(!!error);
  };

  const updateProviderChoice = (selection) =&gt; {
    setSearchQuery(&quot;&quot;);
    setSelectedProvider(selection);
    setSearchMenuOpen(false);
    setHasChanges(true);
  };

  const handleXButton = () =&gt; {
    if (searchQuery.length &gt; 0) {
      setSearchQuery(&quot;&quot;);
      if (searchInputRef.current) searchInputRef.current.value = &quot;&quot;;
    } else {
      setSearchMenuOpen(!searchMenuOpen);
    }
  };

  useEffect(() =&gt; {
    const filtered = PROVIDERS.filter((provider) =&gt;
      provider.name.toLowerCase().includes(searchQuery.toLowerCase())
    );
    setFilteredProviders(filtered);
  }, [searchQuery, selectedProvider]);

  const selectedProviderObject = PROVIDERS.find(
    (provider) =&gt; provider.value === selectedProvider
  );

  return (
    &lt;form onSubmit={handleSubmit} className=&quot;flex w-full&quot;&gt;
      &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
        &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10&quot;&gt;
          &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
            &lt;p className=&quot;text-lg leading-6 font-bold text-white&quot;&gt;
              Speech</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 98:13 - Line 122:20), frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 133:2 - Line 157:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn669" onclick="toggleCodeBlock('cloneGroup669', 'expandBtn669', 'collapseBtn669')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn669" onclick="toggleCodeBlock('cloneGroup669', 'expandBtn669', 'collapseBtn669')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup669"><code class="language-jsx text-sm text-gray-800">&gt;
              {saving ? &quot;Saving...&quot; : &quot;Save changes&quot;}
            &lt;/CTAButton&gt;
          )}
        &lt;/div&gt;
        &lt;div className=&quot;text-base font-bold text-white mt-6 mb-4&quot;&gt;Provider&lt;/div&gt;
        &lt;div className=&quot;relative&quot;&gt;
          {searchMenuOpen &amp;&amp; (
            &lt;div
              className=&quot;fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 backdrop-blur-sm z-10&quot;
              onClick={() =&gt; setSearchMenuOpen(false)}
            /&gt;
          )}
          {searchMenuOpen ? (
            &lt;div className=&quot;absolute top-0 left-0 w-full max-w-[640px] max-h-[310px] min-h-[64px] bg-theme-settings-input-bg rounded-lg flex flex-col justify-between cursor-pointer border-2 border-primary-button z-20&quot;&gt;
              &lt;div className=&quot;w-full flex flex-col gap-y-1&quot;&gt;
                &lt;div className=&quot;flex items-center sticky top-0 z-10 border-b border-[#9CA3AF] mx-4 bg-theme-settings-input-bg&quot;&gt;
                  &lt;MagnifyingGlass
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;absolute left-4 z-30 text-theme-text-primary -ml-4 my-2&quot;
                  /&gt;
                  &lt;input
                    type=&quot;text&quot;
                    name=&quot;stt-provider-search</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/stt.jsx (Line 124:32 - Line 192:1), frontend/src/pages/GeneralSettings/AudioPreference/tts.jsx (Line 159:32 - Line 227:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn670" onclick="toggleCodeBlock('cloneGroup670', 'expandBtn670', 'collapseBtn670')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn670" onclick="toggleCodeBlock('cloneGroup670', 'expandBtn670', 'collapseBtn670')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup670"><code class="language-jsx text-sm text-gray-800">&quot;
                    className=&quot;border-none -ml-4 my-2 bg-transparent z-20 pl-12 h-[38px] w-full px-4 py-1 text-sm outline-none text-theme-text-primary placeholder:text-theme-text-primary placeholder:font-medium&quot;
                    onChange={(e) =&gt; setSearchQuery(e.target.value)}
                    ref={searchInputRef}
                    onKeyDown={(e) =&gt; {
                      if (e.key === &quot;Enter&quot;) e.preventDefault();
                    }}
                  /&gt;
                  &lt;X
                    size={20}
                    weight=&quot;bold&quot;
                    className=&quot;cursor-pointer text-white hover:text-x-button&quot;
                    onClick={handleXButton}
                  /&gt;
                &lt;/div&gt;
                &lt;div className=&quot;flex-1 pl-4 pr-2 flex flex-col gap-y-1 overflow-y-auto white-scrollbar pb-4 max-h-[245px]&quot;&gt;
                  {filteredProviders.map((provider) =&gt; (
                    &lt;LLMItem
                      key={provider.name}
                      name={provider.name}
                      value={provider.value}
                      image={provider.logo}
                      description={provider.description}
                      checked={selectedProvider === provider.value}
                      onClick={() =&gt; updateProviderChoice(provider.value)}
                    /&gt;
                  ))}
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          ) : (
            &lt;button
              className=&quot;w-full max-w-[640px] h-[64px] bg-theme-settings-input-bg rounded-lg flex items-center p-[14px] justify-between cursor-pointer border-2 border-transparent hover:border-primary-button transition-all duration-300&quot;
              type=&quot;button&quot;
              onClick={() =&gt; setSearchMenuOpen(true)}
            &gt;
              &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
                &lt;img
                  src={selectedProviderObject.logo}
                  alt={`${selectedProviderObject.name} logo`}
                  className=&quot;w-10 h-10 rounded-md&quot;
                /&gt;
                &lt;div className=&quot;flex flex-col text-left&quot;&gt;
                  &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;
                    {selectedProviderObject.name}
                  &lt;/div&gt;
                  &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;
                    {selectedProviderObject.description}
                  &lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;CaretUpDown size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          )}
        &lt;/div&gt;
        &lt;div
          onChange={() =&gt; setHasChanges(true)}
          className=&quot;mt-4 flex flex-col gap-y-1&quot;
        &gt;
          {selectedProvider &amp;&amp;
            PROVIDERS.find(
              (provider) =&gt; provider.value === selectedProvider
            )?.options(settings)}
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/AudioPreference/index.jsx (Line 19:10 - Line 39:21), frontend/src/pages/GeneralSettings/EmbeddingTextSplitterPreference/index.jsx (Line 62:14 - Line 201:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn671" onclick="toggleCodeBlock('cloneGroup671', 'expandBtn671', 'collapseBtn671')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn671" onclick="toggleCodeBlock('cloneGroup671', 'expandBtn671', 'collapseBtn671')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup671"><code class="language-jsx text-sm text-gray-800">();
  }, []);

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      {loading ? (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;div className=&quot;w-full h-full flex justify-center items-center&quot;&gt;
            &lt;PreLoader /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ) : (
        &lt;div
          style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
          className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
        &gt;
          &lt;SpeechToTextProvider</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/index.jsx (Line 34:2 - Line 51:12), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 36:2 - Line 40:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn672" onclick="toggleCodeBlock('cloneGroup672', 'expandBtn672', 'collapseBtn672')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn672" onclick="toggleCodeBlock('cloneGroup672', 'expandBtn672', 'collapseBtn672')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup672"><code class="language-jsx text-sm text-gray-800">;

  const removeApiKey = (id) =&gt; {
    setApiKeys((prevKeys) =&gt; prevKeys.filter((apiKey) =&gt; apiKey.id !== id));
  };

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                {t(&quot;api.title&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/GeneralSettings/ApiKeys/index.jsx (Line 72:2 - Line 86:2), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 67:4 - Line 81:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn673" onclick="toggleCodeBlock('cloneGroup673', 'expandBtn673', 'collapseBtn673')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn673" onclick="toggleCodeBlock('cloneGroup673', 'expandBtn673', 'collapseBtn673')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup673"><code class="language-jsx text-sm text-gray-800">
            &lt;/CTAButton&gt;
          &lt;/div&gt;
          &lt;div className=&quot;overflow-x-auto mt-6&quot;&gt;
            {loading ? (
              &lt;Skeleton.default
                height=&quot;80vh&quot;
                width=&quot;100%&quot;
                highlightColor=&quot;var(--theme-bg-primary)&quot;
                baseColor=&quot;var(--theme-bg-secondary)&quot;
                count={1}
                className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm&quot;
                containerClassName=&quot;flex w-full&quot;
              /&gt;
            ) : (</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/index.jsx (Line 15:2 - Line 28:9), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 40:2 - Line 21:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn674" onclick="toggleCodeBlock('cloneGroup674', 'expandBtn674', 'collapseBtn674')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn674" onclick="toggleCodeBlock('cloneGroup674', 'expandBtn674', 'collapseBtn674')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup674"><code class="language-jsx text-sm text-gray-800">;

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                Instance</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/index.jsx (Line 66:12 - Line 87:72), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 46:8 - Line 67:55)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn675" onclick="toggleCodeBlock('cloneGroup675', 'expandBtn675', 'collapseBtn675')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn675" onclick="toggleCodeBlock('cloneGroup675', 'expandBtn675', 'collapseBtn675')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup675"><code class="language-jsx text-sm text-gray-800">);
      setLoading(false);
    }
    fetchData();
  }, []);

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm mt-6&quot;
        containerClassName=&quot;flex w-full&quot;
      /&gt;
    );
  }

  return (
    &lt;table className=&quot;w-full text-xs text-left rounded-lg mt-6 min-w-[640px] border-spacing-0</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Workspaces/index.jsx (Line 97:6 - Line 108:11), frontend/src/pages/Admin/ExperimentalFeatures/Features/LiveSync/manage/index.jsx (Line 77:8 - Line 88:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn676" onclick="toggleCodeBlock('cloneGroup676', 'expandBtn676', 'collapseBtn676')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn676" onclick="toggleCodeBlock('cloneGroup676', 'expandBtn676', 'collapseBtn676')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup676"><code class="language-jsx text-sm text-gray-800">
          &lt;/th&gt;
          &lt;th scope=&quot;col&quot; className=&quot;px-6 py-3&quot;&gt;
            Created On
          &lt;/th&gt;
          &lt;th scope=&quot;col&quot; className=&quot;px-6 py-3 rounded-tr-lg&quot;&gt;
            {&quot; &quot;}
          &lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        {workspaces</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/index.jsx (Line 15:11 - Line 29:6), frontend/src/pages/Admin/Workspaces/index.jsx (Line 14:16 - Line 21:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn677" onclick="toggleCodeBlock('cloneGroup677', 'expandBtn677', 'collapseBtn677')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn677" onclick="toggleCodeBlock('cloneGroup677', 'expandBtn677', 'collapseBtn677')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup677"><code class="language-jsx text-sm text-gray-800">() {
  const { isOpen, openModal, closeModal } = useModal();

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                Users</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Users/index.jsx (Line 66:7 - Line 80:59), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/index.jsx (Line 22:8 - Line 60:59)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn678" onclick="toggleCodeBlock('cloneGroup678', 'expandBtn678', 'collapseBtn678')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn678" onclick="toggleCodeBlock('cloneGroup678', 'expandBtn678', 'collapseBtn678')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup678"><code class="language-jsx text-sm text-gray-800">);
      setLoading(false);
    }
    fetchUsers();
  }, []);

  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm mt-8</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/SystemPromptVariables/index.jsx (Line 34:2 - Line 48:7), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 39:2 - Line 21:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn679" onclick="toggleCodeBlock('cloneGroup679', 'expandBtn679', 'collapseBtn679')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn679" onclick="toggleCodeBlock('cloneGroup679', 'expandBtn679', 'collapseBtn679')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup679"><code class="language-jsx text-sm text-gray-800">
  };

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                System</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Logging/index.jsx (Line 46:2 - Line 56:7), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedChats/index.jsx (Line 101:2 - Line 111:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn680" onclick="toggleCodeBlock('cloneGroup680', 'expandBtn680', 'collapseBtn680')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn680" onclick="toggleCodeBlock('cloneGroup680', 'expandBtn680', 'collapseBtn680')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup680"><code class="language-jsx text-sm text-gray-800">;

  const handlePrevious = () =&gt; {
    setOffset(Math.max(offset - 1, 0));
  };

  const handleNext = () =&gt; {
    setOffset(offset + 1);
  };

  return</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Logging/index.jsx (Line 53:2 - Line 65:26), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 39:2 - Line 19:26)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn681" onclick="toggleCodeBlock('cloneGroup681', 'expandBtn681', 'collapseBtn681')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn681" onclick="toggleCodeBlock('cloneGroup681', 'expandBtn681', 'collapseBtn681')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup681"><code class="language-jsx text-sm text-gray-800">);
  };

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;flex gap-x-4 items-center</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Logging/index.jsx (Line 106:2 - Line 127:19), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/EmbedConfigs/index.jsx (Line 27:1 - Line 237:20)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn682" onclick="toggleCodeBlock('cloneGroup682', 'expandBtn682', 'collapseBtn682')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn682" onclick="toggleCodeBlock('cloneGroup682', 'expandBtn682', 'collapseBtn682')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup682"><code class="language-jsx text-sm text-gray-800">
  if (loading) {
    return (
      &lt;Skeleton.default
        height=&quot;80vh&quot;
        width=&quot;100%&quot;
        highlightColor=&quot;var(--theme-bg-primary)&quot;
        baseColor=&quot;var(--theme-bg-secondary)&quot;
        count={1}
        className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm&quot;
        containerClassName=&quot;flex w-full&quot;
      /&gt;
    );
  }

  return (
    &lt;&gt;
      &lt;table className=&quot;w-full text-xs text-left rounded-lg min-w-[640px] border-spacing-0&quot;&gt;
        &lt;thead className=&quot;text-theme-text-secondary text-xs leading-[18px] font-bold uppercase border-white/10 border-b&quot;&gt;
          &lt;tr&gt;
            &lt;th scope=&quot;col&quot; className=&quot;px-6 py-3 rounded-tl-lg&quot;&gt;
              {t(&quot;event.table.type&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/index.jsx (Line 27:2 - Line 40:12), frontend/src/pages/Admin/Workspaces/index.jsx (Line 15:2 - Line 21:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn683" onclick="toggleCodeBlock('cloneGroup683', 'expandBtn683', 'collapseBtn683')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn683" onclick="toggleCodeBlock('cloneGroup683', 'expandBtn683', 'collapseBtn683')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup683"><code class="language-jsx text-sm text-gray-800">);

  return (
    &lt;div className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex&quot;&gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0&quot;
      &gt;
        &lt;div className=&quot;flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16&quot;&gt;
          &lt;div className=&quot;w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2&quot;&gt;
            &lt;div className=&quot;items-center flex gap-x-4&quot;&gt;
              &lt;p className=&quot;text-lg leading-6 font-bold text-theme-text-primary&quot;&gt;
                Invitations</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Invitations/index.jsx (Line 54:5 - Line 73:7), frontend/src/pages/GeneralSettings/BrowserExtensionApiKey/index.jsx (Line 67:4 - Line 91:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn684" onclick="toggleCodeBlock('cloneGroup684', 'expandBtn684', 'collapseBtn684')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn684" onclick="toggleCodeBlock('cloneGroup684', 'expandBtn684', 'collapseBtn684')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup684"><code class="language-jsx text-sm text-gray-800">
            &lt;/CTAButton&gt;
          &lt;/div&gt;
          &lt;div className=&quot;overflow-x-auto mt-6&quot;&gt;
            {loading ? (
              &lt;Skeleton.default
                height=&quot;80vh&quot;
                width=&quot;100%&quot;
                highlightColor=&quot;var(--theme-bg-primary)&quot;
                baseColor=&quot;var(--theme-bg-secondary)&quot;
                count={1}
                className=&quot;w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm&quot;
                containerClassName=&quot;flex w-full&quot;
              /&gt;
            ) : (
              &lt;table className=&quot;w-full text-xs text-left rounded-lg min-w-[640px] border-spacing-0&quot;&gt;
                &lt;thead className=&quot;text-theme-text-secondary text-xs leading-[18px] font-bold uppercase border-white/10 border-b&quot;&gt;
                  &lt;tr&gt;
                    &lt;th scope=&quot;col&quot; className=&quot;px-6 py-3 rounded-tl-lg&quot;&gt;
                      Status</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/ExperimentalFeatures/index.jsx (Line 92:37 - Line 106:12), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/index.jsx (Line 104:36 - Line 118:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn685" onclick="toggleCodeBlock('cloneGroup685', 'expandBtn685', 'collapseBtn685')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn685" onclick="toggleCodeBlock('cloneGroup685', 'expandBtn685', 'collapseBtn685')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup685"><code class="language-jsx text-sm text-gray-800">&quot;
      className=&quot;w-screen h-screen overflow-hidden bg-theme-bg-container flex md:mt-0 mt-6&quot;
    &gt;
      &lt;Sidebar /&gt;
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] w-full h-full flex&quot;
      &gt;
        {children}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function FeatureList</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/ExperimentalFeatures/index.jsx (Line 139:2 - Line 152:1), frontend/src/pages/Admin/Agents/Imported/SkillList/index.jsx (Line 48:7 - Line 61:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn686" onclick="toggleCodeBlock('cloneGroup686', 'expandBtn686', 'collapseBtn686')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn686" onclick="toggleCodeBlock('cloneGroup686', 'expandBtn686', 'collapseBtn686')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup686"><code class="language-jsx text-sm text-gray-800"> ? &quot;On&quot; : &quot;Off&quot;}
            &lt;/div&gt;
            &lt;CaretRight
              size={14}
              weight=&quot;bold&quot;
              className=&quot;text-theme-text-secondary&quot;
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/index.jsx (Line 127:2 - Line 148:7), frontend/src/pages/WorkspaceSettings/AgentConfig/index.jsx (Line 32:2 - Line 54:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn688" onclick="toggleCodeBlock('cloneGroup688', 'expandBtn688', 'collapseBtn688')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn688" onclick="toggleCodeBlock('cloneGroup688', 'expandBtn688', 'collapseBtn688')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup688"><code class="language-jsx text-sm text-gray-800">
    e.preventDefault();
    const data = {
      workspace: {},
      system: {},
      env: {},
    };

    const form = new FormData(formEl.current);
    for (var [key, value] of form.entries()) {
      if (key.startsWith(&quot;system::&quot;)) {
        const [_, label] = key.split(&quot;system::&quot;);
        data.system[label] = String(value);
        continue;
      }

      if (key.startsWith(&quot;env::&quot;)) {
        const [_, label] = key.split(&quot;env::&quot;);
        data.env[label] = String(value);
        continue;
      }
      </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/index.jsx (Line 229:5 - Line 243:3), frontend/src/pages/Admin/ExperimentalFeatures/index.jsx (Line 31:2 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn689" onclick="toggleCodeBlock('cloneGroup689', 'expandBtn689', 'collapseBtn689')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn689" onclick="toggleCodeBlock('cloneGroup689', 'expandBtn689', 'collapseBtn689')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup689"><code class="language-jsx text-sm text-gray-800">);
  };

  if (loading) {
    return (
      &lt;div
        style={{ height: isMobile ? &quot;100%&quot; : &quot;calc(100% - 32px)&quot; }}
        className=&quot;relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] w-full h-full flex justify-center items-center&quot;
      &gt;
        &lt;FullScreenLoader /&gt;
      &lt;/div&gt;
    );
  }

  if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/Admin/Agents/index.jsx (Line 336:15 - Line 355:77), frontend/src/pages/GeneralSettings/ChatEmbedWidgets/index.jsx (Line 33:14 - Line 52:76)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn690" onclick="toggleCodeBlock('cloneGroup690', 'expandBtn690', 'collapseBtn690')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn690" onclick="toggleCodeBlock('cloneGroup690', 'expandBtn690', 'collapseBtn690')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup690"><code class="language-jsx text-sm text-gray-800"> &amp;&amp; (
            &lt;div className=&quot;fixed top-0 left-0 w-full h-full bg-sidebar z-30&quot;&gt;
              &lt;div className=&quot;flex flex-col h-full&quot;&gt;
                &lt;div className=&quot;flex items-center p-4&quot;&gt;
                  &lt;button
                    type=&quot;button&quot;
                    onClick={() =&gt; {
                      setShowSkillModal(false);
                      setSelectedSkill(&quot;&quot;);
                    }}
                    className=&quot;text-white/60 hover:text-white transition-colors duration-200&quot;
                  &gt;
                    &lt;div className=&quot;flex items-center text-sky-400&quot;&gt;
                      &lt;CaretLeft size={24} /&gt;
                      &lt;div&gt;Back&lt;/div&gt;
                    &lt;/div&gt;
                  &lt;/button&gt;
                &lt;/div&gt;
                &lt;div className=&quot;flex-1 overflow-y-auto p-4&quot;&gt;
                  &lt;div className=&quot; bg-theme-bg-secondary text-white rounded-xl p-4 overflow-y-scroll no-scroll</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/WorkspaceChat/LoadingChat/index.jsx (Line 35:2 - Line 50:6), frontend/src/components/WorkspaceChat/LoadingChat/index.jsx (Line 17:2 - Line 32:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn691" onclick="toggleCodeBlock('cloneGroup691', 'expandBtn691', 'collapseBtn691')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn691" onclick="toggleCodeBlock('cloneGroup691', 'expandBtn691', 'collapseBtn691')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup691"><code class="language-jsx text-sm text-gray-800">
        count={1}
        className=&quot;max-w-full md:max-w-[80%] p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm mt-6&quot;
        containerClassName=&quot;flex justify-start&quot;
      /&gt;
      &lt;Skeleton.default
        height=&quot;100px&quot;
        width={isMobile ? &quot;88%&quot; : &quot;25%&quot;}
        baseColor={baseColor}
        highlightColor={highlightColor}
        count={1}
        className=&quot;max-w-full md:max-w-[80%] p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm mt-6&quot;
        containerClassName=&quot;flex justify-end&quot;
      /&gt;
      &lt;Skeleton.default
        height=&quot;160px</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/VectorDBSelection/VectorDBItem/index.jsx (Line 8:2 - Line 26:11), frontend/src/pages/Admin/Agents/WebSearchSelection/SearchProviderItem/index.jsx (Line 2:2 - Line 19:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn692" onclick="toggleCodeBlock('cloneGroup692', 'expandBtn692', 'collapseBtn692')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn692" onclick="toggleCodeBlock('cloneGroup692', 'expandBtn692', 'collapseBtn692')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup692"><code class="language-jsx text-sm text-gray-800">
  return (
    &lt;div
      onClick={() =&gt; onClick(value)}
      className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
        checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
      }`}
    &gt;
      &lt;input
        type=&quot;checkbox&quot;
        value={value}
        className=&quot;peer hidden&quot;
        checked={checked}
        readOnly={true}
        formNoValidate={true}
      /&gt;
      &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
        &lt;img
          </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/VectorDBSelection/QDrantDBOptions/index.jsx (Line 13:22 - Line 27:13), frontend/src/components/VectorDBSelection/WeaviateDBOptions/index.jsx (Line 13:22 - Line 27:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn693" onclick="toggleCodeBlock('cloneGroup693', 'expandBtn693', 'collapseBtn693')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn693" onclick="toggleCodeBlock('cloneGroup693', 'expandBtn693', 'collapseBtn693')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup693"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.QdrantEndpoint}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;

        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;QdrantApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/UserMenu/AccountModal/index.jsx (Line 77:32 - Line 92:2), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/AddPresetModal.jsx (Line 34:29 - Line 69:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn694" onclick="toggleCodeBlock('cloneGroup694', 'expandBtn694', 'collapseBtn694')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn694" onclick="toggleCodeBlock('cloneGroup694', 'expandBtn694', 'collapseBtn694')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup694"><code class="language-jsx text-sm text-gray-800">)}
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={hideModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div
          className=&quot;h-full w-full overflow-y-auto&quot;
          style={{ maxHeight: &quot;calc(100vh - 200px)&quot; }}
        &gt;
          &lt;form onSubmit={handleUpdate} </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/UserMenu/AccountModal/index.jsx (Line 169:2 - Line 181:249), frontend/src/pages/Admin/Users/UserRow/EditUserModal/index.jsx (Line 103:5 - Line 115:217)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn695" onclick="toggleCodeBlock('cloneGroup695', 'expandBtn695', 'collapseBtn695')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn695" onclick="toggleCodeBlock('cloneGroup695', 'expandBtn695', 'collapseBtn695')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup695"><code class="language-jsx text-sm text-gray-800">
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;div&gt;
                &lt;label
                  htmlFor=&quot;bio&quot;
                  className=&quot;block mb-2 text-sm font-medium text-white&quot;
                &gt;
                  Bio
                &lt;/label&gt;
                &lt;textarea
                  name=&quot;bio&quot;
                  className=&quot;border-none bg-theme-settings-input-bg placeholder:text-theme-settings-input-placeholder border-gray-500 text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5 min-h-[100px] resize-y</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/UserMenu/AccountModal/index.jsx (Line 363:16 - Line 373:10), frontend/src/components/UserMenu/AccountModal/index.jsx (Line 305:17 - Line 315:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn696" onclick="toggleCodeBlock('cloneGroup696', 'expandBtn696', 'collapseBtn696')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn696" onclick="toggleCodeBlock('cloneGroup696', 'expandBtn696', 'collapseBtn696')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup696"><code class="language-jsx text-sm text-gray-800">&quot;
          data-tooltip-content={t(&quot;customization.chat.auto_speak.description&quot;)}
          className=&quot;cursor-pointer h-fit&quot;
        &gt;
          &lt;Info size={16} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex items-center gap-x-4&quot;&gt;
        &lt;label className=&quot;relative inline-flex cursor-pointer items-center&quot;&gt;
          &lt;input
            id=&quot;autoSpeak</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/TranscriptionSelection/NativeTranscriptionOptions/index.jsx (Line 70:13 - Line 83:5), frontend/src/components/TranscriptionSelection/NativeTranscriptionOptions/index.jsx (Line 50:13 - Line 63:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn697" onclick="toggleCodeBlock('cloneGroup697', 'expandBtn697', 'collapseBtn697')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn697" onclick="toggleCodeBlock('cloneGroup697', 'expandBtn697', 'collapseBtn697')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup697"><code class="language-jsx text-sm text-gray-800">() {
  const { t } = useTranslation();

  return (
    &lt;div className=&quot;flex flex-col md:flex-row md:items-center gap-x-2 text-white mb-4 bg-blue-800/30 w-fit rounded-lg px-4 py-2&quot;&gt;
      &lt;div className=&quot;gap-x-2 flex items-center&quot;&gt;
        &lt;Gauge size={25} /&gt;
        &lt;p className=&quot;text-sm&quot;&gt;
          {t(&quot;transcription.warn-start&quot;)}
          &lt;br /&gt;
          {t(&quot;transcription.warn-recommend&quot;)}
          &lt;br /&gt;
          &lt;br /&gt;
          &lt;i&gt;{t(&quot;transcription.warn-end&quot;)} (1.56</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/TextToSpeech/PiperTTSOptions/index.jsx (Line 134:8 - Line 152:1), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/piperTTS.jsx (Line 5:8 - Line 22:8)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn698" onclick="toggleCodeBlock('cloneGroup698', 'expandBtn698', 'collapseBtn698')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn698" onclick="toggleCodeBlock('cloneGroup698', 'expandBtn698', 'collapseBtn698')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup698"><code class="language-jsx text-sm text-gray-800"> }) {
  const playerRef = useRef(null);
  const [speaking, setSpeaking] = useState(false);
  const [loading, setLoading] = useState(false);
  const [audioSrc, setAudioSrc] = useState(null);

  async function speakMessage(e) {
    e.preventDefault();
    if (speaking) {
      playerRef?.current?.pause();
      return;
    }

    try {
      if (!audioSrc) {
        setLoading(true);
        const client = new PiperTTSClient({ voiceId });
        const blobUrl = await client.getAudioBlobForText(
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/TextToSpeech/PiperTTSOptions/index.jsx (Line 157:5 - Line 178:9), frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/Actions/TTSButton/piperTTS.jsx (Line 24:2 - Line 45:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn699" onclick="toggleCodeBlock('cloneGroup699', 'expandBtn699', 'collapseBtn699')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn699" onclick="toggleCodeBlock('cloneGroup699', 'expandBtn699', 'collapseBtn699')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup699"><code class="language-jsx text-sm text-gray-800">;
      } else {
        playerRef.current.play();
      }
    } catch (e) {
      console.error(e);
      setLoading(false);
      setSpeaking(false);
    }
  }

  useEffect(() =&gt; {
    function setupPlayer() {
      if (!playerRef?.current) return;
      playerRef.current.addEventListener(&quot;play&quot;, () =&gt; {
        setSpeaking(true);
      });

      playerRef.current.addEventListener(&quot;pause&quot;, () =&gt; {
        playerRef.current.currentTime = 0;
        setSpeaking(false);
        </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 8:2 - Line 18:17), frontend/src/components/TextToSpeech/OpenAiOptions/index.jsx (Line 8:13 - Line 18:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn700" onclick="toggleCodeBlock('cloneGroup700', 'expandBtn700', 'collapseBtn700')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn700" onclick="toggleCodeBlock('cloneGroup700', 'expandBtn700', 'collapseBtn700')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup700"><code class="language-jsx text-sm text-gray-800">;

  return (
    &lt;div className=&quot;flex gap-x-4&quot;&gt;
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          API Key
        &lt;/label&gt;
        &lt;input
          type=&quot;password&quot;
          name=&quot;TTSElevenLabsKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 177:6 - Line 193:5), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 16:5 - Line 32:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn701" onclick="toggleCodeBlock('cloneGroup701', 'expandBtn701', 'collapseBtn701')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn701" onclick="toggleCodeBlock('cloneGroup701', 'expandBtn701', 'collapseBtn701')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup701"><code class="language-jsx text-sm text-gray-800">);
  const [customAppName, setCustomAppName] = useState(null);

  const {
    isOpen: isRecoveryCodeModalOpen,
    openModal: openRecoveryCodeModal,
    closeModal: closeRecoveryCodeModal,
  } = useModal();

  const handleLogin = async (e) =&gt; {
    setError(null);
    setLoading(true);
    e.preventDefault();
    const data = {};
    const form = new FormData(e.target);
    for (var [key, value] of form.entries()) data[key] = value;
    const { valid, user</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 203:2 - Line 214:20), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 39:2 - Line 50:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn702" onclick="toggleCodeBlock('cloneGroup702', 'expandBtn702', 'collapseBtn702')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn702" onclick="toggleCodeBlock('cloneGroup702', 'expandBtn702', 'collapseBtn702')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup702"><code class="language-jsx text-sm text-gray-800">
        window.localStorage.setItem(AUTH_TOKEN, token);
        window.location = paths.home();
      }
    } else {
      setError(message);
      setLoading(false);
    }
    setLoading(false);
  };

  const handleDownloadComplete = () =&gt; setDownloadComplete</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 259:5 - Line 270:3), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 59:17 - Line 70:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn703" onclick="toggleCodeBlock('cloneGroup703', 'expandBtn703', 'collapseBtn703')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn703" onclick="toggleCodeBlock('cloneGroup703', 'expandBtn703', 'collapseBtn703')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup703"><code class="language-jsx text-sm text-gray-800">, token]);

  useEffect(() =&gt; {
    const fetchCustomAppName = async () =&gt; {
      const { appName } = await System.fetchCustomAppName();
      setCustomAppName(appName || &quot;&quot;);
      setLoading(false);
    };
    fetchCustomAppName();
  }, []);

  if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 284:154 - Line 305:9), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 73:157 - Line 94:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn704" onclick="toggleCodeBlock('cloneGroup704', 'expandBtn704', 'collapseBtn704')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn704" onclick="toggleCodeBlock('cloneGroup704', 'expandBtn704', 'collapseBtn704')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup704"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
          &lt;div className=&quot;flex items-start justify-between pt-11 pb-9 rounded-t&quot;&gt;
            &lt;div className=&quot;flex items-center flex-col gap-y-4&quot;&gt;
              &lt;div className=&quot;flex gap-x-1&quot;&gt;
                &lt;h3 className=&quot;text-md md:text-2xl font-bold text-white text-center white-space-nowrap hidden md:block&quot;&gt;
                  {t(&quot;login.multi-user.welcome&quot;)}
                &lt;/h3&gt;
                &lt;p className=&quot;text-4xl md:text-2xl font-bold bg-gradient-to-r from-[#75D6FF] via-[#FFFFFF] light:via-[#75D6FF] to-[#FFFFFF] light:to-[#75D6FF] bg-clip-text text-transparent&quot;&gt;
                  {customAppName || &quot;AnythingLLM&quot;}
                &lt;/p&gt;
              &lt;/div&gt;
              &lt;p className=&quot;text-sm text-theme-text-secondary text-center&quot;&gt;
                {t(&quot;login.sign-in.start&quot;)} {customAppName || &quot;AnythingLLM&quot;}{&quot; &quot;}
                {t(&quot;login.sign-in.end&quot;)}
              &lt;/p&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div className=&quot;w-full px-4 md:px-12&quot;&gt;
            &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
              &lt;div className=&quot;w-screen md:w-full md:px-0 px-6&quot;&gt;
                &lt;input
                  name=&quot;username</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 317:2 - Line 336:13), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 96:2 - Line 115:11)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn705" onclick="toggleCodeBlock('cloneGroup705', 'expandBtn705', 'collapseBtn705')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn705" onclick="toggleCodeBlock('cloneGroup705', 'expandBtn705', 'collapseBtn705')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup705"><code class="language-jsx text-sm text-gray-800">
                  className=&quot;border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder focus:outline-primary-button active:outline-primary-button outline-none text-sm rounded-md p-2.5 w-full h-[48px] md:w-[300px] md:h-[34px]&quot;
                  required={true}
                  autoComplete=&quot;off&quot;
                /&gt;
              &lt;/div&gt;
              {error &amp;&amp; &lt;p className=&quot;text-red-400 text-sm&quot;&gt;Error: {error}&lt;/p&gt;}
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div className=&quot;flex items-center md:p-12 px-10 mt-12 md:mt-0 space-x-2 border-gray-600 w-full flex-col gap-y-8&quot;&gt;
            &lt;button
              disabled={loading}
              type=&quot;submit&quot;
              className=&quot;md:text-primary-button md:bg-transparent text-dark-text text-sm font-bold focus:ring-4 focus:outline-none rounded-md border-[1.5px] border-primary-button md:h-[34px] h-[48px] md:hover:text-white md:hover:bg-primary-button bg-primary-button focus:z-10 w-full&quot;
            &gt;
              {loading
                ? t(&quot;login.multi-user.validating&quot;)
                : t(&quot;login.multi-user.login&quot;)}
            &lt;/button&gt;
            </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/Password/MultiUserAuth.jsx (Line 342:2 - Line 358:1), frontend/src/components/Modals/Password/SingleUserAuth.jsx (Line 113:2 - Line 129:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn706" onclick="toggleCodeBlock('cloneGroup706', 'expandBtn706', 'collapseBtn706')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn706" onclick="toggleCodeBlock('cloneGroup706', 'expandBtn706', 'collapseBtn706')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup706"><code class="language-jsx text-sm text-gray-800">
            &lt;/button&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/form&gt;

      &lt;ModalWrapper isOpen={isRecoveryCodeModalOpen} noPortal={true}&gt;
        &lt;RecoveryCodeModal
          recoveryCodes={recoveryCodes}
          onDownloadComplete={handleDownloadComplete}
          onClose={closeRecoveryCodeModal}
        /&gt;
      &lt;/ModalWrapper&gt;
    &lt;/&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/ManageWorkspace/index.jsx (Line 47:19 - Line 58:4), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/SetupProvider/index.jsx (Line 44:9 - Line 55:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn707" onclick="toggleCodeBlock('cloneGroup707', 'expandBtn707', 'collapseBtn707')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn707" onclick="toggleCodeBlock('cloneGroup707', 'expandBtn707', 'collapseBtn707')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup707"><code class="language-jsx text-sm text-gray-800">
              &lt;/h3&gt;
            &lt;/div&gt;
            &lt;button
              onClick={hideModal}
              type=&quot;button&quot;
              className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
            &gt;
              &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
            &lt;/button&gt;
          &lt;/div&gt;
          &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 94:17 - Line 108:7), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 84:18 - Line 98:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn708" onclick="toggleCodeBlock('cloneGroup708', 'expandBtn708', 'collapseBtn708')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn708" onclick="toggleCodeBlock('cloneGroup708', 'expandBtn708', 'collapseBtn708')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup708"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.XAIModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/TogetherAiOptions/index.jsx (Line 74:20 - Line 92:20), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn710" onclick="toggleCodeBlock('cloneGroup710', 'expandBtn710', 'collapseBtn710')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn710" onclick="toggleCodeBlock('cloneGroup710', 'expandBtn710', 'collapseBtn710')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup710"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;TogetherAiModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/TogetherAiOptions/index.jsx (Line 92:20 - Line 115:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 87:24 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn711" onclick="toggleCodeBlock('cloneGroup711', 'expandBtn711', 'collapseBtn711')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn711" onclick="toggleCodeBlock('cloneGroup711', 'expandBtn711', 'collapseBtn711')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup711"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.TogetherAiModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/PerplexityOptions/index.jsx (Line 50:20 - Line 68:20), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn712" onclick="toggleCodeBlock('cloneGroup712', 'expandBtn712', 'collapseBtn712')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn712" onclick="toggleCodeBlock('cloneGroup712', 'expandBtn712', 'collapseBtn712')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup712"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;PerplexityModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/PerplexityOptions/index.jsx (Line 73:28 - Line 88:5), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 84:18 - Line 109:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn713" onclick="toggleCodeBlock('cloneGroup713', 'expandBtn713', 'collapseBtn713')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn713" onclick="toggleCodeBlock('cloneGroup713', 'expandBtn713', 'collapseBtn713')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup713"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.PerplexityModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 62:143 - Line 73:14), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 71:104 - Line 82:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn714" onclick="toggleCodeBlock('cloneGroup714', 'expandBtn714', 'collapseBtn714')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn714" onclick="toggleCodeBlock('cloneGroup714', 'expandBtn714', 'collapseBtn714')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup714"><code class="language-jsx text-sm text-gray-800">&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 80:121 - Line 101:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 89:104 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn715" onclick="toggleCodeBlock('cloneGroup715', 'expandBtn715', 'collapseBtn715')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn715" onclick="toggleCodeBlock('cloneGroup715', 'expandBtn715', 'collapseBtn715')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup715"><code class="language-jsx text-sm text-gray-800">&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.PPIOModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 92:17 - Line 102:20), frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 49:12 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn716" onclick="toggleCodeBlock('cloneGroup716', 'expandBtn716', 'collapseBtn716')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn716" onclick="toggleCodeBlock('cloneGroup716', 'expandBtn716', 'collapseBtn716')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup716"><code class="language-jsx text-sm text-gray-800">();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;OpenRouterModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 102:20 - Line 120:20), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn717" onclick="toggleCodeBlock('cloneGroup717', 'expandBtn717', 'collapseBtn717')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn717" onclick="toggleCodeBlock('cloneGroup717', 'expandBtn717', 'collapseBtn717')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup717"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;OpenRouterModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 120:20 - Line 143:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 87:24 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn718" onclick="toggleCodeBlock('cloneGroup718', 'expandBtn718', 'collapseBtn718')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn718" onclick="toggleCodeBlock('cloneGroup718', 'expandBtn718', 'collapseBtn718')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup718"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.OpenRouterModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenAiOptions/index.jsx (Line 9:23 - Line 27:2), frontend/src/components/TranscriptionSelection/OpenAiOptions/index.jsx (Line 8:31 - Line 26:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn719" onclick="toggleCodeBlock('cloneGroup719', 'expandBtn719', 'collapseBtn719')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn719" onclick="toggleCodeBlock('cloneGroup719', 'expandBtn719', 'collapseBtn719')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup719"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          API Key
        &lt;/label&gt;
        &lt;input
          type=&quot;password&quot;
          name=&quot;OpenAiKey&quot;
          className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
          placeholder=&quot;OpenAI API Key&quot;
          defaultValue={settings?.OpenAiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
          required={true}
          autoComplete=&quot;off&quot;
          spellCheck={false}
          onChange={(e) =&gt; setInputValue(e.target.value)}
          onBlur={() =&gt; setOpenAIKey(inputValue)}
        /&gt;
      &lt;/div&gt;
      {</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenAiOptions/index.jsx (Line 42:9 - Line 67:16), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 44:17 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn720" onclick="toggleCodeBlock('cloneGroup720', 'expandBtn720', 'collapseBtn720')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn720" onclick="toggleCodeBlock('cloneGroup720', 'expandBtn720', 'collapseBtn720')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup720"><code class="language-jsx text-sm text-gray-800">,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey
      );

      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});
        setGroupedModels(modelsByOrganization);
      }

      setLoading(false);
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;OpenAiModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenAiOptions/index.jsx (Line 67:16 - Line 85:16), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn721" onclick="toggleCodeBlock('cloneGroup721', 'expandBtn721', 'collapseBtn721')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn721" onclick="toggleCodeBlock('cloneGroup721', 'expandBtn721', 'collapseBtn721')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup721"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;OpenAiModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OpenAiOptions/index.jsx (Line 85:16 - Line 108:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 87:24 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn722" onclick="toggleCodeBlock('cloneGroup722', 'expandBtn722', 'collapseBtn722')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn722" onclick="toggleCodeBlock('cloneGroup722', 'expandBtn722', 'collapseBtn722')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup722"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.OpenAiModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 297:19 - Line 312:65), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 84:18 - Line 109:73)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn723" onclick="toggleCodeBlock('cloneGroup723', 'expandBtn723', 'collapseBtn723')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn723" onclick="toggleCodeBlock('cloneGroup723', 'expandBtn723', 'collapseBtn723')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup723"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.OllamaLLMModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
      &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NvidiaNimOptions/remote.jsx (Line 96:22 - Line 114:22), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn724" onclick="toggleCodeBlock('cloneGroup724', 'expandBtn724', 'collapseBtn724')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn724" onclick="toggleCodeBlock('cloneGroup724', 'expandBtn724', 'collapseBtn724')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup724"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;NvidiaNimLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 25:21 - Line 38:4), frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 25:25 - Line 38:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn727" onclick="toggleCodeBlock('cloneGroup727', 'expandBtn727', 'collapseBtn727')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn727" onclick="toggleCodeBlock('cloneGroup727', 'expandBtn727', 'collapseBtn727')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup727"><code class="language-jsx text-sm text-gray-800"> settings={settings} /&gt;
        )}
      &lt;/div&gt;
      &lt;AdvancedControls settings={settings} /&gt;
    &lt;/div&gt;
  );
}

function AdvancedControls({ settings }) {
  const [showAdvancedControls, setShowAdvancedControls] = useState(false);

  return (
    &lt;div className=&quot;flex flex-col gap-y-4&quot;&gt;
      &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 40:2 - Line 52:7), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 62:7 - Line 78:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn728" onclick="toggleCodeBlock('cloneGroup728', 'expandBtn728', 'collapseBtn728')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn728" onclick="toggleCodeBlock('cloneGroup728', 'expandBtn728', 'collapseBtn728')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup728"><code class="language-jsx text-sm text-gray-800">
          onClick={() =&gt; setShowAdvancedControls(!showAdvancedControls)}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 84:9 - Line 95:17), frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 38:7 - Line 49:12)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn729" onclick="toggleCodeBlock('cloneGroup729', 'expandBtn729', 'collapseBtn729')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn729" onclick="toggleCodeBlock('cloneGroup729', 'expandBtn729', 'collapseBtn729')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup729"><code class="language-jsx text-sm text-gray-800">);
      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});
        setGroupedModels(modelsByOrganization);
      }
      setLoading(false);
    }
    findCustomModels</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 92:2 - Line 105:19), frontend/src/components/LLMSelection/OpenRouterOptions/index.jsx (Line 89:1 - Line 68:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn730" onclick="toggleCodeBlock('cloneGroup730', 'expandBtn730', 'collapseBtn730')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn730" onclick="toggleCodeBlock('cloneGroup730', 'expandBtn730', 'collapseBtn730')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup730"><code class="language-jsx text-sm text-gray-800">
      setLoading(false);
    }
    findCustomModels();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;NovitaLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 107:121 - Line 119:57), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 71:104 - Line 83:44)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn731" onclick="toggleCodeBlock('cloneGroup731', 'expandBtn731', 'collapseBtn731')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn731" onclick="toggleCodeBlock('cloneGroup731', 'expandBtn731', 'collapseBtn731')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup731"><code class="language-jsx text-sm text-gray-800">&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 112:7 - Line 123:19), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 78:2 - Line 89:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn732" onclick="toggleCodeBlock('cloneGroup732', 'expandBtn732', 'collapseBtn732')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn732" onclick="toggleCodeBlock('cloneGroup732', 'expandBtn732', 'collapseBtn732')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup732"><code class="language-jsx text-sm text-gray-800">&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-theme-text-primary text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;NovitaLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/NovitaLLMOptions/index.jsx (Line 123:19 - Line 146:1), frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 78:14 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn733" onclick="toggleCodeBlock('cloneGroup733', 'expandBtn733', 'collapseBtn733')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn733" onclick="toggleCodeBlock('cloneGroup733', 'expandBtn733', 'collapseBtn733')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup733"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg text-theme-text-primary border-theme-border text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.NovitaLLMModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/MistralOptions/index.jsx (Line 70:2 - Line 83:17), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 74:3 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn734" onclick="toggleCodeBlock('cloneGroup734', 'expandBtn734', 'collapseBtn734')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn734" onclick="toggleCodeBlock('cloneGroup734', 'expandBtn734', 'collapseBtn734')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup734"><code class="language-jsx text-sm text-gray-800">
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;MistralModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/MistralOptions/index.jsx (Line 88:25 - Line 106:1), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/LLMSelector/ChatModelSelection/index.jsx (Line 84:18 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn735" onclick="toggleCodeBlock('cloneGroup735', 'expandBtn735', 'collapseBtn735')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn735" onclick="toggleCodeBlock('cloneGroup735', 'expandBtn735', 'collapseBtn735')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup735"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.MistralModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 87:3 - Line 107:31), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 58:2 - Line 53:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn737" onclick="toggleCodeBlock('cloneGroup737', 'expandBtn737', 'collapseBtn737')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn737" onclick="toggleCodeBlock('cloneGroup737', 'expandBtn737', 'collapseBtn737')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup737"><code class="language-jsx text-sm text-gray-800">
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 197:17 - Line 220:1), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 292:19 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn738" onclick="toggleCodeBlock('cloneGroup738', 'expandBtn738', 'collapseBtn738')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn738" onclick="toggleCodeBlock('cloneGroup738', 'expandBtn738', 'collapseBtn738')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup738"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.LocalAiModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 76:22 - Line 88:6), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 147:22 - Line 245:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn739" onclick="toggleCodeBlock('cloneGroup739', 'expandBtn739', 'collapseBtn739')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn739" onclick="toggleCodeBlock('cloneGroup739', 'expandBtn739', 'collapseBtn739')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup739"><code class="language-jsx text-sm text-gray-800">({ settings, basePath = null, apiKey = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 89:10 - Line 102:44), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 160:10 - Line 173:44)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn740" onclick="toggleCodeBlock('cloneGroup740', 'expandBtn740', 'collapseBtn740')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn740" onclick="toggleCodeBlock('cloneGroup740', 'expandBtn740', 'collapseBtn740')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup740"><code class="language-jsx text-sm text-gray-800">,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 106:17 - Line 122:44), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 177:17 - Line 193:44)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn741" onclick="toggleCodeBlock('cloneGroup741', 'expandBtn741', 'collapseBtn741')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn741" onclick="toggleCodeBlock('cloneGroup741', 'expandBtn741', 'collapseBtn741')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup741"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;-- loading available models --&quot;
              : &quot;-- waiting for URL --&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 113:24 - Line 126:17), frontend/src/components/LLMSelection/MistralOptions/index.jsx (Line 70:28 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn742" onclick="toggleCodeBlock('cloneGroup742', 'expandBtn742', 'collapseBtn742')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn742" onclick="toggleCodeBlock('cloneGroup742', 'expandBtn742', 'collapseBtn742')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup742"><code class="language-jsx text-sm text-gray-800">}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;LiteLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 126:17 - Line 149:1), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 292:19 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn743" onclick="toggleCodeBlock('cloneGroup743', 'expandBtn743', 'collapseBtn743')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn743" onclick="toggleCodeBlock('cloneGroup743', 'expandBtn743', 'collapseBtn743')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup743"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.LiteLLMModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 38:9 - Line 50:42), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 32:8 - Line 44:43)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn745" onclick="toggleCodeBlock('cloneGroup745', 'expandBtn745', 'collapseBtn745')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn745" onclick="toggleCodeBlock('cloneGroup745', 'expandBtn745', 'collapseBtn745')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup745"><code class="language-jsx text-sm text-gray-800"> as your LLM requires you to set an embedding service to
              use.
            &lt;/p&gt;
          &lt;/div&gt;
          &lt;a
            href={paths.settings.embedder.modelPreference()}
            className=&quot;text-sm md:text-base my-2 underline&quot;
          &gt;
            Manage embedding &amp;rarr;
          &lt;/a&gt;
        &lt;/div&gt;
      )}
      &lt;div className=&quot;w-full flex items-start gap-[36px] mt-1.5</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 58:19 - Line 82:7), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 45:20 - Line 69:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn746" onclick="toggleCodeBlock('cloneGroup746', 'expandBtn746', 'collapseBtn746')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn746" onclick="toggleCodeBlock('cloneGroup746', 'expandBtn746', 'collapseBtn746')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup746"><code class="language-jsx text-sm text-gray-800">&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;4096&quot;
            defaultChecked=&quot;4096&quot;
            min={1}
            value={maxTokens}
            onChange={handleMaxTokensChange}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum number of tokens for context and response.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 82:6 - Line 92:30), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 69:9 - Line 79:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn747" onclick="toggleCodeBlock('cloneGroup747', 'expandBtn747', 'collapseBtn747')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn747" onclick="toggleCodeBlock('cloneGroup747', 'expandBtn747', 'collapseBtn747')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup747"><code class="language-jsx text-sm text-gray-800">
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 96:7 - Line 115:17), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 111:3 - Line 130:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn748" onclick="toggleCodeBlock('cloneGroup748', 'expandBtn748', 'collapseBtn748')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn748" onclick="toggleCodeBlock('cloneGroup748', 'expandBtn748', 'collapseBtn748')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup748"><code class="language-jsx text-sm text-gray-800"> Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;LMStudioBasePath</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 135:9 - Line 149:11), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 147:7 - Line 247:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn749" onclick="toggleCodeBlock('cloneGroup749', 'expandBtn749', 'collapseBtn749')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn749" onclick="toggleCodeBlock('cloneGroup749', 'expandBtn749', 'collapseBtn749')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup749"><code class="language-jsx text-sm text-gray-800"> = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(
          &quot;lmstudio&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 150:5 - Line 161:2), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 248:10 - Line 259:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn750" onclick="toggleCodeBlock('cloneGroup750', 'expandBtn750', 'collapseBtn750')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn750" onclick="toggleCodeBlock('cloneGroup750', 'expandBtn750', 'collapseBtn750')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup750"><code class="language-jsx text-sm text-gray-800">,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 194:18 - Line 215:3), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 292:19 - Line 313:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn751" onclick="toggleCodeBlock('cloneGroup751', 'expandBtn751', 'collapseBtn751')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn751" onclick="toggleCodeBlock('cloneGroup751', 'expandBtn751', 'collapseBtn751')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup751"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.LMStudioModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
      &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
        Choose the LM</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/LLMItem/index.jsx (Line 1:8 - Line 38:1), frontend/src/components/VectorDBSelection/VectorDBItem/index.jsx (Line 1:13 - Line 28:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn753" onclick="toggleCodeBlock('cloneGroup753', 'expandBtn753', 'collapseBtn753')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn753" onclick="toggleCodeBlock('cloneGroup753', 'expandBtn753', 'collapseBtn753')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup753"><code class="language-jsx text-sm text-gray-800">({
  name,
  value,
  image,
  description,
  checked,
  onClick,
}) {
  return (
    &lt;div
      onClick={() =&gt; onClick(value)}
      className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
        checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
      }`}
    &gt;
      &lt;input
        type=&quot;checkbox&quot;
        value={value}
        className=&quot;peer hidden&quot;
        checked={checked}
        readOnly={true}
        formNoValidate={true}
      /&gt;
      &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
        &lt;img
          src={image}
          alt={`${name} logo`}
          className=&quot;w-10 h-10 rounded-md&quot;
        /&gt;
        &lt;div className=&quot;flex flex-col&quot;&gt;
          &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;{name}&lt;/div&gt;
          &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;{description}&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 52:12 - Line 64:9), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 48:15 - Line 60:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn755" onclick="toggleCodeBlock('cloneGroup755', 'expandBtn755', 'collapseBtn755')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn755" onclick="toggleCodeBlock('cloneGroup755', 'expandBtn755', 'collapseBtn755')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup755"><code class="language-jsx text-sm text-gray-800">=&quot;4096&quot;
            min={1}
            value={tokenLimit}
            onChange={handleTokenLimitChange}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum number of tokens for context and response.
          &lt;/p&gt;
        &lt;/div&gt;
        </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 81:4 - Line 107:10), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 57:4 - Line 96:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn756" onclick="toggleCodeBlock('cloneGroup756', 'expandBtn756', 'collapseBtn756')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn756" onclick="toggleCodeBlock('cloneGroup756', 'expandBtn756', 'collapseBtn756')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup756"><code class="language-jsx text-sm text-gray-800"> response.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                KoboldCPP</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 146:24 - Line 158:4), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 135:23 - Line 159:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn757" onclick="toggleCodeBlock('cloneGroup757', 'expandBtn757', 'collapseBtn757')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn757" onclick="toggleCodeBlock('cloneGroup757', 'expandBtn757', 'collapseBtn757')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup757"><code class="language-jsx text-sm text-gray-800">({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath || !basePath.includes(&quot;/v1&quot;)) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 160:12 - Line 174:4), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 149:11 - Line 163:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn758" onclick="toggleCodeBlock('cloneGroup758', 'expandBtn758', 'collapseBtn758')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn758" onclick="toggleCodeBlock('cloneGroup758', 'expandBtn758', 'collapseBtn758')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup758"><code class="language-jsx text-sm text-gray-800">,
          null,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length ===</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GroqAiOptions/index.jsx (Line 35:21 - Line 49:7), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 35:18 - Line 49:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn760" onclick="toggleCodeBlock('cloneGroup760', 'expandBtn760', 'collapseBtn760')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn760" onclick="toggleCodeBlock('cloneGroup760', 'expandBtn760', 'collapseBtn760')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup760"><code class="language-jsx text-sm text-gray-800">({ apiKey, settings }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!apiKey) {
        setCustomModels([]);
        setLoading(true);
        return;
      }

      try {
        setLoading(true);
        const { models } = await System.customModels(&quot;groq&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GroqAiOptions/index.jsx (Line 49:7 - Line 68:14), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 49:6 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn761" onclick="toggleCodeBlock('cloneGroup761', 'expandBtn761', 'collapseBtn761')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn761" onclick="toggleCodeBlock('cloneGroup761', 'expandBtn761', 'collapseBtn761')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup761"><code class="language-jsx text-sm text-gray-800">, apiKey);
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      } finally {
        setLoading(false);
      }
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;GroqModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GroqAiOptions/index.jsx (Line 78:2 - Line 89:14), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 76:7 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn762" onclick="toggleCodeBlock('cloneGroup762', 'expandBtn762', 'collapseBtn762')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn762" onclick="toggleCodeBlock('cloneGroup762', 'expandBtn762', 'collapseBtn762')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup762"><code class="language-jsx text-sm text-gray-800">&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;GroqModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GroqAiOptions/index.jsx (Line 91:104 - Line 110:7), frontend/src/components/LLMSelection/XAiLLMOptions/index.jsx (Line 91:121 - Line 313:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn763" onclick="toggleCodeBlock('cloneGroup763', 'expandBtn763', 'collapseBtn763')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn763" onclick="toggleCodeBlock('cloneGroup763', 'expandBtn763', 'collapseBtn763')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup763"><code class="language-jsx text-sm text-gray-800">&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Available models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.GroqModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
      &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
        Select</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GeminiLLMOptions/index.jsx (Line 81:2 - Line 94:19), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 56:1 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn764" onclick="toggleCodeBlock('cloneGroup764', 'expandBtn764', 'collapseBtn764')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn764" onclick="toggleCodeBlock('cloneGroup764', 'expandBtn764', 'collapseBtn764')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup764"><code class="language-jsx text-sm text-gray-800">
      setLoading(false);
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;GeminiLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/GeminiLLMOptions/index.jsx (Line 94:19 - Line 112:19), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn765" onclick="toggleCodeBlock('cloneGroup765', 'expandBtn765', 'collapseBtn765')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn765" onclick="toggleCodeBlock('cloneGroup765', 'expandBtn765', 'collapseBtn765')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup765"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;GeminiLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/FireworksAiOptions/index.jsx (Line 35:14 - Line 59:24), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 46:7 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn766" onclick="toggleCodeBlock('cloneGroup766', 'expandBtn766', 'collapseBtn766')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn766" onclick="toggleCodeBlock('cloneGroup766', 'expandBtn766', 'collapseBtn766')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup766"><code class="language-jsx text-sm text-gray-800">);

      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});

        setGroupedModels(modelsByOrganization);
      }

      setLoading(false);
    }
    findCustomModels();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;FireworksAiLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/FireworksAiOptions/index.jsx (Line 59:24 - Line 77:24), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn767" onclick="toggleCodeBlock('cloneGroup767', 'expandBtn767', 'collapseBtn767')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn767" onclick="toggleCodeBlock('cloneGroup767', 'expandBtn767', 'collapseBtn767')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup767"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;FireworksAiLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/FireworksAiOptions/index.jsx (Line 77:24 - Line 100:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 87:24 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn768" onclick="toggleCodeBlock('cloneGroup768', 'expandBtn768', 'collapseBtn768')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn768" onclick="toggleCodeBlock('cloneGroup768', 'expandBtn768', 'collapseBtn768')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup768"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.FireworksAiLLMModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DeepSeekOptions/index.jsx (Line 8:3 - Line 18:15), frontend/src/components/LLMSelection/OpenAiOptions/index.jsx (Line 6:10 - Line 16:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn769" onclick="toggleCodeBlock('cloneGroup769', 'expandBtn769', 'collapseBtn769')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn769" onclick="toggleCodeBlock('cloneGroup769', 'expandBtn769', 'collapseBtn769')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup769"><code class="language-jsx text-sm text-gray-800">);

  return (
    &lt;div className=&quot;flex gap-[36px] mt-1.5&quot;&gt;
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          API Key
        &lt;/label&gt;
        &lt;input
          type=&quot;password&quot;
          name=&quot;DeepSeekApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DeepSeekOptions/index.jsx (Line 53:2 - Line 66:18), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 56:1 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn770" onclick="toggleCodeBlock('cloneGroup770', 'expandBtn770', 'collapseBtn770')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn770" onclick="toggleCodeBlock('cloneGroup770', 'expandBtn770', 'collapseBtn770')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup770"><code class="language-jsx text-sm text-gray-800">
      setLoading(false);
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;DeepSeekModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DeepSeekOptions/index.jsx (Line 66:18 - Line 84:18), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn771" onclick="toggleCodeBlock('cloneGroup771', 'expandBtn771', 'collapseBtn771')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn771" onclick="toggleCodeBlock('cloneGroup771', 'expandBtn771', 'collapseBtn771')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup771"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;DeepSeekModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DeepSeekOptions/index.jsx (Line 84:18 - Line 101:1), frontend/src/components/LLMSelection/NvidiaNimOptions/remote.jsx (Line 114:22 - Line 131:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn772" onclick="toggleCodeBlock('cloneGroup772', 'expandBtn772', 'collapseBtn772')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn772" onclick="toggleCodeBlock('cloneGroup772', 'expandBtn772', 'collapseBtn772')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup772"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {models.map((model) =&gt; (
          &lt;option
            key={model.id}
            value={model.id}
            selected={settings?.DeepSeekModelPref === model.id}
          &gt;
            {model.name}
          &lt;/option&gt;
        ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 51:2 - Line 71:20), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 59:2 - Line 108:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn774" onclick="toggleCodeBlock('cloneGroup774', 'expandBtn774', 'collapseBtn774')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn774" onclick="toggleCodeBlock('cloneGroup774', 'expandBtn774', 'collapseBtn774')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup774"><code class="language-jsx text-sm text-gray-800">
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-fit</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 74:3 - Line 93:24), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 96:3 - Line 130:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn775" onclick="toggleCodeBlock('cloneGroup775', 'expandBtn775', 'collapseBtn775')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn775" onclick="toggleCodeBlock('cloneGroup775', 'expandBtn775', 'collapseBtn775')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup775"><code class="language-jsx text-sm text-gray-800"> Studio Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;DellProAiStudioBasePath</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 110:30 - Line 123:8), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 135:23 - Line 47:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn776" onclick="toggleCodeBlock('cloneGroup776', 'expandBtn776', 'collapseBtn776')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn776" onclick="toggleCodeBlock('cloneGroup776', 'expandBtn776', 'collapseBtn776')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup776"><code class="language-jsx text-sm text-gray-800">({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;dpais&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 128:2 - Line 141:25), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 157:2 - Line 177:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn777" onclick="toggleCodeBlock('cloneGroup777', 'expandBtn777', 'collapseBtn777')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn777" onclick="toggleCodeBlock('cloneGroup777', 'expandBtn777', 'collapseBtn777')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup777"><code class="language-jsx text-sm text-gray-800">
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;DellProAiStudioModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 141:25 - Line 155:44), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 83:44)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn778" onclick="toggleCodeBlock('cloneGroup778', 'expandBtn778', 'collapseBtn778')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn778" onclick="toggleCodeBlock('cloneGroup778', 'expandBtn778', 'collapseBtn778')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup778"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 146:3 - Line 159:25), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 184:2 - Line 197:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn779" onclick="toggleCodeBlock('cloneGroup779', 'expandBtn779', 'collapseBtn779')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn779" onclick="toggleCodeBlock('cloneGroup779', 'expandBtn779', 'collapseBtn779')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup779"><code class="language-jsx text-sm text-gray-800">
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;DellProAiStudioModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/DPAISOptions/index.jsx (Line 159:25 - Line 182:1), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 292:19 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn780" onclick="toggleCodeBlock('cloneGroup780', 'expandBtn780', 'collapseBtn780')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn780" onclick="toggleCodeBlock('cloneGroup780', 'expandBtn780', 'collapseBtn780')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup780"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.DellProAiStudioModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/ApiPieOptions/index.jsx (Line 38:9 - Line 61:19), frontend/src/components/LLMSelection/PPIOLLMOptions/index.jsx (Line 38:7 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn782" onclick="toggleCodeBlock('cloneGroup782', 'expandBtn782', 'collapseBtn782')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn782" onclick="toggleCodeBlock('cloneGroup782', 'expandBtn782', 'collapseBtn782')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup782"><code class="language-jsx text-sm text-gray-800">);
      if (models?.length &gt; 0) {
        const modelsByOrganization = models.reduce((acc, model) =&gt; {
          acc[model.organization] = acc[model.organization] || [];
          acc[model.organization].push(model);
          return acc;
        }, {});

        setGroupedModels(modelsByOrganization);
      }

      setLoading(false);
    }
    findCustomModels();
  }, []);

  if (loading || Object.keys(groupedModels).length === 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;ApipieLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/ApiPieOptions/index.jsx (Line 63:210 - Line 79:19), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 71:104 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn783" onclick="toggleCodeBlock('cloneGroup783', 'expandBtn783', 'collapseBtn783')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn783" onclick="toggleCodeBlock('cloneGroup783', 'expandBtn783', 'collapseBtn783')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup783"><code class="language-jsx text-sm text-gray-800">&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;ApipieLLMModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/ApiPieOptions/index.jsx (Line 81:210 - Line 102:1), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 89:104 - Line 110:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn784" onclick="toggleCodeBlock('cloneGroup784', 'expandBtn784', 'collapseBtn784')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn784" onclick="toggleCodeBlock('cloneGroup784', 'expandBtn784', 'collapseBtn784')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup784"><code class="language-jsx text-sm text-gray-800">&quot;
      &gt;
        {Object.keys(groupedModels)
          .sort()
          .map((organization) =&gt; (
            &lt;optgroup key={organization} label={organization}&gt;
              {groupedModels[organization].map((model) =&gt; (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.ApipieLLMModelPref === model.id}
                &gt;
                  {model.name}
                &lt;/option&gt;
              ))}
            &lt;/optgroup&gt;
          ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/AnthropicAiOptions/index.jsx (Line 92:7 - Line 105:19), frontend/src/components/LLMSelection/DeepSeekOptions/index.jsx (Line 53:2 - Line 69:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn785" onclick="toggleCodeBlock('cloneGroup785', 'expandBtn785', 'collapseBtn785')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn785" onclick="toggleCodeBlock('cloneGroup785', 'expandBtn785', 'collapseBtn785')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup785"><code class="language-jsx text-sm text-gray-800">);
      setLoading(false);
    }
    findCustomModels();
  }, [apiKey]);

  if (loading) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Chat Model Selection
        &lt;/label&gt;
        &lt;select
          name=&quot;AnthropicModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/AnthropicAiOptions/index.jsx (Line 105:19 - Line 123:19), frontend/src/components/TextToSpeech/ElevenLabsOptions/index.jsx (Line 69:24 - Line 87:24)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn786" onclick="toggleCodeBlock('cloneGroup786', 'expandBtn786', 'collapseBtn786')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn786" onclick="toggleCodeBlock('cloneGroup786', 'expandBtn786', 'collapseBtn786')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup786"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            -- loading available models --
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
        Chat Model Selection
      &lt;/label&gt;
      &lt;select
        name=&quot;AnthropicModelPref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/LLMSelection/AnthropicAiOptions/index.jsx (Line 123:19 - Line 140:1), frontend/src/components/LLMSelection/NvidiaNimOptions/remote.jsx (Line 114:22 - Line 131:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn787" onclick="toggleCodeBlock('cloneGroup787', 'expandBtn787', 'collapseBtn787')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn787" onclick="toggleCodeBlock('cloneGroup787', 'expandBtn787', 'collapseBtn787')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup787"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {models.map((model) =&gt; (
          &lt;option
            key={model.id}
            value={model.id}
            selected={settings?.AnthropicModelPref === model.id}
          &gt;
            {model.name}
          &lt;/option&gt;
        ))}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OpenAiOptions/index.jsx (Line 1:14 - Line 11:10), frontend/src/components/VectorDBSelection/ZillizCloudOptions/index.jsx (Line 1:19 - Line 11:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn788" onclick="toggleCodeBlock('cloneGroup788', 'expandBtn788', 'collapseBtn788')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn788" onclick="toggleCodeBlock('cloneGroup788', 'expandBtn788', 'collapseBtn788')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup788"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  return (
    &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px] mt-1.5&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;OpenAiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OpenAiOptions/index.jsx (Line 13:15 - Line 27:10), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 13:18 - Line 27:13)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn789" onclick="toggleCodeBlock('cloneGroup789', 'expandBtn789', 'collapseBtn789')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn789" onclick="toggleCodeBlock('cloneGroup789', 'expandBtn789', 'collapseBtn789')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup789"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.OpenAiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Model Preference
          &lt;/label&gt;
          &lt;select
            name=&quot;EmbeddingModelPref&quot;
            required={true}
            className</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OpenAiOptions/index.jsx (Line 40:19 - Line 52:1), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 45:2 - Line 57:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn790" onclick="toggleCodeBlock('cloneGroup790', 'expandBtn790', 'collapseBtn790')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn790" onclick="toggleCodeBlock('cloneGroup790', 'expandBtn790', 'collapseBtn790')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup790"><code class="language-jsx text-sm text-gray-800">&gt;
                    {model}
                  &lt;/option&gt;
                );
              })}
            &lt;/optgroup&gt;
          &lt;/select&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 54:10 - Line 80:7), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 57:9 - Line 96:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn792" onclick="toggleCodeBlock('cloneGroup792', 'expandBtn792', 'collapseBtn792')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn792" onclick="toggleCodeBlock('cloneGroup792', 'expandBtn792', 'collapseBtn792')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup792"><code class="language-jsx text-sm text-gray-800">.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                Ollama</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 80:7 - Line 99:18), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 111:3 - Line 130:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn793" onclick="toggleCodeBlock('cloneGroup793', 'expandBtn793', 'collapseBtn793')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn793" onclick="toggleCodeBlock('cloneGroup793', 'expandBtn793', 'collapseBtn793')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup793"><code class="language-jsx text-sm text-gray-800"> Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 119:30 - Line 132:9), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 135:23 - Line 247:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn794" onclick="toggleCodeBlock('cloneGroup794', 'expandBtn794', 'collapseBtn794')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn794" onclick="toggleCodeBlock('cloneGroup794', 'expandBtn794', 'collapseBtn794')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup794"><code class="language-jsx text-sm text-gray-800">({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(&quot;ollama&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 132:9 - Line 147:10), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 250:9 - Line 265:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn795" onclick="toggleCodeBlock('cloneGroup795', 'expandBtn795', 'collapseBtn795')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn795" onclick="toggleCodeBlock('cloneGroup795', 'expandBtn795', 'collapseBtn795')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup795"><code class="language-jsx text-sm text-gray-800">);
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Ollama Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 150:19 - Line 161:4), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 268:19 - Line 279:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn796" onclick="toggleCodeBlock('cloneGroup796', 'expandBtn796', 'collapseBtn796')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn796" onclick="toggleCodeBlock('cloneGroup796', 'expandBtn796', 'collapseBtn796')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup796"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter Ollama URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the Ollama model for</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 161:11 - Line 171:10), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 279:4 - Line 289:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn797" onclick="toggleCodeBlock('cloneGroup797', 'expandBtn797', 'collapseBtn797')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn797" onclick="toggleCodeBlock('cloneGroup797', 'expandBtn797', 'collapseBtn797')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup797"><code class="language-jsx text-sm text-gray-800">. Models will load after
          entering a valid Ollama URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Ollama Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 174:19 - Line 195:11), frontend/src/components/LLMSelection/OllamaLLMOptions/index.jsx (Line 292:19 - Line 313:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn798" onclick="toggleCodeBlock('cloneGroup798', 'expandBtn798', 'collapseBtn798')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn798" onclick="toggleCodeBlock('cloneGroup798', 'expandBtn798', 'collapseBtn798')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup798"><code class="language-jsx text-sm text-gray-800">&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
      &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
        Choose the Ollama model you want to use for generating</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/MistralAiOptions/index.jsx (Line 1:17 - Line 11:14), frontend/src/components/VectorDBSelection/ZillizCloudOptions/index.jsx (Line 1:19 - Line 11:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn799" onclick="toggleCodeBlock('cloneGroup799', 'expandBtn799', 'collapseBtn799')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn799" onclick="toggleCodeBlock('cloneGroup799', 'expandBtn799', 'collapseBtn799')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup799"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  return (
    &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px] mt-1.5&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;MistralApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/MistralAiOptions/index.jsx (Line 13:19 - Line 31:16), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 13:18 - Line 32:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn800" onclick="toggleCodeBlock('cloneGroup800', 'expandBtn800', 'collapseBtn800')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn800" onclick="toggleCodeBlock('cloneGroup800', 'expandBtn800', 'collapseBtn800')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup800"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.MistralApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Model Preference
          &lt;/label&gt;
          &lt;select
            name=&quot;EmbeddingModelPref&quot;
            required={true}
            defaultValue={settings?.EmbeddingModelPref}
            className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
          &gt;
            &lt;optgroup label=&quot;Available embedding models&quot;&gt;
              {[&quot;mistral-embed&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/MistralAiOptions/index.jsx (Line 31:16 - Line 45:1), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 43:15 - Line 57:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn801" onclick="toggleCodeBlock('cloneGroup801', 'expandBtn801', 'collapseBtn801')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn801" onclick="toggleCodeBlock('cloneGroup801', 'expandBtn801', 'collapseBtn801')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup801"><code class="language-jsx text-sm text-gray-800">].map((model) =&gt; {
                return (
                  &lt;option key={model} value={model}&gt;
                    {model}
                  &lt;/option&gt;
                );
              })}
            &lt;/optgroup&gt;
          &lt;/select&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 8:15 - Line 18:18), frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 8:17 - Line 19:16)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn803" onclick="toggleCodeBlock('cloneGroup803', 'expandBtn803', 'collapseBtn803')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn803" onclick="toggleCodeBlock('cloneGroup803', 'expandBtn803', 'collapseBtn803')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup803"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  const {
    autoDetecting: loading,
    basePath,
    basePathValue,
    showAdvancedControls,
    setShowAdvancedControls,
    handleAutoDetectClick,
  } = useProviderEndpointAutoDiscovery({
    provider: &quot;localai&quot;,
    initialBasePath: settings?.EmbeddingBasePath</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 47:2 - Line 89:8), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 69:2 - Line 111:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn804" onclick="toggleCodeBlock('cloneGroup804', 'expandBtn804', 'collapseBtn804')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn804" onclick="toggleCodeBlock('cloneGroup804', 'expandBtn804', 'collapseBtn804')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup804"><code class="language-jsx text-sm text-gray-800">
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;div className=&quot;flex flex-col gap-y-1 mb-2&quot;&gt;
            &lt;label className=&quot;text-white text-sm font-semibold flex items-center gap-x-2&quot;&gt;
              Local AI API Key{&quot; &quot;}
              &lt;p className=&quot;!text-xs !italic !font-thin&quot;&gt;optional&lt;/p&gt;
            &lt;/label&gt;
          &lt;/div&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;LocalAiApiKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;sk-mysecretkey&quot;
            defaultValue={settings?.LocalAiApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setApiKeyValue(e.target.value)}
            onBlur={() =&gt; setApiKey(apiKeyValue)}
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-center gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                LocalAI</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 89:8 - Line 110:25), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 111:3 - Line 101:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn805" onclick="toggleCodeBlock('cloneGroup805', 'expandBtn805', 'collapseBtn805')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn805" onclick="toggleCodeBlock('cloneGroup805', 'expandBtn805', 'collapseBtn805')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup805"><code class="language-jsx text-sm text-gray-800"> Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:8080/v1</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 108:18 - Line 125:7), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 130:16 - Line 147:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn806" onclick="toggleCodeBlock('cloneGroup806', 'expandBtn806', 'collapseBtn806')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn806" onclick="toggleCodeBlock('cloneGroup806', 'expandBtn806', 'collapseBtn806')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup806"><code class="language-jsx text-sm text-gray-800">&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:8080/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LocalAIModelSelection({ settings, apiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 125:5 - Line 152:10), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 135:9 - Line 265:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn807" onclick="toggleCodeBlock('cloneGroup807', 'expandBtn807', 'collapseBtn807')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn807" onclick="toggleCodeBlock('cloneGroup807', 'expandBtn807', 'collapseBtn807')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup807"><code class="language-jsx text-sm text-gray-800">, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath || !basePath.includes(&quot;/v1&quot;)) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;localai&quot;,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 155:19 - Line 172:10), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 177:17 - Line 194:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn808" onclick="toggleCodeBlock('cloneGroup808', 'expandBtn808', 'collapseBtn808')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn808" onclick="toggleCodeBlock('cloneGroup808', 'expandBtn808', 'collapseBtn808')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup808"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;-- loading available models --&quot;
              : &quot;-- waiting for URL --&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 172:5 - Line 198:1), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 171:6 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn809" onclick="toggleCodeBlock('cloneGroup809', 'expandBtn809', 'collapseBtn809')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn809" onclick="toggleCodeBlock('cloneGroup809', 'expandBtn809', 'collapseBtn809')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup809"><code class="language-jsx text-sm text-gray-800">
      &lt;/label&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings?.EmbeddingModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 14:43 - Line 39:4), frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 12:36 - Line 37:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn812" onclick="toggleCodeBlock('cloneGroup812', 'expandBtn812', 'collapseBtn812')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn812" onclick="toggleCodeBlock('cloneGroup812', 'expandBtn812', 'collapseBtn812')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup812"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Base URL
          &lt;/label&gt;
          &lt;input
            type=&quot;url&quot;
            name=&quot;LiteLLMBasePath&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;http://127.0.0.1:4000&quot;
            defaultValue={settings?.LiteLLMBasePath}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setBasePathValue(e.target.value)}
            onBlur={() =&gt; setBasePath(basePathValue)}
          /&gt;
        &lt;/div&gt;
        &lt;LiteLLMModelSelection
          settings={settings}
          basePath={basePath}
          apiKey={apiKey}
        /&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Max</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 45:5 - Line 105:10), frontend/src/components/LLMSelection/LiteLLMOptions/index.jsx (Line 43:5 - Line 47:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn813" onclick="toggleCodeBlock('cloneGroup813', 'expandBtn813', 'collapseBtn813')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn813" onclick="toggleCodeBlock('cloneGroup813', 'expandBtn813', 'collapseBtn813')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup813"><code class="language-jsx text-sm text-gray-800">&quot;
            min={1}
            onScroll={(e) =&gt; e.target.blur()}
            defaultValue={settings?.EmbeddingModelMaxChunkLength}
            required={false}
            autoComplete=&quot;off&quot;
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px]&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
            &lt;label className=&quot;text-white text-sm font-semibold flex items-center gap-x-2&quot;&gt;
              API Key &lt;p className=&quot;!text-xs !italic !font-thin&quot;&gt;optional&lt;/p&gt;
            &lt;/label&gt;
          &lt;/div&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;LiteLLMAPIKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;sk-mysecretkey&quot;
            defaultValue={settings?.LiteLLMAPIKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            autoComplete=&quot;off&quot;
            spellCheck={false}
            onChange={(e) =&gt; setApiKeyValue(e.target.value)}
            onBlur={() =&gt; setApiKey(apiKeyValue)}
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LiteLLMModelSelection({ settings, basePath = null, apiKey = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      const { models } = await System.customModels(
        &quot;litellm&quot;,
        typeof apiKey === &quot;boolean&quot; ? null : apiKey,
        basePath
      );
      setCustomModels(models || []);
      setLoading(false);
    }
    findCustomModels();
  }, [basePath, apiKey]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
          Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 105:10 - Line 124:4), frontend/src/components/EmbeddingSelection/LocalAiOptions/index.jsx (Line 152:5 - Line 193:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn814" onclick="toggleCodeBlock('cloneGroup814', 'expandBtn814', 'collapseBtn814')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn814" onclick="toggleCodeBlock('cloneGroup814', 'expandBtn814', 'collapseBtn814')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup814"><code class="language-jsx text-sm text-gray-800">
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {basePath?.includes(&quot;/v1&quot;)
              ? &quot;-- loading available models --&quot;
              : &quot;-- waiting for URL --&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;div</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 129:4 - Line 154:1), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 172:6 - Line 91:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn815" onclick="toggleCodeBlock('cloneGroup815', 'expandBtn815', 'collapseBtn815')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn815" onclick="toggleCodeBlock('cloneGroup815', 'expandBtn815', 'collapseBtn815')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup815"><code class="language-jsx text-sm text-gray-800">&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 8:25 - Line 18:18), frontend/src/components/LLMSelection/KoboldCPPOptions/index.jsx (Line 8:17 - Line 19:17)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn817" onclick="toggleCodeBlock('cloneGroup817', 'expandBtn817', 'collapseBtn817')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn817" onclick="toggleCodeBlock('cloneGroup817', 'expandBtn817', 'collapseBtn817')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup817"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  const {
    autoDetecting: loading,
    basePath,
    basePathValue,
    showAdvancedControls,
    setShowAdvancedControls,
    handleAutoDetectClick,
  } = useProviderEndpointAutoDiscovery({
    provider: &quot;lmstudio&quot;,
    initialBasePath: settings?.EmbeddingBasePath</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 19:21 - Line 33:23), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 19:19 - Line 33:30)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn818" onclick="toggleCodeBlock('cloneGroup818', 'expandBtn818', 'collapseBtn818')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn818" onclick="toggleCodeBlock('cloneGroup818', 'expandBtn818', 'collapseBtn818')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup818"><code class="language-jsx text-sm text-gray-800">,
  });

  const [maxChunkLength, setMaxChunkLength] = useState(
    settings?.EmbeddingModelMaxChunkLength || 8192
  );

  const handleMaxChunkLengthChange = (e) =&gt; {
    setMaxChunkLength(Number(e.target.value));
  };

  return (
    &lt;div className=&quot;w-full flex flex-col gap-y-7&quot;&gt;
      &lt;div className=&quot;w-full flex items-start gap-[36px] mt-1.5&quot;&gt;
        &lt;LMStudioModelSelection</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 33:2 - Line 98:25), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 36:9 - Line 101:23)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn819" onclick="toggleCodeBlock('cloneGroup819', 'expandBtn819', 'collapseBtn819')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn819" onclick="toggleCodeBlock('cloneGroup819', 'expandBtn819', 'collapseBtn819')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup819"><code class="language-jsx text-sm text-gray-800">/&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
            Max Embedding Chunk Length
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;EmbeddingModelMaxChunkLength&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;8192&quot;
            min={1}
            value={maxChunkLength}
            onChange={handleMaxChunkLengthChange}
            onScroll={(e) =&gt; e.target.blur()}
            required={true}
            autoComplete=&quot;off&quot;
          /&gt;
          &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
            Maximum length of text chunks for embedding.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} Manual Endpoint Input
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4&quot;&gt;
          &lt;div className=&quot;flex flex-col w-60&quot;&gt;
            &lt;div className=&quot;flex justify-between items-center mb-2&quot;&gt;
              &lt;label className=&quot;text-white text-sm font-semibold&quot;&gt;
                LM Studio Base URL
              &lt;/label&gt;
              {loading ? (
                &lt;PreLoader size=&quot;6&quot; /&gt;
              ) : (
                &lt;&gt;
                  {!basePathValue.value &amp;&amp; (
                    &lt;button
                      onClick={handleAutoDetectClick}
                      className=&quot;bg-primary-button text-xs font-medium px-2 py-1 rounded-lg hover:bg-secondary hover:text-white shadow-[0_4px_14px_rgba(0,0,0,0.25)]&quot;
                    &gt;
                      Auto-Detect
                    &lt;/button&gt;
                  )}
                &lt;/&gt;
              )}
            &lt;/div&gt;
            &lt;input
              type=&quot;url&quot;
              name=&quot;EmbeddingBasePath&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:1234/v1</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 96:18 - Line 148:10), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 115:17 - Line 167:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn820" onclick="toggleCodeBlock('cloneGroup820', 'expandBtn820', 'collapseBtn820')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn820" onclick="toggleCodeBlock('cloneGroup820', 'expandBtn820', 'collapseBtn820')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup820"><code class="language-jsx text-sm text-gray-800">&quot;
              className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
              placeholder=&quot;http://localhost:1234/v1&quot;
              value={basePathValue.value}
              required={true}
              autoComplete=&quot;off&quot;
              spellCheck={false}
              onChange={basePath.onChange}
              onBlur={basePath.onBlur}
            /&gt;
            &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
              Enter the URL where LM Studio is running.
            &lt;/p&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

function LMStudioModelSelection({ settings, basePath = null }) {
  const [customModels, setCustomModels] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function findCustomModels() {
      if (!basePath) {
        setCustomModels([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      try {
        const { models } = await System.customModels(
          &quot;lmstudio&quot;,
          null,
          basePath
        );
        setCustomModels(models || []);
      } catch (error) {
        console.error(&quot;Failed to fetch custom models:&quot;, error);
        setCustomModels([]);
      }
      setLoading(false);
    }
    findCustomModels();
  }, [basePath]);

  if (loading || customModels.length == 0) {
    return (
      &lt;div className=&quot;flex flex-col w-60&quot;&gt;
        &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
          LM Studio Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 148:7 - Line 158:28), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 147:7 - Line 157:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn821" onclick="toggleCodeBlock('cloneGroup821', 'expandBtn821', 'collapseBtn821')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn821" onclick="toggleCodeBlock('cloneGroup821', 'expandBtn821', 'collapseBtn821')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup821"><code class="language-jsx text-sm text-gray-800"> Embedding Model
        &lt;/label&gt;
        &lt;select
          name=&quot;EmbeddingModelPref&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter LM Studio URL first&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 151:19 - Line 162:4), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 170:18 - Line 181:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn822" onclick="toggleCodeBlock('cloneGroup822', 'expandBtn822', 'collapseBtn822')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn822" onclick="toggleCodeBlock('cloneGroup822', 'expandBtn822', 'collapseBtn822')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup822"><code class="language-jsx text-sm text-gray-800">&quot;
          disabled={true}
          className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
        &gt;
          &lt;option disabled={true} selected={true}&gt;
            {!!basePath
              ? &quot;--loading available models--&quot;
              : &quot;Enter LM Studio URL first&quot;}
          &lt;/option&gt;
        &lt;/select&gt;
        &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
          Select the LM Studio model for</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 162:11 - Line 172:10), frontend/src/components/LLMSelection/LMStudioOptions/index.jsx (Line 181:4 - Line 191:6)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn823" onclick="toggleCodeBlock('cloneGroup823', 'expandBtn823', 'collapseBtn823')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn823" onclick="toggleCodeBlock('cloneGroup823', 'expandBtn823', 'collapseBtn823')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup823"><code class="language-jsx text-sm text-gray-800">. Models will load after
          entering a valid LM Studio URL.
        &lt;/p&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div className=&quot;flex flex-col w-60&quot;&gt;
      &lt;label className=&quot;text-white text-sm font-semibold block mb-2&quot;&gt;
        LM Studio Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/LMStudioOptions/index.jsx (Line 172:7 - Line 196:11), frontend/src/components/EmbeddingSelection/OllamaOptions/index.jsx (Line 171:7 - Line 215:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn824" onclick="toggleCodeBlock('cloneGroup824', 'expandBtn824', 'collapseBtn824')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn824" onclick="toggleCodeBlock('cloneGroup824', 'expandBtn824', 'collapseBtn824')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup824"><code class="language-jsx text-sm text-gray-800"> Embedding Model
      &lt;/label&gt;
      &lt;select
        name=&quot;EmbeddingModelPref&quot;
        required={true}
        className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
      &gt;
        {customModels.length &gt; 0 &amp;&amp; (
          &lt;optgroup label=&quot;Your loaded models&quot;&gt;
            {customModels.map((model) =&gt; {
              return (
                &lt;option
                  key={model.id}
                  value={model.id}
                  selected={settings.EmbeddingModelPref === model.id}
                &gt;
                  {model.id}
                &lt;/option&gt;
              );
            })}
          &lt;/optgroup&gt;
        )}
      &lt;/select&gt;
      &lt;p className=&quot;text-xs leading-[18px] font-base text-white text-opacity-60 mt-2&quot;&gt;
        Choose the LM Studio model you want to use for generating</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/GenericOpenAiOptions/index.jsx (Line 38:2 - Line 65:29), frontend/src/components/EmbeddingSelection/LiteLLMOptions/index.jsx (Line 36:3 - Line 61:14)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn825" onclick="toggleCodeBlock('cloneGroup825', 'expandBtn825', 'collapseBtn825')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn825" onclick="toggleCodeBlock('cloneGroup825', 'expandBtn825', 'collapseBtn825')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup825"><code class="language-jsx text-sm text-gray-800">
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Max embedding chunk length
          &lt;/label&gt;
          &lt;input
            type=&quot;number&quot;
            name=&quot;EmbeddingModelMaxChunkLength&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;8192&quot;
            min={1}
            onScroll={(e) =&gt; e.target.blur()}
            defaultValue={settings?.EmbeddingModelMaxChunkLength}
            required={false}
            autoComplete=&quot;off&quot;
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px]&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;div className=&quot;flex flex-col gap-y-1 mb-4&quot;&gt;
            &lt;label className=&quot;text-white text-sm font-semibold flex items-center gap-x-2&quot;&gt;
              API Key &lt;p className=&quot;!text-xs !italic !font-thin&quot;&gt;optional&lt;/p&gt;
            &lt;/label&gt;
          &lt;/div&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;GenericOpenAiEmbeddingApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/GenericOpenAiOptions/index.jsx (Line 72:2 - Line 93:30), frontend/src/components/LLMSelection/LocalAiOptions/index.jsx (Line 86:2 - Line 53:19)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn826" onclick="toggleCodeBlock('cloneGroup826', 'expandBtn826', 'collapseBtn826')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn826" onclick="toggleCodeBlock('cloneGroup826', 'expandBtn826', 'collapseBtn826')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup826"><code class="language-jsx text-sm text-gray-800">
          /&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div className=&quot;flex justify-start mt-4&quot;&gt;
        &lt;button
          onClick={(e) =&gt; {
            e.preventDefault();
            setShowAdvancedControls(!showAdvancedControls);
          }}
          className=&quot;border-none text-theme-text-primary hover:text-theme-text-secondary flex items-center text-sm&quot;
        &gt;
          {showAdvancedControls ? &quot;Hide&quot; : &quot;Show&quot;} advanced settings
          {showAdvancedControls ? (
            &lt;CaretUp size={14} className=&quot;ml-1&quot; /&gt;
          ) : (
            &lt;CaretDown size={14} className=&quot;ml-1&quot; /&gt;
          )}
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div hidden={!showAdvancedControls}&gt;
        &lt;div className=&quot;w-full flex items-start gap-4</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/GeminiOptions/index.jsx (Line 16:14 - Line 26:22), frontend/src/components/VectorDBSelection/ZillizCloudOptions/index.jsx (Line 1:19 - Line 11:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn827" onclick="toggleCodeBlock('cloneGroup827', 'expandBtn827', 'collapseBtn827')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn827" onclick="toggleCodeBlock('cloneGroup827', 'expandBtn827', 'collapseBtn827')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup827"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  return (
    &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px] mt-1.5&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;GeminiEmbeddingApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/GeminiOptions/index.jsx (Line 28:15 - Line 45:15), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 13:18 - Line 30:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn828" onclick="toggleCodeBlock('cloneGroup828', 'expandBtn828', 'collapseBtn828')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn828" onclick="toggleCodeBlock('cloneGroup828', 'expandBtn828', 'collapseBtn828')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup828"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.GeminiEmbeddingApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Model Preference
          &lt;/label&gt;
          &lt;select
            name=&quot;EmbeddingModelPref&quot;
            required={true}
            className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
          &gt;
            &lt;optgroup label=&quot;Available embedding models&quot;&gt;
              {DEFAULT_MODELS</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/EmbedderItem/index.jsx (Line 1:13 - Line 38:1), frontend/src/components/VectorDBSelection/VectorDBItem/index.jsx (Line 1:13 - Line 28:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn830" onclick="toggleCodeBlock('cloneGroup830', 'expandBtn830', 'collapseBtn830')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn830" onclick="toggleCodeBlock('cloneGroup830', 'expandBtn830', 'collapseBtn830')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup830"><code class="language-jsx text-sm text-gray-800">({
  name,
  value,
  image,
  description,
  checked,
  onClick,
}) {
  return (
    &lt;div
      onClick={() =&gt; onClick(value)}
      className={`w-full p-2 rounded-md hover:cursor-pointer hover:bg-theme-bg-secondary ${
        checked ? &quot;bg-theme-bg-secondary&quot; : &quot;&quot;
      }`}
    &gt;
      &lt;input
        type=&quot;checkbox&quot;
        value={value}
        className=&quot;peer hidden&quot;
        checked={checked}
        readOnly={true}
        formNoValidate={true}
      /&gt;
      &lt;div className=&quot;flex gap-x-4 items-center&quot;&gt;
        &lt;img
          src={image}
          alt={`${name} logo`}
          className=&quot;w-10 h-10 rounded-md&quot;
        /&gt;
        &lt;div className=&quot;flex flex-col&quot;&gt;
          &lt;div className=&quot;text-sm font-semibold text-white&quot;&gt;{name}&lt;/div&gt;
          &lt;div className=&quot;mt-1 text-xs text-description&quot;&gt;{description}&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/CohereOptions/index.jsx (Line 1:23 - Line 11:13), frontend/src/components/VectorDBSelection/ZillizCloudOptions/index.jsx (Line 1:19 - Line 11:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn831" onclick="toggleCodeBlock('cloneGroup831', 'expandBtn831', 'collapseBtn831')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn831" onclick="toggleCodeBlock('cloneGroup831', 'expandBtn831', 'collapseBtn831')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup831"><code class="language-jsx text-sm text-gray-800">({ settings }) {
  return (
    &lt;div className=&quot;w-full flex flex-col gap-y-4&quot;&gt;
      &lt;div className=&quot;w-full flex items-center gap-[36px] mt-1.5&quot;&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;CohereApiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/CohereOptions/index.jsx (Line 7:13 - Line 22:6), frontend/src/components/LLMSelection/CohereAiOptions/index.jsx (Line 7:2 - Line 22:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn832" onclick="toggleCodeBlock('cloneGroup832', 'expandBtn832', 'collapseBtn832')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn832" onclick="toggleCodeBlock('cloneGroup832', 'expandBtn832', 'collapseBtn832')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup832"><code class="language-jsx text-sm text-gray-800">API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;CohereApiKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;Cohere API Key&quot;
            defaultValue={settings?.CohereApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Model</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/CohereOptions/index.jsx (Line 13:15 - Line 31:21), frontend/src/components/EmbeddingSelection/VoyageAiOptions/index.jsx (Line 13:18 - Line 31:25)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn833" onclick="toggleCodeBlock('cloneGroup833', 'expandBtn833', 'collapseBtn833')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn833" onclick="toggleCodeBlock('cloneGroup833', 'expandBtn833', 'collapseBtn833')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup833"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.CohereApiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;
        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Model Preference
          &lt;/label&gt;
          &lt;select
            name=&quot;EmbeddingModelPref&quot;
            required={true}
            className=&quot;border-none bg-theme-settings-input-bg border-gray-500 text-white text-sm rounded-lg block w-full p-2.5&quot;
          &gt;
            &lt;optgroup label=&quot;Available embedding models&quot;&gt;
              {[
                &quot;embed-english-v3.0&quot;</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/CohereOptions/index.jsx (Line 37:26 - Line 56:1), frontend/src/components/EmbeddingSelection/OpenAiOptions/index.jsx (Line 33:25 - Line 57:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn834" onclick="toggleCodeBlock('cloneGroup834', 'expandBtn834', 'collapseBtn834')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn834" onclick="toggleCodeBlock('cloneGroup834', 'expandBtn834', 'collapseBtn834')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup834"><code class="language-jsx text-sm text-gray-800">,
              ].map((model) =&gt; {
                return (
                  &lt;option
                    key={model}
                    value={model}
                    selected={settings?.EmbeddingModelPref === model}
                  &gt;
                    {model}
                  &lt;/option&gt;
                );
              })}
            &lt;/optgroup&gt;
          &lt;/select&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/AzureAiOptions/index.jsx (Line 7:9 - Line 23:4), frontend/src/components/LLMSelection/AzureAiOptions/index.jsx (Line 11:2 - Line 27:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn835" onclick="toggleCodeBlock('cloneGroup835', 'expandBtn835', 'collapseBtn835')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn835" onclick="toggleCodeBlock('cloneGroup835', 'expandBtn835', 'collapseBtn835')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup835"><code class="language-jsx text-sm text-gray-800">
          &lt;/label&gt;
          &lt;input
            type=&quot;url&quot;
            name=&quot;AzureOpenAiEndpoint&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;https://my-azure.openai.azure.com&quot;
            defaultValue={settings?.AzureOpenAiEndpoint}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;

        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/AzureAiOptions/index.jsx (Line 13:34 - Line 27:15), frontend/src/components/VectorDBSelection/WeaviateDBOptions/index.jsx (Line 13:22 - Line 27:15)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn836" onclick="toggleCodeBlock('cloneGroup836', 'expandBtn836', 'collapseBtn836')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn836" onclick="toggleCodeBlock('cloneGroup836', 'expandBtn836', 'collapseBtn836')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup836"><code class="language-jsx text-sm text-gray-800">&quot;
            defaultValue={settings?.AzureOpenAiEndpoint}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;

        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            API Key
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;AzureOpenAiKey</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/EmbeddingSelection/AzureAiOptions/index.jsx (Line 23:4 - Line 39:10), frontend/src/components/LLMSelection/AzureAiOptions/index.jsx (Line 27:2 - Line 43:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn837" onclick="toggleCodeBlock('cloneGroup837', 'expandBtn837', 'collapseBtn837')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn837" onclick="toggleCodeBlock('cloneGroup837', 'expandBtn837', 'collapseBtn837')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup837"><code class="language-jsx text-sm text-gray-800">
          &lt;/label&gt;
          &lt;input
            type=&quot;password&quot;
            name=&quot;AzureOpenAiKey&quot;
            className=&quot;border-none bg-theme-settings-input-bg text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5&quot;
            placeholder=&quot;Azure OpenAI API Key&quot;
            defaultValue={settings?.AzureOpenAiKey ? &quot;*&quot;.repeat(20) : &quot;&quot;}
            required={true}
            autoComplete=&quot;off&quot;
            spellCheck={false}
          /&gt;
        &lt;/div&gt;

        &lt;div className=&quot;flex flex-col w-60&quot;&gt;
          &lt;label className=&quot;text-white text-sm font-semibold block mb-3&quot;&gt;
            Embedding</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceChat/index.jsx (Line 10:14 - Line 22:5), frontend/src/pages/WorkspaceSettings/index.jsx (Line 36:18 - Line 48:2)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn841" onclick="toggleCodeBlock('cloneGroup841', 'expandBtn841', 'collapseBtn841')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn841" onclick="toggleCodeBlock('cloneGroup841', 'expandBtn841', 'collapseBtn841')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup841"><code class="language-jsx text-sm text-gray-800">() {
  const { loading, requiresAuth, mode } = usePasswordModal();

  if (loading) return &lt;FullScreenLoader /&gt;;
  if (requiresAuth !== false) {
    return &lt;&gt;{requiresAuth !== null &amp;&amp; &lt;PasswordModal mode={mode} /&gt;}&lt;/&gt;;
  }

  return &lt;ShowWorkspaceChat /&gt;;
}

function ShowWorkspaceChat() {
  const { slug</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/pages/WorkspaceChat/index.jsx (Line 22:10 - Line 34:7), frontend/src/pages/WorkspaceSettings/index.jsx (Line 50:8 - Line 63:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn842" onclick="toggleCodeBlock('cloneGroup842', 'expandBtn842', 'collapseBtn842')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn842" onclick="toggleCodeBlock('cloneGroup842', 'expandBtn842', 'collapseBtn842')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup842"><code class="language-jsx text-sm text-gray-800">();
  const [workspace, setWorkspace] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() =&gt; {
    async function getWorkspace() {
      if (!slug) return;
      const _workspace = await Workspace.bySlug(slug);
      if (!_workspace) {
        setLoading(false);
        return;
      }
      </code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Sidebar/index.jsx (Line 186:8 - Line 196:133), frontend/src/components/Sidebar/index.jsx (Line 68:5 - Line 78:131)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn921" onclick="toggleCodeBlock('cloneGroup921', 'expandBtn921', 'collapseBtn921')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn921" onclick="toggleCodeBlock('cloneGroup921', 'expandBtn921', 'collapseBtn921')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup921"><code class="language-jsx text-sm text-gray-800">&quot; /&gt;
                        &lt;p className=&quot;text-sidebar text-sm font-semibold&quot;&gt;
                          {t(&quot;new-workspace.title&quot;)}
                        &lt;/p&gt;
                      &lt;/button&gt;
                    )}
                  &lt;/div&gt;
                  &lt;ActiveWorkspaces /&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;div className=&quot;z-99 absolute bottom-0 left-0 right-0 pt-2 pb-6 rounded-br-[26px] bg-theme-bg-sidebar bg-opacity-80 backdrop-filter backdrop-blur-md</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Sidebar/index.jsx (Line 196:133 - Line 207:1), frontend/src/components/Sidebar/index.jsx (Line 78:131 - Line 89:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn922" onclick="toggleCodeBlock('cloneGroup922', 'expandBtn922', 'collapseBtn922')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn922" onclick="toggleCodeBlock('cloneGroup922', 'expandBtn922', 'collapseBtn922')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup922"><code class="language-jsx text-sm text-gray-800">&quot;&gt;
                &lt;Footer /&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        {showingNewWsModal &amp;&amp; &lt;NewWorkspaceModal hideModal={hideNewWsModal} /&gt;}
      &lt;/div&gt;
    &lt;/&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/SettingsSidebar/index.jsx (Line 34:2 - Line 47:3), frontend/src/components/Sidebar/index.jsx (Line 105:25 - Line 118:7)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn923" onclick="toggleCodeBlock('cloneGroup923', 'expandBtn923', 'collapseBtn923')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn923" onclick="toggleCodeBlock('cloneGroup923', 'expandBtn923', 'collapseBtn923')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup923"><code class="language-jsx text-sm text-gray-800">
    function handleBg() {
      if (showSidebar) {
        setTimeout(() =&gt; {
          setShowBgOverlay(true);
        }, 300);
      } else {
        setShowBgOverlay(false);
      }
    }
    handleBg();
  }, [showSidebar]);

  if</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/SettingsSidebar/index.jsx (Line 186:2 - Line 201:7), frontend/src/pages/GeneralSettings/Settings/components/SupportEmail/index.jsx (Line 13:3 - Line 57:3)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn924" onclick="toggleCodeBlock('cloneGroup924', 'expandBtn924', 'collapseBtn924')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn924" onclick="toggleCodeBlock('cloneGroup924', 'expandBtn924', 'collapseBtn924')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup924"><code class="language-jsx text-sm text-gray-800">);
  const { t } = useTranslation();

  useEffect(() =&gt; {
    const fetchSupportEmail = async () =&gt; {
      const supportEmail = await System.fetchSupportEmail();
      setSupportEmail(
        supportEmail?.email
          ? `mailto:${supportEmail.email}`
          : paths.mailToMintplex()
      );
    };
    fetchSupportEmail();
  }, []);

  return</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/PrivateRoute/index.jsx (Line 116:10 - Line 126:4), frontend/src/components/PrivateRoute/index.jsx (Line 87:6 - Line 97:4)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn925" onclick="toggleCodeBlock('cloneGroup925', 'expandBtn925', 'collapseBtn925')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn925" onclick="toggleCodeBlock('cloneGroup925', 'expandBtn925', 'collapseBtn925')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup925"><code class="language-jsx text-sm text-gray-800"> }) {
  const { isAuthd, shouldRedirectToOnboarding, multiUserMode } =
    useIsAuthenticated();
  if (isAuthd === null) return &lt;FullScreenLoader /&gt;;

  if (shouldRedirectToOnboarding) {
    return &lt;Navigate to={paths.onboarding.home()} /&gt;;
  }

  const user = userFromStorage();
  return isAuthd &amp;&amp; (user?.role !==</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/PrivateRoute/index.jsx (Line 145:8 - Line 155:1), frontend/src/components/PrivateRoute/index.jsx (Line 126:2 - Line 136:1)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn926" onclick="toggleCodeBlock('cloneGroup926', 'expandBtn926', 'collapseBtn926')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn926" onclick="toggleCodeBlock('cloneGroup926', 'expandBtn926', 'collapseBtn926')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup926"><code class="language-jsx text-sm text-gray-800"> ? (
    &lt;KeyboardShortcutWrapper&gt;
      &lt;UserMenu&gt;
        &lt;Component /&gt;
      &lt;/UserMenu&gt;
    &lt;/KeyboardShortcutWrapper&gt;
  ) : (
    &lt;Navigate to={paths.login(true)} /&gt;
  );
}
</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Modals/NewWorkspace.jsx (Line 32:22 - Line 47:4), frontend/src/components/WorkspaceChat/ChatContainer/PromptInput/SlashCommands/SlashPresets/AddPresetModal.jsx (Line 34:29 - Line 69:9)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn927" onclick="toggleCodeBlock('cloneGroup927', 'expandBtn927', 'collapseBtn927')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn927" onclick="toggleCodeBlock('cloneGroup927', 'expandBtn927', 'collapseBtn927')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup927"><code class="language-jsx text-sm text-gray-800">)}
            &lt;/h3&gt;
          &lt;/div&gt;
          &lt;button
            onClick={hideModal}
            type=&quot;button&quot;
            className=&quot;absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border&quot;
          &gt;
            &lt;X size={24} weight=&quot;bold&quot; className=&quot;text-white&quot; /&gt;
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div
          className=&quot;h-full w-full overflow-y-auto&quot;
          style={{ maxHeight: &quot;calc(100vh - 200px)&quot; }}
        &gt;
          &lt;form ref</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/Footer/index.jsx (Line 79:9 - Line 92:24), frontend/src/components/Footer/index.jsx (Line 62:11 - Line 75:5)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn928" onclick="toggleCodeBlock('cloneGroup928', 'expandBtn928', 'collapseBtn928')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn928" onclick="toggleCodeBlock('cloneGroup928', 'expandBtn928', 'collapseBtn928')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup928"><code class="language-jsx text-sm text-gray-800">
                weight=&quot;fill&quot;
                className=&quot;h-5 w-5&quot;
                color=&quot;var(--theme-sidebar-footer-icon-fill)&quot;
              /&gt;
            &lt;/Link&gt;
          &lt;/div&gt;
          &lt;div className=&quot;flex w-fit&quot;&gt;
            &lt;Link
              to={paths.discord()}
              target=&quot;_blank&quot;
              rel=&quot;noreferrer&quot;
              className=&quot;transition-all duration-300 p-2 rounded-full bg-theme-sidebar-footer-icon hover:bg-theme-sidebar-footer-icon-hover&quot;
              aria-label=&quot;Join our Discord server</code></pre></div><div class="py-4"><p class="text-gray-600">frontend/src/components/DataConnectorOption/index.jsx (Line 6:2 - Line 17:7), frontend/src/components/LLMSelection/LLMProviderOption/index.jsx (Line 19:3 - Line 30:10)</p><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2" id="expandBtn929" onclick="toggleCodeBlock('cloneGroup929', 'expandBtn929', 'collapseBtn929')">Show code</button><button class="bg-gray-500 text-white px-1 py-0.5 text-xs rounded focus:outline-none ml-2 hidden" id="collapseBtn929" onclick="toggleCodeBlock('cloneGroup929', 'expandBtn929', 'collapseBtn929')">Hide code</button><pre class="bg-gray-100 border border-gray-200 p-4 rounded mt-2 hidden" id="cloneGroup929"><code class="language-jsx text-sm text-gray-800">
      &lt;label className=&quot;transition-all duration-300 inline-flex flex-col h-full w-60 cursor-pointer items-start justify-between rounded-2xl bg-preference-gradient border-2 border-transparent shadow-md px-5 py-4 text-white hover:bg-selected-preference-gradient hover:border-white/60 peer-checked:border-white peer-checked:border-opacity-90 peer-checked:bg-selected-preference-gradient&quot;&gt;
        &lt;div className=&quot;flex items-center&quot;&gt;
          &lt;img src={image} alt={name} className=&quot;h-10 w-10 rounded&quot; /&gt;
          &lt;div className=&quot;ml-4 text-sm font-semibold&quot;&gt;{name}&lt;/div&gt;
        &lt;/div&gt;
        &lt;div className=&quot;mt-2 text-xs font-base text-white tracking-wide&quot;&gt;
          {description}
        &lt;/div&gt;
        &lt;a
          href={link}
          target</code></pre></div><!-- Add more clone groups for .txt format as needed         // Add more clone groups for .txt format as needed--></div></section><!-- Add more sections for other formats and clone groups as needed--></main><footer class="bg-white shadow mt-8 py-4"><div class="container mx-auto px-4 text-center"><p class="text-sm text-gray-600">This report is generated by jscpd, an open-source copy/paste detector.</p><p class="text-sm text-gray-600">jscpd is licensed under the MIT License.</p><a class="text-blue-500 text-sm" href="https://github.com/kucherenko/jscpd" target="_blank" rel="noopener noreferrer">View jscpd on GitHub</a></div></footer><script src="js/prism.js"></script><script>function toggleCodeBlock(codeBlockId, expandBtnId, collapseBtnId) {
  const codeBlock = document.getElementById(codeBlockId);
  const expandBtn = document.getElementById(expandBtnId);
  const collapseBtn = document.getElementById(collapseBtnId);

  codeBlock.classList.toggle('hidden');
  expandBtn.classList.toggle('hidden');
  collapseBtn.classList.toggle('hidden');
}</script></body></html>